var WSB;(function(n){const t=/[0-9a-zA-Z]/,i=/\s+/g;class r{constructor(t){this._accessTokenManager=t;n.Host.bindAccessTokenAvailable(n=>{this.getProfilePictureToken(n,()=>{})})}getProfilePictureToken(t,i){this._accessTokenManager.getAccount(t,t==1?"https://outlook.office.com/":n.config.useCobaltCSS?"https://outlook.office.com/M365.Access":"https://outlook.office.com/User.ReadWrite",!1,!0,n=>i(n?n.Token:null),undefined,n.Host.isAuthInvestigation()?["SubstrateProfilePictureProvider::getProfilePictureToken"]:undefined)}getProfilePictureIconInternal(t,i,r,u){return n.Async.safeChainWithGlobalCaching("getProfilePictureIcon",()=>ThresholdUtilities.createPromise(u=>t(t=>{if(!t){u(null);return}let f=SearchAppWrapper.CortanaApp.createStringMap(),s=SearchAppWrapper.CortanaApp.createStringMap();f.Authorization="Bearer "+t;i==0&&(f["X-AnchorMailbox"]=r);let e,o=0;_w.BingAtWork&&_w.BingAtWork.wsb&&_w.BingAtWork.wsb.gccRegion===2&&(o=2);e=o===2?i==1?"https://substrate.office365.us/api/v2.0/Users('"+r+"')/photo/$value":"https://substrate.office365.us/imageB2/v1.0/users/"+r+"/image/$value":i==1?"https://substrate.office.com/api/v2.0/Users('"+r+"')/photo/$value":"https://substrate.office.com/imageB2/v1.0/users/"+r+"/image/$value";n.Async.safeChain("getProfilePictureIcon",()=>SearchAppWrapper.CortanaApp.makeHttpRequestAsync(0,e,f,"",s),t=>{if(t.statusCode!==200){u(null);return}n.Async.safeChain("getProfilePictureIcon",()=>t.readAsStreamAsync(),u,()=>u(null))},()=>u(null),null,null,0)})),()=>r+"_icon",t=>{let i=n.toIcon(t,"getProfilePictureIcon",u);return i&&(i.className="peopleIcon"),i},u)}getProfilePictureIconForToken(n,t,i,r){return this.getProfilePictureIconInternal(n=>n(t),n,i,r)}getProfilePictureIcon(n,t,i){return this.getProfilePictureIconInternal(t=>this.getProfilePictureToken(n,t),n,t,i)}getPersonDefaultIcon(n){let r,u=n.trim().replace(i," ").split(" ",2);if(u.length>0){let n=u[0][0];if(t.test(n)&&(r=n),u.length==2){let n=u[1][0];r&&t.test(n)?r+=n:r=""}}return{type:r?5:2,content:r?r.toUpperCase():"&#xE77B",className:"peopleIcon"}}}n.SubstrateProfilePictureProvider=r})(WSB||(WSB={}))