(window.officehome_pwa_webpackJsonp=window.officehome_pwa_webpackJsonp||[]).push([[133],{"6oTH":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));const s=new Map([["mru","Recent"],["unpinned-mru","Recent"],["pinned-mru","Pinned"],["shared-mru","Shared"],["trending-docs","Trending"],["classNotebook-mru","ClassNotebooks"],["app-items-mru","AppItems"],["app-items-forms","AppItems"],["app-items-deleted","Other"],["groupItemsForms","AppItems"],["groupItemsFormsDeleted","Other"]])},GHXR:function(e,t,i){"use strict";i.r(t),i.d(t,"MruModuleNgFactory",(function(){return yt}));var s=i("Mlb/"),a=i("laSs"),n=i("WJAz"),r=i("WKA6"),o=i("lrJm"),l=i("dOgD"),c=i("dx17"),h=i("Ry9Z"),u=i("+YV+"),d=i("rmEM"),m=i("1ygu"),p=i("CC5A"),b=i("hhzZ"),S=i("BaAg"),g=i("p6Zr"),v=i("Eu1D"),f=i("6oTH"),T=i("2lMP"),M=i("L/Tc"),y=i("QOOv"),w=i("JT1q"),I=i("7Rc8"),A=i("fKR7"),C=i("7wk3"),D=i("AXqk"),L=i("W3Zz"),E=i("hZW2"),R=i("7Gwk"),x=i("rBEp"),k=i("Z0U4"),N=i("Dpxn"),F=i("v3sZ"),P=i("p6gk"),O=i("EqbI"),U=i("Uqr9"),V=i("6GOa"),W=i("w1PR"),z=i("BJbw"),B=i("gO/A"),H=i("4/We"),_=i("cgnd"),j=i("/I02"),G=i("PBJH"),q=i("JH4S"),Z=i("ZBli"),$=i("JScD"),J=i("9MHL"),K=i("rBrS"),Q=i("TDzr");class Y{constructor(e){const t=[],i=[];for(let s=0;s<e.length;s++){const a=e[s];a.isPinned?t.push(a):i.push(a)}this.documents={[Y.PinnedStateKey]:t,[Y.UnpinnedStateKey]:i,[Y.AllCategoryKey]:e}}getAllPinnedDocuments(){return this.documents[Y.PinnedStateKey]||[]}getAllUnpinnedDocuments(){return this.documents[Y.UnpinnedStateKey]||[]}getAllDocuments(){return this.documents[Y.AllCategoryKey]||[]}removeItem(e){const t=e.isPinned?this.getAllPinnedDocuments():this.getAllUnpinnedDocuments();this.deleteItemFromList(t,e),this.deleteItemFromList(this.getAllDocuments(),e)}addItem(e){const t=e.isPinned?this.getAllPinnedDocuments():this.getAllUnpinnedDocuments();this.addItemToList(t,e),this.addItemToList(this.getAllDocuments(),e)}deleteItemFromList(e,t){if(e)for(let i=0;i<e.length;i++)if(e[i].id===t.id)return void e.splice(i,1)}addItemToList(e,t){if(e){for(let i=0;i<e.length;i++)if(e[i].lastViewedTime<=t.lastViewedTime)return void e.splice(i,0,t);e.push(t)}}}Y.AllCategoryKey="all",Y.PinnedStateKey="pinned",Y.UnpinnedStateKey="unpinned";var X=i("3GGT"),ee=i("R7NL"),te=i("OyI4"),ie=i("kpuN"),se=i("wwmn"),ae=i("casz"),ne=i("ZtId"),re=i("pOWU"),oe=i("oAX+"),le=i("vk2e");class ce extends te.a{constructor(e,t,i,s,a,n,r,o,l,c,h){super(e,t,i,s,a,n,r,o,l,n.config.sharedWithMeV2Enabled?"docs/v2.0/sharedwithme":"docs/sharedwithme",n.config.supportedFileTypesSwM,h),this.updateContentService=c,this.mruConfig=n.config,this.sharingTypeParam=this.mruConfig.sharedWithMeV2Enabled&&!this.mruConfig.sharedAttachmentsEnabled?ce.sharingSpecifier:"",this.sharedDocsDataStreamMap=new Map}getSharedDocuments(e,t){const i=`${this.serviceBaseUrl}?${this.requestParams(e,t)}${this.sharingTypeParam}`;if(this.sharedDocsDataStreamMap.has(i))return this.sharedDocsDataStreamMap.get(i);const s=this.updateContentService.getOrAddUpdateStream(`sharedwithme-${i}`,(()=>this.fetchSharedData(i,"network-first"))),a=this.fetchSharedData(i,"cache-only"),n=this.fetchSharedData(i,"network-first"),r=oe.a.createResultsWithCacheObservable(a,n,s,(e=>this.sharedDocsDataStreamMap.delete(i)));return this.sharedDocsDataStreamMap.set(i,r),r}handleQueryParam(e,t,i){"mocksharedwithme"===e&&this.mockRequestHeader&&i.headers.set(this.mockRequestHeader,t)}fetchSharedData(e,t){return new Promise(((i,s)=>{const a=this.mruConfig.sharedWithMeV2Enabled?"2":"1";this.get("Shared_With_Me_Request","Shared_With_Me",e,(e=>{e.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e),e.ok&&(t.SharedWithMeVersion=a,e.data&&e.data.shared_documents?t.ActualSize=e.data.shared_documents.length.toString():t.HttpCode=X.a.UnexpectedResponse.toString())})).then((e=>{e.ok&&e.data&&e.data.shared_documents?(e.data.shared_documents.sort(((e,t)=>new Date(t.SharedDate).getTime()-new Date(e.SharedDate).getTime())),i({items:e.data.shared_documents,fromCache:e.fromCache})):s(new re.b(e,"No data returned"))})).catch((e=>{this.globalErrorHandler.handleError(e,"sMMaG")}))}),s,this.getNewRequestConfig(!1),t)}))}}ce.sharingSpecifier="&sharingTypes=ShareFlow",ce.Éµprov=s.kc({factory:function(){return new ce(s.lc(ie.a),s.lc(b.a),s.lc(ee.a),s.lc(j.a),s.lc(se.a),s.lc(y.a),s.lc(le.q),s.lc(o.b),s.lc(_.b),s.lc(ne.a),s.lc(ae.a))},token:ce,providedIn:"root"});class he{constructor(e,t,i,a,n,r,o,l,c,h,u,d,m,p,b,S,g,v,f,T,M,y,w,I,A,C,D,L,E,R,x,k,N,F,P){this.capabilitiesService=e,this.changeDetector=t,this.clientStartupConfigService=i,this.contextService=a,this.dataSecurityService=n,this.deviceDetector=r,this.documentService=o,this.eventService=l,this.formsService=c,this.instrumentationService=h,this.jumpListService=u,this.locService=d,this.mruConfigService=m,this.officeFeedService=p,this.onenoteGraphService=b,this.oneNoteService=S,this.onNoteConfigService=g,this.performanceService=v,this.mruDataService=f,this.sharedWithMeService=T,this.activatedRoute=M,this.globalErrorHandler=y,this.userContextService=w,this.uploadConfigService=I,this.activityDescriptionService=A,this.officeRouteService=C,this.swayServiceConfigService=D,this.analyticsService=L,this.browserPaintMeasurementService=E,this.urlAuthenticatorService=R,this.oneDriveUploadService=x,this.createMenuService=k,this.oneDriveService=N,this.themingService=F,this.visualService=P,this.numLoggableItems=0,this.isVisualRefresh=!1,this.emptyViewName="empty-view",this.tabImpressionIndex=0,this.isFormsApp=!1,this.stateChanged=new s.q,this.listAnimation=this.capabilitiesService.capabilities.disableAnimation?"None":"FadeAndScale"}ngOnInit(){T.a.isFirstClick=!0,this.fluentRefresh=this.capabilitiesService.capabilities.fluentRefresh,this.isFormsApp=this.fileType===S.b.Forms,this.showInCardView=this.isFormsApp,this.filterEnabled=this.isFormsApp,this.onFilter=this.onFilter.bind(this),this.defaultView=this.isFormsApp?"Card":"List";const e=this.capabilitiesService.capabilities;this.stateChanged.emit({state:v.a.Loading}),this.componentArea=b.b.Documents,this.recentSectionLandmarkAriaLabel=this.locService.RecentDocumentsLandmarkAriaLabel,this.themed=this.userContextService.user.themed,this.mruConfig=this.mruConfigService.config,this.pinnedDocsEnabled=this.mruConfig.mruPinEnabled,this.selectedTab=0,this.tileViewEnabled=this.mruConfig.tileViewEnabled||this.isFormsApp,this.trendingDocsEnabled=this.mruConfig.trendingAroundMeEnabled&&this.fileType!==S.b.Sway&&!this.isFormsApp,this.mobile=!this.deviceDetector.isDesktopDevice(),this.appFilter=this.fileType?new Set([this.fileType]):null,this.appSuffix=this.fileType?`-${S.b[this.fileType].toLowerCase()}`:"",this.maxInitialDocumentCards=this.maxInitialDocs||2*he.maxCardsPerLine,this.maxInitialDocuments=this.maxInitialDocs||this.mruConfig.maxInitialListItems,this.maxTotalDocuments=this.maxTotalDocs||this.mruConfig.maxTotalListItems,this.showAnalytics=this.mruConfig.analyticsEnabled&&this.fileType===S.b.Sway,this.showActivity=!this.showAnalytics&&this.mruConfig.activityEnabled&&this.fileType!==S.b.OneNote&&!this.isFormsApp,this.showSharing=!this.showAnalytics&&this.mruConfig.sharingStatusEnabled&&!this.isFormsApp,this.showMobileShareAndActivity=this.mruConfig.mobileShareAndActivityEnabled,this.isConsumer=this.clientStartupConfigService.config.authType===_.a.MSA,this.newMruEmptyStateEnabled=this.isConsumer&&this.capabilitiesService.capabilities.newMruEmptyStateEnabled,this.sharedWithMeViewEnabled=this.mruConfig.sharedWithMeViewEnabled&&this.fileType!==S.b.Sway&&!(this.isConsumer&&this.isFormsApp),this.capabilitiesService.capabilities.darkModeEnabled&&(this.themeShadesSubscription=this.themingService.darkModeSubscription.subscribe((e=>{this.darkMode=e,this.updateEmptyStates()}))),this.capabilitiesService.capabilities.visualBackgroundEnabled&&(this.visualRefreshSubscription=this.visualService.visualConfigSubscription.subscribe((e=>{this.isVisualRefresh=e.visualBackgroundEnabled}))),e.oneDriveUploadEnabled&&this.uploadConfigService.config&&this.fileType!==S.b.Sway&&this.fileType!==S.b.OneNote&&!this.isFormsApp&&this.oneDriveUploadService.uploadEnabledPromise.then((e=>this.uploadEnabled=e)),this.createMenuService.createButtonEnabledPromise.then((e=>this.createButtonEnabled=e)),this.routeSubscription=this.officeRouteService.subscribeToRouteChangeEnd((e=>{if(e.currentRoute){const t=e.currentRoute.route,i=e.previousRoute?e.previousRoute.route:null;("Templates"===i&&"Start"===t||null!==i&&"OfficeHome"===t)&&(this.listAnimation="None"),("Content"===i||this.isFormsApp&&("MyForms"===i||"GroupForms"===i))&&this.mruDataService.updateMruDocuments(this.appFilter)}})),this.recentTabListModel=new p.b({id:this.isFormsApp?K.a.FormsTabList:K.a.Recent,area:this.componentArea,tabs:[],logImpression:this.logTabImpression.bind(this),headerText:this.title,tabActivationAriaLabel:this.locService.MruTabActivationAriaLabel}),this.recentMruStreamData||(this.recentMruStreamData=this.mruDataService.getMruDocuments(this.appFilter)),this.recentMruStream=this.recentMruStreamData.results.subscribe((e=>this.processRecentMruTask(e))),this.recentMruStreamData.initialCompletion.then((e=>{e&&(this.globalErrorHandler.handleCacheObservableError(e,"jM9a5","al4U3"),this.recentTab||this.stateChanged.emit({state:v.a.Failed}))}));const t=this.recentMruStreamData.results.pipe(Object(r.a)(1)).toPromise().then((e=>e?e.items.length:Promise.reject("Observable completed with no values")));(e.isPwaInUwp||this.isConsumer)&&t.then((e=>this.eventService.broadcastEvent({name:"mruReady",args:[e]}))),this.initialTabsPromise=t.then((()=>{S.b.OneNote===this.fileType&&this.onNoteConfigService.config.enableOneNoteApis&&this.recentTabListModel.updateOrAddTab(this.createMyAppItemsLoadingTab(this.fileType)),this.sharedWithMeViewEnabled&&(this.createSharedLoadingTab(),this.recentTabListModel.updateOrAddTab(this.sharedWithMeTab)),S.b.OneNote===this.fileType&&this.userContextService.user.isEdu&&this.onNoteConfigService.config.enableOneNoteApis&&this.recentTabListModel.updateOrAddTab(this.createClassNoteBookLoadingTab()),this.trendingDocsEnabled&&(this.createTrendingLoadingTab(),this.recentTabListModel.updateOrAddTab(this.trendingTab))})).catch((()=>{}))}ngOnDestroy(){var e,t,i,s,a,n,r;this.logPendingTabImpression(),null===(e=this.recentMruStream)||void 0===e||e.unsubscribe(),null===(t=this.routeSubscription)||void 0===t||t.unsubscribe(),null===(i=this.sharedWithMeSubscription)||void 0===i||i.unsubscribe(),null===(s=this.trendingDocSubscription)||void 0===s||s.unsubscribe(),null===(a=this.appItemStreamSubscription)||void 0===a||a.unsubscribe(),null===(n=this.themeShadesSubscription)||void 0===n||n.unsubscribe(),null===(r=this.visualRefreshSubscription)||void 0===r||r.unsubscribe()}onTabClicked(e){this.selectedTab=e,this.focusFirstItem=!1,this.updateNumLoggableItems(),this.updateWithNewZeroStateCheck()}onDeleteItem(e){if(5===e.deleteOption)e.item.fileType===S.b.Forms&&(this.sendMruItemState(0,e.item),this.formsService.unpinSharedForm(e.item.docId).then((()=>{const t=this.sharedData,i=t.value.findIndex((t=>t.id===e.item.docId));t.value.splice(i,1),t.fromCache=!1,this.processSharedDocTask(t,!1),this.sendMruItemState(1,e.item)})).catch((()=>{this.sendMruItemState(1,e.item)})));else if(3===e.deleteOption);else{const t=e.item;this.documents.removeItem(t),this.mruDataService.removeDocument(Object(w.h)(t)),this.updateListModels(),this.setFocusOnStateChange(e.index)}}onFilter(e){this.updateListModels(e),this.focusOnFilter=!0,this.screenReaderText=e?this.locService.format(this.locService.FilterResultsFound,this.recentTabListModel.tabs[this.selectedTab].listModel.items.length.toString()):this.locService.NoFiltersApplied}onChangePinState(e){const t=e.item;this.documents.removeItem(t),t.isPinned=e.isPinned,this.documents.addItem(t),this.updateListModels(),this.mruDataService.updatePinnedState(Object(w.h)(t)),this.changeDetector.detectChanges(),this.setFocusOnStateChange(e.index,e.element)}trackByIndex(e){return e}updateEmptyStates(){!this.appSuffix&&this.recentTabListModel&&this.recentTabListModel.tabs&&this.recentTabListModel.tabs.length&&(this.pinnedTab.zeroExperienceImage=this.darkMode?"emptystate-icons-sprite-darkmode emptystate-pinned-darkmode":"emptystate-icons-sprite emptystate-pinned",this.recentTabListModel.updateOrAddTab(this.pinnedTab),this.recentTab.zeroExperienceImage=this.darkMode?"emptystate-icons-sprite-darkmode emptystate-recent-darkmode":"emptystate-icons-sprite emptystate-recent",this.recentTabListModel.updateOrAddTab(this.recentTab),this.sharedWithMeTab.zeroExperienceImage=this.darkMode?"emptystate-icons-sprite-darkmode emptystate-swm-darkmode":"emptystate-icons-sprite emptystate-swm",this.recentTabListModel.updateOrAddTab(this.sharedWithMeTab),this.trendingTab&&(this.trendingTab.zeroExperienceImage=this.darkMode?"emptystate-icons-sprite-darkmode emptystate-discover-darkmode":"emptystate-icons-sprite emptystate-discover",this.recentTabListModel.updateOrAddTab(this.trendingTab)))}setFocusOnStateChange(e,t){setTimeout((()=>{const i=this.recentTabListModel.tabs[this.selectedTab];let s;if(0===i.listModel.items.length)s=this.documentService.nativeDocument.getElementById(`tab-list-header-link-${i.id}`);else if(t&&i!==this.pinnedTab)s=t.nativeElement;else{const t=i.listModel.items[(!i.listModel.maxItemCount||e<i.listModel.maxItemCount)&&e<i.listModel.items.length?e:i.listModel.items.length];s=t?this.documentService.nativeDocument.getElementById(`${i.id}-${t.getId()}`):null}s&&s.focus()}),0)}isEmptyRecentView(){return this.recentTab&&this.recentTabListModel.tabs[this.selectedTab]===this.recentTab&&this.recentTab.listModel&&this.recentTab.listModel.items&&0===this.recentTab.listModel.items.length&&!this.recentTab.hasError&&!this.fileType}getSharedDocuments(){return this.sharedWithMeService.getSharedDocuments(this.mruConfig.mruNumItemsToRequest,this.appFilter)}getTamyDocuments(){return this.officeFeedService.getTamyDocuments(this.maxTotalDocuments,this.appFilter)}waitOnItemInflations(e){return Object(n.a)(e.map((e=>e.initialInflationCompleted))).toPromise()}processShared(e){if(!e)return;let t=null,i=this.maxTotalDocuments;return this.isFormsApp?(t=e.map(((e,t)=>Object(w.b)(e,`forms_shared_item_${t}`,"FormsSharedDocsImpression",this.contextService.isRtl,this.clientStartupConfigService.config.authType,!1,A.a.SharedForm))),i=t.length):t=e.map(((e,t)=>Object(w.g)(e,`shared_item_${t}`,"SharedDocsImpression",this.contextService.isRtl,this.clientStartupConfigService.config.authType,!1))),new d.a(t,this.locService.ShowMoreMruResultsAriaLabel,this.locService.ShowLessMruResultsAriaLabel,this.locService.ShowMoreMruResultsUpdateAriaLabel,this.locService.ShowLessMruResultsUpdateAriaLabel,this.maxInitialDocuments,i,((e,i)=>this.logTabImpression(t,"shared-mru",e,i,!1)),this.listAnimation,{isSmallMobileCards:this.isFormsApp,isEvenPadding:this.isFormsApp})}getNotebooks(){return this.onenoteGraphService.getNoteBooks("stale-while-revalidate")}processAppItems(e){return new Promise((t=>{if(!e.value)return void t(void 0);const i=[];for(const t of e.value)this.fileType===S.b.OneNote&&i.push(Promise.resolve(t));Promise.all(i).then((e=>{const i=e.filter((e=>null!==e)).map(((e,t)=>{if(this.fileType===S.b.OneNote)return Object(w.c)(e,`${S.a.fileTypeNameFromType(this.fileType)}_item_${t}`,`${S.a.fileTypeNameFromType(this.fileType)}Impression`,this.contextService.isRtl,this.clientStartupConfigService.config.authType,!1)}));t(new d.a(i,this.locService.ShowMoreMruResultsAriaLabel,this.locService.ShowLessMruResultsAriaLabel,this.locService.ShowMoreMruResultsUpdateAriaLabel,this.locService.ShowLessMruResultsUpdateAriaLabel,this.maxInitialDocuments,this.maxTotalDocuments,((e,t)=>this.logTabImpression(i,"app-items-mru",e,t,!1)),this.listAnimation,{isSmallMobileCards:this.isFormsApp,isEvenPadding:this.isFormsApp}))}))}))}getClassNoteBooks(){return this.oneNoteService.getClassNoteBooks().then((e=>this.processClassNoteBooks(e)))}processClassNoteBooks(e){if(!e)return;const t=e.map(((e,t)=>Object(w.a)(e,`classnotebook_item_${t}`,"ClassNoteBookImpression",this.contextService.isRtl,this.clientStartupConfigService.config.authType,!1)));return new d.a(t,this.locService.ShowMoreMruResultsAriaLabel,this.locService.ShowLessMruResultsAriaLabel,this.locService.ShowMoreMruResultsUpdateAriaLabel,this.locService.ShowLessMruResultsUpdateAriaLabel,this.maxInitialDocuments,this.maxTotalDocuments,((e,i)=>this.logTabImpression(t,"classNotebook-mru",e,i,!1)),this.listAnimation)}createClassNoteBookLoadingTab(){const e=this.createClassNoteBookTab();return e.onLoad=()=>this.getClassNoteBooks().then((t=>{e.listModel=t})),e}createClassNoteBookTab(e){const t=this.locService.ClassNotebookTabTitle;return{id:"classNotebook-mru",title:t,ariaLabel:this.locService.format(this.locService.DocumentTabAriaLabelFormat,t),listModel:e,zeroExperienceTitle:this.locService.NoClassNotebooksTitle,zeroExperienceSubtitle:this.locService.NoClassNotebooksSubTitle,zeroExperienceImage:"zero-docs-icon-sprite zero-docs-icon-sprite-icon-emptyfolder-208x208",errorTitle:this.locService.MruErrorTitle,errorSubtitle:this.locService.MruErrorSubtitle,errorImage:"emptystate-icons-sprite emptystate-error",showZeroExperience:!0,attribution:null,loaded:!!e,fromCache:!1}}createMyAppItemsLoadingTab(e){if(e!==S.b.OneNote)return;let t=!1;this.myAppItemsTab=this.createMyAppItemsTab();const i=e=>new Promise((i=>{this.processAppItems(e).then((s=>{s&&(this.myAppItemsTab.listModel=s,this.myAppItemsTab.fromCache=e.fromCache,this.myAppItemsTab.loaded=!0,!e.fromCache&&t&&this.recentTabListModel.updateOrAddTab(this.myAppItemsTab)),i()}))}));return this.myAppItemsTab.onLoad=()=>new Promise(((s,a)=>{let n=null;e===S.b.OneNote&&(n=this.getNotebooks()),this.appItemStreamSubscription=n.results.subscribe((e=>{e.fromCache&&(t=!0),i(e).then((()=>{s()}))})),n.initialCompletion.then((e=>{t=!0,e&&(this.globalErrorHandler.handleCacheObservableError(e,"uLfZP","yUFz9"),e.cacheError&&e.networkError&&a())}))})),this.myAppItemsTab}createMyAppItemsTab(e){const t={id:"app-items-mru",title:"",ariaLabel:"",listModel:e,zeroExperienceTitle:"",zeroExperienceSubtitle:"",zeroExperienceImage:"emptystate-icons-sprite emptystate-recent",errorTitle:this.locService.MruErrorTitle,errorSubtitle:this.locService.MruErrorSubtitle,errorImage:"emptystate-icons-sprite emptystate-error",showZeroExperience:!0,attribution:null,loaded:!!e,fromCache:!1,showCardsInTileView:this.showInCardView};return this.fileType===S.b.OneNote&&(t.zeroExperienceTitle=this.locService.NoOwnedOneNoteItems,t.zeroExperienceSubtitle=this.locService.NoOwnedOneNoteItemsMemo,t.title=this.locService.MyNotebooksTabTitle,t.ariaLabel=this.locService.format(this.locService.DocumentTabAriaLabelFormat,this.locService.MyNotebooksTabTitle)),t}createSharedLoadingTab(){this.sharedWithMeTab=this.createSharedTab(),this.sharedWithMeTab.onLoad=()=>new Promise(((e,t)=>{let i=null;i=this.isFormsApp?this.formsService.getSharedForms():this.getSharedDocuments();let s=!1;this.sharedWithMeSubscription=i.results.subscribe((t=>{t.fromCache&&(s=!0),this.processSharedDocTask(t,s),e()})),i.initialCompletion.then((e=>{s=!0,e&&(this.globalErrorHandler.handleCacheObservableError(e,"Vu9AW","idjiA"),e.cacheError&&e.networkError&&t())}))}))}processSharedDocTask(e,t){this.sharedData&&e.fromCache||(this.sharedData=e);let i=null;i=this.processShared(this.isFormsApp?this.sharedData.value:this.sharedData.items),this.sharedWithMeTabListData=i.items,this.sharedWithMeTab.listModel=i,this.sharedWithMeTab.fromCache=this.sharedData.fromCache,this.sharedWithMeTab.loaded=!0,!this.sharedData.fromCache&&t&&this.recentTabListModel.updateOrAddTab(this.sharedWithMeTab)}createSharedTab(){const e=this.locService.SharedDocumentsSectionTitleLowercase;return{id:"shared-mru",title:e,ariaLabel:this.locService.format(this.locService.DocumentTabAriaLabelFormat,e),listModel:null,zeroExperienceTitle:this.locService.appResource("NoSharedWithMeTitle",this.fileType),zeroExperienceSubtitle:this.locService.appResource("NoSharedWithMeSubtitle",this.fileType),zeroExperienceImage:this.newMruEmptyStateEnabled?this.darkMode?"empty-state-image empty-state-image--shared-dark":"empty-state-image empty-state-image--shared":this.darkMode?"emptystate-icons-sprite-darkmode emptystate-sharedwithme-darkmode":"emptystate-icons-sprite emptystate-swm",errorTitle:this.locService.MruErrorTitle,errorSubtitle:this.locService.MruErrorSubtitle,errorImage:"emptystate-icons-sprite emptystate-error",showZeroExperience:!0,attribution:this.createAttribution(this.mruConfig.oneDriveSharedViewId),loaded:!1,fromCache:!1,showCardsInTileView:this.showInCardView}}processTamy(e){const t=(e.items||[]).map(((t,i)=>Object(w.d)(t,`trending_item_${i}`,e.impressionId,this.contextService.isRtl,this.clientStartupConfigService.config.authType,e.fromCache,!0)));return new d.a(t,this.locService.ShowMoreMruResultsAriaLabel,this.locService.ShowLessMruResultsAriaLabel,this.locService.ShowMoreMruResultsUpdateAriaLabel,this.locService.ShowLessMruResultsUpdateAriaLabel,this.maxInitialDocuments,this.maxTotalDocuments,((e,i)=>this.logTabImpression(t,"trending-docs",e,i,!1)),this.listAnimation,{initialTileItemCount:this.maxInitialDocumentCards})}createTrendingLoadingTab(){const e=this.locService.TrendingDocumentsSectionTitle;this.trendingTab={id:"trending-docs",title:e,ariaLabel:this.locService.format(this.locService.DocumentTabAriaLabelFormat,e),listModel:null,zeroExperienceTitle:this.locService.appResource("NoDiscoverTitle",this.fileType),zeroExperienceSubtitle:this.locService.appResource("NoDiscoverSubtitle",this.fileType),zeroExperienceImage:this.darkMode?"emptystate-icons-sprite-darkmode emptystate-discover-darkmode":"emptystate-icons-sprite emptystate-discover",errorTitle:this.locService.MruErrorTitle,errorSubtitle:this.locService.MruErrorSubtitle,errorImage:"emptystate-icons-sprite emptystate-error",showZeroExperience:!0,attribution:this.createAttribution(this.mruConfig.oneDriveDiscoverViewId),loaded:!1,fromCache:!1,showCardsInTileView:!0},this.trendingTab.onLoad=()=>new Promise(((e,t)=>{let i=!1;const s=this.getTamyDocuments();this.trendingDocSubscription=s.results.subscribe((t=>{t.fromCache&&(i=!0),this.processTamyTask(t,i),e()})),s.initialCompletion.then((e=>{i=!0,e&&(this.globalErrorHandler.handleCacheObservableError(e,"IyhlP","HFUrB"),e.cacheError&&e.networkError&&t())}))}))}processTamyTask(e,t){const i=this.processTamy(e);this.trendingTab.listModel=i,this.trendingTab.fromCache=e.fromCache,this.trendingTab.loaded=!0,!e.fromCache&&t&&this.recentTabListModel.updateOrAddTab(this.trendingTab)}processRecentMruTask(e){if(this.contextService.isNewConsumerUserExperience&&(!e.items||!e.items.length))return void(this.forceHideMru=!0);const t=(e.items||[]).map(((t,i)=>Object(w.e)(t,`mru_item_${i}`,e.impressionId,this.locService,this.contextService.isRtl,this.clientStartupConfigService.config.authType,e.fromCache)));if(this.documents){const e=this.documents.getAllUnpinnedDocuments().slice(0,this.maxTotalDocuments).concat(this.documents.getAllPinnedDocuments().slice(0,this.maxTotalDocuments));this.copyInflationData(e,t)}let i,s;if(this.documents=new Y(t),this.impressionId=e.impressionId,this.pinnedDocsEnabled){const t=this.documents.getAllPinnedDocuments();i=new d.a(t,this.locService.ShowMoreMruResultsAriaLabel,this.locService.ShowLessMruResultsAriaLabel,this.locService.ShowMoreMruResultsUpdateAriaLabel,this.locService.ShowLessMruResultsUpdateAriaLabel,this.maxInitialDocuments,t.length,((t,i)=>this.logTabImpression(this.pinnedTab.listModel.items,"pinned-mru",t,i,e.fromCache)),this.listAnimation,{isSmallMobileCards:this.isFormsApp,isEvenPadding:this.isFormsApp,isVisualRefresh:this.isVisualRefresh}),s=new d.a(this.documents.getAllDocuments(),this.locService.ShowMoreMruResultsAriaLabel,this.locService.ShowLessMruResultsAriaLabel,this.locService.ShowMoreMruResultsUpdateAriaLabel,this.locService.ShowLessMruResultsUpdateAriaLabel,this.maxInitialDocuments,this.maxTotalDocuments,((t,i)=>{this.logTabImpression(this.recentTab.listModel.items,"pinned-mru",t,i,e.fromCache),this.focusFirstItem=!1}),this.listAnimation,{infiniteShowMoreEnabled:this.mruConfig.infiniteShowMoreEnabled,isSmallMobileCards:this.isFormsApp,isEvenPadding:this.isFormsApp,isVisualRefresh:this.isVisualRefresh})}else s=new d.a(t,this.locService.ShowMoreMruResultsAriaLabel,this.locService.ShowLessMruResultsAriaLabel,this.locService.ShowMoreMruResultsUpdateAriaLabel,this.locService.ShowLessMruResultsUpdateAriaLabel,this.maxInitialDocuments,this.maxTotalDocuments,((t,i)=>{this.logTabImpression(this.recentTab.listModel.items,"mru",t,i,e.fromCache),this.focusFirstItem=!1}),this.listAnimation,{infiniteShowMoreEnabled:this.mruConfig.infiniteShowMoreEnabled,isSmallMobileCards:this.isFormsApp,isEvenPadding:this.isFormsApp,isVisualRefresh:this.isVisualRefresh});const a=this.locService.RecentDocumentsSectionTitleLowercase;if(this.recentTab={id:this.pinnedDocsEnabled?"unpinned-mru":"mru",title:a,ariaLabel:this.locService.format(this.locService.DocumentTabAriaLabelFormat,a),listModel:s,timestampHeader:this.lastOpened,zeroExperienceTitle:this.newMruEmptyStateEnabled?this.locService.NoRecentNewConsumerTitle:this.locService.appResource("NoRecentTitle",this.fileType),zeroExperienceSubtitle:this.newMruEmptyStateEnabled?this.uploadEnabled?this.locService.NoRecentNewConsumerSubtitle:this.locService.NoRecentNewConsumerSubtitleWithNoUpload:this.locService.appResource(this.uploadConfigService.config&&this.uploadConfigService.config.dragAndDropEnabled&&this.fileType!==S.b.Sway?"NoRecentSubtitleDragAndDrop":"NoRecentSubtitle",this.fileType),zeroExperienceImage:this.newMruEmptyStateEnabled?this.darkMode?"empty-state-image empty-state-image--recent-dark":"empty-state-image empty-state-image--recent":this.darkMode?"emptystate-icons-sprite-darkmode emptystate-recent-darkmode":"emptystate-icons-sprite emptystate-recent",showZeroExperience:!0,errorTitle:null,attribution:this.createAttribution(this.mruConfig.oneDriveRecentViewId),loaded:!0,fromCache:e.fromCache,footerText:null,showCardsInTileView:this.showInCardView},this.recentTabListModel.updateOrAddTab(this.recentTab),i){let t,s,a;this.capabilitiesService.capabilities.replacePinActionEnabled?(t=this.locService.FavoritedDocumentSectionTitle,s=this.locService.NoFavoritedTitle,a=this.locService.NoFavoritedSubtitle):(t=this.locService.PinnedDocumentsSectionTitleLowercase,s=this.locService.appResource("NoPinnedTitle",this.fileType),a=this.locService.appResource("NoPinnedSubtitle",this.fileType)),this.pinnedTab={id:"pinned-mru",title:t,ariaLabel:this.locService.format(this.locService.DocumentTabAriaLabelFormat,t),listModel:i,timestampHeader:this.lastOpened,zeroExperienceTitle:s,zeroExperienceSubtitle:a,zeroExperienceImage:this.newMruEmptyStateEnabled?this.darkMode?"empty-state-image empty-state-image--pinned-dark":"empty-state-image empty-state-image--pinned":this.darkMode?"emptystate-icons-sprite-darkmode emptystate-pinned-darkmode":"emptystate-icons-sprite emptystate-pinned",showZeroExperience:!0,errorTitle:null,attribution:this.createAttribution(this.mruConfig.oneDriveRecentViewId),loaded:!0,fromCache:e.fromCache,showCardsInTileView:this.showInCardView},this.recentTabListModel.updateOrAddTab(this.pinnedTab)}if(this.oneDriveUploadService.uploadEnabledPromise.then((e=>{e&&this.uploadConfigService.config&&this.uploadConfigService.config.dragAndDropEnabled&&this.fileType!==S.b.Sway&&this.fileType!==S.b.OneNote&&!this.isFormsApp&&(this.recentTab.footerText=this.locService.UploadFooter)})),this.updateNumLoggableItems(),s.items.length?(this.markMruReady(e.fromCache),this.updateWithNewZeroStateCheck()):Promise.all([this.oneDriveUploadService.uploadEnabledPromise,this.initialTabsPromise,this.createMenuService.createButtonEnabledPromise]).then((()=>{this.markMruReady(e.fromCache),this.updateWithNewZeroStateCheck()})),this.stateChanged.emit({state:v.a.Displayed}),he.shellDeeplinkPromise||(he.shellDeeplinkPromise=this.activatedRoute.queryParams.pipe(Object(r.a)(1)).toPromise().then((e=>{const t=e.section;t&&"recentdocs"===t.toLowerCase()&&(this.initialListState=m.a.Open,this.focusFirstItem=!0,setTimeout((()=>this.recentTabElement.nativeElement.scrollIntoView(!0)),1e3))}))),this.showAnalytics){const t=[...this.documents.getAllPinnedDocuments().slice(0,this.maxTotalDocuments),...this.documents.getAllUnpinnedDocuments().slice(0,this.maxTotalDocuments)];this.analyticsService.prefetchAnalytics(t,e.fromCache)}this.appFilter&&0!==this.appFilter.size||this.jumpListService.registerRecentJumpList(t)}copyInflationData(e,t){for(const i of t){let t=null;e.some((e=>e.documentUrl===i.documentUrl&&(t=e,!0)))&&i.copyInflationData(t,this.mruConfig.mruActivityEnabled)}}createAttribution(e){if(this.fileType===S.b.Sway)return{title:this.locService.AllSways,url:this.urlAuthenticatorService.appendPvrAndUpnAuthParams(this.swayServiceConfigService.config.myEndpoint),tooltip:this.locService.AllSwaysLinkTooltip,ariaLabel:this.locService.AllSwaysLinkAriaLabel,referral:g.a.Sway,zeroTitle:this.locService.AllSways};if(this.isFormsApp)return this.formsService.getAllMyFormsLink();{const t=this.capabilitiesService.capabilities.outgoingLoginHintEnabled,i=this.clientStartupConfigService.config.loginHint,s={title:this.locService.MoreInOneDrive,url:Z.a.appendLoginHint(this.contextService.sharedContext.oneDriveUrl,i,t),ariaLabel:this.locService.MoreInOneDrive,referral:g.a.OneDrive,zeroTitle:this.locService.GoToOneDrive};return this.oneDriveService.getMyDriveRootUrl().then((a=>{if(a&&a.userRoot){const n={};this.clientStartupConfigService.config.authType===_.a.MSA?n.qt=e:n.view=e,t&&(n.login_hint=i),s.url=Z.a.appendQueryParams(a.userRoot,n)}})).catch((e=>{this.globalErrorHandler.handleError(e,"u9Mjx")})),s}}updateWithNewZeroStateCheck(){this.emptyRecentNewButtonEnabled=this.isEmptyRecentView(),this.recentTab.attribution=!this.mobile&&this.emptyRecentNewButtonEnabled?null:this.createAttribution(this.mruConfig.oneDriveRecentViewId)}updateListModels(e){const t=e&&new RegExp(e,"i");this.pinnedDocsEnabled&&(this.pinnedTab.listModel.items=this.documents.getAllPinnedDocuments().filter((e=>!t||t.test(e.fileName))),this.pinnedTab.listModel.maxItemCount=this.pinnedTab.listModel.items.length),this.sharedWithMeTab&&this.sharedWithMeTabListData&&(this.sharedWithMeTab.listModel.items=this.sharedWithMeTabListData.filter((e=>!t||t.test(e.fileName)))),this.recentTab.listModel.items=this.documents.getAllDocuments().filter((e=>!t||t.test(e.fileName))),this.updateNumLoggableItems(),this.updateWithNewZeroStateCheck()}logTabImpression(e,t,i,s,a,n=p.a.Loaded){const r=e.slice(0,i);this.logOtelImpressionEvent(e,t,r,a,n),this.pendingTabImpressionEvent&&this.logPendingTabImpression();const o=this.createImpressionEvent(e,t,r,s,a,n),l=++this.tabImpressionIndex;this.pendingTabImpressionEvent={event:o,items:r,id:l},n===p.a.Loaded?(this.updateNumLoggableItems(),this.waitOnItemInflations(r).then((()=>{this.pendingTabImpressionEvent&&this.pendingTabImpressionEvent.id===l&&this.logPendingTabImpression()}))):this.logPendingTabImpression()}logPendingTabImpression(){if(!this.pendingTabImpressionEvent)return;const e=this.pendingTabImpressionEvent.event;this.fillInflatedImpressionParams(e.params,this.pendingTabImpressionEvent.items),e.record(),this.pendingTabImpressionEvent=null}fillInflatedImpressionParams(e,t){e.ActivityDistribution=t.map((e=>this.activityDescriptionService.displayedActivityType(e.activities,e.lastViewedTime,!0))).reduce(((e,t,i)=>e+(0===i?"":";")+M.a[t]),""),e.IsNewDistribution=t.map((e=>"boolean"==typeof e.isNew?e.isNew.toString():"undefined")).reduce(((e,t,i)=>e+(0===i?"":";")+t),""),e.IsSharedDistribution=t.map((e=>e.sharing&&"boolean"==typeof e.sharing.shared?e.sharing.shared.toString():"undefined")).reduce(((e,t,i)=>e+(0===i?"":";")+t),"")}createImpressionEvent(e,t,i,s,a,n=p.a.Loaded,r){const o=!i||this.dataSecurityService.securityLevel>=2?i:i.filter((e=>!e.isLocal)),l=S.a.distributionFromFileItems(o),c={};if(c.RenderSize=(o?o.length:0).toString(),c.Distribution=l,c.ElementId=t,c.TotalSize=this.getNumLoggableItems(e).toString(),c.State=s,c.TabState=p.a[n],c.ImpressionId=this.impressionId,c.FromServiceWorkerCache=(!!a).toString(),void 0!==r&&(c.Index=r.toString()),e.length>0){const t=e[0].timeSinceLastOpenInSeconds();null!==t&&(c.InactivityDuration=t.toString())}return this.instrumentationService.generateEvent("Mru_Impression","Generic_Impression",0,c)}logOtelImpressionEvent(e,t,i,s,n=p.a.Loaded){const r=!i||this.dataSecurityService.securityLevel>=2?i:i.filter((e=>!e.isLocal)),o=S.a.distributionFromFileItems(r),l=r?r.length:0;Object(a.a)({id:this.impressionId,eventName:"Mru",area:"Documents",subArea:f.a[t],fromCache:!!s,renderSize:l,totalSize:this.getNumLoggableItems(e),distribution:o})}markMruReady(e){this.performanceService.mark(e?"Cached_MRU_Ready":"MRU_Ready"),this.browserPaintMeasurementService.recordWhenPainted("MRU")}updateNumLoggableItems(){const e=this.recentTabListModel.tabs[this.selectedTab];this.numLoggableItems=e&&e.listModel?this.getNumLoggableItems(e.listModel.items):0}getNumLoggableItems(e){return e?this.dataSecurityService.securityLevel>=2?e.length:e.filter((e=>!e.isLocal)).length:0}sendMruItemState(e,t){this.eventService.broadcastEvent({name:"mruItemStateChange",args:[e,t]})}}he.maxCardsPerLine=4;const ue=he;class de{}var me=i("fYis"),pe=i("7IJ8"),be=i("QhWD"),Se=i("RsrG"),ge=i("6Po3"),ve=i("WLAd"),fe=i("9gjh"),Te=i("7J/E"),Me=i("55A9"),ye=i("EYcb"),we=i("qCYW"),Ie=i("pd4Y"),Ae=i("C0xW"),Ce=i("Bc8L"),De=i("kfAr"),Le=i("1Bt+"),Ee=i("OPwp"),Re=i("uNUv"),xe=i("6u39"),ke=i("TIi1"),Ne=i("Xc4i"),Fe=i("EUVs"),Pe=i("BMb5"),Oe=i("hoyd"),Ue=i("DQbD"),Ve=i("GmnP"),We=i("U8M1"),ze=i("hjJp"),Be=i("345u"),He=i("xoWf"),_e=i("qk26"),je=s.Fb({encapsulation:2,styles:[],data:{}});function Ge(e){return s.jc(0,[(e()(),s.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),s.Gb(1,475136,null,0,pe.a,[be.a,s.W,b.a,_.b,ae.a,Se.a,ge.a,s.F,ve.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),s.Zb(2,{showAsLink:0,fileType:1,numDocuments:2}),(e()(),s.qb(0,null,null,0))],(function(e,t){var i=t.component,s=e(t,2,0,!0,i.fileType,(null==i.recentTabListModel||null==i.recentTabListModel.tabs[i.selectedTab]||null==i.recentTabListModel.tabs[i.selectedTab].listModel||null==i.recentTabListModel.tabs[i.selectedTab].listModel.items?null:i.recentTabListModel.tabs[i.selectedTab].listModel.items.length)||0);e(t,1,0,"upload-button#UploadButtonModule",s)}),null)}function qe(e){return s.jc(0,[(e()(),s.Hb(0,0,null,null,2,"ohp-mru-item",[],null,[[null,"deleteItem"],[null,"changePinState"]],(function(e,t,i){var s=!0,a=e.component;return"deleteItem"===t&&(s=!1!==a.onDeleteItem(i)&&s),"changePinState"===t&&(s=!1!==a.onChangePinState(i)&&s),s}),fe.b,fe.a)),s.bc(512,null,Te.a,Te.a,[G.a,j.a,Me.a,Q.a,R.a,ye.a,_.b]),s.Gb(2,770048,null,0,T.a,[c.a,H.a,_.b,we.a,j.a,Ie.a,L.b,E.a,Ae.b,R.a,b.a,Ce.a,G.a,y.a,De.a,Te.a,l.a,k.a,N.a,O.a,U.b,s.K,Le.a,Ee.b,Re.a,xe.a,ke.a,Ne.a,Fe.a,Pe.b,Oe.a,I.a,Ue.a,Ve.a,ie.a,We.a],{item:[0,"item"],index:[1,"index"],view:[2,"view"],listId:[3,"listId"],focusOnLoad:[4,"focusOnLoad"],showActivity:[5,"showActivity"],showSharing:[6,"showSharing"],showAnalytics:[7,"showAnalytics"],mruAppType:[8,"mruAppType"]},{deleteItem:"deleteItem",changePinState:"changePinState"})],(function(e,t){var i=t.component;e(t,2,0,t.parent.context.item,t.parent.context.index,t.parent.context.itemView,t.parent.context.listId,!i.focusOnFilter&&t.parent.context.focusOnLoad,i.showActivity,i.showSharing,i.showAnalytics,i.fileType)}),null)}function Ze(e){return s.jc(0,[(e()(),s.Hb(0,0,null,null,2,"ohp-mru-item",[],null,[[null,"deleteItem"],[null,"changePinState"]],(function(e,t,i){var s=!0,a=e.component;return"deleteItem"===t&&(s=!1!==a.onDeleteItem(i)&&s),"changePinState"===t&&(s=!1!==a.onChangePinState(i)&&s),s}),fe.b,fe.a)),s.bc(512,null,Te.a,Te.a,[G.a,j.a,Me.a,Q.a,R.a,ye.a,_.b]),s.Gb(2,770048,null,0,T.a,[c.a,H.a,_.b,we.a,j.a,Ie.a,L.b,E.a,Ae.b,R.a,b.a,Ce.a,G.a,y.a,De.a,Te.a,l.a,k.a,N.a,O.a,U.b,s.K,Le.a,Ee.b,Re.a,xe.a,ke.a,Ne.a,Fe.a,Pe.b,Oe.a,I.a,Ue.a,Ve.a,ie.a,We.a],{item:[0,"item"],index:[1,"index"],view:[2,"view"],listId:[3,"listId"],focusOnLoad:[4,"focusOnLoad"],showActivity:[5,"showActivity"],showSharing:[6,"showSharing"],showAnalytics:[7,"showAnalytics"],mruAppType:[8,"mruAppType"]},{deleteItem:"deleteItem",changePinState:"changePinState"})],(function(e,t){var i=t.component;e(t,2,0,t.parent.context.item,t.parent.context.index,t.parent.context.itemView,t.parent.context.listId,!i.focusOnFilter&&0===t.parent.context.index,i.showActivity,i.showSharing,i.showAnalytics,i.fileType)}),null)}function $e(e){return s.jc(0,[(e()(),s.Hb(0,0,null,null,4,"div",[],null,null,null,null,null)),(e()(),s.qb(16777216,null,null,1,null,qe)),s.Gb(2,16384,null,0,le.k,[s.W,s.S],{ngIf:[0,"ngIf"]},null),(e()(),s.qb(16777216,null,null,1,null,Ze)),s.Gb(4,16384,null,0,le.k,[s.W,s.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,!i.focusFirstItem),e(t,4,0,i.focusFirstItem)}),null)}function Je(e){return s.jc(0,[(e()(),s.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),s.Gb(1,475136,null,0,pe.a,[be.a,s.W,b.a,_.b,ae.a,Se.a,ge.a,s.F,ve.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),s.Zb(2,{buttonOrigin:0,fileType:1,numDocuments:2}),(e()(),s.qb(0,null,null,0))],(function(e,t){var i=t.component,s=e(t,2,0,i.emptyViewName,i.fileType,i.numLoggableItems);e(t,1,0,"upload-button#UploadButtonModule",s)}),null)}function Ke(e){return s.jc(0,[(e()(),s.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),s.Gb(1,475136,null,0,pe.a,[be.a,s.W,b.a,_.b,ae.a,Se.a,ge.a,s.F,ve.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),s.Zb(2,{buttonOrigin:0,numDocuments:1,withAnimation:2,showDropdown:3}),(e()(),s.qb(0,null,null,0))],(function(e,t){var i=t.component,s=e(t,2,0,i.emptyViewName,i.numLoggableItems,!1,!1);e(t,1,0,"create-menu#CreateMenuModule",s)}),null)}function Qe(e){return s.jc(0,[(e()(),s.Hb(0,0,null,null,4,"div",[["class","buttons-container buttons-container--empty"]],null,null,null,null,null)),(e()(),s.qb(16777216,null,null,1,null,Je)),s.Gb(2,16384,null,0,le.k,[s.W,s.S],{ngIf:[0,"ngIf"]},null),(e()(),s.qb(16777216,null,null,1,null,Ke)),s.Gb(4,16384,null,0,le.k,[s.W,s.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,i.uploadEnabled),e(t,4,0,i.createButtonEnabled)}),null)}function Ye(e){return s.jc(0,[(e()(),s.Hb(0,0,[[1,0],["recentTab",1]],null,15,"div",[],null,null,null,null,null)),s.Gb(1,278528,null,0,le.i,[s.x,s.y,s.o,s.K],{ngClass:[0,"ngClass"]},null),s.Zb(2,{"recent-tab__height-restrictor":0}),(e()(),s.Hb(3,0,null,null,1,"div",[["aria-live","polite"],["class","visually-hidden"]],null,null,null,null,null)),(e()(),s.gc(4,null,["",""])),(e()(),s.Hb(5,0,null,null,8,"ohp-tab-list",[],null,[[null,"tabClicked"]],(function(e,t,i){var s=!0;return"tabClicked"===t&&(s=!1!==e.component.onTabClicked(i)&&s),s}),ze.b,ze.a)),s.Gb(6,4308992,null,1,Be.b,[H.a,L.b,b.a,G.a,He.a,s.h,_.b,o.b],{model:[0,"model"],columnsEnabled:[1,"columnsEnabled"],tileViewEnabled:[2,"tileViewEnabled"],listState:[3,"listState"],defaultStateNoMinHeight:[4,"defaultStateNoMinHeight"],customButtonEnabled:[5,"customButtonEnabled"],defaultView:[6,"defaultView"],pillTabs:[7,"pillTabs"],showFilter:[8,"showFilter"],filterInput:[9,"filterInput"],isVisualRefresh:[10,"isVisualRefresh"]},{tabClicked:"tabClicked"}),s.cc(603979776,2,{tabListItems:1}),(e()(),s.Hb(8,0,null,0,3,"div",[["ohpTabListButton",""]],null,null,null,null,null)),s.Gb(9,16384,null,0,Be.a,[],null,null),(e()(),s.qb(16777216,null,null,1,null,Ge)),s.Gb(11,16384,null,0,le.k,[s.W,s.S],{ngIf:[0,"ngIf"]},null),(e()(),s.qb(0,null,null,1,null,$e)),s.Gb(13,16384,[[2,4]],0,Be.c,[s.S],null,null),(e()(),s.qb(16777216,null,null,1,null,Qe)),s.Gb(15,16384,null,0,le.k,[s.W,s.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,s=e(t,2,0,!(null!=i.recentTabListModel.tabs[i.selectedTab].listModel&&i.recentTabListModel.tabs[i.selectedTab].listModel.items.length)||i.recentTabListModel.tabs[i.selectedTab].hasError);e(t,1,0,s),e(t,6,1,[i.recentTabListModel,!0,i.tileViewEnabled,i.initialListState,!0,i.uploadEnabled&&i.headless,i.defaultView,i.fluentRefresh,(null==i.recentTabListModel||null==i.recentTabListModel.tabs[i.selectedTab]?null:i.recentTabListModel.tabs[i.selectedTab].loaded)&&i.filterEnabled,i.onFilter,i.isVisualRefresh]),e(t,11,0,i.uploadEnabled&&i.headless),e(t,15,0,i.emptyRecentNewButtonEnabled&&!i.newMruEmptyStateEnabled&&(i.createButtonEnabled||i.uploadEnabled))}),(function(e,t){e(t,4,0,t.component.screenReaderText)}))}function Xe(e){return s.jc(0,[s.cc(671088640,1,{recentTabElement:0}),(e()(),s.qb(16777216,null,null,1,null,Ye)),s.Gb(2,16384,null,0,le.k,[s.W,s.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,(null==i.recentTabListModel.tabs?null:i.recentTabListModel.tabs.length)&&!i.forceHideMru)}),null)}var et=s.Db("ohp-mru-component",he,(function(e){return s.jc(0,[(e()(),s.Hb(0,0,null,null,1,"ohp-mru-component",[],null,null,null,Xe,je)),s.Gb(1,245760,null,0,he,[H.a,s.h,_.b,j.a,D.a,L.b,E.a,R.a,Q.a,b.a,x.a,G.a,y.a,l.a,P.a,O.a,F.a,U.b,I.a,ce,_e.a,o.b,q.a,$.a,c.a,k.a,V.a,h.a,C.a,z.a,J.a,u.a,N.a,W.b,B.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{fileType:"fileType",maxInitialDocs:"maxInitialDocs",maxTotalDocs:"maxTotalDocs",headless:"headless",recentMruStreamData:"recentMruStreamData",title:"title"},{stateChanged:"stateChanged"},[]),tt=i("xIlw"),it=i("+a0u"),st=i("lQwO"),at=i("+P5Z"),nt=i("izKO"),rt=i("L9A/"),ot=i("CfLe"),lt=i("ej7j"),ct=i("VY7U"),ht=i("T/SX"),ut=i("up2P"),dt=i("D8EG"),mt=i("D6F8"),pt=i("9InZ"),bt=i("upmJ"),St=i("T6pR"),gt=i("5WpM"),vt=i("ApBt"),ft=i("mOWz"),Tt=i("ci1G"),Mt=i("CCRL"),yt=s.Eb(de,[],(function(e){return s.Tb([s.Ub(512,s.k,s.hb,[[8,[me.a,et]],[3,s.k],s.D]),s.Ub(4608,le.m,le.l,[s.z]),s.Ub(1073742336,le.c,le.c,[]),s.Ub(1073742336,tt.a,tt.a,[]),s.Ub(1073742336,it.a,it.a,[]),s.Ub(1073742336,st.a,st.a,[]),s.Ub(1073742336,at.a,at.a,[]),s.Ub(1073742336,nt.a,nt.a,[]),s.Ub(1073742336,rt.a,rt.a,[]),s.Ub(1073742336,ot.a,ot.a,[]),s.Ub(1073742336,lt.a,lt.a,[]),s.Ub(1073742336,_e.o,_e.o,[[2,_e.t],[2,_e.n]]),s.Ub(1073742336,ct.a,ct.a,[]),s.Ub(1073742336,ht.a,ht.a,[]),s.Ub(1073742336,ut.a,ut.a,[]),s.Ub(1073742336,dt.a,dt.a,[]),s.Ub(1073742336,mt.a,mt.a,[]),s.Ub(1073742336,pt.a,pt.a,[]),s.Ub(1073742336,bt.a,bt.a,[]),s.Ub(1073742336,St.a,St.a,[]),s.Ub(1073742336,gt.a,gt.a,[]),s.Ub(1073742336,vt.b,vt.b,[]),s.Ub(1073742336,ft.g,ft.g,[]),s.Ub(1073742336,Tt.a,Tt.a,[]),s.Ub(1073742336,de,de,[]),s.Ub(256,Mt.a,ue,[])])}))},WJAz:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var s=i("GAcG"),a=i("r7hm"),n=i("UGNb"),r=i("/zlj"),o=i("REFP"),l=i("O6Zd");function c(...e){let t;return"function"==typeof e[e.length-1]&&(t=e.pop()),1===e.length&&Object(a.a)(e[0])&&(e=e[0]),0===e.length?n.a:t?c(e).pipe(Object(l.a)((e=>t(...e)))):new s.a((t=>new h(t,e)))}class h extends o.a{constructor(e,t){super(e),this.sources=t,this.completed=0,this.haveValues=0;const i=t.length;this.values=new Array(i);for(let e=0;e<i;e++){const i=t[e],s=Object(r.a)(this,i,null,e);s&&this.add(s)}}notifyNext(e,t,i,s,a){this.values[i]=t,a._hasValue||(a._hasValue=!0,this.haveValues++)}notifyComplete(e){const{destination:t,haveValues:i,values:s}=this,a=s.length;e._hasValue?(this.completed++,this.completed===a&&(i===a&&t.next(s),t.complete())):t.complete()}}},rBrS:function(e,t,i){"use strict";var s;i.d(t,"a",(function(){return s})),function(e){e.Recent="recent",e.FormsTabList="formsTabList"}(s||(s={}))}}]);
//# sourceMappingURL=pwa-mru.a07aa2490b2dcd35d639.chunk.v7.js.map