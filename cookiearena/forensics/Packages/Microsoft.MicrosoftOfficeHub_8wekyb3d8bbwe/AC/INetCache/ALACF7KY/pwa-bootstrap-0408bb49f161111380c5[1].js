/*! For license information please see pwa-bootstrap-0408bb49f161111380c5.js.LICENSE.txt */
!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="QCi+")}({"QCi+":function(e,t,n){"use strict";n.r(t);var r=n("bb6g"),o=n("yxA9"),i=new(function(){function e(){this.currentMsaUser=null,this.currentUserAccount=null,this.currentUserPhoto="",this.currentUserPhotoPromise=null,this.initializedAccountsPane=!1,this.isUserInteractionErrorHandled=!1,this.userInteractionRequired=!1,this.wamUiPromptPromise=null;var t=window.navigator.serviceWorker;window.diskPreloadRequestMap=new Map,window.diskPreloadUserIdStorageKey="PwaDiskPreloadUserStorageId",window.wamAccessTokenRequests=new Map,window.diskPreloadUrlStorageKey=e.DiskPreloadStorageKey,window.pwaCurrentUserId=null,window.windowsDataSecuritySetting=0,window.shellTokenRequestDictionary={},window.pwaResuming=!1,window.startedFromServiceWorker=!(!t||!t.controller),this.swEnabled=!!t,"0"===window.forcedMockAuth?this.requiredMockAuthority=window.forcedMockAuth:"1"===window.forcedMockAuth?this.requiredMockAuthority=e.MsaAuthority:"2"===window.forcedMockAuth&&(this.requiredMockAuthority=e.AadAuthority),this.currentUrl=new URL(window.location.href),this.isUwp=navigator&&navigator.userAgent.toLowerCase().indexOf("msapphost/")>-1&&"undefined"!=typeof Windows,this.localSettingsProps=this.isUwp?Windows.Storage.ApplicationData.current.localSettings.values:null,this.elementsDisplayStyleMap=new Map([[e.UnauthPageId,"flex"],[e.OfficeHomeId,"flex"],[e.ErrorPageId,"inline-block"]]),e.SessionExpiredToastTemplate='<toast><visual><binding template="ToastGeneric"><text>Office</text><text>'+e.ToastMessageKey+"</text></binding></visual></toast>"}return e.prototype.canRender=function(){return this.isUwp||this.requiredMockAuthority},e.prototype.initVars=function(){var t=this;if(window.MSApp&&window.MSApp.pageHandlesAllApplicationActivations(!0),o.c.InitializeCIDSID("OHPWA.SID","/"),this.markPerformance(e.InitialPerformanceEvent,0),this.getSharedClientStartupConfig().then((function(e){var n={PageResponseCid:e?e.correlationId:""};t.logAriaEvent(o.d.GenericEvent,"Pwa_Begin",0,n)})),this.isUwp){try{Windows.System.Profile.PlatformDiagnosticsAndUsageDataSettings.addEventListener("collectionlevelchanged",(function(){return t.resetSecurityLevel()})),this.resetSecurityLevel()}catch(e){}if(!sessionStorage.getItem(e.ExistingSessionKey)){var n="Splashscreen";try{var r=Windows.System.Diagnostics.ProcessDiagnosticInfo.getForCurrentProcess().processStartTime.getTime(),i={Latency:(window.performance.timing.navigationStart-r).toString(),ItemCategory:"Inline"};this.logAriaEvent(o.d.PerformanceDump,n,0,i)}catch(e){var a={Error:n,DebugInfo:e,ItemCategory:"Inline"};this.logAriaEvent(o.d.GenericEvent,o.d.PerformanceMarkFailure,2,a)}sessionStorage.setItem(e.ExistingSessionKey,"true")}try{Windows.UI.WebUI.WebUIApplication.addEventListener("activated",(function(e){return t.onActivate(e)})),Windows.UI.WebUI.WebUIApplication.addEventListener("suspending",(function(e){return t.onSuspend(e)})),Windows.UI.WebUI.WebUIApplication.addEventListener("resuming",(function(e){return t.onResume(e)})),Windows.UI.WebUI.WebUIApplication.addEventListener("navigated",(function(e){return t.onNavigate(e)})),Windows.UI.WebUI.WebUIApplication.addEventListener("enteredbackground",(function(e){return t.onEnterBackground(e)})),Windows.UI.WebUI.WebUIApplication.addEventListener("leavingbackground",(function(e){return t.onLeaveBackground(e)}))}catch(e){this.logAriaEvent(o.d.GenericEvent,"SubscribeToLifecycleEvents_Error",2)}if(window.thirdPartyNoticeUrl&&this.waitForPageLoad().then((function(){return t.installThirdPartyNotice()})),this.localSettingsProps.hasKey(e.CurrentAuthorityKey)&&this.localSettingsProps.hasKey(e.CurrentAccountIdKey)){var s=this.localSettingsProps.lookup(e.CurrentAuthorityKey);window.pwaCurrentUserId=this.getUserIdKey(s,this.localSettingsProps.lookup(e.CurrentAccountIdKey))}}else window.windowsDataSecuritySetting=3},e.prototype.initApp=function(){var t=this;this.isUwp&&this.localSettingsProps&&this.localSettingsProps.hasKey(e.PrelaunchModeKey)&&this.setPrelaunchMode();var n=function(){t.logAriaEvent(o.d.GenericEvent,"Pwa_Unauth_PageView",0),t.initializeUnAuthOTelAndLogPageView({pageName:"OfficeHome",pageType:"SignoutUserView",isIntentional:!0,securityThreshold:0}),t.swEnabled&&navigator.serviceWorker.getRegistration(e.BasePwaPath).then((function(e){o.c.NotifyInstallingWorkerAppFailed(e,!1)})),t.waitForPageLoad().then((function(){t.displayScreen(e.UnauthPageId),document.getElementById("sign-in-button").onclick=function(){t.logUnAuthUserAction({id:"Pwa_SignIn_Click",area:"Other",result:"SignIn",target:"Office",pageName:"OfficeHome",pageType:"SignoutUserView",securityThreshold:0}),t.showAccountsPane()},document.getElementById("create-account-link").onclick=function(){t.logUnAuthUserAction({id:"Pwa_Create_Account_Click",area:"Other",result:"Create",target:"Account",pageName:"OfficeHome",pageType:"SignoutUserView",securityThreshold:0})},t.markPerformance("Pwa_Unauth_Ready",0,e.InitialPerformanceEvent),t.flushLogs()}))};if("0"!==this.requiredMockAuthority){if(this.localSettingsProps&&this.localSettingsProps.hasKey(e.SignOutWindowNameKey)){try{window.open("about:blank",e.SignOutWindowName,"msHideView=yes").close(),this.localSettingsProps.remove(e.SignOutWindowNameKey)}catch(e){}this.logAriaEvent(o.d.GenericEvent,"SignOut_Completed",2)}this.isUwp?this.getAccountProvider().then((function(e){e?t.bootstrapApp(t.isConsumerAuthority(e.authority)):n()})).catch((function(e){e&&t.logAriaEvent(o.d.GenericEvent,"GetAccountProvider_Error",2),t.showErrorPage()})):this.bootstrapApp(this.isConsumerAuthority(this.requiredMockAuthority))}else n()},e.prototype.initializeGlobalFunctions=function(){var t=this,n=this;window.openThirdPartyNotice=function(){var e=function(){var e=new Windows.Foundation.Uri(window.thirdPartyNoticeUrl);Windows.System.Launcher.launchUriAsync(e).then((function(e){if(!e)throw new Error})).then(null,(function(){n.logAriaEvent(o.d.GenericEvent,"OpenThirdPartyNotice_Error",2)}))};n.thirdPartyLicenseNotice?Windows.System.Launcher.launchFileAsync(n.thirdPartyLicenseNotice).then((function(t){t||e()}),e):e()},window.getRememberedAccounts=function(){return Object(r.b)(t,void 0,void 0,(function(){var t,o;return Object(r.d)(this,(function(r){return n.rememberedAccounts=[],t=n.findAllAccounts(e.AadAuthority),o=n.findAllAccounts(e.MsaAuthority),[2,Promise.all([t,o]).then((function(e){return e.forEach((function(e){e&&e.forEach((function(e){n.rememberedAccounts.push(e)}))})),Promise.resolve(n.rememberedAccounts)}))]}))}))},window.switchTo=function(i){return Object(r.b)(t,void 0,void 0,(function(){var t,a,s,c,u,l,d,p;return Object(r.d)(this,(function(r){switch(r.label){case 0:t=o.d.CurrentTime(),r.label=1;case 1:if(r.trys.push([1,9,,10]),!i.nextAccount||!i.nextAccount.memberName)return[3,8];a=i.nextAccount.memberName,s=0,c=n.rememberedAccounts,r.label=2;case 2:return s<c.length?(u=c[s],a!==u.userName?[3,4]:[4,Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.findAccountAsync(u.webAccountProvider,u.id)]):[3,5];case 3:if(!(l=r.sent()))throw new Error("Failed to find account");return n.currentUserAccount=l,[3,5];case 4:return s++,[3,2];case 5:return n.localSettingsProps.insert(e.CurrentAccountIdKey,n.currentUserAccount.id),[4,Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.findAccountProviderAsync(e.MsaAadProviderId,n.currentUserAccount.webAccountProvider.authority)];case 6:return d=r.sent(),n.saveAccountProvider(d),n.setupCurrentUser(d.authority,n.currentUserAccount.id),n.logAriaEvent(o.d.GenericEvent,"UMCSwitchAccount_FetchedToken",2),n.resetBrowserStorage(),[4,n.forceNewServiceWorker()];case 7:r.sent(),n.logAriaEvent(o.d.GenericEvent,"UMCSwitchAccount_Completed",2,{Latency:Math.ceil(o.d.CurrentTime()-t).toString()}),n.reloadApp(),r.label=8;case 8:return[3,10];case 9:return p=r.sent(),this.logAriaEvent(o.d.GenericEvent,"UMCSwitchAccount_Error",0,{Latency:Math.ceil(o.d.CurrentTime()-t).toString(),Error:p.toString||""}),this.displayScreen(e.OfficeHomeId),[3,10];case 10:return[2]}}))}))},window.switchAccount=function(){n.localSettingsProps.insert(e.SwitchAccountKey,!0),n.logAriaEvent(o.d.GenericEvent,"SwitchAccount_Start",2),n.showAccountsPane(!0)},window.uwpSignOut=function(){n.logAriaEvent(o.d.GenericEvent,"SignOut_Started",2),window.open("/pwa/logout",e.SignOutWindowName,"msHideView=yes",!1);var t=n.localSettingsProps.hasKey("UMCEnabledSessionId");n.resetBrowserStorage(),n.localSettingsProps.clear(),t&&n.localSettingsProps.insert("UMCEnabledSessionId",window.overrideSID),n.localSettingsProps.insert(e.SignOutWindowNameKey,e.SignOutWindowName),n.localSettingsProps.insert(e.SignedOutKey,!0),n.reloadApp()},window.getWamAccessToken=function(t,r,o,i){return n.getAccountProvider().then((function(a){return a?n.getWamTokenResult(r,t,a,!1,o,e.V2ResourceFriendlyName.includes(r),i):Promise.reject("Cannot get user account")})).then((function(e){return n.buildAccessTokenResponse(e,t,r)}))},window.logPwaLifecycleEvent=function(e){var t,n;"function"==typeof(null===(n=null===(t=null===MyOffice||void 0===MyOffice?void 0:MyOffice.RuntimeComponents)||void 0===t?void 0:t.TraceLog)||void 0===n?void 0:n.logLifeCycleTrace)&&MyOffice.RuntimeComponents.TraceLog.logLifeCycleTrace(e,"","",0,0)}},e.prototype.getAccountProvider=function(){var t=this;return this.currentAccountProvider?Promise.resolve(this.currentAccountProvider):this.localSettingsProps.hasKey(e.SignedOutKey)?Promise.resolve(null):new Promise((function(n,r){var o=t.localSettingsProps.lookup(e.CurrentUserProviderIdKey),i=t.localSettingsProps.lookup(e.CurrentAuthorityKey);(o&&i?Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.findAccountProviderAsync(o,i):Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.findAccountProviderAsync(e.LocalProviderId)).then((function(n){return!n||n.authority!==e.MsaAuthority&&n.authority!==e.AadAuthority||t.requiredMockAuthority&&n.authority!==t.requiredMockAuthority?null:n.id===e.LocalProviderId?Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.findAccountProviderAsync(e.MsaAadProviderId,n.authority):n})).then((function(e){e&&t.saveAccountProvider(e),n(e)}))}))},e.prototype.buildAccessTokenResponse=function(t,n,r){if(!this.checkWamTokenResult(t))return null;var o=t.responseData[0],i=o.webAccount.webAccountProvider,a=o.properties&&o.properties.hasKey("exp")&&1e3*parseInt(o.properties.lookup("exp")),s=this.isConsumerAuthority(i.authority);return{success:!0,token:t.responseData[0].token,expiryMs:a||!s&&this.getDefaultExpiry(),format:i&&s&&n!==e.OfficeHomeV2Resource&&"Substrate"!==r?"RPSCompact":"JWT",source:"WAM"}},e.prototype.getDefaultExpiry=function(){return(new Date).getTime()+o.a},e.prototype.isAsianCulture=function(e){return!!e&&["ja","ko","zh"].some((function(t){return 0===e.indexOf(t)}))},e.prototype.getUserDisplayName=function(e){var t="";if(this.currentUserAccount){var n=this.currentUserAccount.properties.hasKey("FirstName")?this.currentUserAccount.properties.lookup("FirstName"):"",r=this.currentUserAccount.properties.hasKey("LastName")?this.currentUserAccount.properties.lookup("LastName"):"";t=n&&r?this.isAsianCulture(e)?r+n:n+" "+r:n||r||this.currentUserAccount.userName}return t},e.prototype.getUserIdKey=function(e,t){return e+"_"+t},e.prototype.getCurrentAccount=function(t){var n=this;return this.currentUserAccount?Promise.resolve(this.currentUserAccount):t&&this.localSettingsProps.hasKey(e.CurrentAccountIdKey)?this.findAccountAsync(t).then((function(e){return n.currentUserAccount=e,n.setupCurrentUser(t.authority,e.id),e})):Promise.reject()},e.prototype.findAccountAsync=function(t){var n=this,r=o.d.CurrentTime(),i=new Promise((function(r,o){Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.findAccountAsync(t,n.localSettingsProps.lookup(e.CurrentAccountIdKey)).then(r,o)})),a=function(e,t){n.logRequest("FindAccount_Request",Math.ceil(o.d.CurrentTime()-r),e,2,!1,t)};return i.then((function(t){if(!t){var r="Failed to find account";return a(!1,r),n.localSettingsProps.remove(e.CurrentAccountIdKey),Promise.reject(r)}return a(!0),Promise.resolve(t)}),(function(t){return a(!1,t),n.localSettingsProps.remove(e.CurrentAccountIdKey),Promise.reject(t)}))},e.prototype.cleanUpShellAndConfigCallbacks=function(){this.shellAndConfigPromiseResolver=null,this.shellAndConfigPromiseRejecter=null},e.prototype.logAriaEvent=function(e,t,n,r,i){r=r||{},this.currentAccountProvider&&(r.AuthType=this.isConsumerAuthority(this.currentAccountProvider.authority)?"MSA":"OrgId"),o.d.LogEvent(e,t,n,r,i)},e.prototype.logRequest=function(e,t,n,r,i,a,s){var c;(s=s||{}).Latency=t.toString(),s.State=n?"Succeeded":"Failed",s.FromServiceWorkerCache=(!!i).toString(),a&&(s.Error=null===(c=a.toString())||void 0===c?void 0:c.replace(o.d.EmailRegex,"email_removed")),this.logAriaEvent(o.d.GenericRequest,e,r,s)},e.prototype.markPerformance=function(t,n,r){o.d.MarkPerformance(t,r,n,window.windowsDataSecuritySetting,{Page:e.PwaPage})},e.prototype.checkWamTokenResult=function(e){return e&&e.responseStatus===Windows.Security.Authentication.Web.Core.WebTokenRequestStatus.success&&e.responseData&&e.responseData.length>0},e.prototype.getWamTokenResult=function(t,n,r,i,a,s,c){var u,l,d=this,p=o.d.CurrentTime(),h="";if(this.isConsumerAuthority(r.authority))l=new Windows.Security.Authentication.Web.Core.WebTokenRequest(r,n,s?e.AppId:"none"),s&&l.properties.insert("api-version","2.0");else{var f=t===e.OfficeApiResource?"openid":"";if(l=new Windows.Security.Authentication.Web.Core.WebTokenRequest(r,f,a||e.AppId),a&&l.properties.insert("api-version","2.0"),l.properties.insert("resource",n),c&&(null===(u=this.capabilitiesConfig)||void 0===u?void 0:u.claimsChallengeEnabled))try{var g=atob(c);l.properties.insert("claims",g)}catch(e){this.logAriaEvent(o.d.GenericEvent,"DecodeClaimsChallenge_Error",1,{Error:"string"==typeof e?e:e?e.message:""})}}var m=new Promise((function(n,o){if(!l)return h="InvalidTokenRequest",void o();var i=function(e,r){void 0===r&&(r=!1),d.getWamToken(t,e,r).then(n,o)};d.localSettingsProps.hasKey(e.SwitchAccountKey)||d.localSettingsProps.hasKey(e.SwitchToSelectedAccountKey)?i(l):d.getCurrentAccount(r).then((function(e){return d.getWamTokenSilently(t,l,e)})).then((function(e){n(e)})).catch((function(){i(l,!0)}))})),v=!0;if(m.catch((function(){v=!1})).then((function(){var e={Resource:t};d.logRequest("GetWamTokenResult_Request",Math.ceil(o.d.CurrentTime()-p),v,0,!1,h,e)})),i){var w={pending:!0,result:m.then((function(e){return d.buildAccessTokenResponse(e,n,t)}))};window.wamAccessTokenRequests.set(n,w)}return m},e.prototype.getWamToken=function(t,n,r){var i=this;void 0===r&&(r=!1);var a=function(){var a=new Promise((function(t,a){(r&&i.currentUserAccount?Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.requestTokenAsync(n,i.currentUserAccount):Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.requestTokenAsync(n)).then((function(n){if(n&&n.responseStatus===Windows.Security.Authentication.Web.Core.WebTokenRequestStatus.userCancel&&i.userInteractionRequired){if(i.isUserInteractionErrorHandled)return;if(e.SessionExpiredToastMessage)try{var r=new Windows.Data.Xml.Dom.XmlDocument;r.loadXml(e.SessionExpiredToastMessage);var a=new Windows.UI.Notifications.ToastNotification(r);Windows.UI.Notifications.ToastNotificationManager.createToastNotifier().show(a),i.logAriaEvent(o.d.GenericEvent,"UserSessionExpired",0)}catch(e){i.logAriaEvent(o.d.GenericEvent,"CreateSessionExpiredToast_Error",0,{Error:"string"==typeof e?e:e?e.message:""})}else i.logAriaEvent(o.d.GenericEvent,"MissingSessionExpiredToastMessage",0);i.isUserInteractionErrorHandled=!0,window.uwpSignOut()}else t(n)}),a)}));return i.instrumentedTokenFetch(a,"GetWamToken_Request",t)};return this.wamUiPromptPromise?this.wamUiPromptPromise=this.wamUiPromptPromise.then(a,a):this.wamUiPromptPromise=a(),this.wamUiPromptPromise},e.prototype.getWamTokenSilently=function(e,t,n){var r=this,o=new Promise((function(e,o){(n?Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.getTokenSilentlyAsync(t,n):Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.getTokenSilentlyAsync(t)).then((function(t){window.enableUIRForceSignOut&&t&&t.responseStatus===Windows.Security.Authentication.Web.Core.WebTokenRequestStatus.userInteractionRequired&&t.responseError&&(2156265478===t.responseError.errorCode||2156265484===t.responseError.errorCode)&&(r.userInteractionRequired=!0),e(t)}),o)}));return this.instrumentedTokenFetch(o,"GetWamTokenSilently_Request",e)},e.prototype.instrumentedTokenFetch=function(e,t,n){var r=this,i=o.d.CurrentTime(),a=function(e,a,s){var c={Resource:n,DebugInfo:a.toString()};r.logRequest(t,Math.ceil(o.d.CurrentTime()-i),e,0,!1,s,c)};return e.then((function(e){if(!r.checkWamTokenResult(e)){var t=e&&e.responseError;return a(!1,e&&e.responseStatus,t?t.errorCode+": "+t.errorMessage:""),Promise.reject(e)}return a(!0,e.responseStatus),Promise.resolve(e)}),(function(e){return a(!1,-1,e),Promise.reject()}))},e.prototype.processShellConfigApiData=function(t,n){var r,i,a,s,c,u,l=this,d=null;try{d=JSON.parse(t)}catch(e){d=t}if(!d)throw new Error("Empty shell and config response");this.configRetrieved=!0;var p=d.clientStartupConfiguration?JSON.parse(d.clientStartupConfiguration):null,h={ShellAndConfigCid:p?p.sharedClientStartupContext.correlationId:""};if(this.logAriaEvent(o.d.GenericEvent,"ShellAndConfigApi_Response",0,h),d.capabilities&&(this.capabilitiesConfig=JSON.parse(d.capabilities),this.capabilitiesConfig.universalMeControlSafetyFlightEnabled&&(this.capabilitiesConfig.universalMeControlPWAEnabled=this.capabilitiesConfig.universalMeControlPWAEnabled&&(null===(r=null===Windows||void 0===Windows?void 0:Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager)||void 0===r?void 0:r.findAllAccountsAsync)&&null!==(u=null===(c=null===(s=null===(a=null===(i=Windows.Foundation)||void 0===i?void 0:i.Metadata)||void 0===a?void 0:a.ApiInformation)||void 0===s?void 0:s.isMethodPresent)||void 0===c?void 0:c.call(s,"Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager","FindAllAccountsAsync"))&&void 0!==u&&u&&this.isValidAppVersion({build:1201,major:18,minor:2204,revision:0}),this.capabilitiesConfig.universalMeControlPWAEnabled?this.localSettingsProps.insert("UMCEnabledSessionId",window.overrideSID):this.localSettingsProps.lookup("UMCEnabledSessionId")===window.overrideSID?this.capabilitiesConfig.universalMeControlPWAEnabled=!0:this.localSettingsProps.remove("UMCEnabledSessionId"))),d.pwaConfig){var f=JSON.parse(d.pwaConfig);if(f){if(f.resourceUrlMap&&this.isUwp){var g=Object.entries(f.resourceUrlMap),m=new Set(f.deferredTokens||[]);g.forEach((function(t){var n=t[0],r=t[1];m.has(n)||l.getWamTokenResult(n,r,l.currentAccountProvider,!0,void 0,e.V2ResourceFriendlyName.includes(n)),"WCSS"!==n&&"Graph"!==n||(window.shellTokenRequestDictionary[r]=function(){return window.wamAccessTokenRequests.has(r)?window.wamAccessTokenRequests.get(r).result.then((function(e){return e?e.token:null})):l.getWamTokenResult(n,r,l.currentAccountProvider,!0,void 0,e.V2ResourceFriendlyName.includes(n)).then((function(e){return l.checkWamTokenResult(e)?e.responseData[0].token:null}))})}))}if(f.sessionExpiredToastMessage&&(e.SessionExpiredToastMessage=e.SessionExpiredToastTemplate.replace(e.ToastMessageKey,f.sessionExpiredToastMessage)),this.capabilitiesConfig&&this.capabilitiesConfig.fluentIconFontEnabled&&f.iconFontUrl){var v=document.createElement("link");v.rel="stylesheet",v.type="text/css",v.crossOrigin="anonymous",v.id=e.IconFontElementId,f.iconFontIntegrity&&(v.integrity=f.iconFontIntegrity),v.onerror=function(){var t,n=((t={})[e.InstrumentationParamAction]=f.iconFontUrl,t);l.logAriaEvent(o.d.GenericEvent,"Icon_Font_Load_Error",0,n)},v.href=f.iconFontUrl;var w=document.getElementById(e.IconFontElementId),A=w.parentNode;A&&w&&A.replaceChild(v,w)}}}if(d.navBarData){var y=JSON.parse(d.navBarData);window.navBarData=y}return n&&this.isUwp&&(this.currentMsaUser={upn:this.currentUserAccount.userName,puid:this.currentUserAccount.properties.hasKey("UID")?this.currentUserAccount.properties.lookup("UID"):"",userDisplayName:this.getUserDisplayName(Windows.ApplicationModel.Resources.Core.ResourceManager.current.defaultContext.languages[0])},window.userPrincipalName=this.currentUserAccount.userName),d.reactShellConfiguration&&(this.reactShellConfig=JSON.parse(d.reactShellConfiguration)),this.shellShimReady&&!this.reactShellBootstrapped&&this.waitForPageLoad().then((function(){return l.bootstrapReactShell()})),window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},d},e.prototype.requestConfigAndShellApiData=function(e,t,n){var r=this,i=this.swEnabled?window.navigator.serviceWorker.controller:null,a=new Headers;return this.getSharedClientStartupConfig().then((function(s){e&&!s.pwaV2TokenEnabled||!n||0===n.indexOf("t=")||a.append("Authorization","Bearer "+n),i&&(a.append("X-SW-OHP-FetchStrategy",t?"cache-only":"network-first"),window.pwaCurrentUserId&&a.append("X-SW-OHP-UserCacheId",window.pwaCurrentUserId)),a.append("X-OfficeHome-CorrelationId",window.overrideCID);var c={method:"GET",headers:a,cache:"default",credentials:"include"},u=new URL(r.currentUrl.origin+"/"+(window.configApiPath||"api/shellandconfigdata/pwa")+r.currentUrl.search);o.c.SetQueryParam(u,r.requiredMockAuthority?"mockauth":"auth",e?"1":"2"),o.c.SetQueryParam(u,"workload","pwa");var l=new Request(u.toString(),c),d=o.d.CurrentTime(),p=fetch(l),h=function(e,n){var i={HttpCode:n.toString(),DebugInfo:u.href};r.logRequest("ShellAndConfig_Request",Math.ceil(o.d.CurrentTime()-d),e,0,t,"",i)};return p.then((function(e){h(e.ok,e.status)}),(function(){h(!1,t?709:700)})),p.then((function(e){if(e.status>=200&&e.status<300)return e;throw Error(e.statusText)})).then((function(e){return e.json()}))}))},e.prototype.getOfficeToken=function(t,n){var r=this;return void 0===n&&(n=!0),this.getSharedClientStartupConfig().then((function(i){var a=!1,s=function(){var n=r.isConsumerAuthority(t.authority),s=null;try{s=t.user}catch(e){console.log("error accessing user property. Proceeding as if user property is null.")}var c=void 0!==window.Office,u=r.localSettingsProps.hasKey(e.CurrentAccountIdKey),l=r.localSettingsProps.hasKey(e.SwitchAccountKey)||r.localSettingsProps.hasKey(e.SwitchToSelectedAccountKey);return(null==i?void 0:i.pwaV2TokenEnabled)&&(!n||c||(null==s?void 0:s.nonRoamableId)||u&&!l)?(a=!0,e.OfficeHomeV2Resource):n?(r.logAriaEvent(o.d.GenericEvent,"WAM_V1_MSA_Fallback",2,{DebugInfo:"user: "+!!s+". currentUserAccount: "+u+". IsWebView2: "+c}),"service::office.com::MBI_SSL"):"4345a7b9-9a63-4910-a426-35363201d503"}();return r.getWamTokenResult(e.OfficeApiResource,s,t,n,void 0,a).then((function(n){return r.currentUserAccount=n.responseData[0].webAccount,r.localSettingsProps.insert(e.CurrentAccountIdKey,r.currentUserAccount.id),r.setupCurrentUser(t.authority,r.currentUserAccount.id),n}))}))},e.prototype.saveAccountProvider=function(t){this.currentAccountProvider=t,this.localSettingsProps.insert(e.CurrentUserProviderIdKey,t.id),this.localSettingsProps.insert(e.CurrentAuthorityKey,t.authority)},e.prototype.clearSavedProvider=function(){this.currentAccountProvider=null,this.localSettingsProps.remove(e.CurrentUserProviderIdKey),this.localSettingsProps.remove(e.CurrentAuthorityKey)},e.prototype.getCurrentUserPhoto=function(){var t=this;this.currentUserAccount&&this.isConsumerAuthority(this.currentUserAccount.webAccountProvider.authority)&&!this.localSettingsProps.hasKey(e.SwitchAccountKey)&&(this.currentUserPhotoPromise||(this.currentUserPhotoPromise=new Promise((function(e){t.currentUserAccount.getPictureAsync(Windows.Security.Credentials.WebAccountPictureSize.size208x208).then((function(e){var t=new Windows.Storage.Streams.Buffer(e.size);return e.readAsync(t,e.size,Windows.Storage.Streams.InputStreamOptions.readAhead)})).then((function(e){t.currentUserPhoto=Windows.Security.Cryptography.CryptographicBuffer.encodeToBase64String(e)})).done((function(){return e(t.currentUserPhoto)}),(function(){t.logAriaEvent(o.d.GenericEvent,"GetUserPhoto_Error",2),e("")}))}))))},e.prototype.handleShellConfigError=function(e){var t={Error:"string"==typeof e?e:e?e.name:"",DebugInfo:e?e.message:""};this.logAriaEvent(o.d.GenericEvent,"ShellAndConfigData_Error",0,t),this.shellAndConfigPromiseRejecter("Failed to fetch config data"),this.cleanUpShellAndConfigCallbacks()},e.prototype.fetchAndHandleShellAndConfigResponse=function(e,t){var n=this;return this.requestConfigAndShellApiData(e,!1,t).then((function(t){var r=n.processShellConfigApiData(t,e);n.shellAndConfigPromiseResolver(r),n.cleanUpShellAndConfigCallbacks()})).catch((function(e){return n.handleShellConfigError(e)}))},e.prototype.fetchTokenAndCallShellAndConfigApi=function(t){var n=this;if(this.shellAndConfigPromiseResolver&&this.shellAndConfigPromiseRejecter){var r=function(e){return"Error fetching token ("+(e?e.responseStatus:"")+") "+(e&&e.responseError?e.responseError.errorCode:"")},i=this.isConsumerAuthority(t.authority),a=!1,s=window.pwaCurrentUserId&&this.swEnabled&&window.navigator.serviceWorker.controller,c=s?this.getCurrentAccount(t).then((function(e){return n.requestConfigAndShellApiData(i,!0)})):null,u=i?this.getSharedClientStartupConfig().then((function(e){return(null==e?void 0:e.pwaV2TokenEnabled)?n.getOfficeToken(t).then((function(e){return n.requestConfigAndShellApiData(!0,!1,e.responseData[0].token)})):n.getCurrentAccount(t).catch((function(e){return n.getOfficeToken(t)})).then((function(e){return n.requestConfigAndShellApiData(!0,!1)}))})):this.getOfficeToken(t).then((function(e){return n.requestConfigAndShellApiData(!1,!1,e.responseData[0].token)})),l=function(t){if(t&&t.responseStatus){n.clearSavedProvider(),n.localSettingsProps.remove(e.CurrentAccountIdKey),n.localSettingsProps.insert(e.SignedOutKey,!0);var i={Message:r(t)};return n.logAriaEvent(o.d.GenericEvent,"FetchOfficeToken_Error",0,i),void n.reloadApp()}n.handleShellConfigError(t)};u.then((function(e){if(!a){var t=n.processShellConfigApiData(e,i);n.shellAndConfigPromiseResolver(t),n.cleanUpShellAndConfigCallbacks(),a=!0}})).catch((function(e){s||a||(l(e),a=!0)})),c&&c.then((function(e){if(!a){var t=n.processShellConfigApiData(e,i);n.shellAndConfigPromiseResolver(t),n.cleanUpShellAndConfigCallbacks(),a=!0}})).catch((function(){var t=function(){u.catch((function(e){l(e),a=!0}))};window.enableCacheMissReload&&!a?(a=!0,navigator.serviceWorker.getRegistration(e.BasePwaPath).then((function(e){return e.unregister()})).then((function(e){if(!e)throw new Error("unregister failed");n.logAriaEvent(o.d.GenericEvent,"CacheMissUnregister",0),n.reloadApp()})).catch((function(r){var i;n.logAriaEvent(o.d.GenericEvent,"CacheMissHandling_Error",0,((i={})[e.InstrumentationParamError]=r&&r.message?r.message.toString():"",i)),t()}))):t()}))}else this.logAriaEvent(o.d.GenericEvent,"MissingPromiseResolveReject_Error",0)},e.prototype.webAccountProviderCommandInvoked=function(t){var n=this;if(t&&t.webAccountProvider&&t.webAccountProvider.authority){var r=t.webAccountProvider;if(this.localSettingsProps.hasKey(e.SwitchAccountKey)){this.localSettingsProps.insert(e.SwitchToSelectedAccountKey,!0);var i=this.currentAccountProvider;this.saveAccountProvider(r);var a,s=o.d.CurrentTime();this.getOfficeToken(r,!1).then((function(t){return a=o.d.CurrentTime(),n.logAriaEvent(o.d.GenericEvent,"SwitchAccount_FetchedToken",2,{Latency:Math.ceil(a-s).toString()}),n.localSettingsProps.remove(e.SwitchAccountKey),n.localSettingsProps.remove(e.SwitchToSelectedAccountKey),n.resetBrowserStorage(),n.forceNewServiceWorker()})).then((function(){n.logAriaEvent(o.d.GenericEvent,"SwitchAccount_Completed",2,{Latency:Math.ceil(o.d.CurrentTime()-a).toString()}),n.reloadApp()})).catch((function(){n.localSettingsProps.remove(e.SwitchAccountKey),n.localSettingsProps.remove(e.SwitchToSelectedAccountKey),n.saveAccountProvider(i),n.logAriaEvent(o.d.GenericEvent,"SwitchAccount_Error",2,{Latency:Math.ceil(o.d.CurrentTime()-s).toString()}),n.displayScreen(e.OfficeHomeId)}))}else this.saveAccountProvider(r),this.displayScreen(e.OfficeHomeId),this.getOfficeToken(r).then((function(e){n.bootstrapApp(n.isConsumerAuthority(r.authority),e.responseData[0].token)})).catch((function(t){t&&t.responseStatus&&t.responseStatus===Windows.Security.Authentication.Web.Core.WebTokenRequestStatus.userCancel?(n.logAriaEvent(o.d.GenericEvent,"UserCancelSignIn",2),n.displayScreen(e.UnauthPageId)):(n.logAriaEvent(o.d.GenericEvent,"GetOfficeToken_Error",2),n.showErrorPage()),n.clearSavedProvider()}))}else this.logAriaEvent(o.d.GenericEvent,"InvalidWamProvider_Error",2)},e.prototype.onAccountCommandsRequested=function(t){var n=this,r=t.getDeferral(),o=new Array;this.requiredMockAuthority?o.push(new Promise((function(t){return Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.findAccountProviderAsync(e.MsaAadProviderId,n.requiredMockAuthority).then(t)}))):(o.push(new Promise((function(t){return Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.findAccountProviderAsync(e.MsaAadProviderId,e.AadAuthority).then(t)}))),o.push(new Promise((function(t){return Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.findAccountProviderAsync(e.MsaAadProviderId,e.MsaAuthority).then(t)})))),Promise.all(o).then((function(e){e.forEach((function(e){var r=new Windows.UI.ApplicationSettings.WebAccountProviderCommand(e,(function(e){return n.webAccountProviderCommandInvoked(e)}));t.webAccountProviderCommands.push(r)})),r.complete()}))},e.prototype.showAccountsPane=function(t){var n=this;void 0===t&&(t=!1),this.initializedAccountsPane||(Windows.UI.ApplicationSettings.AccountsSettingsPane.getForCurrentView().onaccountcommandsrequested=function(e){return n.onAccountCommandsRequested(e)},this.initializedAccountsPane=!0);var r=Windows.UI.ApplicationSettings.AccountsSettingsPane;t?r.showManageAccountsAsync?r.showManageAccountsAsync().then((function(){return n.localSettingsProps.remove(e.SwitchAccountKey)})):(this.logAriaEvent(o.d.GenericEvent,"MissingAccountSettingsPaneApi",2),r.show()):r.show()},e.prototype.reloadApp=function(){var t=this;this.flushLogs(!0).then((function(){window.open(""+e.BasePwaPath+t.currentUrl.search,"_self","msHideView=yes",!0)}))},e.prototype.bootstrapApp=function(t,n){var r=this;o.d.RevokeStandaloneLogger(),this.logAriaEvent(o.d.GenericEvent,"Pwa_Bootstrap_Start",0);var i=n?void 0:e.InitialPerformanceEvent,a=(n?"Unauth":"Auth")+"_Pwa_Bootstrap_Start";window.measureAppFrom=a,this.markPerformance(a,0,i),this.isConsumer=t,window.pwaCurrentUserId&&o.b.InitDiskPreload(window.pwaCurrentUserId,window.diskPreloadRequestMap,e.DiskPreloadStorageKey);var s=this;return window.shellAndConfigResponse=new Promise((function(e,r){if(s.shellAndConfigPromiseResolver=e,s.shellAndConfigPromiseRejecter=r,!s.isUwp)return window.pwaCurrentUserId="mock user",void s.fetchAndHandleShellAndConfigResponse(t,"mock token");s.getAccountProvider().then((function(e){n?s.fetchAndHandleShellAndConfigResponse(t,n):s.fetchTokenAndCallShellAndConfigApi(e)})).catch((function(){s.shellAndConfigPromiseRejecter("fetch provider error"),s.cleanUpShellAndConfigCallbacks()}))})),window.shellAndConfigResponse.then((function(){r.localSettingsProps&&r.localSettingsProps.hasKey(e.SignedOutKey)&&r.localSettingsProps.remove(e.SignedOutKey)}),(function(){s.showErrorPage()})),this.waitForDocumentLoad().then((function(){var n=r.getPwaStartupConfig();n.isConsumer=t;var i=n.shellBootHost+(t?n.consumerBootstrapPath:n.commercialBootstrapPath),s=t?n.consumerAppIconsUrl:n.commercialAppIconsUrl,c=n.shellBootHost+s,u=document.createElement("script"),l=document.createElement("script"),d=document.createElement("script");l.async=u.async=d.async=!0,l.crossOrigin=u.crossOrigin=d.crossOrigin="anonymous",l.type=u.type=d.type="text/javascript",l.onload=function(){r.markPerformance("Pwa_App_Bundle_Load",0,a)},l.onerror=function(){var t,n=((t={})[e.InstrumentationParamAction]=window.bundleUrl,t);r.logAriaEvent(o.d.GenericEvent,"App_Bundle_Load_Error",0,n)},u.onload=function(){r.markPerformance("Pwa_Shell_Bootstrapper_Load",0,a),r.shellShimReady=!0,r.configRetrieved&&!r.reactShellBootstrapped&&r.bootstrapReactShell()},u.onerror=function(){var t,n=((t={})[e.InstrumentationParamAction]=i,t);r.logAriaEvent(o.d.GenericEvent,"Shell_Bootstrapper_Load_Error",0,n)},d.onload=function(){r.markPerformance("Pwa_Shell_AppIcons_Load",0)},d.onerror=function(){var t,n=((t={})[e.InstrumentationParamAction]=c,t);r.logAriaEvent(o.d.GenericEvent,"Pwa_Shell_AppIcons_Error",0,n)},u.src=i,l.src=window.bundleUrl,d.src=c,window.bundleIntegrity&&(l.integrity=window.bundleIntegrity),document.body.appendChild(l),document.body.appendChild(u),document.body.appendChild(d)}))},e.prototype.bootstrapReactShell=function(){var t;try{if(this.isConsumer&&(this.reactShellConfig.isConsumer=!0,this.currentMsaUser&&(this.reactShellConfig.upn=this.currentMsaUser.upn,this.reactShellConfig.puid=this.currentMsaUser.puid,this.reactShellConfig.userDisplayName=this.currentMsaUser.userDisplayName,this.reactShellConfig.mePhotoSource=this.currentUserPhoto?"data:image/jpeg;base64,"+this.currentUserPhoto:"")),!HomePage.ShellUtil.BootstrapReactShell("OfficePwa",this.reactShellConfig,this.capabilitiesConfig))throw new Error("Bootstrap failed");this.reactShellBootstrapped=!0,this.isConsumer||HomePage.ShellUtil.HydrateCommercialReactShell(window.navBarData,!0,this.reactShellConfig,this.capabilitiesConfig)}catch(i){var n="string"==typeof i?i:i.name+": "+i.message,r=((t={})[e.InstrumentationParamError]=n,t);this.logAriaEvent(o.d.GenericEvent,"Shell_Bootstrapper_Error",0,r)}},e.prototype.resetBrowserStorage=function(){sessionStorage.clear(),sessionStorage.setItem(e.ExistingSessionKey,"true"),localStorage.removeItem(e.PwaOnActivatePendingEventArgsKey),this.clearPwaJumpList()},e.prototype.resetSecurityLevel=function(){var e=Windows.System.Profile.PlatformDiagnosticsAndUsageDataSettings.collectionLevel;window.windowsDataSecuritySetting="number"==typeof e?e>=3?3:e:0},e.prototype.onLifecycleEvent=function(e,t,n){(n=n||{}).Type=t.type,n.Target=t.target?t.target.toString():"",this.logAriaEvent(o.d.GenericEvent,"UWPLifecycleEvent_"+e,2,n)},e.prototype.onActivate=function(t){var n,r,i,a,s=t.detail&&t.detail.length?t.detail[0]:null,c="",u=(c=t.kind===Windows.ApplicationModel.Activation.ActivationKind.protocol?null!==(n=null==t?void 0:t.uri.absoluteUri)&&void 0!==n?n:"":null!==(r=null==s?void 0:s.arguments)&&void 0!==r?r:"").toLowerCase(),l=u.includes("officekey"),d=u.includes("wordpad"),p=u.includes("covid"),h=u.includes("hvastartmenu"),f=u.includes("appid"),g=u.includes("cgeawareness");if(l)window.requestOriginOverride="OfficeKey";else if(u&&(d||p||h||f||g)){var m=new URLSearchParams,v="";if(f){var w=u.split(":");m=w.length>1?new URLSearchParams(w[1].split("'")[1]):new URLSearchParams(u),v="M365Apps"}else{var A=null===(i=c.split("?")[1])||void 0===i?void 0:i.replace("'","");v=null!==(a=(m=new URLSearchParams(A)).get("from"))&&void 0!==a?a:""}var y=m.get("appid"),S=m.get("pageid"),P=m.get("subpageid");window.requestOriginOverride=v;var E="Default";u.includes("open=wordstartpage")?E="Word":u.includes("open=excelstartpage")?E="Excel":u.includes("open=powerpointstartpage")?E="PowerPoint":f&&(E="",y&&(E+="/"+y),S&&(E+="/"+S),P&&(E+="/"+P));var C={by:v,argument:E};window.localStorage.setItem(e.PwaOnActivatePendingEventArgsKey,JSON.stringify(C)),window.dispatchEvent(new CustomEvent("activated",{detail:C})),this.logAriaEvent(o.d.GenericEvent,e.InstrumentationEventOnActivate,2)}if(s.kind===Windows.ApplicationModel.Activation.ActivationKind.launch){this.localSettingsProps.SplashImageWidth=s.splashScreen.imageLocation.width;var b=t;if(b.arguments&&!l&&!d&&!g)try{var I=JSON.parse(b.arguments);if(I.createFileType||I.id){var k={};k[e.InstrumentationParamState]="Pending",k[e.InstrumentationParamAction]=I.createFileType?"CreateNewFile":"OpenFile",C={by:"JumpList",argument:b.arguments,previousExecutionState:void 0!==s.previousExecutionState?s.previousExecutionState:0},window.localStorage.setItem(e.PwaOnActivatePendingEventArgsKey,JSON.stringify(C)),window.dispatchEvent(new CustomEvent("activated",{detail:C})),window.requestOriginOverride="JumpList",this.logAriaEvent(o.d.GenericEvent,e.InstrumentationEventJumpListItemClick,2,k)}}catch(t){var U={};U[e.InstrumentationParamState]="Pending",U[e.InstrumentationParamError]=(t||"").toString(),U[e.InstrumentationParamAction]="ActivateByJumpList",this.logAriaEvent(o.d.GenericEvent,e.InstrumentationEventJumpList,2,U)}}s.prelaunchActivated&&(this.setPrelaunchMode(),this.localSettingsProps[e.PrelaunchModeKey]=!0);var W=s?{Kind:Windows.ApplicationModel.Activation.ActivationKind[s.kind],PreviousState:Windows.ApplicationModel.Activation.ApplicationExecutionState[s.previousExecutionState],TileId:s.tileId,ViewId:s.currentlyShownApplicationViewId.toString(),FromOfficeKey:l}:{};this.onLifecycleEvent("Activate",t,W),!s.prelaunchActivated&&Windows.UI.WebUI.WebUIApplication.hasOwnProperty("enablePrelaunch")&&"function"==typeof Windows.UI.WebUI.WebUIApplication.enablePrelaunch&&Windows.UI.WebUI.WebUIApplication.enablePrelaunch(!0)},e.prototype.onSuspend=function(e){this.onLifecycleEvent("Suspend",e)},e.prototype.onResume=function(e){window.pwaResuming=!0,this.onLifecycleEvent("Resume",e)},e.prototype.onNavigate=function(e){this.onLifecycleEvent("Navigate",e)},e.prototype.onEnterBackground=function(e){this.onLifecycleEvent("EnterBackground",e)},e.prototype.onLeaveBackground=function(e){this.onLifecycleEvent("LeaveBackground",e)},e.prototype.isConsumerAuthority=function(t){return t===e.MsaAuthority},e.prototype.installThirdPartyNotice=function(){var t=this,n=Windows.Storage.ApplicationData.current.localFolder;fetch(window.thirdPartyNoticeUrl).then((function(r){if(!r.ok)throw new Error;return r.arrayBuffer().then((function(r){var o=Windows.Security.Cryptography.CryptographicBuffer.createFromByteArray(Array.from(new Uint8Array(r)));return n.createFileAsync(e.ThirdPartyNoticeFileName,Windows.Storage.CreationCollisionOption.replaceExisting).then((function(e){return t.thirdPartyLicenseNotice=e,Windows.Storage.FileIO.writeBufferAsync(e,o)}))}))})).catch((function(){return t.logAriaEvent(o.d.GenericEvent,"InstallThirdPartyNotice_Error",2),n.getFileAsync(e.ThirdPartyNoticeFileName).then((function(e){t.thirdPartyLicenseNotice=e}))})).catch((function(){t.logAriaEvent(o.d.GenericEvent,"GetThirdPartyNotice_Error",2)}))},e.prototype.forceNewServiceWorker=function(){var t=this;return this.swEnabled?new Promise((function(n){navigator.serviceWorker.getRegistration(e.BasePwaPath).then((function(e){if(e){var r=e.waiting;if(r){var i=!1,a=new Promise((function(e){navigator.serviceWorker.oncontrollerchange=function(){i=!0,e()}})),s=new Promise((function(e){setTimeout(e,500)}));return r.postMessage({type:"OFFICECOM_FORCE_ACTIVATION"}),void Promise.race([a,s]).then((function(){i||t.logAriaEvent(o.d.GenericEvent,"SWForceActivation_Error",0),n()}))}if(e.active){var c=function(){return e.unregister().then((function(e){return n()})).catch((function(e){return n()}))};return void caches.keys().then((function(e){e&&e.some((function(e){return e.indexOf(window.pwaCurrentUserId)>=0&&e.indexOf("shell-config-api")>=0}))?n():c()}),c)}}n()}))})):Promise.resolve()},e.prototype.displayScreen=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t&&t.length&&(t.includes(e.OfficeHomeId)&&(document.getElementById(e.ReactShellHeaderId).style.display="block"),this.elementsDisplayStyleMap.forEach((function(e,n){var r=document.getElementById(n);r&&(t.includes(n)?r.style.display=e:r.style.display="none")})))},e.prototype.showErrorPage=function(){var t=this,n=function(){t.logAriaEvent(o.d.GenericEvent,"Pwa_Error_PageView",0),t.waitForPageLoad().then((function(){t.flushLogs(),document.getElementById("correlation-id").innerText=window.overrideCID,t.displayScreen(e.ErrorPageId),t.markPerformance("Pwa_Error_Ready",0)}))};this.swEnabled?navigator.serviceWorker.getRegistration(e.BasePwaPath).then((function(e){return e&&e.active?(t.logAriaEvent(o.d.GenericEvent,"Pwa_FoundErrorWithSW",0),e.unregister().then((function(e){return e?Promise.resolve(e):Promise.reject()}))):(n(),Promise.resolve(!1))})).then((function(e){e&&(t.logAriaEvent(o.d.GenericEvent,"Pwa_WorkerUnregistration_Success",0),t.reloadApp())})).catch((function(){t.logAriaEvent(o.d.GenericEvent,"Pwa_WorkerUnregistration_Failed",0),n()})):n()},e.prototype.setPrelaunchMode=function(){var t=this;window.prelaunchMode=!0,Math.random()>e.PrelaunchLogsSamplingRate&&(window.disableLogs=!0);var n=this,r=function(){window.prelaunchMode&&(window.prelaunchMode=!1,window.disableLogs=!1,n.localSettingsProps.remove(e.PrelaunchModeKey),n.logAriaEvent(o.d.GenericEvent,"Pwa_FocusWindow_PageView",0),t.currentAccountProvider&&t.initializeAuthOTelAndLogPageView({pageName:"OfficeHome",pageType:"Default",eventName:"Pwa_FocusWindow_PageView",isIntentional:!0,securityThreshold:0})),window.removeEventListener("focus",r)};window.addEventListener("focus",r)},e.prototype.getAriaContext=function(){var e=this;return this.getSharedClientStartupConfig().then((function(t){return t?Promise.resolve({appWorkloadType:e.getAppWorkloadType(),ariaCollectorUrl:t.ariaCollectorUrl,ariaTenant:t.ariaTenant,authTypeString:e.currentAccountProvider?e.currentAccountProvider.authority:"",authVersion:"1.0",cookieConsentRequired:t.cookieConsentRequired,corpNet:t.corpNet,correlationId:window.overrideCID,deploymentEnvironment:t.deploymentEnvironment,devEnvironment:t.devEnvironment,ecsRing:t.ecsRing,features:"",flights:t.flights,geoName:t.geoName,domainOrigin:t.domainOrigin,puid:"",requestOrigin:window.requestOriginOverride||t.requestOrigin,serverBuildDate:t.buildDateUtc,serverBuildId:t.buildId,sessionId:window.overrideSID,tenantId:"",testTraffic:t.testTraffic,wrapperVersion:e.getVersionString(),workload:"Pwa"}):Promise.reject("Startup config not found")}))},e.prototype.initializeUnAuthOTelAndLogPageView=function(e){this.getSharedClientStartupConfig().then((function(e){return e?Promise.resolve({appName:e.oTelAppName,appPlatform:"Universal",appWorkload:"HWA",bundleBuildDate:e.buildDateUtc,bundleBuildId:e.buildId,correlationId:e.correlationId,deploymentEnvironment:e.deploymentEnvironment,eventCategoryConfig:{actionEnabled:e.oTelClickEnabled,diagnosticEnabled:e.oTelDiagnosticEnabled,errorEnabled:e.oTelErrorEnabled,impressionEnabled:e.oTelImpressionEnabled,pageViewEnabled:e.oTelPageViewEnabled,perfEnabled:e.oTelPerfEnabled,requestEnabled:e.oTelRequestEnabled,featureEnabled:e.oTelFeatureEnabled},flights:e.flights,isCorpNet:e.corpNet,isTestTraffic:e.testTraffic,oTelEnabled:e.oTelEnabled,oTelAriaTenant:e.oTelAriaTenant,oTelAriaNameSpace:e.oTelNameSpace,sessionId:e.sessionId,serverLocation:e.geoName,requestOrigin:e.requestOrigin}):Promise.reject("Startup config not found")})).then((function(t){var n,r;null===(n=window.standaloneOteLogger)||void 0===n||n.initializeUnAuthOTel(t),null===(r=window.standaloneOteLogger)||void 0===r||r.logPageView(e,!0)})).catch((function(e){console.log(e)}))},e.prototype.initializeAuthOTelAndLogPageView=function(e){var t=this;this.getSharedClientStartupConfig().then((function(e){return e?Promise.resolve({appName:e.oTelAppName,appPlatform:"Universal",appWorkload:"HWA",bundleBuildDate:e.buildDateUtc,bundleBuildId:e.buildId,correlationId:e.correlationId,deploymentEnvironment:e.deploymentEnvironment,eventCategoryConfig:{actionEnabled:e.oTelClickEnabled,diagnosticEnabled:e.oTelDiagnosticEnabled,errorEnabled:e.oTelErrorEnabled,impressionEnabled:e.oTelImpressionEnabled,pageViewEnabled:e.oTelPageViewEnabled,perfEnabled:e.oTelPerfEnabled,requestEnabled:e.oTelRequestEnabled,featureEnabled:e.oTelFeatureEnabled},flights:e.flights,identity:{isMsa:t.currentAccountProvider?t.isConsumerAuthority(t.currentAccountProvider.authority):void 0,objectId:e.objectId,puid:e.puid,tenantId:e.tenantId,encryptionConfig:void 0,userPrincipalName:void 0},isCorpNet:e.corpNet,isTestTraffic:e.testTraffic,oTelEnabled:e.oTelEnabled,oTelAriaTenant:e.oTelAriaTenant,oTelAriaNameSpace:e.oTelNameSpace,sessionId:e.sessionId,serverLocation:e.geoName,requestOrigin:e.requestOrigin}):Promise.reject("Startup config not found")})).then((function(t){var n,r;null===(n=window.standaloneOteLogger)||void 0===n||n.initializeAuthOTel(t),null===(r=window.standaloneOteLogger)||void 0===r||r.logPageView(e,!1)})).catch((function(e){console.log(e);var n={Error:"string"==typeof e?e:e?e.name:"",DebugInfo:e?e.message:""};t.logAriaEvent(o.d.GenericDebugCache,"Pwa_Initialize_OTEL_Error",0,n)}))},e.prototype.logUnAuthUserAction=function(e){var t;this.logAriaEvent(o.d.GenericClick,e.id,e.securityThreshold),null===(t=window.standaloneOteLogger)||void 0===t||t.logUnAuthUserAction(e)},e.prototype.getVersionString=function(){var e=this.isUwp?Windows.ApplicationModel.Package.current.id.version:null;return e&&e.major+"."+e.minor+"."+e.build+"."+e.revision},e.prototype.flushLogs=function(t){return void 0===t&&(t=!1),o.d.FlushQueuedEvents(this.getAriaContext(),t,e.PwaPage)},e.prototype.parseJsonElementWithId=function(e){var t=document.getElementById(e);return t&&t.textContent?JSON.parse(t.textContent):null},e.prototype.getSharedClientStartupConfig=function(){var e=this;return this.waitForDocumentLoad().then((function(){return e.parseJsonElementWithId("sharedClientStartupConfigJson")}))},e.prototype.getPwaStartupConfig=function(){return this.parseJsonElementWithId(e.PwaStartupConfigElementId)},e.prototype.waitForPageLoad=function(){return new Promise((function(e){"complete"===document.readyState?e():window.addEventListener("load",(function(){e()}))}))},e.prototype.waitForDocumentLoad=function(){return new Promise((function(e){"interactive"===document.readyState||"complete"===document.readyState?e():document.addEventListener("DOMContentLoaded",(function(){e()}))}))},e.prototype.clearPwaJumpList=function(){var t=this;localStorage.removeItem(e.PwaJumpListMappingKey),localStorage.removeItem(e.PwaJumpListRemovedItemsKey);var n={};Windows.UI.StartScreen.JumpList.loadCurrentAsync().then((function(r){r.systemGroupKind=Windows.UI.StartScreen.JumpListSystemGroupKind.none,r.items.clear(),r.saveAsync().then((function(){n[e.InstrumentationParamState]="Success",n[e.InstrumentationParamAction]="SaveJumpListToClear",t.logAriaEvent(o.d.GenericEvent,e.InstrumentationEventJumpList,2,n)}),(function(r){n[e.InstrumentationParamError]=(r||"").toString(),n[e.InstrumentationParamAction]="SaveJumpListToClear",t.logAriaEvent(o.d.GenericEvent,e.InstrumentationEventJumpList,2,n)}))}),(function(r){n[e.InstrumentationParamError]=(r||"").toString(),n[e.InstrumentationParamAction]="LoadJumpListToClear",t.logAriaEvent(o.d.GenericEvent,e.InstrumentationEventJumpList,2,n)}))},e.prototype.setupCurrentUser=function(e,t){window.pwaCurrentUserId=this.getUserIdKey(e,t),this.getCurrentUserPhoto()},e.prototype.getAppWorkloadType=function(){if(this.isUwp){if(void 0!==window.Office)return"WebView2";var e=new RegExp("1[0-9]{2}10"),t=Windows.ApplicationModel.Package.current.id.version;return(null==t?void 0:t.build)&&e.test(t.build.toString())?"UWP_fallback":"UWP"}},e.prototype.isValidAppVersion=function(e){if(this.isUwp){if(void 0!==window.Office){var t=Windows.ApplicationModel.Package.current.id.version;return t.minor>e.minor||t.minor===e.minor&&t.build>=e.build}return!0}return!1},e.prototype.findAllAccounts=function(t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,a,s;return Object(r.d)(this,(function(r){switch(r.label){case 0:n={},r.label=1;case 1:return r.trys.push([1,4,,5]),[4,Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.findAccountProviderAsync(e.MsaAadProviderId,t)];case 2:return i=r.sent(),[4,Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.findAllAccountsAsync(i,e.AppId)];case 3:return(a=r.sent()).status===Windows.Security.Authentication.Web.Core.FindAllWebAccountsStatus.success?[2,Promise.resolve(a.accounts)]:(n[e.InstrumentationParamError]=a.status+":"+a.providerError.toString(),[3,5]);case 4:return s=r.sent(),n[e.InstrumentationParamError]=(s||"Error when calling FindAllAccountsAsync").toString(),[3,5];case 5:return this.logAriaEvent(o.d.GenericEvent,"Pwa_FindAllAccounts_Error",0,n),[2,Promise.resolve([])]}}))}))},e.AadAuthority="organizations",e.AppId="0ec893e0-5785-4de6-99da-4ed124e5296c",e.BasePwaPath="/pwa",e.CurrentAccountIdKey="CurrentAccountId",e.CurrentAuthorityKey="CurrentAuthority",e.CurrentUserProviderIdKey="CurrentUserProviderId",e.DiskPreloadStorageKey="PwaDiskPreloadUrlCache",e.ErrorPageId="error-page",e.ExistingSessionKey="ExistingSession",e.IconFontElementId="icon-font-bundle",e.InitialPerformanceEvent="Pwa_Init",e.InstrumentationEventJumpList="Pwa_Jump_List",e.InstrumentationEventJumpListItemClick="Pwa_Jump_List_Item_Click",e.InstrumentationEventOnActivate="Pwa_On_Activated",e.InstrumentationParamAction="Action",e.InstrumentationParamError="Error",e.InstrumentationParamState="State",e.LocalProviderId="https://login.windows.local",e.PrelaunchLogsSamplingRate=.005,e.PwaPage="Pwa",e.MsaAadProviderId="https://login.microsoft.com",e.MsaAuthority="consumers",e.OfficeApiResource="OfficeApi",e.OfficeHomeId="officeHome",e.PrelaunchModeKey="PrelaunchMode",e.PwaJumpListMappingKey="PwaJumpListMapping",e.PwaJumpListRemovedItemsKey="PwaJumpListRemovedItems",e.PwaOnActivatePendingEventArgsKey="PwaOnActivatePendingEventArgs",e.ReactShellHeaderId="ReactShellHeader",e.PwaStartupConfigElementId="pwaStartupConfigJson",e.SignedOutKey="UserSignedOut",e.SignOutWindowName="logout",e.SignOutWindowNameKey="LogoutWindowName",e.SwitchAccountKey="SwitchAccount",e.SwitchToSelectedAccountKey="SwitchSelectedAccount",e.ThirdPartyNoticeFileName="ThirdPartyNotice.html",e.ToastMessageKey="{TOASTMSG}",e.UnauthPageId="unauth-page",e.OfficeHomeV2Resource="4765445b-32c6-49b0-83e6-1d93765276ca/.default",e.V2ResourceFriendlyName=["OfficeHome","OfficeApi","Graph","Substrate"],e}());i.canRender()||(window.location.href="/"),i.initializeGlobalFunctions(),i.initVars(),i.initApp()},bb6g:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return c}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function s(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function c(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}},yxA9:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return a}));var r=36e5,o=function(){function e(){}return e.GetCookies=function(){return document.cookie.split("; ").map((function(e){return e.split("=")})).map((function(e){var t=e[0],n=e[1];return{key:decodeURIComponent(t),value:decodeURIComponent(n)}}))},e.CreateGuid=function(){var e=window.performance.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))},e.InitializeCIDSID=function(t,n){if(t){var r=e.GetQueryParam(new URL(window.location.href),"cid");window.overrideCID=r||e.CreateGuid();var o=e.GetCookies().find((function(e){return e.key===t}));if(o)window.overrideSID=o.value;else{window.overrideSID=e.CreateGuid();var i=n?";path="+n:"";document.cookie=t+"="+encodeURIComponent(window.overrideSID)+i}}},e.NotifyInstallingWorkerAppFailed=function(e,t){if(void 0===t&&(t=!1),e){var n=function(){var r={type:"OFFICECOM_LOAD_COMPLETE",meta:"installation-app",payload:{success:!1,unregister:t}};e.installing.postMessage(r),e.removeEventListener("updatefound",n)};e.installing?n():(e.addEventListener("updatefound",n),setTimeout((function(){e.removeEventListener("updatefound",n)}),5e3))}},e.SetQueryParam=function(e,t,n){if(e&&t&&n)if("undefined"==typeof URLSearchParams){var r=e.search;if(!r||r.length<2)e.search="?"+t+"="+n;else{var o,i=r.substring(1).split("&");for(o=0;o<i.length;o++){var a=i[o].split("=")[0];if(a===t){i[o]=a+"="+n;break}}o===i.length&&i.push(t+"="+n),e.search="?"+i.join("&")}}else e.searchParams.set(t,n)},e.GetQueryParam=function(e,t){if(!e||!t)return"";if("undefined"!=typeof URLSearchParams)return e.searchParams.get(t);var n=e.search;if(!n||n.length<2)return"";for(var r=n.substring(1).split("&"),o=0;o<r.length;o++){var i=r[o].split("="),a=i[0],s=i[1];if(a===t)return s}return""},e}(),i=function(){function e(){}return e.CurrentTime=function(){return e.PerformanceLoggingEnabled?performance.now():(new Date).getTime()},e.LogEvent=function(t,n,r,o,i){if(o=o||{},i=i||[],window.instrumentationService)window.instrumentationService.generateEvent(n,t,r,o,i,!0);else if(e.StandaloneLoggerRunning)StandaloneAriaLogger.Logger.LogEvent(t,n,o,r);else{window.queuedEvents||(window.queuedEvents=[]);var a={streamName:t,eventName:n,eventParams:o,metrics:i,securityThreshold:r};window.queuedEvents.push(a)}},e.MarkPerformance=function(t,n,r,o,i){if(e.PerformanceLoggingEnabled&&!(r>o)&&t)if(window.performanceService)window.performanceService.mark(t,n,0);else{window.performance.mark(t),window.queuedMarks||(window.queuedMarks=[]);var a={markName:t,measureFrom:n,eventParams:i};window.queuedMarks.push(a),e.DrainOnMark&&e.GeneratePerformanceEvents(!1)}},e.FlushQueuedEvents=function(t,n,r){return e.GeneratePerformanceEvents(n,r),window.instrumentationService||e.StandaloneLoggerRunning?(n&&(window.instrumentationService?window.instrumentationService.flush():StandaloneAriaLogger.Logger.EndSession(!0,!0)),Promise.resolve(!0)):t.then((function(t){return"undefined"!=typeof StandaloneAriaLogger&&StandaloneAriaLogger.Logger?(StandaloneAriaLogger.Logger.Initialize(t,!1),n&&StandaloneAriaLogger.Logger.EndSession(!0,!0),e.StandaloneLoggerRunning=!0,Promise.resolve(!0)):Promise.reject("Standalone aria logger does not exist")})).catch((function(e){return console.log(e),Promise.resolve(!1)}))},e.RevokeStandaloneLogger=function(){e.StandaloneLoggerRunning&&(StandaloneAriaLogger.Logger.EndSession(!0,!1),e.StandaloneLoggerRunning=!1,e.DrainOnMark=!1)},e.GeneratePerformanceEvents=function(t,n){if(e.DrainOnMark=!0,e.PerformanceLoggingEnabled&&!window.performanceService){var r=function(t,n,r){var o;(r=r||{}).Latency=n.toString(),r.ItemCategory=null!==(o=r.ItemCategory)&&void 0!==o?o:"Inline",e.LogEvent(e.PerformanceDump,t,0,r,[])},o=function(t,n,r){var o;(r=r||{}).Error=t,r.DebugInfo=n,r.ItemCategory=null!==(o=r.ItemCategory)&&void 0!==o?o:"Inline",e.LogEvent(e.GenericEvent,e.PerformanceMarkFailure,0,r,[])};window.queuedMarks&&window.queuedMarks.splice(0,window.queuedMarks.length).forEach((function(e){var t=e.measureFrom||"navigationStart";try{window.performance.measure(e.markName,t,e.markName)}catch(n){return void o(e.markName,"Failed to record <"+e.markName+"> starting from <"+t+">: exception is thrown",e.eventParams)}var n=window.performance.getEntriesByName(e.markName,"measure");if(n&&n.length){var i=n[0],a=Math.ceil(i.duration);r(e.markName,a,e.eventParams)}else o(e.markName,"Failed to record <"+e.markName+">: measure missing",e.eventParams)})),t||"complete"===document.readyState?e.BrowserMeasuresLogged||(e.BrowserMeasuresLogged=!0,e.GetBrowserTimingMeasures((function(e,t){o(e,t,{Page:n})})).forEach((function(e){r(e.name,e.duration,{Page:n})}))):window.addEventListener("load",(function(){e.GeneratePerformanceEvents(!0,n)}))}},e.PerformanceLoggingSupported=function(){var e=window.performance;return!!(e&&e.now&&e.mark&&e.timing&&e.timing.navigationStart&&e.measure&&e.getEntriesByType)},e.GetBrowserTimingMeasures=function(t,n,r){var o=new Array;if(!e.PerformanceLoggingSupported())return o;for(var i in window.performance.timing){var a=e.globalAllowedMarkers.get(i);if(a){var s=window.performance.timing[i],c=window.performance.timing[a];if("number"==typeof s&&"number"==typeof c)if(0!==s&&0!==c)if(s<c)t(i,"Failed to calculate measure for <"+i+"> starting from <"+a+"> due to relative marker value being greater than marker value: <"+i+">="+s+"; diff from <"+a+">="+(s-c));else if(s<window.performance.timing.navigationStart)t(i,"Failed to calculate measure for <"+i+"> starting from <"+a+"> due to marker value being less than <navigationStart> marker value: <"+i+">="+s+"; diff from <navigationStart}>="+(s-window.performance.timing.navigationStart));else if(c<window.performance.timing.navigationStart)t(i,"Failed to calculate measure for <"+i+"> starting from <"+a+"> due to relative marker value being less than <navigationStart> marker value: <"+i+">="+s+"; <"+a+">="+c+"; diff from <navigationStart}>="+(c-window.performance.timing.navigationStart));else{var u=Math.ceil(s-c);o.push({name:i,duration:u,params:n?Object.assign({},n):{}});var l=i+"_ohp_measure";r&&r(i,l);try{window.performance.measure(l,a,i)}catch(e){t(i,"Failed to record measure for <"+i+"> starting from <"+a+">: exception is thrown")}}else"unloadEventStart"!==i&&"unloadEventEnd"!==i&&t(i,"Failed to calculate measure for <"+i+"> starting from <"+a+"> due to unexpected zero values: <"+i+">="+s+"; <"+a+">="+c);else t(i,"Failed to calculate measure for <"+i+"> starting from <"+a+"> due to unexpected value type: <"+i+"> value type is "+typeof s+"; <"+a+"> value type is "+typeof c)}}return o},e.PerformanceLoggingEnabled=e.PerformanceLoggingSupported(),e.DrainOnMark=!1,e.BrowserMeasuresLogged=!1,e.StandaloneLoggerRunning=!1,e.GenericDebugCache="Generic_Debug_Cache_2",e.GenericClick="Generic_Click",e.GenericEvent="Generic_Event",e.GenericRequest="Generic_Request",e.PerformanceDump="Performance_Dump",e.PerformanceMarkFailure="Performance_Mark_Failure",e.EmailRegex=new RegExp("[a-zA-Z0-9_\\-\\.]+(@|%40|%2540)[a-zA-Z0-9_\\-\\.]+\\.[a-zA-Z]{2,63}","gm"),e.globalAllowedMarkers=new Map([["fetchStart","navigationStart"],["unloadEventStart","navigationStart"],["unloadEventEnd","unloadEventStart"],["domainLookupEnd","domainLookupStart"],["connectEnd","connectStart"],["requestStart","navigationStart"],["responseStart","requestStart"],["responseEnd","responseStart"],["domLoading","responseStart"],["domInteractive","domLoading"],["domComplete","domLoading"]]),e}(),a=function(){function e(){}return e.InitDiskPreload=function(e,t,n){var r=window.navigator.serviceWorker&&window.navigator.serviceWorker.controller;if(e&&r&&t){var o=[],a=localStorage.getItem(n);a&&(o=JSON.parse(a)),o.forEach((function(n){var r=n.url,o=n.markerName;if(r&&o){var a=new Headers;a.append("X-SW-OHP-FetchStrategy","cache-only"),a.append("X-SW-OHP-UserCacheId",e);var s=new Request(r,{headers:a}),c="Disk_Preload_Start_"+o;i.MarkPerformance(c,"",0,3);var u=fetch(s).catch((function(){return Response.error()}));u.then((function(){var e="Disk_Preload_End_"+o;i.MarkPerformance(e,c,0,3)})),t.set(r,u)}}))}},e}();!function(){function e(){}e.prefetchMruData=function(e,t,n,r,o,i,a,s){var c=new URL(window.location.href),u="";u=n?c.origin+"/"+(t?"mock/api/mru":"api/mru"):t?c.origin+"/mock/v2/recent/docs":"https://ocws.officeapps.live.com/ocs/v2/recent/docs";var l=new URL(u+"?apps=Word,Excel,PowerPoint,Visio,OneNote,Sway,Project,Portfolio,Forms,PdfViewer,PowerBI&show=100&rs="+r+(n?"&workload="+i:"")),d=new Headers;n||(d.append("X-CorrelationId",window.overrideCID),d.append("X-Office-Platform","Web"),d.append("X-Office-Application",109..toString()),d.append("X-Office-Version",o)),e&&d.append("Authorization","Bearer "+e.token),a&&this.addCacheHeaders(d,a),s&&d.append("ohp-mock",s);var p={method:"GET",headers:d,credentials:"include"},h=new Request(l.toString(),p);return fetch(h)},e.prefetchRecommendedData=function(e,t,n,r,o,i,a,s,c,u){var l=new URL(window.location.href),d="",p=new URL(window.location.href),h=new Headers;h.append("client-request-id",u),h.append("X-Office-Application",114..toString()),n?(d=t?l.origin+"/mock/PeoplePredictionsB2/MicrosoftFeed":"https://substrate.office.com/PeoplePredictionsB2/MicrosoftFeed",p=new URL(d+"?section=OfficeComHome&scenario=OfficeComANTP&rs="+r),h.append("scenariotag","OfficeComANTP"),h.append("x-officefeedflight","evaluation")):(d=t?l.origin+"/mock/recommended/api/v1.0":"https://substrate.office.com/recommended/api/v1.0",p=new URL(d+"/files?show=16&skipCache=false&apps=Word,Excel,PowerPoint,OneNote,Pdf,Visio&rs="+r),h.append("X-Ms-ClientAppId",o),h.append("X-AnchorMailbox",a+"@"+i),h.append("X-RoutingParameter-SessionKey",a)),e&&h.append("Authorization","Bearer "+e.token),s&&this.addCacheHeaders(h,s),c&&h.append("ohp-mock",c);var f={method:"GET",headers:h,cache:"default",credentials:"include"},g=new Request(p.toString(),f);return fetch(g)},e.prefetchSharePointSitesData=function(e,t,n,r,o,i){var a=new URL(window.location.href),s=t?a.origin+"/mock/sites":"https://odc.officeapps.live.com/odc/servicemanager/v2.0/sites?lcid="+n+"&uilcid="+n+"&syslcid="+n+"&lists=frequent,followed&items=12",c=new URL(s),u=new Headers;u.append("Accept","application/json"),u.append("X-CorrelationId",window.overrideCID),u.append("X-Office-Platform","Web"),u.append("X-Office-Application",109..toString()),u.append("X-Office-Version",r),e&&u.append("Authorization","Bearer "+e.token),o&&this.addCacheHeaders(u,o),i&&u.append("ohp-mock",i);var l={method:"GET",headers:u,cache:"default"},d=new Request(c.toString(),l);return fetch(d)},e.addCacheHeaders=function(e,t){if("serviceWorker"in window.navigator){var n=!!window.navigator.serviceWorker.controller,r=window.navigator.onLine;n&&r&&t&&(e.append("X-SW-OHP-FetchStrategy","network-first"),e.append("X-SW-OHP-UserCacheId",t))}}}()}});
//# sourceMappingURL=pwa-bootstrap-0408bb49f161111380c5.js.map