/*! For license information please see pwa-bundle-bf1bfe6553b9b60574ca.js.LICENSE.txt */
!function(e){function t(t){for(var n,r,s=t[0],l=t[1],c=t[2],u=0,h=[];u<s.length;u++)r=s[u],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&h.push(a[r][0]),a[r]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(d&&d(t);h.length;)h.shift()();return o.push.apply(o,c||[]),i()}function i(){for(var e,t=0;t<o.length;t++){for(var i=o[t],n=!0,r=1;r<i.length;r++)0!==a[i[r]]&&(n=!1);n&&(o.splice(t--,1),e=s(s.s=i[0]))}return e}var n={},r={145:0},a={145:0},o=[];function s(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.e=function(e){var t=[];r[e]?t.push(r[e]):0!==r[e]&&{7:1,29:1,38:1,55:1,63:1,75:1,76:1,78:1,79:1,80:1,83:1,84:1,99:1,100:1,102:1,106:1,112:1,119:1,129:1,141:1,147:1,148:1,149:1,154:1,163:1,169:1,171:1,172:1,173:1,174:1,176:1,178:1,187:1,188:1,205:1,214:1,225:1,239:1,252:1}[e]&&t.push(r[e]=new Promise((function(t,i){for(var n="pwa-"+({7:"async-styles",11:"vendors~action-context-menu-rc~app-create~app-gallery-rc~appbar~cc~cc-rc~coh~commercial-install-butt~4257c977",16:"vendors~action-context-menu-rc~app-gallery-rc~app-host-component~appbar~cc~cc-rc~copd-rc~create-link~79f02073",24:"vendors~action-context-menu-rc~app-gallery-rc~appbar~cc~copd-rc~ew-os~rec1-os~upload-rc~wb-rc",25:"vendors~app-gallery-rc~app-host-component~appbar~cc~copd-rc~ew-os~rec1-os~upload-rc~wb-rc",31:"forms-group~mru~officeforms-group-forms~officeforms-my-forms~places",33:"auto-suggest~bc~search-preload~search-results",34:"vendors~action-context-menu-rc~appbar~copd-rc~toast-container-rc",35:"vendors~auto-suggest~bc~search-preload~search-results",42:"vendors~action-context-menu-rc~appbar~copd-rc",43:"vendors~app-create~cnt-actions-helper~wb-rc",44:"vendors~edgeworth~input-dialog~wac-start",45:"vendors~mstart~start-page-rc~teaching-ui-rc",46:"vendors~search-page-bootstrapper~search-page-main~search-results",54:"mstart~start-page-rc",55:"templates~wac-start",56:"vendors~appbar~copd-rc",57:"vendors~appbar~feed-component",58:"vendors~first-run-rc~m365-apps-component",59:"vendors~m365-apps-component~teaching-ui-rc",60:"vendors~search-page-main~searchux-prefetch",61:"wac-cnt",72:"action-context-menu-rc",73:"allow-filesystem-access",74:"announcement",75:"app-gallery-ag",76:"app-gallery-rc",77:"app-gallery-wrapper",78:"app-host-component",79:"appbar",80:"auto-suggest",81:"banner",82:"bc",83:"cc",84:"cc-rc",85:"cc-wrapper",86:"cnt-actions-helper",87:"coh",88:"confirmation-dialog-rc",89:"context-menu",90:"copd-rc",91:"create-links-control-icns",92:"create-menu",93:"data-prefetch-service",94:"default-templates-dataprovider",95:"edgeworth",96:"edgeworth-trie-webworker",97:"edgeworth-worker",98:"error-dialog",99:"ew-os",100:"ew-rc",101:"fb-theme",102:"feature-callout",103:"feature-tooltip-container",104:"feed",105:"feed-component",106:"first-run",107:"first-run-rc",108:"first-run-wrapper",109:"fl-unsupported-page",110:"flframework-hashfallback",111:"fluent-theme-provider",112:"forms-group",113:"home",114:"hwalaunchurl",115:"initialize-fluent-theme",116:"input-dialog",117:"install",118:"install-rc",119:"install-wizard",120:"install-wrapper",121:"instrumentation-service",122:"learning-home-dataprovider",123:"learning-shelf-card",124:"learning-shelf-rc",125:"learning-word-dataprovider",126:"left-nav-rc",127:"m365-apps",128:"m365-apps-component",129:"mc",130:"midgard-bootstrapper",131:"mock-app-service",132:"move-to-folder-control",133:"mru",134:"mstart",135:"new-consumer-experience",136:"new-user-shelf",137:"northstar-prefetch-service",138:"odsp-start-onedrive",139:"odsp-start-sharepoint",140:"office-theme",141:"officeforms-group-forms",142:"officeforms-my-forms",143:"oteljs",144:"places",147:"qa",148:"rec1-os",149:"rec1-rc",150:"search-dispatcher",151:"search-instrumenter",152:"search-page-strings",153:"search-preload",154:"search-results",155:"searchux-prefetch",156:"share-control",157:"side-popup-menu",158:"spaces-tinylicious-client",159:"start-page-rc",160:"start-page-wrapper",161:"task-dialog-rc",162:"teaching-ui-rc",163:"templates",164:"text-encoder-lite",165:"toast-container-rc",166:"upload-button",167:"upload-dialog",168:"upload-local-file",169:"upload-rc",170:"user-settings-control",171:"vendors~announcement",172:"vendors~app-create",173:"vendors~cnt-actions-helper",174:"vendors~coh",175:"vendors~commercial-install-button",176:"vendors~confirmation-dialog-rc",177:"vendors~consumer-install-button",178:"vendors~copd-rc",179:"vendors~data-prefetch-service",180:"vendors~edgeworth",181:"vendors~feed-component",182:"vendors~first-run-rc",183:"vendors~hwalaunchfile",184:"vendors~install-rc",185:"vendors~learning-iris-dataprovider",186:"vendors~learning-shelf-rc",187:"vendors~left-nav-rc",188:"vendors~m365-apps-component",189:"vendors~mfs-storage-provider",190:"vendors~oteljs1ds",191:"vendors~rf-dataprovider",192:"vendors~search-page-bootstrapper",193:"vendors~search-page-main",194:"vendors~search-preload",195:"vendors~searchux-logger",196:"vendors~spaces-tinylicious-client",197:"vendors~task-dialog-rc",198:"vendors~teaching-ui-rc",199:"vendors~teamsservicefile",200:"vendors~toast-container-rc",201:"vendors~visual-background-rc",202:"vendors~vroom-service",203:"vendors~wb-rc",204:"visual-background-rc",205:"wac-start",206:"wb-rc",207:"web-vitals",208:"workspace-nav"}[e]||e)+"."+{0:"31d6cfe0d16ae931b73c",1:"31d6cfe0d16ae931b73c",2:"31d6cfe0d16ae931b73c",3:"31d6cfe0d16ae931b73c",4:"31d6cfe0d16ae931b73c",5:"31d6cfe0d16ae931b73c",6:"31d6cfe0d16ae931b73c",7:"cd4e1f71cda644f8f08d",8:"31d6cfe0d16ae931b73c",9:"31d6cfe0d16ae931b73c",10:"31d6cfe0d16ae931b73c",11:"31d6cfe0d16ae931b73c",12:"31d6cfe0d16ae931b73c",13:"31d6cfe0d16ae931b73c",14:"31d6cfe0d16ae931b73c",15:"31d6cfe0d16ae931b73c",16:"31d6cfe0d16ae931b73c",17:"31d6cfe0d16ae931b73c",18:"31d6cfe0d16ae931b73c",19:"31d6cfe0d16ae931b73c",20:"31d6cfe0d16ae931b73c",21:"31d6cfe0d16ae931b73c",22:"31d6cfe0d16ae931b73c",23:"31d6cfe0d16ae931b73c",24:"31d6cfe0d16ae931b73c",25:"31d6cfe0d16ae931b73c",26:"31d6cfe0d16ae931b73c",27:"31d6cfe0d16ae931b73c",28:"31d6cfe0d16ae931b73c",29:"afc3d6d88a175783e2ae",30:"31d6cfe0d16ae931b73c",31:"31d6cfe0d16ae931b73c",32:"31d6cfe0d16ae931b73c",33:"31d6cfe0d16ae931b73c",34:"31d6cfe0d16ae931b73c",35:"31d6cfe0d16ae931b73c",36:"31d6cfe0d16ae931b73c",37:"31d6cfe0d16ae931b73c",38:"b1e2819113777b0a2702",39:"31d6cfe0d16ae931b73c",40:"31d6cfe0d16ae931b73c",41:"31d6cfe0d16ae931b73c",42:"31d6cfe0d16ae931b73c",43:"31d6cfe0d16ae931b73c",44:"31d6cfe0d16ae931b73c",45:"31d6cfe0d16ae931b73c",46:"31d6cfe0d16ae931b73c",47:"31d6cfe0d16ae931b73c",48:"31d6cfe0d16ae931b73c",49:"31d6cfe0d16ae931b73c",50:"31d6cfe0d16ae931b73c",51:"31d6cfe0d16ae931b73c",52:"31d6cfe0d16ae931b73c",53:"31d6cfe0d16ae931b73c",54:"31d6cfe0d16ae931b73c",55:"0df2f875bc90bc6cd1d9",56:"31d6cfe0d16ae931b73c",57:"31d6cfe0d16ae931b73c",58:"31d6cfe0d16ae931b73c",59:"31d6cfe0d16ae931b73c",60:"31d6cfe0d16ae931b73c",61:"31d6cfe0d16ae931b73c",62:"31d6cfe0d16ae931b73c",63:"ed108d3e9a0fa09c7012",64:"31d6cfe0d16ae931b73c",65:"31d6cfe0d16ae931b73c",66:"31d6cfe0d16ae931b73c",67:"31d6cfe0d16ae931b73c",68:"31d6cfe0d16ae931b73c",69:"31d6cfe0d16ae931b73c",70:"31d6cfe0d16ae931b73c",71:"31d6cfe0d16ae931b73c",72:"31d6cfe0d16ae931b73c",73:"31d6cfe0d16ae931b73c",74:"31d6cfe0d16ae931b73c",75:"ec162b3a117cc182f843",76:"477222e784b338ed7f33",77:"31d6cfe0d16ae931b73c",78:"df228e026f24a918c21d",79:"3029613691a5ed274278",80:"4af15026cfd35658fac5",81:"31d6cfe0d16ae931b73c",82:"31d6cfe0d16ae931b73c",83:"100c8aad863f4d375032",84:"100c8aad863f4d375032",85:"31d6cfe0d16ae931b73c",86:"31d6cfe0d16ae931b73c",87:"31d6cfe0d16ae931b73c",88:"31d6cfe0d16ae931b73c",89:"31d6cfe0d16ae931b73c",90:"31d6cfe0d16ae931b73c",91:"31d6cfe0d16ae931b73c",92:"31d6cfe0d16ae931b73c",93:"31d6cfe0d16ae931b73c",94:"31d6cfe0d16ae931b73c",95:"31d6cfe0d16ae931b73c",96:"31d6cfe0d16ae931b73c",97:"31d6cfe0d16ae931b73c",98:"31d6cfe0d16ae931b73c",99:"caed182ec72dc7a53e10",100:"caed182ec72dc7a53e10",101:"31d6cfe0d16ae931b73c",102:"e79a2d51d9dfd8a3b78b",103:"31d6cfe0d16ae931b73c",104:"31d6cfe0d16ae931b73c",105:"31d6cfe0d16ae931b73c",106:"d2384a4b91b259a1e867",107:"31d6cfe0d16ae931b73c",108:"31d6cfe0d16ae931b73c",109:"31d6cfe0d16ae931b73c",110:"31d6cfe0d16ae931b73c",111:"31d6cfe0d16ae931b73c",112:"2b85442a3b0af53ce369",113:"31d6cfe0d16ae931b73c",114:"31d6cfe0d16ae931b73c",115:"31d6cfe0d16ae931b73c",116:"31d6cfe0d16ae931b73c",117:"31d6cfe0d16ae931b73c",118:"31d6cfe0d16ae931b73c",119:"7e4431d02c76777d3eb3",120:"31d6cfe0d16ae931b73c",121:"31d6cfe0d16ae931b73c",122:"31d6cfe0d16ae931b73c",123:"31d6cfe0d16ae931b73c",124:"31d6cfe0d16ae931b73c",125:"31d6cfe0d16ae931b73c",126:"31d6cfe0d16ae931b73c",127:"31d6cfe0d16ae931b73c",128:"31d6cfe0d16ae931b73c",129:"f3fac34b73a9bd652cd3",130:"31d6cfe0d16ae931b73c",131:"31d6cfe0d16ae931b73c",132:"31d6cfe0d16ae931b73c",133:"31d6cfe0d16ae931b73c",134:"31d6cfe0d16ae931b73c",135:"31d6cfe0d16ae931b73c",136:"31d6cfe0d16ae931b73c",137:"31d6cfe0d16ae931b73c",138:"31d6cfe0d16ae931b73c",139:"31d6cfe0d16ae931b73c",140:"31d6cfe0d16ae931b73c",141:"bcc1faca1b6f14550067",142:"31d6cfe0d16ae931b73c",143:"31d6cfe0d16ae931b73c",144:"31d6cfe0d16ae931b73c",147:"9eb239514d846c7ef3b1",148:"1c82e137817058ddeccf",149:"1c82e137817058ddeccf",150:"31d6cfe0d16ae931b73c",151:"31d6cfe0d16ae931b73c",152:"31d6cfe0d16ae931b73c",153:"31d6cfe0d16ae931b73c",154:"15cf0ff57eed3f3d0a33",155:"31d6cfe0d16ae931b73c",156:"31d6cfe0d16ae931b73c",157:"31d6cfe0d16ae931b73c",158:"31d6cfe0d16ae931b73c",159:"31d6cfe0d16ae931b73c",160:"31d6cfe0d16ae931b73c",161:"31d6cfe0d16ae931b73c",162:"31d6cfe0d16ae931b73c",163:"16ffd87724de6f831ddb",164:"31d6cfe0d16ae931b73c",165:"31d6cfe0d16ae931b73c",166:"31d6cfe0d16ae931b73c",167:"31d6cfe0d16ae931b73c",168:"31d6cfe0d16ae931b73c",169:"cbd4759584710d834c5e",170:"31d6cfe0d16ae931b73c",171:"46bab4c032c6336cda95",172:"c7c40bd21ecc68327712",173:"e03c6f5a17495f74df98",174:"ad143b6905a8b5a96cb3",175:"31d6cfe0d16ae931b73c",176:"6e798c1c4b1c737fbe05",177:"31d6cfe0d16ae931b73c",178:"d196be2ced22766cbb52",179:"31d6cfe0d16ae931b73c",180:"31d6cfe0d16ae931b73c",181:"31d6cfe0d16ae931b73c",182:"31d6cfe0d16ae931b73c",183:"31d6cfe0d16ae931b73c",184:"31d6cfe0d16ae931b73c",185:"31d6cfe0d16ae931b73c",186:"31d6cfe0d16ae931b73c",187:"61c3e16455c78710228f",188:"d257cebe867b72fcd0ff",189:"31d6cfe0d16ae931b73c",190:"31d6cfe0d16ae931b73c",191:"31d6cfe0d16ae931b73c",192:"31d6cfe0d16ae931b73c",193:"31d6cfe0d16ae931b73c",194:"31d6cfe0d16ae931b73c",195:"31d6cfe0d16ae931b73c",196:"31d6cfe0d16ae931b73c",197:"31d6cfe0d16ae931b73c",198:"31d6cfe0d16ae931b73c",199:"31d6cfe0d16ae931b73c",200:"31d6cfe0d16ae931b73c",201:"31d6cfe0d16ae931b73c",202:"31d6cfe0d16ae931b73c",203:"31d6cfe0d16ae931b73c",204:"31d6cfe0d16ae931b73c",205:"e4009ea87f4bbd071498",206:"31d6cfe0d16ae931b73c",207:"31d6cfe0d16ae931b73c",208:"31d6cfe0d16ae931b73c",209:"31d6cfe0d16ae931b73c",210:"31d6cfe0d16ae931b73c",211:"31d6cfe0d16ae931b73c",212:"31d6cfe0d16ae931b73c",213:"31d6cfe0d16ae931b73c",214:"ae5d852697cbcc76b8e0",215:"31d6cfe0d16ae931b73c",216:"31d6cfe0d16ae931b73c",217:"31d6cfe0d16ae931b73c",218:"31d6cfe0d16ae931b73c",219:"31d6cfe0d16ae931b73c",220:"31d6cfe0d16ae931b73c",221:"31d6cfe0d16ae931b73c",222:"31d6cfe0d16ae931b73c",223:"31d6cfe0d16ae931b73c",224:"31d6cfe0d16ae931b73c",225:"a08003390fd8513932c0",226:"31d6cfe0d16ae931b73c",227:"31d6cfe0d16ae931b73c",228:"31d6cfe0d16ae931b73c",229:"31d6cfe0d16ae931b73c",230:"31d6cfe0d16ae931b73c",231:"31d6cfe0d16ae931b73c",232:"31d6cfe0d16ae931b73c",233:"31d6cfe0d16ae931b73c",234:"31d6cfe0d16ae931b73c",235:"31d6cfe0d16ae931b73c",236:"31d6cfe0d16ae931b73c",237:"31d6cfe0d16ae931b73c",238:"31d6cfe0d16ae931b73c",239:"9eb150f6c0fa479ed81e",240:"31d6cfe0d16ae931b73c",241:"31d6cfe0d16ae931b73c",242:"31d6cfe0d16ae931b73c",243:"31d6cfe0d16ae931b73c",244:"31d6cfe0d16ae931b73c",245:"31d6cfe0d16ae931b73c",246:"31d6cfe0d16ae931b73c",247:"31d6cfe0d16ae931b73c",248:"31d6cfe0d16ae931b73c",249:"31d6cfe0d16ae931b73c",250:"31d6cfe0d16ae931b73c",251:"31d6cfe0d16ae931b73c",252:"57c360882a068415ec7e",253:"31d6cfe0d16ae931b73c",254:"31d6cfe0d16ae931b73c",255:"31d6cfe0d16ae931b73c",256:"31d6cfe0d16ae931b73c",257:"31d6cfe0d16ae931b73c",258:"31d6cfe0d16ae931b73c",259:"31d6cfe0d16ae931b73c",260:"31d6cfe0d16ae931b73c",261:"31d6cfe0d16ae931b73c",262:"31d6cfe0d16ae931b73c",263:"31d6cfe0d16ae931b73c",264:"31d6cfe0d16ae931b73c",265:"31d6cfe0d16ae931b73c",266:"31d6cfe0d16ae931b73c",267:"31d6cfe0d16ae931b73c",268:"31d6cfe0d16ae931b73c",269:"31d6cfe0d16ae931b73c",270:"31d6cfe0d16ae931b73c",271:"31d6cfe0d16ae931b73c",272:"31d6cfe0d16ae931b73c",273:"31d6cfe0d16ae931b73c",274:"31d6cfe0d16ae931b73c",275:"31d6cfe0d16ae931b73c",276:"31d6cfe0d16ae931b73c",277:"31d6cfe0d16ae931b73c",278:"31d6cfe0d16ae931b73c",279:"31d6cfe0d16ae931b73c",280:"31d6cfe0d16ae931b73c",281:"31d6cfe0d16ae931b73c",282:"31d6cfe0d16ae931b73c",283:"31d6cfe0d16ae931b73c",284:"31d6cfe0d16ae931b73c",285:"31d6cfe0d16ae931b73c",286:"31d6cfe0d16ae931b73c",287:"31d6cfe0d16ae931b73c",288:"31d6cfe0d16ae931b73c",289:"31d6cfe0d16ae931b73c",290:"31d6cfe0d16ae931b73c",291:"31d6cfe0d16ae931b73c",292:"31d6cfe0d16ae931b73c",293:"31d6cfe0d16ae931b73c",294:"31d6cfe0d16ae931b73c",295:"31d6cfe0d16ae931b73c",296:"31d6cfe0d16ae931b73c",297:"31d6cfe0d16ae931b73c",298:"31d6cfe0d16ae931b73c",299:"31d6cfe0d16ae931b73c",300:"31d6cfe0d16ae931b73c",301:"31d6cfe0d16ae931b73c",302:"31d6cfe0d16ae931b73c",303:"31d6cfe0d16ae931b73c",304:"31d6cfe0d16ae931b73c",305:"31d6cfe0d16ae931b73c",306:"31d6cfe0d16ae931b73c",307:"31d6cfe0d16ae931b73c",308:"31d6cfe0d16ae931b73c",309:"31d6cfe0d16ae931b73c",310:"31d6cfe0d16ae931b73c",311:"31d6cfe0d16ae931b73c",312:"31d6cfe0d16ae931b73c",313:"31d6cfe0d16ae931b73c",314:"31d6cfe0d16ae931b73c",315:"31d6cfe0d16ae931b73c",316:"31d6cfe0d16ae931b73c",317:"31d6cfe0d16ae931b73c",318:"31d6cfe0d16ae931b73c",319:"31d6cfe0d16ae931b73c",320:"31d6cfe0d16ae931b73c",321:"31d6cfe0d16ae931b73c",322:"31d6cfe0d16ae931b73c",323:"31d6cfe0d16ae931b73c",324:"31d6cfe0d16ae931b73c",325:"31d6cfe0d16ae931b73c",326:"31d6cfe0d16ae931b73c",327:"31d6cfe0d16ae931b73c",328:"31d6cfe0d16ae931b73c",329:"31d6cfe0d16ae931b73c",330:"31d6cfe0d16ae931b73c",331:"31d6cfe0d16ae931b73c",332:"31d6cfe0d16ae931b73c",333:"31d6cfe0d16ae931b73c",334:"31d6cfe0d16ae931b73c",335:"31d6cfe0d16ae931b73c",336:"31d6cfe0d16ae931b73c",337:"31d6cfe0d16ae931b73c",338:"31d6cfe0d16ae931b73c",339:"31d6cfe0d16ae931b73c",340:"31d6cfe0d16ae931b73c",341:"31d6cfe0d16ae931b73c",342:"31d6cfe0d16ae931b73c",343:"31d6cfe0d16ae931b73c",344:"31d6cfe0d16ae931b73c",345:"31d6cfe0d16ae931b73c",346:"31d6cfe0d16ae931b73c",347:"31d6cfe0d16ae931b73c",348:"31d6cfe0d16ae931b73c",349:"31d6cfe0d16ae931b73c",350:"31d6cfe0d16ae931b73c",351:"31d6cfe0d16ae931b73c",352:"31d6cfe0d16ae931b73c",353:"31d6cfe0d16ae931b73c",354:"31d6cfe0d16ae931b73c",355:"31d6cfe0d16ae931b73c",356:"31d6cfe0d16ae931b73c",357:"31d6cfe0d16ae931b73c",358:"31d6cfe0d16ae931b73c",359:"31d6cfe0d16ae931b73c",360:"31d6cfe0d16ae931b73c",361:"31d6cfe0d16ae931b73c",362:"31d6cfe0d16ae931b73c",363:"31d6cfe0d16ae931b73c",364:"31d6cfe0d16ae931b73c",365:"31d6cfe0d16ae931b73c",366:"31d6cfe0d16ae931b73c",367:"31d6cfe0d16ae931b73c",368:"31d6cfe0d16ae931b73c",369:"31d6cfe0d16ae931b73c",370:"31d6cfe0d16ae931b73c",371:"31d6cfe0d16ae931b73c",372:"31d6cfe0d16ae931b73c",373:"31d6cfe0d16ae931b73c",374:"31d6cfe0d16ae931b73c",375:"31d6cfe0d16ae931b73c",376:"31d6cfe0d16ae931b73c",377:"31d6cfe0d16ae931b73c",378:"31d6cfe0d16ae931b73c",379:"31d6cfe0d16ae931b73c",380:"31d6cfe0d16ae931b73c",381:"31d6cfe0d16ae931b73c",382:"31d6cfe0d16ae931b73c",383:"31d6cfe0d16ae931b73c",384:"31d6cfe0d16ae931b73c",385:"31d6cfe0d16ae931b73c",386:"31d6cfe0d16ae931b73c",387:"31d6cfe0d16ae931b73c",388:"31d6cfe0d16ae931b73c",389:"31d6cfe0d16ae931b73c",390:"31d6cfe0d16ae931b73c",391:"31d6cfe0d16ae931b73c",392:"31d6cfe0d16ae931b73c",393:"31d6cfe0d16ae931b73c",394:"31d6cfe0d16ae931b73c",395:"31d6cfe0d16ae931b73c",396:"31d6cfe0d16ae931b73c",397:"31d6cfe0d16ae931b73c",398:"31d6cfe0d16ae931b73c",399:"31d6cfe0d16ae931b73c",400:"31d6cfe0d16ae931b73c",401:"31d6cfe0d16ae931b73c",402:"31d6cfe0d16ae931b73c",403:"31d6cfe0d16ae931b73c",404:"31d6cfe0d16ae931b73c",405:"31d6cfe0d16ae931b73c",406:"31d6cfe0d16ae931b73c",407:"31d6cfe0d16ae931b73c",408:"31d6cfe0d16ae931b73c",409:"31d6cfe0d16ae931b73c",410:"31d6cfe0d16ae931b73c",411:"31d6cfe0d16ae931b73c",412:"31d6cfe0d16ae931b73c",413:"31d6cfe0d16ae931b73c",414:"31d6cfe0d16ae931b73c",415:"31d6cfe0d16ae931b73c",416:"31d6cfe0d16ae931b73c",417:"31d6cfe0d16ae931b73c",418:"31d6cfe0d16ae931b73c",419:"31d6cfe0d16ae931b73c",420:"31d6cfe0d16ae931b73c",421:"31d6cfe0d16ae931b73c",422:"31d6cfe0d16ae931b73c",423:"31d6cfe0d16ae931b73c",424:"31d6cfe0d16ae931b73c",425:"31d6cfe0d16ae931b73c",426:"31d6cfe0d16ae931b73c",427:"31d6cfe0d16ae931b73c",428:"31d6cfe0d16ae931b73c",429:"31d6cfe0d16ae931b73c",430:"31d6cfe0d16ae931b73c",431:"31d6cfe0d16ae931b73c",432:"31d6cfe0d16ae931b73c",433:"31d6cfe0d16ae931b73c",434:"31d6cfe0d16ae931b73c",435:"31d6cfe0d16ae931b73c",436:"31d6cfe0d16ae931b73c",437:"31d6cfe0d16ae931b73c",438:"31d6cfe0d16ae931b73c",439:"31d6cfe0d16ae931b73c",440:"31d6cfe0d16ae931b73c",441:"31d6cfe0d16ae931b73c",442:"31d6cfe0d16ae931b73c",443:"31d6cfe0d16ae931b73c",444:"31d6cfe0d16ae931b73c",445:"31d6cfe0d16ae931b73c",446:"31d6cfe0d16ae931b73c",447:"31d6cfe0d16ae931b73c",448:"31d6cfe0d16ae931b73c",449:"31d6cfe0d16ae931b73c",450:"31d6cfe0d16ae931b73c",451:"31d6cfe0d16ae931b73c",452:"31d6cfe0d16ae931b73c",453:"31d6cfe0d16ae931b73c",454:"31d6cfe0d16ae931b73c",455:"31d6cfe0d16ae931b73c",456:"31d6cfe0d16ae931b73c"}[e]+".chunk.v7.css",a=s.p+n,o=document.getElementsByTagName("link"),l=0;l<o.length;l++){var c=(d=o[l]).getAttribute("data-href")||d.getAttribute("href");if("stylesheet"===d.rel&&(c===n||c===a))return t()}var u=document.getElementsByTagName("style");for(l=0;l<u.length;l++){var d;if((c=(d=u[l]).getAttribute("data-href"))===n||c===a)return t()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onerror=h.onload=function(n){if(h.onerror=h.onload=null,"load"===n.type)t();else{var o=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.href||a,l=new Error("Loading CSS chunk "+e+" failed.\n("+s+")");l.code="CSS_CHUNK_LOAD_FAILED",l.type=o,l.request=s,delete r[e],h.parentNode.removeChild(h),i(l)}},h.href=a,0!==h.href.indexOf(window.location.origin+"/")&&(h.crossOrigin="anonymous"),document.head.appendChild(h)})).then((function(){r[e]=0})));var i=a[e];if(0!==i)if(i)t.push(i[2]);else{var n=new Promise((function(t,n){i=a[e]=[t,n]}));t.push(i[2]=n);var o,l=document.createElement("script");l.charset="utf-8",l.timeout=120,s.nc&&l.setAttribute("nonce",s.nc),l.src=function(e){return s.p+"pwa-"+({7:"async-styles",11:"vendors~action-context-menu-rc~app-create~app-gallery-rc~appbar~cc~cc-rc~coh~commercial-install-butt~4257c977",16:"vendors~action-context-menu-rc~app-gallery-rc~app-host-component~appbar~cc~cc-rc~copd-rc~create-link~79f02073",24:"vendors~action-context-menu-rc~app-gallery-rc~appbar~cc~copd-rc~ew-os~rec1-os~upload-rc~wb-rc",25:"vendors~app-gallery-rc~app-host-component~appbar~cc~copd-rc~ew-os~rec1-os~upload-rc~wb-rc",31:"forms-group~mru~officeforms-group-forms~officeforms-my-forms~places",33:"auto-suggest~bc~search-preload~search-results",34:"vendors~action-context-menu-rc~appbar~copd-rc~toast-container-rc",35:"vendors~auto-suggest~bc~search-preload~search-results",42:"vendors~action-context-menu-rc~appbar~copd-rc",43:"vendors~app-create~cnt-actions-helper~wb-rc",44:"vendors~edgeworth~input-dialog~wac-start",45:"vendors~mstart~start-page-rc~teaching-ui-rc",46:"vendors~search-page-bootstrapper~search-page-main~search-results",54:"mstart~start-page-rc",55:"templates~wac-start",56:"vendors~appbar~copd-rc",57:"vendors~appbar~feed-component",58:"vendors~first-run-rc~m365-apps-component",59:"vendors~m365-apps-component~teaching-ui-rc",60:"vendors~search-page-main~searchux-prefetch",61:"wac-cnt",72:"action-context-menu-rc",73:"allow-filesystem-access",74:"announcement",75:"app-gallery-ag",76:"app-gallery-rc",77:"app-gallery-wrapper",78:"app-host-component",79:"appbar",80:"auto-suggest",81:"banner",82:"bc",83:"cc",84:"cc-rc",85:"cc-wrapper",86:"cnt-actions-helper",87:"coh",88:"confirmation-dialog-rc",89:"context-menu",90:"copd-rc",91:"create-links-control-icns",92:"create-menu",93:"data-prefetch-service",94:"default-templates-dataprovider",95:"edgeworth",96:"edgeworth-trie-webworker",97:"edgeworth-worker",98:"error-dialog",99:"ew-os",100:"ew-rc",101:"fb-theme",102:"feature-callout",103:"feature-tooltip-container",104:"feed",105:"feed-component",106:"first-run",107:"first-run-rc",108:"first-run-wrapper",109:"fl-unsupported-page",110:"flframework-hashfallback",111:"fluent-theme-provider",112:"forms-group",113:"home",114:"hwalaunchurl",115:"initialize-fluent-theme",116:"input-dialog",117:"install",118:"install-rc",119:"install-wizard",120:"install-wrapper",121:"instrumentation-service",122:"learning-home-dataprovider",123:"learning-shelf-card",124:"learning-shelf-rc",125:"learning-word-dataprovider",126:"left-nav-rc",127:"m365-apps",128:"m365-apps-component",129:"mc",130:"midgard-bootstrapper",131:"mock-app-service",132:"move-to-folder-control",133:"mru",134:"mstart",135:"new-consumer-experience",136:"new-user-shelf",137:"northstar-prefetch-service",138:"odsp-start-onedrive",139:"odsp-start-sharepoint",140:"office-theme",141:"officeforms-group-forms",142:"officeforms-my-forms",143:"oteljs",144:"places",147:"qa",148:"rec1-os",149:"rec1-rc",150:"search-dispatcher",151:"search-instrumenter",152:"search-page-strings",153:"search-preload",154:"search-results",155:"searchux-prefetch",156:"share-control",157:"side-popup-menu",158:"spaces-tinylicious-client",159:"start-page-rc",160:"start-page-wrapper",161:"task-dialog-rc",162:"teaching-ui-rc",163:"templates",164:"text-encoder-lite",165:"toast-container-rc",166:"upload-button",167:"upload-dialog",168:"upload-local-file",169:"upload-rc",170:"user-settings-control",171:"vendors~announcement",172:"vendors~app-create",173:"vendors~cnt-actions-helper",174:"vendors~coh",175:"vendors~commercial-install-button",176:"vendors~confirmation-dialog-rc",177:"vendors~consumer-install-button",178:"vendors~copd-rc",179:"vendors~data-prefetch-service",180:"vendors~edgeworth",181:"vendors~feed-component",182:"vendors~first-run-rc",183:"vendors~hwalaunchfile",184:"vendors~install-rc",185:"vendors~learning-iris-dataprovider",186:"vendors~learning-shelf-rc",187:"vendors~left-nav-rc",188:"vendors~m365-apps-component",189:"vendors~mfs-storage-provider",190:"vendors~oteljs1ds",191:"vendors~rf-dataprovider",192:"vendors~search-page-bootstrapper",193:"vendors~search-page-main",194:"vendors~search-preload",195:"vendors~searchux-logger",196:"vendors~spaces-tinylicious-client",197:"vendors~task-dialog-rc",198:"vendors~teaching-ui-rc",199:"vendors~teamsservicefile",200:"vendors~toast-container-rc",201:"vendors~visual-background-rc",202:"vendors~vroom-service",203:"vendors~wb-rc",204:"visual-background-rc",205:"wac-start",206:"wb-rc",207:"web-vitals",208:"workspace-nav"}[e]||e)+"."+{0:"785dedb5b8b0a79a58e1",1:"76bf6b0159c7abb45af4",2:"2a3fa732c5e14c8e6835",3:"7e5ad42e1eeacee9fdea",4:"f84cd911bd5eb7d3ccc5",5:"83e3089132b8a1622d38",6:"ed6a84ed70ed22c7ec22",7:"93889215422c304a3e84",8:"1a015f5a92b1c49d4d55",9:"0a58d1ce11895c1e9e6a",10:"a4ed03d3809106272de3",11:"59a23b81843dfd28f736",12:"501afd64ef62e74340bd",13:"6b17843111b175b5760c",14:"7db452ed37e129451f0f",15:"bb377bbc2ac7d85eb9ba",16:"f0ec133f437bd5e7a328",17:"8e5b83af6e4b467bf08c",18:"5323ca51b24a2ced6517",19:"e5c76384dc2df2addce9",20:"c8becf6ffb1bf196ec4c",21:"75986fefe478c40e3514",22:"7ba330292b02d95e224c",23:"8e4d1b321449c200caa9",24:"b0806bf7db68d1b4c9b4",25:"7a8a6b7c82ad7bd925a6",26:"3be89d1d4c786c6b8b26",27:"c7e865ddcf7116967c69",28:"02777b638e448a075d04",29:"56f2cd448f1a3b427e9c",30:"55bac4c2e33779477108",31:"c6d51fce5ba60a24b363",32:"b19e9209efa864307ac6",33:"19231b1afd0ab58d20fa",34:"d1148bc5b77a4b8585f0",35:"1fd7dca9b1245207e3bb",36:"ae26f985321e33ce0e55",37:"f335c98ef9aadea8cf4b",38:"229d40090fac15e2a6fd",39:"4a521d4c0110197b277d",40:"9207913c52294728ec3a",41:"62734b97f44d63efad6c",42:"e68637b672ae94ea6057",43:"167db6c54977bcd74ffb",44:"a63852d57f7ff7cb4609",45:"be22a0fe05c0edae4444",46:"3f9b928486397180ba03",47:"b40d02d8483fbfa2f546",48:"6d7e3f4a7c57f095ae30",49:"e269b951709de154a30f",50:"74379296cb8641243939",51:"754de0564c5b99ee5507",52:"6d8fa7dc85ba574a3d49",53:"c23449433610449ed1a1",54:"ede0cb0e43c065496555",55:"6c3d6ec17970666cfffe",56:"e3fe4ecaa2f343131ce7",57:"2bf6ac890d48f2779d8e",58:"5c73de314754a2de3caa",59:"610304a6c73bfa07cf7d",60:"13edec440c23c347d447",61:"8ba0639cc5400773d948",62:"dfb3f9504521adaaac81",63:"df81f76f212bdf92a78f",64:"4120ab0aa46dac762d86",65:"4ed0a374de453beb8a40",66:"e2f0b4e7139f324c7940",67:"46c2facdae3a5eeec730",68:"3184e4dff7d1080e2a78",69:"2e9df24d19401eff42cd",70:"4081f2e8e6f4369ed6a3",71:"8235c92b679befd6ea78",72:"7a9d7e64c9e5a53b961e",73:"4c6f989ef11061374082",74:"1368d72f3db6e9859b9d",75:"1c42a3c5bd6a58a5c835",76:"3b0992eee3a3812a7d23",77:"89dd524ed90878aeb2b7",78:"dbf2b8dac39b938be71a",79:"dbe1dca9f1d6e51b6bc2",80:"1b8970ef679af681113a",81:"3d738a50c74567b4b50b",82:"2bf0d59af6ed4479bf91",83:"7f37c13a182e5d8fff4d",84:"746cb1d588d45eaa7cf9",85:"3b8c7638e33928865656",86:"7b0029aeca8378c98870",87:"b7533bdf86879eee8de2",88:"3d9baff1725ee7d995dc",89:"27f100d24d84441a51b5",90:"202fb63e3a57cb0eba39",91:"36a0e0cfc703ea632a08",92:"f49e5ea8e8a7845d1346",93:"652a97cbe2210eed45b5",94:"b77d975cf739dc0657e8",95:"7c36a02d15dd6b1cda08",96:"754c5cbc59e89becac91",97:"17000a516f3a394f76f1",98:"145a0177308ce63cfba9",99:"6fa42b10f7d8235617ac",100:"fb59fcfdee3070b8ab08",101:"c565ded27903c72f734c",102:"df912872f15de13c13ce",103:"2fa746bc8469633872ef",104:"38ad4f2a9d08b9f61912",105:"0c5bda3b81e9d2e0573e",106:"2a90117a381dd1104be0",107:"022aacfd6f58c6d355d8",108:"8562dc94160eea48bb64",109:"a547f84d39fd18898f02",110:"326a9e05f0685361e43f",111:"3ff7affb5ae866d7c8f7",112:"6f27a3d731188e79b6d9",113:"6a6d7a995b1749d0d724",114:"cabecd84c17696810d7a",115:"d64cfafef35aaf432008",116:"a24bda8972de45218ed2",117:"138e594efa7c2e7f93c7",118:"c05ed026fbb3871109d5",119:"99104343b4a42aebd8db",120:"aae0e745fa2ce5db3167",121:"015a0886ac4a6f6548d6",122:"dff393e954d7026608d1",123:"290e20f1871faec10ab5",124:"dba48f5f15e6bd1c510b",125:"f6d66abdbfa0eb8414af",126:"92828ab256394f5a3399",127:"d6e2540a0cba0d0fdc78",128:"89e811122780ebd8f748",129:"c8eec0cfd9a2dd8ec826",130:"811c2d1e78f75be28ed6",131:"d37eb040448cbf2177a1",132:"2e6620fe814c1b16fb8f",133:"a07aa2490b2dcd35d639",134:"bbd2163495a2e92182ae",135:"e3d91220de4027b808d3",136:"50d33cc5009f31dfa21e",137:"70ebf86cfa8a89a6f5c9",138:"0494b367b869de30f820",139:"f907d068f88116690a72",140:"779b7970c64da29b3b5b",141:"b10aec30500e113b73da",142:"2afea01abb4aeee0d3a6",143:"af8442c70fb69c06885d",144:"4e3ad9f91837a79bab5e",147:"029ea40a9bf3f0e10299",148:"4ad45a2fd35aa057a8b9",149:"1ff910f84c08c36b9a0c",150:"58dc6f50686752fa2ab5",151:"cc668e48a63551a257b4",152:"9616bd607d2430894eac",153:"e15787b58c7b573624b6",154:"7ba7961aa9604d96da54",155:"998d501b8705e2d50f7a",156:"ef1bd4df41dd053a456a",157:"9d7f2b3eec8ae6e34d07",158:"5f11171c2546a5959b0a",159:"b0ef006b51e60858b162",160:"9832187ebaf5c8cdec28",161:"ad1b54bb43b0c437904b",162:"66ec5a78d5f1a76ee783",163:"86d194a378bd5fb59dd2",164:"381088e510ab8625c6e0",165:"11270811f1cd9a7e96ca",166:"080bf5f9139cba466828",167:"960225a51f4b2b5b56f6",168:"6f956de338eaf1e3beeb",169:"d586b9f105d0fb8d6001",170:"b52482ccee8a3df74250",171:"66c56a7984ab91d7119d",172:"dc772a493412687fe5ea",173:"91913344112f8e499f72",174:"ca444333709079177dc3",175:"188d0c09df15ee14ac8a",176:"cac95e5afc29eb47000b",177:"0aecb369f3d5549dff2c",178:"a980a437cd038c823e60",179:"9a25e435e20ebf77beb6",180:"dd2eb94604331c17e356",181:"aaf17b1f831323c04425",182:"ee0416f960c2a0d036ce",183:"81e028dbda1944eb22a4",184:"d86d4a773a80d3099e90",185:"e2891febbb3a1a759bef",186:"484cfe7a4f5202cf4810",187:"ce4ff86bc13ce5f1da5c",188:"92ebadd895c9486af30f",189:"7c2239e8464487786cd8",190:"f90cd961e867ee5bb87c",191:"db3b0dc2db990fe7bc33",192:"cbac16cf24760b45372c",193:"1142160afb7aadf10cba",194:"c6e00910875cad333d5f",195:"999dc83caeadc4fe45fb",196:"b89e1b1cc04670467a0f",197:"ac9a755c8ebe930a5dc4",198:"fd5e545831643b3a299b",199:"cb809506a8fbd383d9da",200:"d6d40815961783ed05e5",201:"4cfb9b6b546d123f6364",202:"dff0cf5f8bde90347b46",203:"2261a1fa1764709b5537",204:"97ac69b32f3b6c77b78f",205:"233e5d0a1a2f973577ed",206:"3e8e795668bf7ca05d34",207:"d3c1d6c1a6f04258154b",208:"58e20946c84935e0bf8d",209:"ce44dcd3f1704d097967",210:"a1bf23a3bb6b793927da",211:"28e2c2a902eae09f4780",212:"19d0462857512c98524d",213:"200a3a40ae9fbaaddf3e",214:"ed632cd69ad9af5197a7",215:"c1f1b9c72baa22c5a495",216:"90167583c68d57f4d9de",217:"5f1973e4ce91dac465fb",218:"3e3de4492053d0787406",219:"0ae5492cc0a23065e968",220:"4c6352688ce4db3d2c34",221:"6420a5b6474ecb4e5b84",222:"57cff77ba382b1ae8f9c",223:"c4239190291e81bf9a7d",224:"e603d99c0b7f5d20f771",225:"d1ddcc05c897b062fcdf",226:"536b3ab4ba60c7e9b915",227:"5e52e9531d8295d74735",228:"1d854121b4735606065f",229:"a22fb8e23e5af242cfcc",230:"704e928fe096762b35f6",231:"22cb37a734914d5a0d1b",232:"a8f55c1a2f55fbf60b7f",233:"24ff74bf4f6a791cc9b6",234:"82d677b0c29099b15d48",235:"807c0dd1d20f865879b5",236:"c387d4e7ce6df3951a67",237:"51f774ccf893f693ed53",238:"90ebf9e98fe209a0c8b6",239:"99e1f2f984aba63d3c10",240:"0a19adef24f719051113",241:"2e1513e420d14faa0409",242:"fa1582fb212c0631fe31",243:"f74c4137e951f679ddcb",244:"929af1b6c54fcabf62e2",245:"091f1db04b59388197d5",246:"72e8e296fe95a145e539",247:"e991dfea0dcde9ee4997",248:"c6bd61fa4f8f9f1f8e66",249:"e853064cd514b7d4fc96",250:"371ccc6bc9ec4fa0706e",251:"3f58c01d31146e21163d",252:"eae2171ef91482e90674",253:"e493cbec2bcde4823b96",254:"34d2d7d8e4f07f57b707",255:"667444769951f2476feb",256:"4195c948d41bb448ebc8",257:"bb517ad8dbc6bf193419",258:"f5f682870622485c0975",259:"5ead88471e504816eecc",260:"41fd5904a3d4f23ac870",261:"0ba8a00e02be43909c18",262:"037c3f2ba2e7826a39f3",263:"de0e0d2a469ce33847a8",264:"7389c1fe527addcc3823",265:"e3a492a5307853dc80fc",266:"655f5a783f15dd8ef498",267:"3d650b9b04809362a165",268:"c942ac14aadd3260c3c7",269:"0cc45f43f1762a1bd0b8",270:"62ca4b5dc89a01ce2363",271:"67db43333f3e8ce39f71",272:"464a9851ee79143b087f",273:"f309d21ceb526b93f1ed",274:"6fe052718d912b6867da",275:"dc5c0c3f66f012827114",276:"9008a1620dc3a4c6ee0a",277:"7417216885ad2f73167f",278:"3a4d492de95f55114d8c",279:"d917d21d0622e7c8813a",280:"fd56e47c39a6e1d26521",281:"1bf2dfb0a7c7dc98cd3e",282:"69f913c3c121a68b6966",283:"623927dfd8932715db36",284:"58577cba6cbd4a0b3298",285:"e315f4e0ede5102ae089",286:"20e462f8ec29bee2b679",287:"6159116f8676e1810ade",288:"0183c0e56515fec70004",289:"ed82037a79498b5a5ae7",290:"8addd18c5b42b5f7f8f0",291:"1090ff8f85d0737ce367",292:"e66f3c9f7c421352e4e6",293:"a5cd34ebee6078cb1ecc",294:"f0e4bcff623f0fe466c9",295:"1ddcd7dbba8c5a2694a8",296:"17f4a9040a8ecf29a87d",297:"f018f88d6109bf22c35b",298:"4f068f68aaee826828a2",299:"42d8f491b03ff3b39e12",300:"58d42598d71ec9236806",301:"897c549a3064a94b745b",302:"db4103801739b8945636",303:"14948cadab81bb110609",304:"676612f395ee9d2a4d5a",305:"9dcf07935ade5633f2c1",306:"42a84431db60b0d30066",307:"0ec7aef01f480ecb7294",308:"ec0ef762feeb311bf7fb",309:"3dd69e57e66d117cb5d9",310:"2bdd510eae531c103490",311:"bbf4ee2bdf4c37f0db48",312:"b55bd6493082421af7e0",313:"0a49a4f532c9c85fa8c1",314:"f8cb8b98a1473b019bc1",315:"3b27d51d2558db0f90f2",316:"a1f0bf78301f457d66b8",317:"f989975afa1e444e1b59",318:"5a62491ea045ff986122",319:"e8eeb78c44568d9a6280",320:"d4406dd9a90e6dc8f45b",321:"322afd3bb9e7a1e0bb80",322:"476f7d8c43e69123fbd4",323:"fecd0e3d0860807f4ebd",324:"e94ce6865f7d17ca3fdb",325:"223df3cdc152a0180c23",326:"c2b60077172ae3320e4d",327:"b88e081186d319813726",328:"48b37f66ae589836933d",329:"5ec80f934e1728f94003",330:"93bf22ad95010ac64961",331:"c7cc8b2286c1e609400a",332:"32b541601242ca6934ed",333:"800d67fbd080ee0579eb",334:"9d876b6ab7f20906ba4b",335:"b7e4fd5a0f38f0a00f1c",336:"548f534786bd7101dfec",337:"93cceeea326aca54116f",338:"7c4d0a5fe564cb6293e7",339:"265c355ab2daa8713644",340:"1223e4e6233c456a85ba",341:"287eba4b94c5ea695d69",342:"20bcda17ca29b71a84e4",343:"f3c5635b00b3ffaf9cad",344:"66e48d491781d45ed882",345:"d440ec2998ad9f92b9e6",346:"ea6fda0da67525604240",347:"b209280b1dc2bf51ce8f",348:"60353a687845a27f3153",349:"7bde14940e1fa4f420c1",350:"8eb6c55e6dca4752cff0",351:"84df5dd10fbbc61aeb8d",352:"ea90e1539f52de6f7e31",353:"cacd18ff055944fa59a6",354:"23650e84c1aa54de12bd",355:"2e634c52d88ab38a5ce5",356:"30390e199282f7cd9625",357:"3e8ea6f4bfc64f1a9e78",358:"edf8bcb4b7d29b060045",359:"81a907f5e91fa65e455d",360:"7f133137ff23f2ac16cb",361:"5b186fa3cab302c9418d",362:"e5053336c2eca3636174",363:"696f2a254d51912da750",364:"b0de345194aba14a3684",365:"5fed9acbfa8d73dace7a",366:"a2953864fd6d96093755",367:"390cc1a0f1c45538679c",368:"c0d38fee65c8ba5e73fc",369:"61f9f8923c68116d2815",370:"936fa0b01477c32a02ca",371:"0843384be23e0de1df74",372:"3a6844b35424771bd7d3",373:"86fc84e377839cd88b44",374:"eacecc242b1db1fb5fe0",375:"bb8e135f2886ede67a5a",376:"5a9636c9d923bf9a6dce",377:"6e5c56c91c725c16437b",378:"9b3cc85faaa2f6a75504",379:"c348c108a2db2ad6208b",380:"ef0afce0f26ff5803524",381:"17d3da5cc5bd22e8e8a1",382:"147c375b8b9380d83297",383:"a1423df2f4b33c88d389",384:"1973c2bf57561166d0a7",385:"04fd2777ffadad9f93fd",386:"4e5b62d77bfbcc106b1a",387:"2af0746d537513691dcd",388:"5655cc972df9bc74eba7",389:"c9b3b33545b60d8b1f26",390:"a5bd9b885679de965f4d",391:"7d351d0864c5e38a4d0d",392:"b2dd87581eb6ee887897",393:"32ce84a6bc6db87ba5c7",394:"9ab622475e8ea87e9ade",395:"58267b77c08b5a1333b8",396:"bbf08e9263659f4b1448",397:"cf36fdd0f7a7cfdb4d6b",398:"e41e1c814d7d13f3d548",399:"973c03a7749a7df087f8",400:"556f4a62553b9071132c",401:"57c829ccdae3710c92d4",402:"02369b3312641bfe11bd",403:"0738aa809dbe23629380",404:"e0342be4a26bc9511edf",405:"711fa827a7330de85815",406:"c62b3c8b42560477b3c9",407:"56257761cf4c3131a293",408:"6a531e1ab9830a494b66",409:"2ba059bfa3d7527df5e0",410:"3d7e22017f901411cd9c",411:"5abb6b6009b93c5fcc06",412:"047162b0f5741f2d1901",413:"38c9804274764a191db1",414:"9bb7412599b0a35586db",415:"ed30ee95616adad62790",416:"ad5233792c368f50988c",417:"27ec36a036ef9ab4eaed",418:"79183b590d696a1269bf",419:"933331e3c930aaa1f0d8",420:"84f975a3ff363b162fbc",421:"107b69cc043103c55f6a",422:"91d0a7fd47cdf2ff6aaa",423:"899e2df278e8c560ac93",424:"e8a5ca55b6ca8d0e5f37",425:"eb7fc70c943eb49fa15a",426:"f8f31f065e46ac42c57c",427:"ef3411c532c93390e1c1",428:"014457ecd62ecba2449c",429:"f8f72d2797dff042a349",430:"d94454329421459bcbc6",431:"84590bb7587f2f2890b9",432:"c0aa12b5416502047b54",433:"4979611d412015e5f983",434:"10f15ce8e2462f77e627",435:"6d8cbed3114ebd2150d5",436:"87f3f250606275f6112f",437:"769654033969553706fa",438:"78f64df5c52e3d8f16c9",439:"118acb52559b614f83a1",440:"e415e3b4ec823dac0b13",441:"bbf9124afa01444de61c",442:"ce22f993cff8c792a6d7",443:"1be1bffdafcce9ef4432",444:"86a98c7e88a31ac5e6c3",445:"78858cf9685da54d48af",446:"1bad357efeb7b50b986c",447:"65d8dc5d1ad03518739f",448:"9ec792da689e5b4c1482",449:"b29ba8dc37b20ab3e56a",450:"ad4c726fdd8bc953751a",451:"6ff4798effb71aa0a5a7",452:"056c5b320f5c94e661bd",453:"d2be1f9ef4cd803e7384",454:"78996cdca3163c543405",455:"0ad0d4889820ba29b3c8",456:"a599728afa6c79ab0eeb"}[e]+".chunk.v7.js"}(e),0!==l.src.indexOf(window.location.origin+"/")&&(l.crossOrigin="anonymous");var c=new Error;o=function(t){l.onerror=l.onload=null,clearTimeout(u);var i=a[e];if(0!==i){if(i){var n=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+n+": "+r+")",c.name="ChunkLoadError",c.type=n,c.request=r,i[1](c)}a[e]=void 0}};var u=setTimeout((function(){o({type:"timeout",target:l})}),12e4);l.onerror=l.onload=o,document.head.appendChild(l)}return Promise.all(t)},s.m=e,s.c=n,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var l=window.officehome_pwa_webpackJsonp=window.officehome_pwa_webpackJsonp||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var d=c;o.push([0,146]),i()}({"+1lv":function(e,t,i){"use strict";i.d(t,"a",(function(){return U})),i.d(t,"b",(function(){return N})),i.d(t,"c",(function(){return B}));var n,r,a,o=i("QjXU"),s=i("V9hE"),l=i("gB6C"),c=i("pdjy"),u=i("ZBSS"),d=i("zGJG"),h=i("Y22C"),p=i("uqr+"),m=i("Yvbg"),f=i("Zmq1");function g(e,t){void 0===t&&(t=!1);var i=!1,n=function(n,r){var a=void 0;return t&&r&&(a=r(n)),i||(i=!0,e()),!t&&r&&(a=r(n)),a},r=window.onbeforeunload;window.onbeforeunload=function(e){return n(e,r&&r.bind(window))};var a=Object(f.a)(),o=a.platform.platformType;if(("iPhone"===o||"iPad"===o)&&"Safari"===a.browser.browserType){var s=window.onpagehide;window.onpagehide=function(e){return n(e,s&&s.bind(window))}}}var b,v,S,y,C,w,I,T,k,A,_,P,E,F,O,D=!1,M=!1,R="",x=new h.a,L=new h.a,U=new Promise((function(e){O=e}));function N(e){return e.oTelEnabled&&e.oTelAriaTenant&&function(e,t,i){return i?Object(m.a)(e)&&Object(m.a)(t)&&Object(m.a)(i):Object(m.a)(e)&&Object(m.a)(t)}(e.correlationId,e.sessionId,e.identity.tenantId)&&!M?(D=!0,R=e.oTelAriaNameSpace,Promise.all([W(e.schedulerPriority),j(e.schedulerPriority)]).then((function(){(v=new S(void 0,void 0,{enableQueue:e.win11DetectionEnabled})).setTenantToken(e.oTelAriaNameSpace,e.oTelAriaTenant,F),E=function(e,t,i,s,l,c,h,m,f,g,b,v,S,y,T,k,A,_,P,E,F,O,D,M,R){var x=[s.split(" ")[0].split("-").join(""),"0"].join("."),L=Object(o.__spread)(n.getFields({platform:t,name:e,version:x}),r.getFields({id:l}),[I(Object(p.a)([u.Z,u.k]),V(c,f,g)),I(u.n,c)]),U=null==T?void 0:T.puid,N="";U&&(N=(null==T?void 0:T.isMsa)?"MsaPuid":"OrgIdPuid"),L.push.apply(L,Object(o.__spread)(a.getFields({primaryIdentityHash:U,primaryIdentitySpace:N,tenantId:null==T?void 0:T.tenantId,tenantGroup:(null==T?void 0:T.isMsa)?"Consumer":"Commercial",isAnonymous:!1})));var W=[I(u.A,d.b),I(u.cb,S),I(u.l,b),I(u.h,i),I(u.db,v),I(u.o,h)];return(null==k?void 0:k.isAdmin)&&W.push(C(Object(p.a)([u.hb,u.J]),k.isAdmin)),(null==k?void 0:k.isDynamics)&&W.push(C(Object(p.a)([u.hb,u.K]),k.isDynamics)),(null==k?void 0:k.isEdu)&&W.push(C(Object(p.a)([u.hb,u.L]),k.isEdu)),(null==k?void 0:k.isEduFaculty)&&W.push(C(Object(p.a)([u.hb,u.M]),k.isEduFaculty)),(null==k?void 0:k.isEduStudent)&&W.push(C(Object(p.a)([u.hb,u.N]),k.isEduStudent)),(null==k?void 0:k.isFirstVisit)&&W.push(C(Object(p.a)([u.hb,u.O]),k.isFirstVisit)),(null==k?void 0:k.isIw)&&W.push(C(Object(p.a)([u.hb,u.Q]),k.isIw)),(null==k?void 0:k.isSmb)&&W.push(C(Object(p.a)([u.hb,u.R]),k.isSmb)),m&&W.push(I(u.D,m)),_&&W.push(I(u.i,_)),A&&W.push(I(u.s,A)),P&&W.push(I(u.T,P)),E&&W.push(I(u.eb,E)),F&&W.push(w(u.C,F)),O&&W.push(I(u.r,O)),D&&W.push(I(u.I,D)),M&&W.push(I(u.m,M)),R&&W.push(I(u.g,R)),Object(o.__spread)(L,W)}(e.appName,e.appPlatform,e.appWorkload,e.bundleBuildDate,e.correlationId,e.deploymentEnvironment,e.deviceType,e.flights,e.isCorpNet,e.isTestTraffic,e.sessionId,e.serverLocation,e.requestOrigin,0,e.identity,e.userSegment,e.ecsRing,e.appWorkloadType,e.networkType,e.serviceWorkerState,e.firstVisitAgeInDays,e.domainOrigin,e.initialPageName,e.dataBoundary,e.preferredCulture),e.win11DetectionEnabled?function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return[4,(e=new P).detectOs()];case 1:return t.sent(),[2,e]}}))}))}().then((function(t){_=new k(E,{endpointUrl:q(e.deploymentEnvironment,e.dataBoundary,e.IsEudbEndpointEnabled),plugins:[t]}),O(_),H(e.IsSamplingEnabled,e.identity.puid,e.correlationId),v.addSink(_),M=!0,$(!1),g((function(){z(!1)}),!0)})):(_=new k(E,{endpointUrl:q(e.deploymentEnvironment,e.dataBoundary,e.IsEudbEndpointEnabled)}),O(_),H(e.IsSamplingEnabled,e.identity.puid,e.correlationId),v.addSink(_),M=!0,$(!1),g((function(){z(!1)}),!0))})).catch((function(){D=!1}))):Promise.resolve()}function W(e){return new Promise((function(t,o){Object(l.a)((function(){Promise.all([i.e(23),i.e(143)]).then(i.bind(null,"x7Ba")).then((function(e){n=e.App,r=e.Session,a=e.User,C=e.makeBooleanDataField,w=e.makeInt64DataField,I=e.makeStringDataField,T=e.makeDoubleDataField,S=e.TelemetryLogger,F=e.SuppressNexus,(0,e.onNotification)().addListener((function(e){if(0===e.level){console.log(e.message());try{var t={};t.Error=e.message(),Object(s.a)("OtelNotificationErrorEvent",t)}catch(e){console.log(e)}}})),t()})).catch((function(e){o(e)}))}),null!=e?e:c.b)}))}function j(e){return new Promise((function(t,n){Object(l.a)((function(){Promise.all([i.e(27),i.e(190)]).then(i.bind(null,"uTS/")).then((function(e){k=e.OneDSSink,A=e.OneDSEndpoint,P=e.OsPlugin,b=e.Sampler,t()})).catch((function(e){n(e)}))}),null!=e?e:c.b)}))}function H(e,t,i){if(e){var n=new b;t?n.enableWithIdentifier("PrimaryIdentityHash",t):n.enableWithIdentifier("SessionId",i),n.setSampleRate(.02),_.addPreprocessor(n)}}function B(e,t,i){G(e,t,!1,i)}function G(e,t,i,n){if(!i&&D)if(!i&&M){var r=[R,e].join("."),a=function(e){return Object.keys(e).filter((function(t){return"number"==typeof e[t]||"boolean"==typeof e[t]||"string"==typeof e[t]})).map((function(t){var i=e[t];return"boolean"==typeof i?C(t,i):"number"==typeof i?Number.isInteger(i)?w(t,i):T(t,i):I(t,i)}))}(t);!function(e,t,i,n,r,a){e.sendTelemetryEvent({eventName:t,dataFields:i,eventFlags:{dataCategories:2,diagnosticLevel:110,samplingPolicy:a}})}(i?y:v,r,a,0,0,n?1:0)}else{var o={eventName:e,params:t,isSampled:n};i?L.queueEvent(o):x.queueEvent(o)}}function q(e,t,i){if("EU"===t&&i)return A.EUDB;switch(e){case"pfprod":return A.USGOV_DOD;case"tbprod":return A.USGOV_DOJ;default:return A.PUBLIC}}function V(e,t,i){if(i)return"Automation";switch(e){case"dev":case"ppe":case"prodprv":return"Automation";case"prod":case"bfprod":case"pfprod":case"tbprod":case"unprod":case"usprod":return t?"Microsoft":"Production";default:return"Automation"}}function $(e){e?L.drainQueue().forEach((function(e){e.eventName&&function(e,t,i){G(e,t,!0,void 0)}(e.eventName,e.params||{})})):x.drainQueue().forEach((function(e){e.eventName&&B(e.eventName,e.params||{})}))}function z(e){if(!e&&D&&M){$(e);try{(e?y:v).telemetrySinks.forEach((function(e){var t,i;null===(i=(t=e).flush)||void 0===i||i.call(t,!1)}))}catch(e){console.log(e)}}}},"+2OL":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("dFxn"),r=i("Mlb/");class a{constructor(e){this.config=e.parse("serviceWorkerConfig")||{diskPreloadEnabled:!1,enabled:!1,pilotFlights:[],serviceWorkerAllowedFlights:[],scope:"",scriptUrl:""}}}a.ɵprov=r.kc({factory:function(){return new a(r.lc(n.a))},token:a,providedIn:"root"})},"+P5Z":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("p6wn"),r=i("hhzZ");class a{static forRoot(){return{ngModule:a,providers:[{provide:r.a,useClass:n.a}]}}}},"+YV+":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("lrJm"),r=i("OWzB"),a=i("4/We"),o=i("Mlb/");class s{constructor(e,t,i){this.createDocumentService=e,this.capabilitiesService=t,this.globalErrorHandler=i,this.init()}init(){this.createLinksPromise=this.createDocumentService.getCreateLinks(),this.createButtonEnabledPromise=new Promise((e=>{this.createLinksPromise.then((t=>{e(this.capabilitiesService.capabilities.createDocumentSupported&&t.length>0)})).catch((t=>{this.globalErrorHandler.handleError(t,"wmh4W"),e(!1)}))}))}}s.ɵprov=o.kc({factory:function(){return new s(o.lc(r.a),o.lc(a.a),o.lc(n.b))},token:s,providedIn:"root"})},"+a0u":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},"+ucO":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("QjXU"),r=i("dFxn"),a=i("uzn7"),o=i("cgnd"),s=i("/I02"),l=i("Mlb/");class c{constructor(e,t,i,n){this.localStorageService=e,this.contextService=t,this.configParserService=i,this.clientStartupConfig=n,this.config=i.parse("appGalleryConfig")||{numberOfBusinessApps:0,learnMoreLinks:[],resources:null,categoryId:"TipsAndTricks",workspaceBatches:!1,myApplicationsUrl:"",ecsAppGalleryUpdatesEnabled:!1,filterAllAppsFirstPartyEnabled:!1},this.config.categoryId="TipsAndTricks",c.appCategoryRefreshLocalStorageDataKey+="_"+this.clientStartupConfig.config.tenantId+"_"+this.clientStartupConfig.config.puid,c.appCategoriesLocalStorageDataKey+="_"+this.clientStartupConfig.config.tenantId+"_"+this.clientStartupConfig.config.puid,c.appCategoriesOfficeMarketLocalStorageDataKey+="_"+this.clientStartupConfig.config.tenantId+"_"+this.clientStartupConfig.config.puid}getCategory(){return this.categoriesPromise||(this.categoriesPromise=new Promise((e=>Object(n.__awaiter)(this,void 0,void 0,(function*(){const t=this.localStorageService.get(c.appCategoryRefreshLocalStorageDataKey)||0,i=(new Date).getTime()-t,n=this.contextService.sharedContext.officeMarket,r=this.localStorageService.get(c.appCategoriesOfficeMarketLocalStorageDataKey)||"";if(i<=864e5&&n===r){const t=this.localStorageService.get(c.appCategoriesLocalStorageDataKey)||{};if(t.Apps)return e(t)}const a=this.configParserService.parse("appCategoryData")||{};this.saveToLocalStorage(n,a),e(a)}))))),this.categoriesPromise}saveToLocalStorage(e,t){this.localStorageService.set(c.appCategoryRefreshLocalStorageDataKey,(new Date).getTime()),this.localStorageService.set(c.appCategoriesOfficeMarketLocalStorageDataKey,e),this.localStorageService.set(c.appCategoriesLocalStorageDataKey,t)}}c.appCategoryRefreshDataKey="AppCategoryRefresh",c.appCategoryRefreshLocalStorageDataKey=`${c.appCategoryRefreshDataKey}`,c.appCategoriesDataKey="AppCategories",c.appCategoriesLocalStorageDataKey=`${c.appCategoriesDataKey}`,c.appCategoriesOfficeMarketDataKey="AppCategoryLanguage",c.appCategoriesOfficeMarketLocalStorageDataKey=`${c.appCategoriesOfficeMarketDataKey}`,c.ɵprov=l.kc({factory:function(){return new c(l.lc(a.a),l.lc(s.a),l.lc(r.a),l.lc(o.b))},token:c,providedIn:"root"})},"/6za":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("dFxn"),r=i("Mlb/");class a{constructor(e){this.config=e.parse("sharePointConfig")}}a.ɵprov=r.kc({factory:function(){return new a(r.lc(n.a))},token:a,providedIn:"root"})},"/I02":function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("H90i"),r=i("dFxn"),a=i("hZW2"),o=i("Z0U4"),s=i("Ax7d"),l=i("4/We"),c=i("Mlb/"),u=i("4lGG");class d{constructor(e,t,i,n,r,a){this.capabilitiesService=e,this.cookieService=t,this.documentService=i,this.officeRouteService=n,this.webPwaService=r,this.sharedContext=a.parse("sharedContext")||{abtSignoutPath:null,activityLifetimeInSeconds:0,activityTrackingEnabled:!1,accessTokenMaxRetryAttempts:0,consumerShellServiceEndpoint:null,createButtonTextCompleteStopCount:0,createButtonTextEmptyStopCount:0,createButtonTextTypingSpeed:0,dataUpdateCooldownInSeconds:0,dataUpdateIntervalInSeconds:0,dataUpdateMaxConsecutiveFailures:0,dataUpdateTimeoutInSeconds:0,dateOverride:null,defaultLinkTarget:"_blank",fluentHeroImageUrl:null,graphApiRoot:null,graphApiRootRefreshIntervalInSeconds:0,heroImageUrl:null,heroTitleGradientImageUrl:null,iceApplicationId:-1,inactivityTimeoutInSeconds:60,inMockMode:!1,metaResourcePath:null,msaAppId:null,msaTokenRedirectUrl:null,msaTokenTimeoutMs:0,officeHomeApiRoot:null,officeMarket:"en-us",officeMarketLcid:"1033",officeStartManifestVersion:null,oneDriveConsumerApi:null,oneDriveResourceId:null,oneDriveUrl:null,outlookServiceRoot:null,recommendedIceApplicationId:-1,serviceWorkerIntervalUpdateEnabled:!1,sharePointResourceId:null,signOutRedirectUrl:null,signOutUrlTemplate:null,supportDocsUrl:null,teamsUrl:null,tokenLoginUrlTemplate:null,updateDataOnViewEnabled:!1,usingOneDriveResourceAsSharePointResource:!1,wacHostAppPrebootTimeout:0};const o=this.documentService.nativeDocument.getElementsByTagName("html");this.isRtl=o&&o[0]&&"rtl"===o[0].getAttribute("dir"),this.defaultLinkTarget=this.sharedContext.defaultLinkTarget,this.webPwaService.isStandalone.subscribe((e=>{this.isStandalone=e,this.sharedContext.defaultLinkTarget=e&&!this.webPwaService.isOfficeApp()?"_self":this.defaultLinkTarget}))}getCsrfToken(){return this.cookieService.get("AjaxSessionKey")}getWdOrigin(e){return`OFFICECOM-${this.getWdOriginApp()}.${this.getWdOriginPage()}.${e}`}getCurrentPageForLogging(){return this.officeRouteService.getCurrentPageForLogging()}getWdOriginApp(){return this.isStandalone?n.c.PWA:this.capabilitiesService.capabilities.pwaEnabled?n.c.HWA:this.capabilitiesService.capabilities.isEmbedMode?n.c.Embed:n.c.Web}getWdOriginPage(){const e=this.officeRouteService.getCurrentRoute();if(e)switch(e.route){case"Start":return n.d.Start;case"Templates":return n.d.Templates;case"Content":return n.d.Content;case"Search":return n.d.Search;default:return n.d.Home}return n.d.Home}}d.ɵprov=c.kc({factory:function(){return new d(c.lc(l.a),c.lc(u.a),c.lc(a.a),c.lc(o.a),c.lc(s.a),c.lc(r.a))},token:d,providedIn:"root"})},0:function(e,t,i){i("sqm+"),i("xDq8"),e.exports=i("qiPL")},"0ZeC":function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.MarkTaskAsDone="MarkTaskAsDone",e.MarkAsNotATask="MarkAsNotATask",e.PromoteTask="PromoteTask",e.DismissAction="DismissAction",e.UndoTask="UndoTask"}(n||(n={}))},"1Bt+":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i("pd4Y"),i("uH9+"),i("PBJH");class n{constructor(e,t,i){this.dateService=e,this.locService=t,this.timestampFormatService=i}transform(e,t,i,n){return e?(null==i&&(i=e.toDateString()),this.commonFormat(e,t,i,n)):""}commonFormat(e,t,i,n){if(!this.locService.supportsLocaleSpecifiers)return i;const r=this.dateService.timespanInSeconds(e);switch(this.timestampFormatService.getTimestampType(e)){case 9:return this.timespanString(r,this.locService.NumberMinutesInShort,-60);case 0:return"";case 1:return n?this.locService.JustNowLowerCase:this.locService.JustNow;case 2:return this.timespanString(r,this.locService.NumberMinutesAgoShort,60);case 3:return this.timespanString(r,this.locService.NumberHoursAgoShort,3600);case 4:return t?n?this.locService.YesterdayLowerCase:this.locService.Yesterday:this.locService.format(n?this.locService.TimeYesterdayLowerCase:this.locService.TimeYesterday,this.locService.formatTimeFromDate(e));case 5:return t?this.locService.localizedWeekday(e):this.locService.format(this.locService.TimeDayOfWeek,this.locService.localizedWeekday(e),this.locService.formatTimeFromDate(e));case 6:return this.locService.localizedMonthDate(e);default:return this.locService.localizedDateStringMedium(e)}}timespanString(e,t,i){const n=Math.round(e/i);return this.locService.format(t,this.locService.localizedNumberString(n))}}},"1GMS":function(e,t,i){"use strict";i.d(t,"a",(function(){return h})),i.d(t,"b",(function(){return v}));var n=i("Mlb/"),r=i("vk2e"),a=i("6wOV"),o=i("AY/E"),s=i("pzhl"),l=i("PkQn"),c=i("4/We"),u=i("cAxl"),d=i("3bNC"),h=n.Fb({encapsulation:2,styles:[],data:{}});function p(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,3,"img",[],[[8,"src",4],[8,"title",0]],null,null,null,null)),n.Gb(1,278528,null,0,r.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"person-picture-upcoming-meeting__display":0,"person-picture__image":1,"person-picture__image--card":2}),n.Gb(3,212992,null,0,a.a,[n.o,o.a],{upn:[0,"upn"]},null)],(function(e,t){var i=t.component,r=n.Ob(1,"person-picture__",i.iconSize,""),a=e(t,2,0,i.isUpcomingMeeting,!i.isUpcomingMeeting,i.personPictureCard);e(t,1,0,r,a),e(t,3,0,null==i.person?null:i.person.email)}),(function(e,t){var i=t.component;e(t,0,0,"data:image/png;base64,"+t.context.ngIf,n.Ob(1,"",null==i.person?null:i.person.fullName,""))}))}function m(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),n.Hb(1,0,null,null,1,"ohp-icon-font",[["cssClass","upcomingMeeting-card__attendee_status_image"],["size","16"]],null,null,null,s.b,s.a)),n.Gb(2,638976,null,0,l.a,[c.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){e(t,2,0,"upcomingMeeting-card__attendee_status_image",t.component.status,"16")}),null)}function f(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,2,"div",[["aria-hidden","true"],["class","person-picture-upcoming-meeting__display"]],[[8,"title",0]],null,null,null,null)),(e()(),n.Hb(1,0,null,null,1,"div",[["class","person-picture-upcoming-meeting__text"]],null,null,null,null,null)),(e()(),n.gc(2,null,[" "," "]))],null,(function(e,t){var i=t.component;e(t,0,0,n.Ob(1,"",null==i.person?null:i.person.fullName,"")),e(t,2,0,null==i.person?null:i.person.fullName.slice(0,1))}))}function g(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,"div",[["aria-hidden","true"],["class","person-picture__image person-picture__image--icon"],["style","font-size: 24px;"]],[[8,"title",0]],null,null,null,null)),n.Gb(1,278528,null,0,r.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"person-picture__placeholder--padding--7":0}),(e()(),n.Hb(3,0,null,null,1,"ohp-icon-font",[["iconFontName","Person"],["size","16"]],null,null,null,s.b,s.a)),n.Gb(4,638976,null,0,l.a,[c.a],{iconFontName:[0,"iconFontName"],size:[1,"size"]},null)],(function(e,t){var i=e(t,2,0,t.component.hasPadding);e(t,1,0,"person-picture__image person-picture__image--icon",i),e(t,4,0,"Person","16")}),(function(e,t){var i=t.component;e(t,0,0,n.Ob(1,"",null==i.person?null:i.person.fullName,""))}))}function b(e){return n.jc(0,[(e()(),n.qb(16777216,null,null,1,null,f)),n.Gb(1,16384,null,0,r.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,g)),n.Gb(3,16384,null,0,r.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(0,null,null,0))],(function(e,t){var i=t.component;e(t,1,0,i.isUpcomingMeeting),e(t,3,0,!i.isUpcomingMeeting)}),null)}function v(e){return n.jc(0,[(e()(),n.qb(16777216,null,null,2,null,p)),n.Gb(1,16384,null,0,r.k,[n.W,n.S],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),n.Yb(131072,r.b,[n.h]),(e()(),n.qb(16777216,null,null,1,null,m)),n.Gb(4,16384,null,0,r.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(0,[["placeholder",2]],null,0,null,b))],(function(e,t){var i=t.component;e(t,1,0,n.hc(t,1,0,n.Wb(t,2).transform(i.imageBase64Promise)),n.Wb(t,5)),e(t,4,0,"Accepted"===i.status||"Declined"===i.status||"TentativelyAccepted"===i.status)}),null)}n.Db("ohp-person-picture",u.a,(function(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-person-picture",[],null,null,null,v,h)),n.Gb(1,573440,null,0,u.a,[d.a],null,null)],null,null)}),{person:"person",pictureId:"pictureId",fetchImage:"fetchImage",imageBase64:"imageBase64",isUpcomingMeeting:"isUpcomingMeeting",status:"status",iconSize:"iconSize",hasPadding:"hasPadding",personPictureCard:"personPictureCard"},{},[])},"1Hgo":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("dFxn"),r=i("Mlb/");class a{constructor(e){this.config=e.parse("edgeworthConfig")}}a.ɵprov=r.kc({factory:function(){return new a(r.lc(n.a))},token:a,providedIn:"root"})},"1LNb":function(e,t,i){"use strict";i.d(t,"a",(function(){return T}));var n=i("QjXU"),r=i("lUkk"),a=i("CMIS"),o=i("Cin9"),s=i("BMb5"),l=i("hhzZ"),c=i("BaAg"),u=i("4/We"),d=i("cgnd"),h=i("/I02"),p=i("JH4S"),m=i("fGsv"),f=i("W3Zz"),g=i("hZW2"),b=i("kH2X"),v=i("Z0U4"),S=i("Uqr9"),y=i("casz"),C=i("5aVq"),w=i("Mlb/"),I=i("OtXi");class T{constructor(e,t,i,n,r,a,o,s,l,c,u,d,h,p,m){this.capabilitiesService=e,this.clientStartupConfigService=t,this.deviceDetector=i,this.documentService=n,this.feedbackConfigService=r,this.instrumentationService=a,this.routeService=o,this.startupConfigService=s,this.userContextService=l,this.scheduler=c,this.windowService=u,this.shellShimService=d,this.contextService=h,this.adminPolicyService=p,this.wrapperVersion=m,this.feedbackScript="feedback-script",this.scriptLoadStarted=!1,this.feedbackServiceInitializePromise=null,this.feedbackServiceInitializePromise=this.initialize()}getOCVTelemetryData(e){const t=this.startupConfigService.config.authType===d.a.MSA?this.startupConfigService.config.fixedConsumerTenantId:this.startupConfigService.config.tenantId,i=this.wrapperVersion?`${this.wrapperVersion.major}.${this.wrapperVersion.minor}.${this.wrapperVersion.build}.${this.wrapperVersion.revision}|`:"";return{applicationGroup:{appData:JSON.stringify({userCategories:this.getUserCategories(),latency:e})},telemetryGroup:{audienceGroup:this.getAudienceGroup(),deviceType:this.getDeviceType(),flights:this.startupConfigService.config.sharedClientStartupContext.flights,loggableUserId:this.startupConfigService.config.puid,officeBuild:i+this.startupConfigService.config.sharedClientStartupContext.buildId,platform:this.deviceDetector.getDeviceInfo().platform.keyword,tenantId:t},webGroup:{browser:this.deviceDetector.getDeviceInfo().browser.keyword,sourcePageName:this.getSourcePageName()}}}loadOCVFeedback(e){"undefined"!=typeof OfficeBrowserFeedback&&(OfficeBrowserFeedback.initOptions.appId=this.getOcvAppId(),OfficeBrowserFeedback.initOptions.onDismiss=t=>{this.logDismissOCVFeedback(t),e&&e()},OfficeBrowserFeedback.multiFeedback||this.scriptLoadStarted?this.displayOCVFeedback(0):this.addOCVScriptToPage((e=>{this.displayOCVFeedback(e)})))}addOCVScriptToPage(e){const t=this.feedbackConfigService.config;return!!t&&(this.scriptLoadStarted||(this.scriptLoadStarted=!0,this.scheduler.scheduleWork((()=>{const i=S.a.now();this.documentService.addScriptToPage(t.scriptUrl,(()=>{const t=Math.ceil(S.a.now()-i);e(t)}),(()=>{}),!0,this.feedbackScript,!0)}),4)),!0)}getOcvAppId(){return this.getSourcePageName()===this.feedbackConfigService.config.fluidContentPage?this.feedbackConfigService.config.fluidAppId:this.feedbackConfigService.config.appId}initialize(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){if(this.currentPageView=this.getCurrentPageView(this.routeService.getCurrentRoute()),this.routeService.subscribeToRouteChangeStart((e=>this.currentPageView=this.getCurrentPageView(e.currentRoute))),this.capabilitiesService.capabilities.adminPolicyEnabled&&(this.OCVAdminPolicy=yield this.adminPolicyService.getAdminPolicy()),"undefined"!=typeof OfficeBrowserFeedback&&!OfficeBrowserFeedback.initOptions){const{stylesUrl:e,intlUrl:t,environment:i,screenshotEnabled:n,autopopulateEmail:r}=this.feedbackConfigService.config,{buildId:a,correlationId:o}=this.startupConfigService.config.sharedClientStartupContext;OfficeBrowserFeedback.initOptions={appId:void 0,stylesUrl:e,intlUrl:t,environment:i,sessionId:o,build:a,locale:this.contextService.sharedContext.officeMarket,screenshot:n,userEmail:r?this.startupConfigService.config.userPrincipalName:""},this.OCVAdminPolicy&&(OfficeBrowserFeedback.initOptions.screenshot=this.OCVAdminPolicy.ScreenShot.State,OfficeBrowserFeedback.initOptions.showEmailAddress=this.OCVAdminPolicy.EmailCollection.State)}if(this.capabilitiesService.capabilities.shellFeedbackEnabled){const e=this.getOCVTelemetryData("0"),t=this;(yield this.shellShimService.getShellShim()).NFD.OnFeedbackMetadataRequested(((i,n)=>{t.windowService.nativeWindow.OfficeBrowserFeedback.html2canvas(this.documentService.nativeDocument.body,{background:"#ffffff"}).then((function(e){n(e.toDataURL("image/jpeg"))}));const r=(i=i||{options:{telemetryGroup:{},webGroup:{}}}).options;r.appId=this.getOcvAppId(),r.userVoiceEnabled=!1,r.applicationGroup.appData=e.applicationGroup.appData,r.disableIncludeScreenshot=!1,this.OCVAdminPolicy&&(r.emailPolicyValue=this.OCVAdminPolicy.EmailCollection.PolicyValue,r.screenshotPolicyValue=this.OCVAdminPolicy.ScreenShot.PolicyValue,r.sendFeedbackPolicyValue=this.OCVAdminPolicy.SendFeedback.PolicyValue,r.logCollectionPolicyValue=this.OCVAdminPolicy.LogCollection.PolicyValue);const a=r.telemetryGroup;return a.audienceGroup=e.telemetryGroup.audienceGroup,a.featureArea=this.getSourcePageName(),a.flights=e.telemetryGroup.flights,a.processSessionId=t.startupConfigService.config.sharedClientStartupContext.correlationId,a.officeBuild=e.telemetryGroup.officeBuild,r.webGroup.sourcePageName=this.getSourcePageName(),i}))}}))}logDismissOCVFeedback(e){this.instrumentationService.logGenericEvent(e?"Feedback_OCV_Submitted":"Feedback_OCV_Dismissed",{}),Object(r.a)({id:"feedback-dismiss",area:"Feedback",result:e?"New":"Cancel",target:"Feedback"})}displayOCVFeedback(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const t={},i=e.toString();if(t.Latency=i,this.capabilitiesService.capabilities.shellFeedbackEnabled)(yield this.shellShimService.getShellShim()).NFD.OpenFeedback();else{const e=this.getOCVTelemetryData(i);OfficeBrowserFeedback.multiFeedback(e).then((()=>{}),(e=>{t.Error=e,this.instrumentationService.logGenericEvent("Feedback_OCV_Error",t),Object(a.a)({eventName:"Feedback_OCV",errorType:"Feedback_Error",message:e})}))}this.instrumentationService.logGenericEvent("Feedback_OCV_Click",t),Object(r.a)({id:"feedback-button",area:"Feedback",result:"Open",target:"Feedback"}),Object(o.a)({eventName:"OCV_Script_Downloaded",latency:e,area:"Feedback"})}))}getDeviceType(){return this.deviceDetector.isDesktopDevice()?"Desktop":this.deviceDetector.isTabletDevice()?"Tablet":this.deviceDetector.isMobileDevice()?"Phone":"Laptop"}getAudienceGroup(){return"WorldWide"===this.clientStartupConfigService.config.sharedClientStartupContext.ecsRing?"Production":this.clientStartupConfigService.config.sharedClientStartupContext.ecsRing}getSourcePageName(){return this.currentPageView}getUserCategories(){const e=[];return this.startupConfigService.config.authType===d.a.OrgId?e.push("Commercial"):this.startupConfigService.config.authType===d.a.MSA&&e.push("Consumer"),this.userContextService.user.isAdmin&&e.push("Admin"),this.userContextService.user.isEdu&&e.push("Edu"),this.userContextService.user.isEduStudent&&e.push("EduStudent"),this.userContextService.user.isEduFaculty&&e.push("EduFaculty"),this.userContextService.user.isSmb&&e.push("Smb"),this.userContextService.user.isDynamics&&e.push("Dynamics365"),this.userContextService.user.isFirstRelease&&e.push("FirstRelease"),e}getCurrentPageView(e){if(!e||!e.route)return"Unknown";switch(e.route){case"OfficeHome":return"Home_PageView";case"AppGallery":return"AppGallery_PageView";case"Search":case"SearchSiteScoped":case"SearchTopicScoped":case"SearchMeetingScoped":case"SearchPersonScoped":return"Search_PageView";default:return`${e.app?c.b[e.app]:""}${e.route}`}}}T.ɵprov=w.kc({factory:function(){return new T(w.lc(u.a),w.lc(d.b),w.lc(f.b),w.lc(g.a),w.lc(b.a),w.lc(l.a),w.lc(v.a),w.lc(d.b),w.lc(p.a),w.lc(y.a),w.lc(s.b),w.lc(C.a),w.lc(h.a),w.lc(m.a),w.lc(I.a,8))},token:T,providedIn:"root"})},"1rn/":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("8/lW"),r=i("a3FV"),a=i("4CZh");function o(e,t,i,o){void 0===i&&(i={}),void 0===o&&(o=n.a.Security),i.Latency=t.toString(),Object(a.b)(e,r.a.PerformanceDump,o,i,[],!0)}},"24t9":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{static getKey(e){return n.KeysToKeyboardKeys[e.key]||n.KeyCodesToKeyboardKeys[e.keyCode]||0}}n.KeysToKeyboardKeys={Tab:1,Enter:2,Shift:16,Esc:3,Escape:3,Up:4,ArrowUp:4,Down:5,ArrowDown:5,Spacebar:32," ":32,Zero:48,Nine:57,a:65,z:90,A:65,Z:90,"/":191},n.KeyCodesToKeyboardKeys={9:1,13:2,16:16,27:3,32:32,38:4,40:5,48:48,57:57,65:65,90:90,191:191}},"2CtU":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("6UlS"),r=i("Mlb/");class a{constructor(){this._onenotePageDialog=new n.a(null)}showOneNotePageDialog(e){this._onenotePageDialog.next(e)}get onenotePageDialog(){return this._onenotePageDialog.asObservable()}}a.ɵprov=r.kc({factory:function(){return new a},token:a,providedIn:"root"})},"2lMP":function(e,t,i){"use strict";i.d(t,"a",(function(){return M}));var n=i("QjXU"),r=i("Mlb/"),a=i("YPlO"),o=i("bJUw"),s=i("lLc4"),l=i("IO/W"),c=i("bMT6"),u=i("RtYo"),d=i("lUkk"),h=i("CMIS"),p=i("rTyw"),m=i("70cc"),f=(i("DQbD"),i("GmnP"),i("kaEK")),g=(i("uNUv"),i("0ZeC")),b=(i("dOgD"),i("OPwp")),v=(i("6u39"),i("dx17"),i("M56G"),i("1Bt+"),i("A/um")),S=i("hhzZ"),y=i("BaAg"),C=i("p6Zr"),w=i("L/Tc"),I=(i("QOOv"),i("JT1q")),T=(i("7Rc8"),i("fKR7")),k=(i("kpuN"),i("pd4Y"),i("W3Zz"),i("hZW2"),i("7Gwk"),i("U8M1"),i("Bc8L"),i("Z0U4"),i("Dpxn"),i("EqbI"),i("Uqr9"),i("Xc4i"),i("TIi1"),i("EUVs")),A=(i("BMb5"),i("hoyd"),i("4/We"),i("cgnd")),_=(i("/I02"),i("PBJH"),i("Qqp8")),P=i("uUrA"),E=i("24t9"),F=i("WFKr"),O=i("ZBli"),D=i("H90i");i("qCYW"),i("kfAr"),i("7J/E");class M{constructor(e,t,i,a,o,s,l,c,u,d,h,p,m,f,v,S,C,w,I,T,k,_,P,E,F,O,D,R,x,L,U,N,W,j,H,B){this.activityDescriptionService=e,this.capabilitiesService=t,this.clientStartupConfigService=i,this.contentActionsService=a,this.contextService=o,this.dateService=s,this.deviceDetector=l,this.documentService=c,this.domSanitizer=u,this.eventService=d,this.instrumentationService=h,this.localAppLauncherService=p,this.locService=m,this.mruConfigService=f,this.mruItemInflationService=v,this.mruItemService=S,this.officeFeedService=C,this.officeRouteService=w,this.oneDriveService=I,this.onenoteService=T,this.performanceService=k,this.renderer=_,this.responsiveRelativeDatePipe=P,this.shareControlService=E,this.thumbnailInstrumentationService=F,this.uploadLocalFileService=O,this.urlLauncherService=D,this.uiHostBootstrapperService=R,this.wacContentService=x,this.windowService=L,this.workloadsService=U,this.mruDataService=N,this.fluidHostContext=W,this.fluidInstrumentationService=j,this.accessTokenService=H,this.floodgateService=B,this.leftAlignActionsMenu=!1,this.ShareControlMode=b.a,this.PotentialActionType=g.a,this.shareControlOutputs={dismiss:()=>this.onShareControlDismiss(!0)},this.MRU_ITEM_LOADING_STATE=0,this.MYA_ITEM_VIEW_STATE=2,this.MYA_ITEM_ADDED_STATE=0,this.getToDoUrl=()=>Object(n.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.workloadsPromise,t=null==e?void 0:e.find((e=>"ShellToDo"===e.Id));return null==t?void 0:t.Url})),this.addItem=new r.q,this.deleteItem=new r.q,this.changePinState=new r.q;const G=this.mruConfigService.config;this.activityEnabled=G.activityEnabled,this.mobileMenusEnabled=this.capabilitiesService.capabilities.mobileContextMenusEnabled,this.isConsumer=this.clientStartupConfigService.config.authType===A.a.MSA,this.thumbnailApiEnabled=this.capabilitiesService.capabilities.thumbnailEndpointEnabled,this.actionContextMenuEnabled=this.capabilitiesService.capabilities.contentActionsEnabled&&this.capabilitiesService.capabilities.contentActionsOHomeEnabled,this.downloadActionEnabled=this.capabilitiesService.capabilities.downloadActionEnabled,this.replacePinActionEnabled=this.capabilitiesService.capabilities.replacePinActionEnabled,this.isPwa=this.capabilitiesService.capabilities.isPwaInUwp,M.applicationConversionMap||(M.applicationConversionMap=new Map,M.applicationConversionMap.set(y.b.Word,{iconFontClass:G.wordIconFontClass,iconFontColor:"#185ABD",nativeUriScheme:"ms-word:ofe|u|"}),M.applicationConversionMap.set(y.b.Excel,{iconFontClass:G.excelIconFontClass,iconFontColor:"#107C41",nativeUriScheme:"ms-excel:ofv|ofc|u|"}),M.applicationConversionMap.set(y.b.Visio,{iconFontClass:G.visioIconFontClass,iconFontColor:"#4C68B1",nativeUriScheme:"ms-visio:ofe|u|"}),M.applicationConversionMap.set(y.b.PowerPoint,{iconFontClass:G.powerPointIconFontClass,iconFontColor:"#C43E1C",nativeUriScheme:"ms-powerpoint:ofe|u|"}),M.applicationConversionMap.set(y.b.OneNote,{iconFontClass:G.oneNoteIconFontClass,iconFontColor:"#7719AA",nativeUriScheme:"onenote:"}),M.applicationConversionMap.set(y.b.Sway,{iconFontClass:G.swayIconFontClass,iconFontColor:"#038387"}),M.applicationConversionMap.set(y.b.Forms,{iconFontClass:G.formsIconFontClass,iconFontColor:"#038387"}),M.applicationConversionMap.set(y.b.PowerBI,{iconFontClass:G.powerBIIconFontClass,iconFontColor:"#FFB900"}),M.applicationConversionMap.set(y.b.Stream,{iconFontClass:G.streamIconFontClass,iconFontColor:"#BC1948"}),M.applicationConversionMap.set(y.b.StreamsVideo,{iconFontClass:G.streamIconFontClass,iconFontColor:"#BC1948"}))}ngOnInit(){this.fluentRefresh=this.capabilitiesService.capabilities.fluentRefresh,this.isMicrosoftForms=this.item.fileType===y.b.Forms||this.item.fileType===y.b.FormsQuiz,this.disableFileNavigation=this.item.isDeleted,this.mruItemStateSubscription=this.eventService.events.withScope(0).pipe(Object(m.a)((e=>"mruItemStateChange"===e.name))).subscribe((e=>{e.args[1].docId===this.item.docId&&(0!==e.args[0]&&1!==e.args[0]||(this.mruItemState=e.args[0]))})),this.myAnalyticsState=2,this.uiCardType=this.isMicrosoftForms?"borderless":"normal",this.isCardCreateByLabel=this.isMicrosoftForms;const e=this.mruConfigService.config;this.shortDate=this.windowService.innerWidth<640,this.locService.supportsLocaleSpecifiers&&(this.dateSubscription=this.eventService.events.withScope(1).pipe(Object(m.a)((e=>"contentWidthChanged"===e.name))).subscribe((e=>{let t;[t]=e.args,this.shortDate=t<640}))),this.thumbnailSWEnabled=e.thumbnailSWEnabled,this.permissionsEnabled=e.permissionsEnabled,this.sharedText=this.locService.SharedText,this.privateText=this.locService.OnlyYouText,this.shareActionTitle=this.locService.ShareActionTitle,this.copyLinkActionTitle=this.locService.CopyLinkActionTitle,this.suggestedActionsReplyTitle=this.locService.SuggestedActionReply,this.suggestedActionsMeetingTitle=this.locService.SuggestedActionJoinMeeting,this.suggestedActionsViewChangesTitle=this.locService.SuggestedActionViewChanges,this.suggestedActionsAddToToDoTitle=this.locService.AddToToDo,this.suggestedActionsViewTaskTitle=this.locService.SuggestedActionViewTask,this.dismissSquareRegular=this.domSanitizer.bypassSecurityTrustHtml(s),this.dismissSquareFilled=this.domSanitizer.bypassSecurityTrustHtml(o),this.checklistIcon=this.domSanitizer.bypassSecurityTrustHtml(c),this.meetingIcon=this.domSanitizer.bypassSecurityTrustHtml(l),this.replyIcon=this.domSanitizer.bypassSecurityTrustHtml(a),this.saveAClassNotebook=this.locService.SaveAClassNotebook,this.uploadLocalFileTitle=this.locService.UploadToOneDriveTitle,this.uploadAndOpen=this.locService.PwaUploadAndOpenMenuItem,this.isMobile=this.deviceDetector.isMobileDevice(),this.isTouch=this.isMobile||this.deviceDetector.isTabletDevice(),this.showMobileShareAndActivity=this.mruConfigService.config.mobileShareAndActivityEnabled,this.showOnlyMruActivity=this.item.format===T.a.Recent&&this.mruConfigService.config.onlyMruActivityEnabled,this.mruActivity=this.mruConfigService.config.mruActivityEnabled,this.recommendedDeepLinkEnabled=this.capabilitiesService.capabilities.recommendedDeepLinkEnabled,this.recommendedTeamsLinkEnabled=this.capabilitiesService.capabilities.recommendedTeamsLinkEnabled,this.recommendedMotion=e.recommendedMotionEnabled&&!this.fluentRefresh,this.recommendedNewCards=e.recommendedNewCardsEnabled,this.isStreamsVideo=this.item.format===T.a.StreamsVideo,this.leftNavEnabled=this.capabilitiesService.capabilities.leftNavReact,this.wacHostHoverPrebootEnabled=this.capabilitiesService.wacHostEnabledForFileType(this.item.fileType)&&this.capabilitiesService.wacHostHoverPrebootEnabledForFileType(this.item.fileType),this.dismissItemTitle=this.locService.RemoveDocumentActionTitle,this.isNewTitle=this.locService.IsNewTitle,this.centerThumbnail=this.item.fileType===y.b.PowerPoint,this.mruAppSuffix=this.mruAppType?`-${y.b[this.mruAppType].toLowerCase()}`:"",this.upcomingMeetingAttendeeDisplayMax=e.upcomingMeetingAttendeeDisplayMax,this.isUpcomingMeetingAccepted=this.item.isUpcomingMeetingAccepted,this.addToToDoText=this.locService.AddToToDo,this.viewInToDoText=this.locService.ViewInToDo,this.doneText=this.locService.Done,this.notATaskText=this.locService.NotATask,this.pinActionTitle=this.locService.PinDocumentActionTitle,this.unpinActionTitle=this.locService.UnpinDocumentActionTitle,this.pinActionId="pin_menu",this.unpinActionId="unpin_menu",this.pinActionIcon="PinDown",this.unpinActionIcon="Unpin",this.replacePinActionEnabled&&(this.pinActionTitle=this.locService.FavoriteActionTitle,this.unpinActionTitle=this.locService.UnfavoriteActionTitle,this.pinActionIcon="FavoriteStar",this.unpinActionIcon="Unfavorite"),this.actionContextMenuEnabled&&(this.replacePinActionEnabled?(this.pinActionId="Favorite",this.unpinActionId="Unfavorite",this.pinActionIconReact={type:u.a.ActionContextMenuIcon,iconName:"StarIcon"},this.unpinActionIconReact={type:u.a.ActionContextMenuIcon,iconName:"StarOffIcon"}):(this.pinActionId="pin",this.unpinActionId="unpin",this.pinActionIconReact={type:u.a.ActionContextMenuIcon,iconName:"PinIcon"},this.unpinActionIconReact={type:u.a.ActionContextMenuIcon,iconName:"UnpinIcon"})),this.workloadsPromise=this.workloadsService.getWorkloads(),this.workloadColorPromise=this.workloadsPromise.then((e=>{var t;return(null===(t=null==e?void 0:e.find((e=>e.FileType===this.item.fileType)))||void 0===t?void 0:t.Color)||""})),this.initializeItemFeatures()}ngOnChanges(e){e.hasOwnProperty("item")&&(!e.hasOwnProperty("index")||this.isRecommended||this.isOfficeFeed)&&(this.initializeItemFeatures(),this.isStreamsVideo=this.item.format===T.a.StreamsVideo,this.thumbnailAltText=this.createThumbnailAltText(this.item.fileType)),!e.hasOwnProperty("view")||e.view.firstChange||"Tile"!==e.view.currentValue&&"Card"!==e.view.currentValue||this.isRecommended||this.isOfficeFeed||this.thumbnailLoaded||this.thumbnailUrl||this.mruItemInflationService.inflateThumbnails(this.item).then((()=>{this.thumbnailUrl=this.getThumbnailUrl(),this.onThumbnailLoad(),this.thumbnailAltText=this.createThumbnailAltText(this.item.fileType)}))}ngOnDestroy(){this.dateSubscription&&this.dateSubscription.unsubscribe(),this.mruItemStateSubscription&&this.mruItemStateSubscription.unsubscribe(),this.removeShareControlListeners()}showAsListItem(){return void 0===this.view||"List"===this.view}showAsTile(){return"Tile"===this.view&&this.item.format!==T.a.Trending}showAsCard(){return"Card"===this.view||"Tile"===this.view&&this.item.format===T.a.Trending}showAsSuggestedAction(){return this.capabilitiesService.capabilities.suggestedActionsEnabled&&"SuggestedAction"===this.view}iconFontClass(){const e=M.applicationConversionMap.get(this.item.fileType);return e?e.iconFontClass:null}iconFontColor(){const e=M.applicationConversionMap.get(this.item.fileType);return e?e.iconFontColor:null}onItemClick(e){var t;if(this.disableFileNavigation)return void e.preventDefault();if(e.defaultPrevented)return;this.isOfficeFeed&&this.officeFeedService.logInstrumentation([this.item.feedbackId],["click"],[this.item.fromCache?"cache":"service"]),e.preventDefault();const[n,r]=this.getLaunchUrlAndClickId(this.url),a=this.getClickData(e),o=a.params.ElementId||"Unknown";r&&(a.params.RequestId=r),a.params.IsEmailAttachment=this.item.isEmailAttachment?"true":"false",a.params.IsOnPremOrVanity=this.item.isOnPremOrVanity?"true":"false";let s=!1;const l=(e,t,i,n)=>{if(s)return;s=!0;const r=e?a.params.Referral:"";if(n&&(a.params.ClickDestination="ContentPage"),this.instrumentationService.logClickEvent(a.eventName,o,this.instrumentationArea,r,t,a.params,a.metrics,this.dataSecurityThreshold,i),Object(d.a)({eventName:a.eventName,id:o,area:this.instrumentationArea,subArea:"Document",result:r?"Refer":"Navigate",target:r?Object(p.a)(r):"Other"},this.dataSecurityThreshold),M.isFirstClick&&!this.isRecommended){const e=this.performanceService.getRecordedMarkerNameBySubstring("Paint_MRU");e&&this.performanceService.mark("MRU_First_ItemClick",e),M.isFirstClick=!1}};"_blank"!==this.contextService.sharedContext.defaultLinkTarget&&l(!0,"Web");const c=this.capabilitiesService.wacHostEnabledForFileType(this.item.fileType),u=this.capabilitiesService.capabilities.fluidSupportEnabled&&this.item.fileType===y.b.Fluid,h=y.b.Forms===this.item.fileType?"_self":"_blank",m=()=>{const t=(!this.item.isOnPremOrVanity||this.isConsumer)&&this.accessTokenService.hasOneDriveToken()||this.contextService.sharedContext.inMockMode;if(c&&t||u)if(e.ctrlKey){const e=`/${"launch/:app/content".replace(":app",y.b[this.item.fileType])}`,t=O.a.replacePathAndAddParams(this.windowService.nativeWindow.location.href,e,k.a.getParamsForMruFileItem(this.item,u?{siteUrl:this.item.sharepointIds.siteUrl}:{}));this.urlLauncherService.openUrl(t,"OpenMruItem",h).then((()=>{l(!0,"Web")}),(()=>{l(!1)}))}else{const e=Date.now();u&&(this.fluidInstrumentationService.logPerformanceBootStart(this.fluidHostContext.getBootId()),this.fluidHostContext.hostScenarioLifecycle="Load",this.fluidHostContext.hostScenarioName=this.item.fileType===y.b.Fluid?"Canvas":"MeetingNotes",this.fluidHostContext.hostScenarioEntryPoint="MRU",this.fluidHostContext.hostScenarioStartTime=e),l(!0,"Web",!0,!0),c?this.wacContentService.bootstrapAndRouteMruFileItem(this.item,this.getWdOrigin(!1),void 0,e,this.inflationPromise):this.officeRouteService.navigateTo({route:"Content",app:this.item.fileType},!1,k.a.getParamsForMruFileItem(this.item,u?{siteUrl:this.item.sharepointIds.siteUrl}:{}))}else{if(this.item.fileType===y.b.Pdf&&!this.item.isEmailAttachment){const e=Object(I.h)(this.item);(this.isRecommended||this.isOfficeFeed)&&(e.Application="PdfViewer",e.MruV2Type="DocumentUrl"),this.mruDataService.writeMruDocument(e)}const e=n||this.item.webUrl;this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((t=>{t.launchUrl(e,{action:"OpenMruItem",linkTarget:this.isMicrosoftForms?"_self":void 0}).then((()=>{l(!0,"Web")}),(()=>{l(!1)}))})):this.urlLauncherService.openUrl(e,"OpenMruItem",this.isMicrosoftForms?"_self":null).then((()=>{l(!0,"Web")}),(()=>{l(!1)}))}};this.item.isEmailAttachment||this.capabilitiesService.capabilities.contentLauncherEnabled?(()=>{if(this.capabilitiesService.capabilities.contentLauncherEnabled){const t=this.getOfficeStartDocument();Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((i=>{i.launchContent({action:"OpenMruItem",document:t,linkTarget:this.isPwa||e&&e.ctrlKey?"_blank":y.b.Forms===this.item.fileType||y.b.FormsQuiz===this.item.fileType?"_self":"_blank",useWebUrl:!0,wdOriginType:"REC"}).then((()=>{l(!0,"Web")}),(()=>{l(!1)}))}))}else m()})():this.localAppLauncherService.launchOfficeApp(this.item.application,this.item.canonicalUrl,null).then((e=>e||this.item.isLocal?e:(m(),!0))).then((e=>{e?l(!0,"Native"):(this.openUploadLocalModal(1),l(!1))})).catch((()=>{m()})),"OfficeHome"===(null===(t=this.officeRouteService.getCurrentRoute())||void 0===t?void 0:t.route)&&this.floodgateService.recordFloodgate(["ClickedOnDocument"])}onPathClick(e){e.preventDefault(),this.openFolder();const t=this.getAttributionClickData(),i=t.params.ElementId||"Unknown",n=t.params.Referral;this.instrumentationService.logClickEvent(t.eventName,i,this.instrumentationArea,n,this.item.isLocal?"Native":"Web",t.params,t.metrics,this.dataSecurityThreshold),Object(d.a)({eventName:t.eventName,id:i,area:this.instrumentationArea,subArea:"DocumentPath",result:n?"Refer":"Navigate",target:n?Object(p.a)(n):"Other"},this.dataSecurityThreshold)}onMyAnalyticsClick(e,t){var i,n;e.preventDefault();const r=this.getClickData(e);this.instrumentationService.logClickEvent(r.eventName,r.params.ElementId||"Unknown",this.instrumentationArea);const a=e.target;this.officeFeedService.performAction(this.item.feedbackId,t,this.getActionPayLoadByName(t)),a===(null===(i=this.myAnalyticsAddToDoElement)||void 0===i?void 0:i.nativeElement)?(this.myAnalyticsState=0,this.actionContextMenuEnabled?(this.addToContextMenuReact(this.createViewInToDoActionItemReact()),this.removeFromContextMenuReact(this.addToToDoText)):(this.addToContextMenu(this.createViewInToDoActionItem()),this.removeFromContextMenu(this.addToToDoText)),this.showAsSuggestedAction&&this.setViewInToDoAsPrimaryAction()):a===(null===(n=this.myAnalyticsTaskDoneElement)||void 0===n?void 0:n.nativeElement)&&this.removeItem()}onViewToDoClick(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getToDoUrl(),n=new URL(t),r=`${n.origin}${n.pathname}/inbox${n.search}`;this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((e=>{e.launchUrl(r,{action:"OpenToDoLink"})})):this.urlLauncherService.openUrl(r,"OpenToDoLink"),this.instrumentAction("open",e)}))}disableClick(){event.preventDefault()}onShareClick(e,t,i){if(e&&e.preventDefault(),this.item.isLocal)this.openUploadLocalModal(2);else{if(this.shareControlMode=i,this.showDesktopShareControl=!this.mobileMenusEnabled,this.shareControlLoading=!0,this.currentShareSource=t,this.showDesktopShareControl){const e=e=>{if(!this.shareControlLoading&&this.showDesktopShareControl&&!(e instanceof MouseEvent&&2===e.button)){if(this.shareControl.nativeElement.contains(e.target))return;this.onShareControlDismiss(!1)}},t=e=>{const t=E.a.getKey(e);this.showDesktopShareControl&&3===t&&this.onShareControlDismiss(!0)};this.shareControlClickListener=this.renderer.listen(this.documentService.nativeDocument,"click",e),this.shareControlTouchListener=this.renderer.listen(this.documentService.nativeDocument,"touchend",e),this.shareControlKeyListener=this.renderer.listen(this.documentService.nativeDocument,"keyup",t),setTimeout((()=>this.shareControlLoading=!1),0)}this.mobileMenusEnabled&&(this.shareControlKeyboardFocus=e instanceof KeyboardEvent,this.shareControlService.showControl({file:this.item,index:this.index,mode:this.shareControlMode}),this.shareControlService.subscribeToCloseEvents((e=>{this.item===e.file&&this.index===e.index&&this.onShareControlDismiss(this.shareControlKeyboardFocus)}))),this.instrumentAction(`${b.a[i].toLowerCase()}_${t}`)}}onShareControlDismiss(e){this.showDesktopShareControl=!1,this.removeShareControlListeners(),e&&this.focusOnShareAction(),this.currentShareSource=""}pinItem(e,t){if(this.item.isLocal)return e&&e.preventDefault(),void this.openUploadLocalModal(this.replacePinActionEnabled?3:0);this.updatePinnedState(!0,e,t)}unpinItem(e,t){this.updatePinnedState(!1,e,t)}onThumbnailLoad(){setTimeout((()=>{this.isStreamsVideo?(this.streamsThumbnailLoaded=!0,this.thumbnailLoaded=!1):(this.thumbnailLoaded=!0,this.streamsThumbnailLoaded=!1)})),this.thumbnailInstrumentationService.instrumentThumbnailLoad(!0,this.thumbnailUrl,this.listId,this.index,this.item.fileType)}onThumbnailError(){setTimeout((()=>{this.item.thumbnails=null,this.streamsThumbnailLoaded=!1,this.thumbnailLoaded=!1})),this.thumbnailInstrumentationService.instrumentThumbnailLoad(!1,this.thumbnailUrl,this.listId,this.index,this.item.fileType)}onActionsMenuToggle(e){this.actionsMenuOpen=e,this.recommendedMotion&&(this.isHovered="unhovered")}onFocus(){this.itemFocused=!0}onBlur(){this.itemFocused=!1}onAnalyticsDescriptionChanged(e){this.analyticsDescriptiveAriaLabel=e,this.setDescriptiveAriaLabel()}uploadLocal(e){e&&e.preventDefault(),this.uploadLocalFileService.getLocalFileInfo(this.item.url,this.item.fileName).then((e=>{this.uploadLocalFileService.uploadFile(e,"upload-local-file-commanding")}))}recommendedHover(e){!this.actionsMenuOpen&&this.recommendedMotion&&(this.isHovered=e)}dismissHover(e){this.dismissIsHover=e}getWdOriginTaskForClick(e=!1){return this.isRecommended||this.isOfficeFeed?e?"REC-OIB":"REC":"unpinned-mru"===this.listId?e?"MRU-OIB":"MRU":"OTHER"}onSelectPrimaryAction(e){e&&(e.preventDefault(),"id"in this.primaryAction?this.primaryAction.executeAction():this.primaryAction.executeAction(e))}removeItem(e){e&&e.preventDefault(),this.actionContextMenuEnabled?this.runUnregisteredAction("remove",(()=>this.deleteItem.emit({item:this.item,index:this.index}))):(this.deleteItem.emit({item:this.item,index:this.index}),this.instrumentAction("remove"))}suggestedActionsIcon(){return y.a.documentIconFromType(this.item.fileType,"20x20")}onSuggestedActionsClick(e,t,n,r,a=!1){const o=()=>{this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((i=>{i.launchUrl(e||this.url,{action:t.toString()})})):this.urlLauncherService.openUrl(e||this.url,t),this.instrumentAction(n,r)};if(a){let t;t=this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((t=>t.launchApp({action:"OpenDocument",appName:this.item.application,url:e||this.item.canonicalUrl,useUrl:!0}))):this.localAppLauncherService.launchOfficeApp(this.item.application,e||this.item.canonicalUrl,null),t.then((e=>{e?this.instrumentAction("openInApp",r):o()})).catch((()=>{o()}))}else o()}addToContextMenu(e,t){this.contextMenu&&-1===this.contextMenu.items.findIndex((t=>t.getId()===e.getId()))&&(void 0!==t&&t>=0&&t<this.contextMenu.items.length?this.contextMenu.items.splice(t,0,e):this.contextMenu.items.push(e))}removeFromContextMenu(e){var t,i;const n=this.contextMenu.items.findIndex((t=>t.title===e));-1!==n&&(null===(i=null===(t=this.contextMenu)||void 0===t?void 0:t.items)||void 0===i||i.splice(n,1))}addToContextMenuReact(e,t){if(!this.actionContextMenu)return;const i=this.actionContextMenu.actions.findIndex((t=>t.id===e.id));-1===i&&(this.actionContextMenu.actions=void 0!==t&&t>=0&&t<this.contextMenu.items.length?this.actionContextMenu.actions.slice(0,i).concat(e,this.actionContextMenu.actions.slice(i,this.actionContextMenu.actions.length)):this.actionContextMenu.actions.concat(e))}removeFromContextMenuReact(e){const t=this.actionContextMenu.actions.findIndex((t=>t.title===e));-1!==t&&(this.actionContextMenu.actions=this.actionContextMenu.actions.slice(0,t).concat(this.actionContextMenu.actions.slice(t+1,this.actionContextMenu.actions.length)))}getDisplayTime(){return this.item.format===T.a.Shared||this.item.format===T.a.SharedForm?this.item.sharedTime>new Date("1980-01-01T00:00:00Z")?this.item.sharedTime:null:this.item.format===T.a.Trending||this.item.format===T.a.ClassNoteBook||this.item.format===T.a.NoteBook||this.item.format===T.a.Form||this.item.format===T.a.MyAnalytics?this.item.lastModifiedTime:this.item.lastViewedTime}openUploadLocalModal(e){this.uploadLocalFileService.showModal(this.item.url,this.item.fileName,e)}onAddToDoCallback(e=!1,t=!0,i){t&&(this.capabilitiesService.capabilities.contentActionsEnabled&&(e?this.contentActionsService.createToDoSuccessNotification((()=>{this.onViewToDoClick(i)})):this.contentActionsService.createToDoErrorNotification()),this.maybeAddViewTodo(e))}maybeAddViewTodo(e){e&&(this.myAnalyticsState=0,this.actionContextMenuEnabled?(this.addToContextMenuReact(this.createViewInToDoActionItemReact()),this.removeFromContextMenuReact(this.addToToDoText)):(this.addToContextMenu(this.createViewInToDoActionItem()),this.removeFromContextMenu(this.addToToDoText)),this.showAsSuggestedAction&&this.setViewInToDoAsPrimaryAction())}initializeItemFeatures(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){this.isMicrosoftForms&&this.initializeFormsFeature();const e=this.mruConfigService.config;this.showSharing=this.showSharing&&!(this.mruAppType===y.b.OneNote&&(T.a.Shared===this.item.format||T.a.ClassNoteBook===this.item.format||T.a.NoteBook===this.item.format))&&!(this.isMicrosoftForms&&this.item.format===T.a.Shared),this.isRecommended=this.item.format===T.a.Recommended,this.isOfficeFeed=this.item.format===T.a.News||this.item.format===T.a.OfficeFeedDocument||this.item.format===T.a.StreamsVideo||this.item.format===T.a.UpcomingMeeting||this.item.format===T.a.MyAnalytics,this.isNewsArticle=this.item.format===T.a.News,this.isUpcomingMeeting=this.item.format===T.a.UpcomingMeeting,this.isMyAnalytics=this.item.format===T.a.MyAnalytics,this.instrumentationArea=this.showAsSuggestedAction()?S.b.SuggestedActions:this.isRecommended||this.isOfficeFeed?S.b.Recommended:S.b.Documents,this.url=e.webUrlMruConsumerEnabled&&this.isConsumer&&this.item.webUrl?this.item.webUrl:this.item.url;const t=this.item.fileType!==y.b.Sway&&this.item.fileType!==y.b.Project&&this.item.fileType!==y.b.ProjectOperations,i=F.a.Format(this.item.isEmailAttachment&&this.item.emailReference&&this.item.emailReference.Subject?[this.item.emailReference.Subject]:this.item.isEmailAttachment?[this.locService.OpenFileLocationActionTitle]:this.item.pathArray,this.contextService.isRtl,M.shortPathCharacterLimit);this.shortPath=t?i[1]:null,this.plainTextPath=t?i[0]:null,this.openFolderAriaLabel=this.item.isEmailAttachment?this.locService.OpenFileLocationActionTitle:this.locService.format(this.locService.OpenFileLocationActionWithLocationTitle,this.plainTextPath),this.displayTime=this.getDisplayTime(),this.displayTimeString=this.displayTime?this.locService.localizedDateString(this.displayTime):null,this.shareControlEnabled=e.shareControlEnabled&&this.item.fileType!==y.b.PowerBI&&this.item.fileType!==y.b.Project&&this.item.fileType!==y.b.ProjectOperations&&this.item.fileType!==y.b.Portfolio&&this.item.fileType!==y.b.Sway&&this.item.fileType!==y.b.Forms&&this.item.fileType!==y.b.StreamsVideo&&!(this.item.format===T.a.Shared&&this.item.isEmailAttachment)&&this.item.format!==T.a.UpcomingMeeting&&this.item.fileType!==y.b.MyAnalytics,this.copyLinkEnabled=e.copyLinkEnabled&&this.shareControlEnabled,this.mruPinEnabled=e.mruPinEnabled&&this.item.format===T.a.Recent,this.clickableFolderEnabled=e.clickableFolderEnabled&&!!this.item.attributionUrl,this.actionContextMenuEnabled?yield this.setupActionsMenuReact():this.setupActionsMenu(),this.updateAnimation(this.item),this.setDescriptiveAriaLabel(),this.thumbnailLoaded=this.thumbnailUrl&&this.thumbnailUrl===this.getThumbnailUrl(),this.dataSecurityThreshold=this.item.isLocal?2:0,this.activityDeepLink=this.recommendedDeepLinkEnabled&&this.item.navigationId?this.addLoginHint(`${this.url}&nav=${this.item.navigationId}`):void 0,this.teamsDeepLink=this.recommendedTeamsLinkEnabled&&this.item.teamsDeepLink,this.inflationPromise=this.mruItemInflationService.inflateItem(this.item,"Card"===this.view||"Tile"===this.view,this.showAnalytics,this.mruAppType),this.inflationPromise.then((e=>{this.updateAnimation(e),this.thumbnailUrl=this.getThumbnailUrl(),this.thumbnailLoaded=!!this.thumbnailUrl,this.setBorderlessCardDetail1(),this.setDescriptiveAriaLabel(),this.capabilitiesService.wacHostEnabledForFileType(this.item.fileType)&&this.item.wopiData&&this.item.wopiData.wac&&this.item.wopiData.wac.bootstrapperUrl&&this.uiHostBootstrapperService.loadBootstrapper(this.item.wopiData.wac.bootstrapperUrl,this.item.wopiData.wac.applicationUrl,this.item.fileType,!0).then((()=>{var e;"Start"===(null===(e=this.officeRouteService.getCurrentRoute())||void 0===e?void 0:e.route)&&this.wacContentService.prebootApplication(this.item.fileType,this.contextService.getWdOrigin("PREBOOT"))})),this.updateActionItemsOnInflated()}))}))}initializeFormsFeature(){this.isFormResponsesEnabled=this.mruAppType===y.b.Forms,this.formEnumType=this.item.getFormEnumType(),this.categoryIcon={},"poll"===this.formEnumType?(this.categoryIcon.categoryFontIcon=v.a.PollResults,this.categoryIcon.categoryTooltip=this.locService.FormsPoll):"assignments"===this.formEnumType&&(this.categoryIcon.categoryFontIcon=v.a.AccountActivity,this.categoryIcon.categoryTooltip=this.locService.FormsAssignment)}updateActionItemsOnInflated(){this.mruItemService.updateActionItemsOnInflated(this.index,this.item,this.isConsumer).forEach(this.actionContextMenuEnabled?e=>{this.actionContextMenu.actions=this.actionContextMenu.actions.filter((t=>t.id!==e.item.id));const t=[...this.actionContextMenu.actions];t.splice(e.start,e.deleteCount,this.wrapAdditionalActionReact(e.item)),this.actionContextMenu.actions=t}:e=>{this.contextMenu.items=this.contextMenu.items.filter((t=>t.getId()!==e.item.id)),this.contextMenu.items.splice(e.start,e.deleteCount,this.wrapAdditionalAction(e.item))})}setBorderlessCardDetail1(){this.isMicrosoftForms&&(this.borderlessCardDetail1=this.item.metaData&&null!=this.item.metaData.formsResponseCount?this.locService.format(this.locService.ResponsesText,this.item.metaData.formsResponseCount.toString()):"")}setDescriptiveAriaLabel(){const e=[this.locService.format(this.locService.DocumentDescriptiveAriaLabelTitle,this.item.title)];this.showSharing&&this.item.sharing&&e.push(this.locService.format(this.item.sharing.shared?this.locService.DocumentDescriptiveAriaLabelShared:this.locService.DocumentDescriptiveAriaLabelPrivate,this.item.fileTypeName));const t=this.buildDescriptiveDate();if(t&&e.push(t),this.showActivity&&!this.isRecommended&&!this.isOfficeFeed){const t=this.activityDescriptionService.activityDescription(this.item.activities,this.item.lastViewedTime,!1);e.push(t&&t.plainText?this.locService.format(this.locService.DocumentDescriptiveAriaLabelActivity,t.plainText):this.locService.DocumentDescriptiveAriaLabelNoActivity)}this.showAnalytics&&this.analyticsDescriptiveAriaLabel&&e.push(this.analyticsDescriptiveAriaLabel),this.isCardCreateByLabel&&(this.item.createdBy&&e.push(this.locService.format(this.locService.DocumentDescriptiveAriaLabelCreatedBy,this.item.createdBy)),this.item.metaData&&null!=this.item.metaData.formsResponseCount&&e.push(this.locService.format(this.locService.DocumentDescriptiveAriaLabelNumResponses,this.item.metaData.formsResponseCount.toString()))),this.descriptiveAriaLabel=e.join(" ")}buildDescriptiveDate(){const e=this.responsiveRelativeDatePipe.transform(this.displayTime,!1,this.displayTimeString,!1);let t=e;if(e)switch(this.item.format){case T.a.Trending:t=this.locService.format(this.locService.DocumentDescriptiveAriaLabelLastModified,e);break;case T.a.Shared:t=this.locService.format(this.locService.DocumentDescriptiveAriaLabelDateShared,e);break;case T.a.Recommended:case T.a.News:case T.a.OfficeFeedDocument:t=this.item.activity&&this.item.activity.plainText?this.item.activity.plainText+e:"";break;default:t=this.locService.format(this.locService.DocumentDescriptiveAriaLabelLastOpened,e)}return t}focusOnShareAction(){"topLevel"===this.currentShareSource?this.shareTopLevelElement.nativeElement.focus():this.actionsMenuElement.dropdownMenu.dropdownLink.nativeElement.focus()}removeShareControlListeners(){this.shareControlClickListener&&this.shareControlClickListener(),this.shareControlTouchListener&&this.shareControlTouchListener(),this.shareControlKeyListener&&this.shareControlKeyListener()}updateAnimation(e){this.isNew=e.isNew,this.isNewAnimationState=this.isNew?"active":"inactive"}updatePinnedState(e,t,i){if(t&&t.preventDefault(),this.item.lastViewedTime=this.dateService.getCurrentDate(),this.displayTime=this.getDisplayTime(),this.displayTimeString=this.displayTime?this.locService.localizedDateString(this.displayTime):null,this.changePinState.emit({item:this.item,isPinned:e,element:this.mruListItem,index:this.index}),this.actionContextMenuEnabled){if(!("id"in this.pinAction)||!("id"in this.unpinAction))return;const t=this.actionContextMenu.actions.findIndex((t=>t.id===(e?this.pinActionId:this.unpinActionId)));if(-1===t)return;this.actionContextMenu.actions=this.actionContextMenu.actions.slice(0,t).concat(e?this.unpinAction:this.pinAction,this.actionContextMenu.actions.slice(t+1,this.actionContextMenu.actions.length))}else{if(!("getId"in this.pinAction)||!("getId"in this.unpinAction))return;const t=this.contextMenu.items.findIndex((t=>t.getId()===(e?this.pinActionId:this.unpinActionId)));if(-1===t)return;this.contextMenu.items[t]=e?this.unpinAction:this.pinAction,this.instrumentAction(`${e?"pin":"unpin"}_${i}`)}this.itemFocused=!1}setupActionsMenuReact(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const e=this.mruConfigService.config;this.item.downloadUrl=this.item.documentUrl;const t=this.showAsSuggestedAction()?"SuggestedActions":this.isRecommended||this.isOfficeFeed?"Recommended":"Documents",i=`${this.listId}-${this.item.id}`;let n=yield this.contentActionsService.createDocumentActions(this.item,i,t,this.listId);const r=yield this.contentActionsService.getContentActionsGroupInfo();if(this.item.isLocal&&(n=n.concat(this.createUploadActionItemReact())),this.item.format===T.a.Recent&&this.mruPinEnabled){let e;this.createPinUnpinActionItemsReact(),e=this.item.isPinned?this.unpinAction:this.pinAction,n=n.concat(e)}if(!this.item.isLocal&&(this.item.format===T.a.Recent||(this.isRecommended||this.isOfficeFeed&&!this.isMyAnalytics)&&e.recommendedRemoveItemEnabled)){const e=this.createRemoveActionItemReact();n=n.concat(e)}this.item.format===T.a.ClassNoteBook&&(n=n.concat(this.createCopyClassNoteBookActionItemReact())),this.mruItemService.generateAdditionalActionsMenuItems(this.index,this.item,this.isConsumer).forEach((e=>{n=n.concat(this.wrapAdditionalActionReact(e))})),this.item.fileType===y.b.MyAnalytics&&this.item.potentialAction.forEach((e=>{const t=e.name,i=this.getTextByActionType(t);n=n.concat({id:t,title:i,ariaLabel:i,contentActionOptions:{icon:this.getIconReactByActionType(t)},executeAction:()=>{this.executeFeedAction(t,this.item.feedbackId,t,e.actionPayload),t!==g.a.DismissAction&&t!==g.a.MarkAsNotATask&&t!==g.a.MarkTaskAsDone||this.removeItem()},disabled:!1})})),this.actionContextMenu={id:this.getContextMenuId(),itemIndex:this.index,actions:n,groupInfo:r,mouseEvent:void 0,targetElement:void 0},this.showActionsMenu=n.length>0,this.contextMenu={id:this.getContextMenuId(),items:[]},this.showAsSuggestedAction()&&this.item.activity&&this.item.activity.reasonType&&this.setupPrimaryAction()}))}setupActionsMenu(){var e;const t=this.mruConfigService.config,n=M.applicationConversionMap.get(this.item.fileType),r=t.newMruActions&&n;let a;if(this.item.isEmailAttachment){const o=this.item.format===T.a.OfficeFeedDocument||1===this.item.emailReference.AttachmentType?this.locService.OpenInOutlookActionTitle:this.locService.format(this.locService.OpenOnlineActionTitle,this.item.application);return a=[{getId:()=>"open",title:o,ariaLabel:o,iconCssClass:r?n.iconFontClass:"",icon:r?null:v.a.FolderOpen,iconColor:r?n.iconFontColor:null,executeAction:()=>{this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((e=>{e.launchUrl(this.url,{action:"OpenAttachment"})})):this.urlLauncherService.openUrl(this.url,"OpenAttachment"),this.instrumentAction("open")}}],this.shareControlEnabled&&1!==(null===(e=this.item.emailReference)||void 0===e?void 0:e.AttachmentType)&&this.getShareControlElements(a),(this.isRecommended||this.isOfficeFeed&&!this.isMyAnalytics)&&t.recommendedRemoveItemEnabled&&a.push(this.createRemoveActionItem()),this.showActionsMenu=!0,this.contextMenu={id:this.getContextMenuId(),items:a,customLogging:!0,cssClass:M.actionsMenuCssClass},this.primaryAction=a[0],void(this.primaryActionIconFont=v.a.FolderOpen)}a=[],this.disableFileNavigation||this.item.fileType===y.b.MyAnalytics||a.push({getId:()=>"open",title:this.isUpcomingMeeting?this.locService.OpenInCalendar:this.locService.OpenInBrowser,ariaLabel:this.isUpcomingMeeting?this.locService.OpenInCalendar:this.locService.OpenInBrowser,iconCssClass:r?n.iconFontClass:"",icon:r?null:this.isUpcomingMeeting?v.a.Calendar:v.a.FolderOpen,iconColor:r?n.iconFontColor:null,executeAction:this.item.isLocal?()=>this.openUploadLocalModal(1):()=>{var e;const[t]=this.getLaunchUrlAndClickId(null!==(e=this.item.webUrl)&&void 0!==e?e:this.url,!0);this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((e=>{e.launchUrl(t,{action:"OpenFile"})})):this.urlLauncherService.openUrl(t,"OpenFile"),this.instrumentAction("open")},disabled:this.item.isLocal}),this.item.isLocal&&a.push(this.createUploadActionItem()),this.shareControlEnabled&&(this.showDesktopShareControl=!1,this.getShareControlElements(a));const o=this.item.fileType!==y.b.PowerBI&&this.item.fileType!==y.b.Sway&&this.item.fileType!==y.b.OneNote&&this.item.fileType!==y.b.Forms&&this.item.fileType!==y.b.Project&&this.item.fileType!==y.b.ProjectOperations&&this.item.fileType!==y.b.Portfolio&&this.item.fileType!==y.b.StreamsVideo&&this.item.format!==T.a.UpcomingMeeting&&this.item.format!==T.a.MyAnalytics;if(t.newMruActions){if(n&&n.nativeUriScheme){const e=this.deviceDetector.isDesktopDevice()?this.locService.OpenInDesktopApp:this.deviceDetector.isMobileDevice()||this.deviceDetector.isTabletDevice()?this.locService.OpenInApp:this.locService.OpenActionTitle;a.splice(1,0,{getId:()=>"openInApp",title:e,ariaLabel:e,iconCssClass:r?n.iconFontClass:"",icon:r?null:v.a.FolderOpen,iconColor:r?n.iconFontColor:null,executeAction:()=>{this.localAppLauncherService.launchOfficeApp(this.item.application,this.item.canonicalUrl).then((e=>{if(!e){if(!this.item.isLocal)throw new Error("fallback to protocol handler");{const e=`${n.nativeUriScheme}${this.item.canonicalUrl}`;this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((t=>{t.launchUrl(e,{action:"OpenInApp",linkTarget:"_self"}).catch((()=>{this.openUploadLocalModal(1)}))})):this.urlLauncherService.openUrl(e,"OpenInApp","_self").catch((()=>{this.openUploadLocalModal(1)}))}}})).catch((()=>{const e=this.item.canonicalUrl.lastIndexOf("?");let t=this.item.canonicalUrl;e>0&&(t=t.substring(0,e));const r=`${n.nativeUriScheme}${t}`;this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((e=>{e.launchUrl(r,{action:"OpenInApp",linkTarget:"_self"})})):this.urlLauncherService.openUrl(r,"OpenInApp","_self")})),this.instrumentAction("openInApp")}})}this.downloadActionEnabled&&o&&t.showDownloadAction&&!this.item.isLocal&&this.item.format!==T.a.News&&this.item.fileType!==y.b.Fluid&&!Object(_.a)(this.item.fileType)&&this.item.driveId&&this.item.documentUrl&&a.push({getId:()=>"download",title:this.locService.DownloadMruItemActionTitle,ariaLabel:this.locService.DownloadMruItemActionTitle,icon:v.a.Download,executeAction:()=>{this.oneDriveService.getDownloadUrl({driveId:this.item.driveId,itemId:this.item.docId,itemUrl:this.item.documentUrl}).then((e=>{if(!e)throw new Error("Empty download url");return e})).catch((e=>(this.instrumentationService.logGenericEvent("Get_DownloadUrl_Error",{Error:(null==e?void 0:e.toString())||"",Area:this.instrumentationArea}),Object(h.a)({eventName:"Get_DownloadUrl_Error",message:(null==e?void 0:e.toString())||"",debugInfo:this.instrumentationArea}),this.item.documentUrl))).then((e=>{this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((t=>{t.launchUrl(e,{action:"Download"})})):this.urlLauncherService.openUrl(e,"Download"),this.instrumentAction("download")}))}}),o&&a.push({getId:()=>"openFileLocation",title:this.locService.OpenFileLocationActionTitle,ariaLabel:this.openFolderAriaLabel,icon:v.a.Folder,executeAction:()=>{this.openFolder(),this.instrumentAction("openFileLocation")}})}if(this.item.format===T.a.Recent&&this.mruPinEnabled){let e;this.createPinUnpinActionItems(),e=this.item.isPinned?this.unpinAction:this.pinAction,t.newMruActions&&o?a.splice(a.length-(this.item.isLocal?1:2),0,e):a.push(e)}if(!this.item.isLocal&&(this.item.format===T.a.Recent||(this.isRecommended||this.isOfficeFeed&&!this.isMyAnalytics)&&t.recommendedRemoveItemEnabled)){const e=this.createRemoveActionItem();t.newMruActions&&o?a.splice(a.length-1,0,e):a.push(e)}this.item.format===T.a.ClassNoteBook&&a.push(this.createCopyClassNoteBookActionItem()),this.mruItemService.generateAdditionalActionsMenuItems(this.index,this.item,this.isConsumer).forEach((e=>a.push(this.wrapAdditionalAction(e)))),this.item.fileType===y.b.MyAnalytics&&(a.push({getId:()=>"open",title:this.locService.OpenInOutlookActionTitle,ariaLabel:this.locService.OpenInOutlookActionTitle,icon:v.a.Outlook,executeAction:()=>{var e;const[t]=this.getLaunchUrlAndClickId(null!==(e=this.item.webUrl)&&void 0!==e?e:this.url,!0);this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((e=>{e.launchUrl(t,{action:"OpenFile"})})):this.urlLauncherService.openUrl(t,"OpenFile"),this.instrumentAction("open")},disabled:!1}),this.item.potentialAction.forEach((e=>{const t=this.getTextByActionType(e.name),i=e.name;a.push({getId:()=>i,title:t,ariaLabel:t,icon:this.getIconByActionType(e.name),executeAction:()=>{this.executeFeedAction(i,this.item.feedbackId,i,e.actionPayload),i!==g.a.DismissAction&&i!==g.a.MarkAsNotATask&&i!==g.a.MarkTaskAsDone||this.removeItem(),this.instrumentAction(i)},disabled:!1})}))),this.showActionsMenu=!(1===a.length&&"open"===a[0].getId()),this.contextMenu={id:this.getContextMenuId(),items:a,customLogging:!0,cssClass:(this.leftNavEnabled?"actions-menu--left-nav ":"")+M.actionsMenuCssClass+(this.isTouch&&(this.isRecommended||this.isOfficeFeed)?" actions-menu--mobile":"")},this.showAsSuggestedAction()&&this.item.activity&&this.item.activity.reasonType&&this.setupPrimaryAction()}setupPrimaryAction(){switch(this.item.activity.reasonType){case f.a.MyAnalytics:this.primaryAction={title:this.addToToDoText,ariaLabel:this.addToToDoText,getId:()=>"suggestedActionsAddToToDo",executeAction:()=>{this.executeFeedAction("add_todo",this.item.feedbackId,g.a.PromoteTask,this.getActionPayLoadByName(g.a.PromoteTask),"add_todo")}},this.primaryActionIconFont=v.a.ToDo;break;case f.a.Task:this.primaryAction={title:this.suggestedActionsViewTaskTitle,ariaLabel:this.suggestedActionsViewTaskTitle,getId:()=>"suggestedActionsViewTask",executeAction:()=>Object(n.__awaiter)(this,void 0,void 0,(function*(){this.onSuggestedActionsClick(this.activityDeepLink,"OpenFile","open","view_task",!0)}))},this.showListSvg=!0;break;case f.a.Comment:case f.a.Mention:this.primaryAction={title:this.suggestedActionsReplyTitle,ariaLabel:this.suggestedActionsReplyTitle,getId:()=>"suggestedActionsReply",executeAction:()=>{this.onSuggestedActionsClick(this.activityDeepLink,"OpenFile","open","reply",!0)}},this.showReplySvg=!0;break;case f.a.Edit:case f.a.Trending:this.primaryAction={title:this.suggestedActionsViewChangesTitle,ariaLabel:this.suggestedActionsViewChangesTitle,getId:()=>"suggestedActionsViewChanges",executeAction:()=>{this.onSuggestedActionsClick(this.activityDeepLink,"OpenFile","open","view_changes",!0)}},this.primaryActionIconFont=v.a.Pencil;break;case f.a.Meeting:this.primaryAction={title:this.suggestedActionsMeetingTitle,ariaLabel:this.suggestedActionsMeetingTitle,getId:()=>"suggestedActionsMeeting",executeAction:()=>{this.onSuggestedActionsClick(this.item.joinUrl,"OpenTeamsMeeting","join_meeting","upcoming_meeting")}},this.showMeetingSvg=!0;break;default:this.primaryAction=this.actionContextMenuEnabled?this.actionContextMenu.actions[0]:this.contextMenu.items[0],this.primaryActionIconFont=v.a.Compass}}getTextByActionType(e){let t="";switch(e){case g.a.DismissAction:t=this.locService.RemoveDocumentActionTitle;break;case g.a.PromoteTask:t=this.addToToDoText;break;case g.a.MarkAsNotATask:t=this.notATaskText;break;case g.a.MarkTaskAsDone:t=this.doneText;break;default:t=""}return t}getIconByActionType(e){let t=v.a.ToDo;switch(e){case g.a.DismissAction:t=v.a.Minus;break;case g.a.PromoteTask:t=v.a.ToDo;break;case g.a.MarkAsNotATask:t=v.a.X;break;case g.a.MarkTaskAsDone:t=v.a.CheckMark;break;default:t=v.a.ToDo}return t}getIconReactByActionType(e){switch(e){case g.a.DismissAction:return{type:u.a.ActionContextMenuIcon,iconName:"SubtractIcon"};case g.a.PromoteTask:return{type:u.a.Svg,iconName:"ToDoSvgIcon"};case g.a.MarkAsNotATask:return{type:u.a.ActionContextMenuIcon,iconName:"DismissIcon"};case g.a.MarkTaskAsDone:return{type:u.a.ActionContextMenuIcon,iconName:"CheckmarkIcon"};default:return{type:u.a.Svg,iconName:"ToDoSvgIcon"}}}getIconReactByIconFontType(e){switch(e){case v.a.Copy:return{type:u.a.ActionContextMenuIcon,iconName:"CopyIcon"};case v.a.Delete:return{type:u.a.ActionContextMenuIcon,iconName:"DeleteIcon"};case v.a.Move:return{type:u.a.ActionContextMenuIcon,iconName:"MoveFolderIcon"};case v.a.Restore:return{type:u.a.ActionContextMenuIcon,iconName:"RestoreIcon"};case v.a.Unpin:return{type:u.a.ActionContextMenuIcon,iconName:"UnpinIcon"};default:return{type:u.a.ActionContextMenuIcon,iconName:"DocumentIcon"}}}getShareControlElements(e){e.push({getId:()=>"share",title:this.shareActionTitle,ariaLabel:this.shareActionTitle,icon:v.a.Share2,executeAction:e=>{this.onShareClick(e,"menu",b.a.Share)},disabled:this.item.isLocal}),this.copyLinkEnabled&&e.push({getId:()=>"copylink",title:this.copyLinkActionTitle,ariaLabel:this.copyLinkActionTitle,icon:v.a.Link,executeAction:e=>{this.onShareClick(e,"menu",b.a.CopyLink)},disabled:this.item.isLocal}),this.item.isOnPremOrVanity||this.shareControlService.getToken(this.item.documentUrl,!1,this.item.fileType)}createCopyClassNoteBookActionItem(){return{getId:()=>"copyClassNoteBook",title:this.locService.SaveAClassNotebook,ariaLabel:this.saveAClassNotebook,icon:v.a.Save,executeAction:()=>{this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((e=>{e.launchUrl(this.onenoteService.generateSaveCopyClassNotebookLink(this.item.docId,this.item.fileName,this.url),{action:"CopyNotebook",linkTarget:"_NewSaveCopyWindow",width:500,height:500})})):this.urlLauncherService.openUrl(this.onenoteService.generateSaveCopyClassNotebookLink(this.item.docId,this.item.fileName,this.url),"CopyNotebook","_NewSaveCopyWindow",500,500),this.instrumentAction("copyClassNoteBook")}}}createCopyClassNoteBookActionItemReact(){return{id:"copyClassNoteBook",title:this.locService.SaveAClassNotebook,ariaLabel:this.saveAClassNotebook,contentActionOptions:{icon:{type:u.a.ActionContextMenuIcon,iconName:"SaveIcon"}},executeAction:()=>{this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((e=>{e.launchUrl(this.onenoteService.generateSaveCopyClassNotebookLink(this.item.docId,this.item.fileName,this.url),{action:"CopyNotebook",linkTarget:"_NewSaveCopyWindow",width:500,height:500})})):this.urlLauncherService.openUrl(this.onenoteService.generateSaveCopyClassNotebookLink(this.item.docId,this.item.fileName,this.url),"CopyNotebook","_NewSaveCopyWindow",500,500),this.instrumentAction("copyClassNoteBook")},disabled:!1}}createPinUnpinActionItems(){this.pinAction={getId:()=>this.pinActionId,title:this.pinActionTitle,ariaLabel:this.pinActionTitle,icon:v.a[this.pinActionIcon],executeAction:()=>this.pinItem(null,"menu"),disabled:this.item.isLocal},this.unpinAction={getId:()=>this.unpinActionId,title:this.unpinActionTitle,ariaLabel:this.unpinActionTitle,icon:v.a[this.unpinActionIcon],executeAction:()=>this.unpinItem(null,"menu"),disabled:this.item.isLocal}}createPinUnpinActionItemsReact(){this.pinAction={id:this.pinActionId,title:this.pinActionTitle,ariaLabel:this.pinActionTitle,contentActionOptions:{icon:this.pinActionIconReact},executeAction:()=>this.runUnregisteredAction(this.pinActionId,(()=>this.pinItem(null,"menu"))),disabled:this.item.isLocal},this.unpinAction={id:this.unpinActionId,title:this.unpinActionTitle,ariaLabel:this.unpinActionTitle,contentActionOptions:{icon:this.unpinActionIconReact},executeAction:()=>this.runUnregisteredAction(this.unpinActionId,(()=>this.unpinItem(null,"menu"))),disabled:this.item.isLocal}}createRemoveActionItem(){return{getId:()=>"remove",title:this.locService.RemoveDocumentActionTitle,ariaLabel:this.locService.RemoveDocumentActionTitle,icon:v.a.Minus,executeAction:()=>this.removeItem()}}createRemoveActionItemReact(){return{id:"remove",title:this.locService.RemoveDocumentActionTitle,ariaLabel:this.locService.RemoveDocumentActionTitle,contentActionOptions:{icon:{type:u.a.ActionContextMenuIcon,iconName:"SubtractIcon"}},executeAction:()=>this.removeItem(),disabled:!1}}createUploadActionItem(){return{getId:()=>"upload",title:this.uploadAndOpen,ariaLabel:this.uploadAndOpen,icon:v.a.Upload,executeAction:()=>{this.uploadLocal()}}}createUploadActionItemReact(){return{id:"upload",title:this.uploadAndOpen,ariaLabel:this.uploadAndOpen,contentActionOptions:{icon:{type:u.a.ActionContextMenuIcon,iconName:"UploadIcon"}},executeAction:()=>this.runUnregisteredAction("upload",this.uploadLocal),disabled:!1}}createViewInToDoActionItem(e){return{getId:()=>"todo",title:this.viewInToDoText,ariaLabel:this.viewInToDoText,icon:v.a.ToDo,executeAction:()=>{this.onViewToDoClick(e)},disabled:!1}}createViewInToDoActionItemReact(e){return{id:"todo",title:this.viewInToDoText,ariaLabel:this.viewInToDoText,contentActionOptions:{icon:{type:u.a.Svg,iconName:"ToDoSvgIcon"}},executeAction:()=>this.runUnregisteredAction("todo",(()=>this.onViewToDoClick(e))),disabled:!1}}setViewInToDoAsPrimaryAction(){this.primaryAction=this.createViewInToDoActionItem("view_todo"),this.primaryActionIconFont=v.a.ToDo}getContextMenuId(){return`${this.listId}-${this.item.id}`}executeFeedAction(e,t,i,n,r){const a=i===g.a.PromoteTask;this.actionContextMenuEnabled?this.runUnregisteredAction(e,(()=>{this.officeFeedService.performAction(t,i,n).then((e=>{this.onAddToDoCallback(e,a,r)})).catch((e=>{this.onAddToDoCallback(!1,a,r)}))})):this.officeFeedService.performAction(t,i,n).then((e=>{this.onAddToDoCallback(e,a,r)})).catch((e=>{this.onAddToDoCallback(!1,a,r)}))}runUnregisteredAction(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const{referral:i,referralPlatform:n}=this.maybeGetReferralAndPlatform(e);this.contentActionsService.runUnregisteredAction(e,t,this.instrumentationArea,this.getInstrumentationParams(),i,n)}))}getClickData(e){const t=this.showAsSuggestedAction()?"Suggested_Action_Click":this.isRecommended||this.isOfficeFeed?"Recommended_Click":"Mru_Click",i=this.item.getClickData(t,"Click",this.index),n=e.target;if(i.params.ItemId=this.titleElement&&n===this.titleElement.nativeElement?"title":this.fileIconElement&&n===this.fileIconElement.nativeElement?"icon":this.attributionElement&&n===this.attributionElement.nativeElement?"attribution":this.timestampElement&&n===this.timestampElement.nativeElement?"timestamp":this.myAnalyticsTaskDoneElement&&n===this.myAnalyticsTaskDoneElement.nativeElement?"taskDoneLink":this.myAnalyticsAddToDoElement&&n===this.myAnalyticsAddToDoElement.nativeElement?"addToDoLink":"item",void 0!==this.relativeIndex&&(i.params.RelativeIndex=this.relativeIndex.toString()),i.params.ItemCategory=this.listId,i.params.State=this.view,i.params.ResourceId=this.item.resourceId,this.activityEnabled){const e=this.item.activities||[],t=this.activityDescriptionService.filterActivities(e,this.item.lastViewedTime)||[];i.params.ActivityCommentsCount=t.filter((e=>e.action.type===w.a.Comment)).length.toString(),i.params.ActivityEditsCount=t.filter((e=>e.action.type===w.a.Edit)).length.toString(),i.params.ActivityMentionsCount=t.filter((e=>e.action.type===w.a.Mention)).length.toString(),i.params.ActivityTotalCount=e.length.toString(),i.params.ActivityCountSinceLastOpened=t.length.toString(),i.params.ActivityCollaboration=this.getActivityCollab(),i.params.ActivityDisplayed=w.a[this.activityDescriptionService.displayedActivityType(t,this.item.lastViewedTime,!1)]}return i.params.ClickDestination="ExternalPage",i}getAttributionClickData(){const e=this.item.getClickDataForPath("Mru_Path_Click","Click",this.index);return e.params.ItemCategory=this.listId,e.params.ResourceId=this.item.resourceId,e}getInstrumentationParams(e){const t={};return t.RenderSize=this.contextMenu.items.length.toString(),t.Index=this.index.toString(),t.DocumentType=this.item.fileTypeName,t.ItemCategory=this.listId,t.Pinned=this.item.isPinned.toString(),t.State=this.view,t.ResourceId=this.item.resourceId,t.ActivityCollaboration=this.getActivityCollab(),t.SuggestedActionType=e,void 0!==this.relativeIndex&&(t.RelativeIndex=this.relativeIndex.toString()),t}maybeGetReferralAndPlatform(e){let t,i=null;return"open"===e||"openInApp"===e?(i=T.b.referralFromFileType(this.item.fileType),t="open"===e?"Web":"Native"):"openFileLocation"===e&&(i=T.b.referralFromFileLocation(this.url),t=this.item.isLocal?"Native":"Web"),{referral:i,referralPlatform:t}}instrumentAction(e,t){const i=this.getInstrumentationParams(t),{referral:n,referralPlatform:r}=this.maybeGetReferralAndPlatform(e);if(this.item.format===T.a.OfficeFeedDocument||this.item.format===T.a.News||this.item.format===T.a.UpcomingMeeting){let t="click";switch(e){case"copylink_menu":t="copyLink";break;case"share_menu":t="share"}"join_meeting"===e?this.officeFeedService.logInstrumentation([this.item.feedbackId],[t],[this.item.fromCache?"cache":"service"],["joinMeeting"]):"remove"!==e&&"myAnalyticsInsight"!==this.item.mruV2Category&&this.officeFeedService.logInstrumentation([this.item.feedbackId],[t],[this.item.fromCache?"cache":"service"])}this.instrumentationService.logClickEvent("Actions_Menu_Item_Click",e,this.instrumentationArea,n,r,i,[],this.dataSecurityThreshold),Object(d.a)({eventName:"Actions_Menu_Item_Click",id:e,area:this.instrumentationArea,subArea:"ActionsMenuItem",result:n?"Refer":"Navigate",target:n?Object(p.a)(n):"Actions"},this.dataSecurityThreshold)}getActivityCollab(){return(this.isRecommended||this.isOfficeFeed)&&this.item.isCollab?"true":(this.item.activities||[]).some((e=>!this.activityDescriptionService.isCurrentUser(e.actor.user))).toString()}getThumbnailUrl(){if(!this.item.thumbnails)return null;if(this.isMicrosoftForms)return this.item.thumbnails.large;const e=M.acceptedThumbnailExtensions.includes(this.item.extension);return e&&this.item.format===T.a.StreamsVideo?(this.streamsVideoThumbnail=this.officeFeedService.getStreamsThumbnail(this.item.thumbnails.recommendedThumbnail),this.streamsVideoThumbnail.then((e=>{this.onThumbnailLoad()})).catch((()=>{this.onThumbnailError()})),null):e&&this.thumbnailApiEnabled&&!this.isNewsArticle?(this.thumbnail=this.oneDriveService.getThumbnailString(this.item.thumbnails.recommendedThumbnail),this.thumbnail.then((e=>{this.onThumbnailLoad()})).catch((e=>{this.onThumbnailError()})),null):this.item.thumbnails&&!this.thumbnailApiEnabled?(this.onThumbnailLoad(),this.isRecommended||this.isOfficeFeed||this.item.format===T.a.Trending?this.item.thumbnails.recommendedThumbnail||this.item.thumbnails.large:this.item.thumbnails.medium):void this.onThumbnailError()}openFolder(){if(this.item.isLocal)return void this.localAppLauncherService.openPathInExplorer(this.item.attributionUrl);let e=this.isUpcomingMeeting?this.item.joinUrl:this.item.isEmailAttachment?this.url:this.item.attributionUrl;e=this.addLoginHint(e),this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((t=>{t.launchUrl(e,{action:"OpenFileLocation"})})):this.urlLauncherService.openUrl(e,"OpenFileLocation"),this.isUpcomingMeeting&&this.instrumentAction("join_meeting")}getWdOrigin(e=!1){return this.contextService.getWdOrigin(this.getWdOriginTaskForClick(e))}addLoginHint(e){return this.item.shouldAddLoginHint()&&(e=O.a.appendLoginHint(e,this.clientStartupConfigService.config.loginHint,this.capabilitiesService.capabilities.outgoingLoginHintEnabled)),e}getLaunchUrlAndClickId(e,t=!1){if(e=this.addLoginHint(e),this.mruConfigService.config.addWacParams&&this.item.fileType!==y.b.Sway&&this.item.fileType!==y.b.Forms&&this.item.fileType!==y.b.Pdf&&this.item.fileType!==y.b.Fluid&&this.item.fileType!==y.b.PowerBI&&!this.item.isLocal&&!this.item.isOnPremOrVanity&&!this.item.isEmailAttachment&&this.item.format!==T.a.News){const i=Date.now(),n=P.a.createGuid(),r=this.capabilitiesService.capabilities.scenarioId,a=Object.assign(Object.assign(Object.assign(Object.assign({ct:i,wdOrigin:this.getWdOrigin(t)},this.isConsumer?{}:{cid:n}),this.item.fileType===y.b.Stream?{web:1}:{}),this.wacContentService.getWacHostControlQueryParams(this.item.fileType)),r?{wdscenarioid:r}:{});return[O.a.appendAndReplaceQueryParams(e,a,!0),n]}if(this.isMicrosoftForms){const t=this.officeRouteService.getCurrentRoute(),i=this.clientStartupConfigService.config.sharedClientStartupContext;return[O.a.appendAndReplaceQueryParams(e,{lang:this.contextService.sharedContext.officeMarket,origin:"prodprv"===i.deploymentEnvironment&&"scu"===i.geoName?D.b:D.a,route:t&&t.route?t.route:void 0,sessionId:this.clientStartupConfigService.config.sharedClientStartupContext.sessionId},!0),void 0]}return this.item.fileType===y.b.Stream?[O.a.appendQueryParam(e,"web","1"),void 0]:[e,void 0]}createThumbnailAltText(e){const t=this.locService.ThumbnailImageAltText;switch(e){case y.b.Word:return this.locService.format(t,this.locService.ThumbnailWordType);case y.b.Excel:return this.locService.format(t,this.locService.ThumbnailExcelType);case y.b.PowerPoint:return this.locService.format(t,this.locService.ThumbnailPowerPointType);case y.b.OneNote:case y.b.OneNoteClassNoteBook:return this.locService.format(t,this.locService.ThumbnailOneNoteType);case y.b.Pdf:return this.locService.format(t,this.locService.ThumbnailPdfType);case y.b.Visio:return this.locService.format(t,this.locService.ThumbnailVisioType);case y.b.Text:return this.locService.format(t,this.locService.ThumbnailTextType);case y.b.Sway:return this.locService.format(t,this.locService.ThumbnailSwayType);case y.b.Forms:return this.locService.format(t,this.locService.ThumbnailFormsType);case y.b.Project:case y.b.ProjectOperations:return this.locService.format(t,this.locService.ThumbnailProjectType);case y.b.Portfolio:return this.locService.format(t,this.locService.ThumbnailProjectPortfolioType);case y.b.NewsArticle:return this.locService.format(t,this.locService.ThumbnailNewsType);case y.b.PowerBI:return this.locService.format(t,this.locService.ThumbnailPowerBIType);default:return""}}getActionPayLoadByName(e){var t;return null===(t=this.item.potentialAction.filter((t=>t.name===e))[0])||void 0===t?void 0:t.actionPayload}getOfficeStartDocument(){var e;const t=y.a.referralFromFileLocation(this.item.url);return{app:this.item.application,attribution:this.item.attribution,canonicalUrl:this.item.canonicalUrl,deepLinkUrl:this.item.teamsDeepLink,docId:this.item.docId,downloadUrl:this.item.documentUrl,driveId:this.item.driveId,extension:this.item.extension,fileType:y.b[this.item.fileType],id:this.item.id,isEmailAttachment:this.item.isEmailAttachment,isLocalFile:this.item.isLocal,isMsftDogfood:this.item.isMsftDogfood,isOnPremOrVanity:this.item.isOnPremOrVanity,iconUrl:this.item.iconUrl,isRedeemed:null!==(e=this.item.isRedeemed)&&void 0!==e?e:t===C.a.OneDrive||t===C.a.SharePoint,title:this.item.title,url:this.item.url,webUrl:this.item.webUrl}}wrapAdditionalAction(e){return Object.assign(Object.assign({},e),{getId:()=>e.id,executeAction:()=>{this.instrumentAction(e.id),e.executeAction().then((e=>{e.forEach((e=>{switch(e.key){case"add":this.addItem.emit(e.props);break;case"delete":this.deleteItem.emit(e.props);break;case"disableAction":this.contextMenu.items=this.contextMenu.items.filter((t=>t.getId()!==e.props.id))}}))}))}})}wrapAdditionalActionReact(e){return{id:e.id,title:e.title,ariaLabel:e.ariaLabel,contentActionOptions:{icon:this.getIconReactByIconFontType(e.icon)},executeAction:()=>this.runUnregisteredAction(e.id,(()=>e.executeAction().then((e=>{e.forEach((e=>{switch(e.key){case"add":this.addItem.emit(e.props);break;case"delete":this.deleteItem.emit(e.props);break;case"disableAction":this.contextMenu.items=this.contextMenu.items.filter((t=>t.getId()!==e.props.id))}}))})))),disabled:e.disabled}}}M.shortPathCharacterLimit=25,M.actionsMenuCssClass="actions-menu",M.acceptedThumbnailExtensions=["flac","m4a","mp3","opus","wma","dwg","cool","fbx","glb","obj","ply","stl","3mf","dcm","dcm30","dic","dicm","dicom","epub","htm","html","eml","msg","md","markdown","cur","ico","icon","mat","pict","psb","psd","webp","xbm","xcf","xpm","txt","bas","bash","bat","c","cbl","cfg","cmd","cpp","cs","css","csv","h","java","js","json","log","php","pl","ps1","py","rb","sh","sql","vb","xaml","yaml","yml","key","numbers","pages","sketch","xd","doc","docx","dot","dotx","dotm","odt","rtf","ods","xls","xlsb","xlsm","xlsx","xltx","odp","ppt","pptx","pptm","pot","potx","potm","pps","ppsx","ppsxm","pano","fppx","hcp","ai","epdf","pdf","pdfa","mts","m2ts","ts","3g2","3gp","3gp2","3gpp","asf","wmv","avi","m4v","mov","mp4","mp4v","ogg","webm","movie","mkv","mpg","mpeg","bmp","dib","rle","gif","jpeg","jpe","jpg","jfif","exif","png","tiff","tif","dng","wdp","jxr","hdp","dds","heic","heif","avci","heics","heifs","avcs","arw","cr2","crw","erf","kdc","mrw","nef","nrw","orf","pef","raf","raw","rw2","rwl","sr2","srw","3fr","ari","bay","cap","cr3","dcs","dcr","drf","eip","fff","iiq","k25","mef","mos","ori","ptx","pxn","srf","x3f"]},"32VK":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},"3GGT":function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.Unknown=0]="Unknown",e[e.OK=200]="OK",e[e.Created=201]="Created",e[e.NoContent=204]="NoContent",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.RequestTimeout=408]="RequestTimeout",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.RangeNotSatisfiable=416]="RangeNotSatisfiable",e[e.Locked=423]="Locked",e[e.Throttled=429]="Throttled",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.InsufficientStorage=507]="InsufficientStorage",e[e.UnexpectedResponse=700]="UnexpectedResponse",e[e.TokenRefreshFailed=701]="TokenRefreshFailed",e[e.TokenUnavailable=702]="TokenUnavailable",e[e.RetryFailed=703]="RetryFailed",e[e.AlternateResponse=704]="AlternateResponse",e[e.Cancelled=705]="Cancelled",e[e.Offline=706]="Offline",e[e.Timeout=707]="Timeout",e[e.DecryptionError=708]="DecryptionError",e[e.CacheMiss=709]="CacheMiss",e[e.EmptyResponse=710]="EmptyResponse"}(n||(n={}))},"3XMr":function(e,t,i){"use strict";i.d(t,"a",(function(){return P}));var n=i("QjXU"),r=i("tyUq"),a=i("Dn7E"),o=i("EYJY"),s=i("GAcG"),l=i("PxQI"),c=i("3GGT"),u=i("hhzZ"),d=i("R7NL"),h=i("7ma0"),p=i("kpuN"),m=i("1Hgo"),f=i("uzn7"),g=i("wwmn"),b=i("Uqr9"),v=i("casz"),S=i("BMb5"),y=i("pOWU"),C=i("cgnd"),w=i("/I02"),I=i("uUrA"),T=i("ksTh"),k=i("IA5y"),A=i("Mlb/"),_=i("vk2e");class P extends y.a{constructor(e,t,i,n,r,a,s,l,c,u,d,h){super(n,i,a,"Substrate",r,s,l,u),this.localStorageService=e,this.windowService=t,this.instrumentationService=i,this.aadAppId=d,this.syncTimestampStorageKey=`${T.d}.${this.windowService.nativeWindow.ewDbVersion}`,this._syncTimestampUpdated=new o.a,this.initialFullSyncCompleted=!1,this.startupConfig=c.config;const p=h.config;if(p){const e=0===p.substrateApiEndpoint.indexOf("/")?`${this.windowService.nativeWindow.location.origin}${p.substrateApiEndpoint}`:p.substrateApiEndpoint;this.endpoint=`${e}${p.edgeworthApiRootPath}${p.deltaSyncApiPath}?${T.c}${this.contextService.sharedContext.officeMarket}`}}get syncTimestampUpdated(){return this._syncTimestampUpdated.asObservable()}syncDocuments(){return this.serverSyncTimestamp=null,new s.a((e=>{(()=>{Object(n.__awaiter)(this,void 0,void 0,(function*(){const t=b.a.now(),i=new URL(this.endpoint),n=this.readLastSyncTimestamp(),o=I.a.createGuid();n&&i.searchParams.append("startDateTime",n);let s=i.toString(),l=1,u=0;for(;;){let t;try{t=yield this.getPage(s,l,o)}catch(t){return void e.error(t)}const{items:i,nextPageLink:n,hasFailures:r,version:a}=t;if((null==i?void 0:i.length)&&!this.serverSyncTimestamp){u+=i.length;const[e]=i;this.serverSyncTimestamp=2===a?e.last_store_modified_datetime:e.last_recommended_modified_datetime}e.next({items:i,hasPluginFailures:r});const c=n?`${this.endpoint}&${n}`:void 0;if(!c||s===c||l>40)break;++l,s=c}if(!this.initialFullSyncCompleted){const e=b.a.now()-t,i={ActualSize:u.toString(),ItemId:o,ItemCount:l.toFixed()};this.instrumentationService.logRequestEvent("EdgeworthFullSyncRequest",c.a.OK,e,null,!1,i),Object(r.a)({eventName:"EdgeworthFullSync",httpCode:c.a.OK,latency:e,fromCache:!1}),Object(a.a)({featureName:"Edgeworth",eventName:"EdgeworthFullSyncRequest",params:i}),this.initialFullSyncCompleted=!0}e.complete()}))})()})).pipe(Object(l.a)(1))}markSyncCompleted(){if(this.serverSyncTimestamp){const e=this.getStorageKey();this.localStorageService.set(e,this.serverSyncTimestamp),this._syncTimestampUpdated.next(),this.serverSyncTimestamp=null}}resetTimestamp(){this.serverSyncTimestamp=null,this.localStorageService.remove(this.getStorageKey())}handleQueryParam(e,t,i){"mockmru"===e&&this.mockRequestHeader&&i.headers.set(this.mockRequestHeader,t)}readLastSyncTimestamp(){const e=this.getStorageKey();return this.localStorageService.get(e)}getPage(e,t,i){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return new Promise(((n,r)=>{this.get("EdgeworthSubstrateDeltaSyncPageRequest","EdgeworthSubstrateDeltaSyncPage",e,(e=>{e.instrument(((e,n)=>{var r;n.ActualSize=((null===(r=null==e?void 0:e.data)||void 0===r?void 0:r.files)?e.data.files.length:-1).toString(),n.RequestId=this.getRequestIdFromResponse(e),n.Index=t.toFixed(),n.ImpressionId=i,n.DebugInfo=Object(k.f)(e)})).then((e=>{var t,i,r,a;const o=!(null===(t=e.data)||void 0===t?void 0:t.is_complete);n({items:this.parse(e.data.files||[]),nextPageLink:e.data.next_page_link,hasFailures:o,version:parseInt(null===(a=null===(r=null===(i=e.data)||void 0===i?void 0:i.diagnostics_data)||void 0===r?void 0:r.extended_info)||void 0===a?void 0:a.Version)||0}),this.scheduler.scheduleWork((()=>{var t;const i=(null===(t=e.data.files)||void 0===t?void 0:t.filter((e=>e.is_deleted)).map((e=>new Promise(((t,i)=>{this.scheduler.scheduleWork((()=>{var n;null===(n=this.windowService.nativeWindow.ewIdb)||void 0===n||n.deleteItem(e.id).then(t).catch(i)}),4)})))))||[];Promise.all(i).catch((e=>{var t;this.instrumentationService.logGenericEvent("Edgeworth_Cache_Delete_Error",{Error:(null===(t=null==e?void 0:e.toString)||void 0===t?void 0:t.call(e))||""})}))}),4)}))}),r,Object(k.a)(`${this.startupConfig.objectId}@${this.startupConfig.tenantId}`,this.contextService.sharedContext.recommendedIceApplicationId.toString(),this.startupConfig.objectId,this.aadAppId,I.a.createGuid(),this.contextService.getCurrentPageForLogging()),"network-only")}))}))}parse(e){return e.map((e=>{const t=e.user_relationship,i=e.activities?e.activities.map((e=>{let t;try{t=JSON.parse(e.a)}catch(t){console.log(`Error parsing activity: ${e.a}`)}return Object.assign(Object.assign({},e),{t:new Date(e.t),da:Object.assign(Object.assign({},e.da),{t:new Date(e.da.t)}),a:t})})):[],n=e.activity_badge?Object.assign(Object.assign({},e.activity_badge),{timestamp:e.activity_badge.timestamp?new Date(e.activity_badge.timestamp):void 0}):void 0;return Object.assign(Object.assign({},e),{last_recommended_modified_datetime:e.last_recommended_modified_datetime,last_store_modified_datetime:e.last_store_modified_datetime,user_relationship:Object(k.i)(t),activities:i,activity_badge:n,created_datetime:Object(k.j)(e.created_datetime),creation_info:e.creation_info?Object.assign(Object.assign({},e.creation_info),{timestamp:Object(k.j)(e.creation_info.timestamp)}):null,indexed:!1})}))}getStorageKey(){return this.syncTimestampStorageKey}}P.ɵprov=A.kc({factory:function(){return new P(A.lc(f.a),A.lc(S.b),A.lc(u.a),A.lc(p.a),A.lc(w.a),A.lc(d.a),A.lc(g.a),A.lc(_.q),A.lc(C.b),A.lc(v.a),A.lc(h.a),A.lc(m.a))},token:P,providedIn:"root"})},"3anA":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("A/um");class r{static getCssClass(e,t){return r.getCssClassFromGlyphName(n.a[e],t)}static getCssClassFromGlyphName(e,t){let i=r.iconTypeToCssClass[e];return t&&(i=`${i} ${r.SvgIconCssClass}`),i||"ms-Icon--placeholder"}}r.FluentIconCssClass="ms-ohp-Icon",r.SvgIconCssClass="ms-ohp-svg-Icon",r.iconTypeToCssClass={Accepted:"ms-ohp-Icon--accepted",Access:"ms-ohp-Icon--accessLogo",AccountActivity:"ms-ohp-Icon--accountActivity",Add:"ms-ohp-Icon--add",AddTo:"ms-ohp-Icon--addTo",Alert:"ms-ohp-Icon--alert",ArrowLeft:"ms-ohp-Icon--back",ArrowRight:"ms-ohp-Icon--forward",At:"ms-ohp-Icon--accounts",Attach:"ms-ohp-Icon--attach",Calendar:"ms-ohp-Icon--calendar",ContactCardSettings:"ms-ohp-Icon--contactCardSettings",Chat:"ms-ohp-Icon--chatSolid",CheckMark:"ms-ohp-Icon--checkMark",ChevronDown:"ms-ohp-Icon--chevronDown",ChevronLeft:"ms-ohp-Icon--chevronLeft",ChevronRight:"ms-ohp-Icon--chevronRight",ChevronUp:"ms-ohp-Icon--chevronUp",CircleFill:"ms-ohp-Icon--circleFill",CircleInfo:"ms-ohp-Icon--circleInfo",Comment:"ms-ohp-Icon--chat",Compass:"ms-ohp-Icon--compassNW",Copy:"ms-ohp-Icon--copy",Declined:"ms-ohp-Icon--declined",Delete:"ms-ohp-Icon--delete",Devices3:"ms-ohp-Icon--devices3",Diamond:"ms-ohp-Icon--diamond",Document:"ms-ohp-Icon--page",Download:"ms-ohp-Icon--download",Ellipsis:"ms-ohp-Icon--moreVertical",Excel:"ms-ohp-Icon--excelLogo",FavoriteStar:"ms-ohp-Icon--favoriteStar",Filter:"ms-ohp-Icon--filter",FilterSolid:"ms-ohp-Icon--filterSolid",Folder:"ms-ohp-Icon--folder",FolderOpen:"ms-ohp-Icon--openFolderHorizontal",GiftCard:"ms-ohp-Icon--giftCard",Glimmer:"ms-ohp-Icon--glimmer",Group:"ms-ohp-Icon--group",Hide:"ms-ohp-Icon--hide",HighLander:"ms-ohp-Icon--highLanderLogo",Home:"ms-ohp-Icon--home",Link:"ms-ohp-Icon--link",ListBullets:"ms-ohp-Icon--list",Location:"ms-ohp-Icon--location",Mail:"ms-ohp-Icon--mail",Microsoft365:"ms-ohp-Icon--m365Logo",Minus:"ms-ohp-Icon--remove",Move:"ms-ohp-Icon--moveToFolder",News:"ms-ohp-Icon--newsfeedLogo",OfficeForms:"ms-ohp-Icon--formsLogo",Office:"ms-ohp-Icon--officeLogo",Office2:"ms-ohp-Icon--officeLogo2",OfficeStore:"ms-ohp-Icon--officeStore",OfficeThreshold:"ms-Icon--officeThreshold",OneDrive:"ms-ohp-Icon--oneDriveLogo",Outlook:"ms-ohp-Icon--outlookLogo",Onenote2:"ms-ohp-Icon--onenoteLogo",Page:"ms-ohp-Icon--page",Pencil:"ms-ohp-Icon--edit",PencilSolid:"ms-ohp-Icon--editSolid",People2:"ms-ohp-Icon--people",Permissions:"ms-ohp-Icon--permissions",Person:"ms-ohp-Icon--person",PhotoVideoMedia:"ms-ohp-Icon--photoVideoMedia",PinDown:"ms-ohp-Icon--pinned",PlayerSettings:"ms-ohp-Icon--playerSettings",PlaylistMusic:"ms-ohp-Icon--playlistMusic",PollResults:"ms-ohp-Icon--pollResults",PowerBI:"ms-ohp-Icon--powerBILogo",PowerPoint:"ms-ohp-Icon--powerpointLogo",Preview:"ms-ohp-Icon--preview",PreviewLink:"ms-ohp-Icon--previewLink",Project:"ms-ohp-Icon--projectLogo",Publisher:"ms-ohp-Icon--publisherLogo",Question:"ms-ohp-Icon--question",Restore:"ms-ohp-Icon--revToggleKey",Save:"ms-ohp-Icon--save",Search:"ms-ohp-Icon--search",Settings:"ms-ohp-Icon--settings",Share2:"ms-ohp-Icon--share",SharePoint:"ms-ohp-Icon--sharepointLogo",SkypeForBusiness:"ms-ohp-Icon--skypeForBusinessLogo",SortDown:"ms-ohp-Icon--sortDown",SortUp:"ms-ohp-Icon--sortUp",Stream:"ms-ohp-Icon--streamLogo",Sync:"ms-ohp-Icon--sync",System:"ms-ohp-Icon--system",Sway:"ms-ohp-Icon--swayLogo",Task:"ms-ohp-Icon--tasksLogo",Teams:"ms-ohp-Icon--teamsLogo",TentativelyAccepted:"ms-ohp-Icon--tentativelyAccepted",TextDocument:"ms-ohp-Icon--textDocument",ToDo:"ms-ohp-Icon--toDoLogoInverse",TileView:"ms-ohp-Icon--viewAll",Trending:"ms-ohp-Icon--trending12",Unfavorite:"ms-ohp-Icon--unfavorite",Unpin:"ms-ohp-Icon--unpin",Upload:"ms-ohp-Icon--upload",Video:"ms-ohp-Icon--video",Visio:"ms-ohp-Icon--visioLogo",Waffle:"ms-ohp-Icon--waffle",Word:"ms-ohp-Icon--wordLogo",X:"ms-ohp-Icon--cancel",X2:"ms-ohp-Icon--cancel"}},"3bNC":function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("lrJm"),r=i("hhzZ"),a=i("R7NL"),o=i("/I02"),s=i("kpuN"),l=i("aQ3G"),c=i("wwmn"),u=i("casz"),d=i("Mlb/"),h=i("vk2e");class p extends l.a{constructor(e,t,i,n,r,a,o,s){super(e,t,i,n,r,a,o,s),this.cache=new Map}getPeoplePictures(e){const t=[];for(let i=0;i<e.length;i++)t.push(this.getPeoplePicture(e[i]));return Promise.all(t).then((e=>[].concat(...e)))}getPeoplePicture(e,t){if(this.cache.has(e))return this.cache.get(e);const i=void 0===t?`users/${e}/photo/$value`:`users/${e}/photos/${t}/$value`,n=new FileReader,r=new Promise((e=>{this.getGraph("OneDrive_Graph_People_Picture_Request","OneDrive_Graph_People_Picture",i,"network-only",null,!0,null,null,null,!1,"blob").then((t=>{t&&t.ok?(n.onloadend=()=>{const t=n.result&&"string"==typeof n.result&&n.result.split(",")||[];e(t.length>1?t[1]:null)},n.onerror=()=>e(null),n.onabort=()=>e(null),n.readAsDataURL(t.data)):e(null)})).catch((t=>{this.globalErrorHandler.handleError(t,"H5HgW"),e(null)}))}));return this.cache.set(e,r),r}}p.ɵprov=d.kc({factory:function(){return new p(d.lc(s.a),d.lc(r.a),d.lc(a.a),d.lc(o.a),d.lc(c.a),d.lc(h.q),d.lc(n.b),d.lc(u.a))},token:p,providedIn:"root"})},"3g20":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("dFxn"),r=i("Mlb/");class a{constructor(e){this.config=e.parse("searchConfig"),this.config&&(this.config.searchInHeaderEnabled=this.config.searchInHeaderEnabled)}}a.ɵprov=r.kc({factory:function(){return new a(r.lc(n.a))},token:a,providedIn:"root"})},"3iMk":function(e,t,i){"use strict";function n(e,t,i){for(let n=0;n<e.length;n+=t){const r=[],a=[];for(let i=0;i<t&&n+i<e.length;++i){const t=n+i;r.push(e[t]),a.push(t)}i(r,a)}}i.d(t,"a",(function(){return n}))},"4/We":function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("O6Zd");let r,a=!1;var o=i("BaAg"),s=i("dFxn"),l=i("W3Zz"),c=i("QjXU"),u=i("uzn7"),d=i("5aVq"),h=i("Mlb/");class p{constructor(e,t){this.localStorageService=e,this.shellShimService=t}static parseBooleanFlagsAndFilter(e,t=new Set){return Object.keys(e).filter((i=>"boolean"==typeof e[i]&&!t.has(i))).reduce(((t,i)=>(t[i]=e[i],t)),{})}registerFlagsAndGetConfig(e){return this.registerFeatures(e),this.mergeConfigWithOverrides(e)}mergeConfigWithOverrides(e){const t=this.getOverrides();return Object.keys(e).reduce(((i,n)=>{var r;return i[n]=null!==(r=t[n])&&void 0!==r?r:e[n],i}),{})}getOverrides(){var e;return null!==(e=this.localStorageService.getGlobal(p.localStorageKey))&&void 0!==e?e:{}}registerFeatures(e){return Object(c.__awaiter)(this,void 0,void 0,(function*(){(yield this.shellShimService.getShellShim()).FeatureFlags.AddFeatureFlags(e)}))}}p.localStorageKey="ShellFeatureFlags",p.ɵprov=h.kc({factory:function(){return new p(h.lc(u.a),h.lc(d.a))},token:p,providedIn:"root"});var m=i("Ax7d"),f=i("BMb5");class g{constructor(e,t,i,s,c){if(this.featureManagerService=i,this.shouldOpenWithUIHost=!1,this.capabilities=t.parse("capabilities")||{accountSwitchingEnabled:!1,adminPolicyEnabled:!1,activityBasedTimeoutEnabled:!1,addToDoEnabled:!1,appBarEnabled:!1,appBarOverflowOnlyEnabled:!1,appBarAdminTileEnabled:!1,appBarFlyoutAddAppsStoreLinkEnabled:!1,appBarFlyoutMoreAppsGalleryLinkEnabled:!1,appBarMicaStylesEnabled:!1,appBarDragDropEnabled:!1,appBarMSAAppsInFlyoutEnabled:!1,appBarPinningEnabled:!1,appsModuleEnabled:!1,appManifestEnabled:!1,appsInHero:!1,altaBrandingChangesEnabled:!1,bottomTrayEnabled:!1,calendarEnabled:!1,capPopupEnabled:!1,clientTokenFetchEnabled:!1,contentActionsEnabled:!1,contentActionsOHomeEnabled:!1,contentLauncherEnabled:!1,contextMenu20Enabled:!1,convertToPdfEnabled:!1,createBackgroundEnabled:!1,createCenterEnabled:!1,createCenterReactEnabled:!1,createClipchampEnabled:!1,createDesignerEnabled:!1,createTemplatesSeeMoreEnabled:!1,createDocAspxExcelEnabled:!1,createDocAspxPowerPointEnabled:!1,createDocAspxVisioEnabled:!1,createDocAspxWordEnabled:!1,createDocumentSupported:!1,createDynamicOrderingEnabled:!1,createOneDriveDocApiEnabled:!1,createOneNotePageEnabled:!1,createOnHomeEnabled:!1,createOnHomeHeaderTextRefreshEnabled:!1,createPaneSvgsEnabled:!1,createSharingLinkApiEnabled:!1,createStreamDocumentEnabled:!1,createStreamPlaylistEnabled:!1,createStreamRecorderEnabled:!1,createPlaylistWithNewUrlEnabled:!1,createVisioEnabled:!1,clientPwasEnabled:!1,darkModeEnabled:!1,darkModeOverride:!1,defaultHeaderLayoutEnabled:!1,delayedServiceWorkerInit:!1,downloadActionEnabled:!1,disableAnimation:!1,edgeworthEnabled:!1,edgeworthReactEnabled:!1,embedAppCachingEnabled:!1,embedHost:"",embedModeEnabled:!1,embedThemingEnabled:!1,favoriteTemplatesEnabled:!1,featureFlagsEnabled:!1,firstRunReactEnabled:!1,fluentHeader:!1,fluentRefresh:!1,fluentIconFontEnabled:!1,fluidAudience:"Unknown",fluidCapPopupEnabled:!1,fluidCreateAbpEnabled:!1,fluidCreateNewEnabled:!1,fluidFirst:!1,fluidMipEnabled:!1,fluidMockMipEnabled:!1,fluidSupportEnabled:!1,fluidUseServiceDeliveredDriver:!1,fluidVersionHistoryEnabled:!1,formsCalloutEnabled:!1,greetingRefreshEnabled:!1,heroGradientEnabled:!1,hoverPreloadTelemetryEnabled:!1,isConsumerUser:!1,isEmbedMode:!1,isPwaInUwp:!1,isPwaInWebView2:!1,installButtonReactEnabled:!1,irisForLearningShelfEnabled:!1,learningShelfEnabled:!1,leftNavCalloutEnabled:!1,leftNavReact:!1,leftNavEmptyImage:"",limitNetworkRequests:!1,listsCreateEnabled:!1,lorByDefaultEnabled:!1,maxInitialPlaces:0,maxTotalPlaces:0,memoryProfilingEnabled:!1,metaExtensionsFetchEnabled:!1,mobileContextMenusEnabled:!1,mobileCustomSearchEnabled:!1,msaClientTokensEnabled:!1,m365AppsAboutEnabled:!1,m365AppsEnabled:!1,m365TestAppEnabled:!1,feedEnabled:!1,modernStartAppsArray:new Array,modernStartPageEnabled:!1,modernStreamStartPageEnabled:!1,modernVisioStartPageEnabled:!1,modernStartPageRootPath:null,myContentEnabled:!1,myContentGridViewEnabled:!1,myContentUsqEnabled:!1,m365AppsPageRootPath:null,nativeSearchInHeaderEnabled:!1,newConsumerExperienceEnabled:!1,newConsumerOverride:!1,newMruEmptyStateEnabled:!1,newUserShelfEnabled:!1,newUserShelfOverride:!1,northStarEnabled:!1,officeHomeFloodgate:!1,officeStartUsedThirdPartyAppsEnabled:!1,oneDriveApisEnabled:!1,oneDriveUploadEnabled:!1,otherFlights:"",outgoingLoginHintEnabled:!1,parkEnabled:!1,peopleCardsEnabled:!1,peopleListViewEnabled:!1,pinningPeopleEnabled:!1,powerBiCreateEnabled:!1,prefetchDataEnabled:!1,pwaEnabled:!1,quickAccessV1Enabled:!1,quickAccessV1GridViewEnabled:!1,quickAccessV1CustomPivotEnabled:!1,recommendedDeepLinkEnabled:!1,recommendedFloodgate:!1,recommendedReact:!1,recommendedTeamsLinkEnabled:!1,redirectWhenSignedOutFromWorkloads:!0,reloadWhenAuthExpired:!0,reloadWhenPolicyCheckFailed:!0,reloadWhenReauthRequired:!0,remoteModulesEnabled:!1,replacePinActionEnabled:!1,scenarioId:null,scheduleEnabled:!1,secondaryTokensEnabled:!1,sharedServicesEnabled:!1,sharePointEnabled:!1,shareToTeamsEnabled:!1,shellDocumentTitleEnabledInFluid:!1,shellFeedbackEnabled:!1,shellPinEnabled:!1,showAppLauncherRedesign:!1,showA2HSPrompt:!1,showBusinessApps:!1,showFeedback:!1,showFloodgate:!1,showFolders:!1,showPwaFeelingsSurvey:!1,showSearch:!1,sideloadAppButtonEnabled:!1,surfaceExpEnabled:!1,spfxAppEnabled:!1,storeAppEnabled:!1,startPageAppsArray:new Array,startPageRootPath:null,suggestedActionsEnabled:!1,supportCentralEnabled:!1,svgAppIconsEnabled:!1,swayCreateNewEnabled:!1,teachingUiReactEnabled:!1,templatePageRootPath:null,templatesEnabled:!1,themeOverridesEnabled:!1,thumbnailEndpointEnabled:!1,threeSRdlFeedExperiment:"",threeSRdlFlightHeader:"",toDoM365AppEnabled:!1,unifiedHostPath:"",unityEnabled:!1,unityCalloutEnabled:!1,universalMeControlPWAEnabled:!1,universalMeControlSafetyFlightEnabled:!1,uploadV2Enabled:!1,userConsentCallEnabled:!1,userPreferenceEnabled:!1,useVroomForOneDriveApis:!1,visualAppsModuleEnabled:!1,visualBackgroundEnabled:!1,visualBackgroundGradientEnabled:!1,visualCreateCenterModuleEnabled:!1,visualEnabled:!1,visualFeedModuleEnabled:!1,visualMyContentModuleEnabled:!1,visualSettingEnabled:!1,wacExcelJsApiV2Enabled:!1,wacHostAppsArray:new Array,wacHostPrebootAppsArray:new Array,wacHostTimeoutTeardownEnabled:!1,wacHostEnabled:!1,wacHostControlFlight:!1,wacHostHoverPreloadEnabled:!1,wacHostPagePath:"",wacSharingLinkEnabled:!1,wacStartPageEnabled:!1,wacHostExternalLinkEnabled:!1,wacHostOrgTemplatesEnabled:!1,wacHostGetAuthTokenEnabled:!1,wacHostGetCustomAuthConfigEnabled:!1,wacHostHoverPrebootAppsArray:new Array,wacHostHoverPrebootControlFlight:!1,wacWordJsApiV2Enabled:!1,wacHostMoveToFolderEnabled:!1,wbShowStoragePercentageEnabled:!1,webVitalsEnabled:!1,welcomeBadgeEnabled:!1,welcomeBadgeV2Enabled:!1,whiteboardCreateEnabled:!1,workloadPublicDataEnabled:!1,yammerCreateEnabled:!1,yammerM365AppEnabled:!1,claimsChallengeEnabled:!1,m365StringLogoEnabled:!1,m365MobileDesktopRebrandEnabled:!1,portalPreloadEnabled:!1,announcementEnabled:!1,useUSQEnabled:!1,showEnforcementEnabled:!1},this.capabilities.featureFlagsEnabled&&this.updateWithOverrides(),this.capabilities.oneDriveUploadEnabled=this.capabilities.oneDriveUploadEnabled&&e.isDesktopDevice(),this.capabilities.createDocumentSupported=!e.isMobileDevice()&&!e.isTabletDevice(l.d.AndroidTablet),this.capabilities.isPwaInUwp=this.capabilities.pwaEnabled&&e.isUwp(),this.capabilities.isPwaInWebView2=this.capabilities.pwaEnabled&&e.isWebView2(),this.capabilities.disableAnimation=this.capabilities.pwaEnabled,this.capabilities.mobileContextMenusEnabled=e.isMobileDevice(),this.capabilities.leftNavReact=!e.isMobileDevice(),this.capabilities.appBarEnabled=this.capabilities.appBarEnabled&&!e.isMobileDevice(),this.capabilities.suggestedActionsEnabled=this.capabilities.suggestedActionsEnabled&&!e.isMobileDevice(),this.capabilities.universalMeControlPWAEnabled=this.capabilities.universalMeControlSafetyFlightEnabled&&this.capabilities.universalMeControlPWAEnabled,this.capabilities.mobileCustomSearchEnabled=e.isMobileDevice()&&!this.capabilities.nativeSearchInHeaderEnabled,this.capabilities.visualEnabled=!e.isMobileDevice()&&this.capabilities.visualEnabled,this.capabilities.contentActionsEnabled||(this.capabilities.addToDoEnabled=!1,this.capabilities.contextMenu20Enabled=!1,this.capabilities.convertToPdfEnabled=!1,this.capabilities.scheduleEnabled=!1,this.capabilities.shareToTeamsEnabled=!1,this.capabilities.createSharingLinkApiEnabled=!1,this.capabilities.contentActionsOHomeEnabled=!1),this.capabilities.m365AppsEnabled||(this.capabilities.m365TestAppEnabled=!1,this.capabilities.parkEnabled=!1,this.capabilities.spfxAppEnabled=!1,this.capabilities.storeAppEnabled=!1,this.capabilities.toDoM365AppEnabled=!1,this.capabilities.yammerM365AppEnabled=!1),a||(r=!!document.getElementById("AppShellEnabled"),a=!0),r&&(this.capabilities.clientTokenFetchEnabled=!0),this.capabilities.wacHostAppsArray&&(this.capabilities.wacHostApps=new Set(this.capabilities.wacHostAppsArray.map((e=>o.a.fileTypeNameToFileType(e))))),this.capabilities.startPageAppsArray&&(this.capabilities.startPageApps=new Set(this.capabilities.startPageAppsArray.map((e=>o.a.fileTypeNameToFileType(e))))),this.capabilities.modernStartAppsArray&&(this.capabilities.modernStartApps=new Set(this.capabilities.modernStartAppsArray.map((e=>o.a.fileTypeNameToFileType(e))))),this.capabilities.wacHostPrebootAppsArray&&(this.capabilities.wacHostPrebootApps=new Set(this.capabilities.wacHostPrebootAppsArray.map((e=>o.a.fileTypeNameToFileType(e))))),this.capabilities.wacHostHoverPrebootAppsArray&&(this.capabilities.wacHostHoverPrebootApps=new Set(this.capabilities.wacHostHoverPrebootAppsArray.map((e=>o.a.fileTypeNameToFileType(e))))),this.openWithUIHost=s.isStandalone.pipe(Object(n.a)((e=>this.capabilities.wacHostEnabled||this.capabilities.clientPwasEnabled&&e))),this.openWithUIHost.subscribe((e=>this.shouldOpenWithUIHost=e)),void 0===this.capabilities.templatesEnabled){const e=c.nativeWindow.location.hostname;this.capabilities.templatesEnabled=e&&e.length>3&&e.lastIndexOf(".com")===e.length-4}this.capabilities.edgeworthEnabled=this.capabilities.edgeworthEnabled&&"Proxy"in c.nativeWindow&&(!this.capabilities.isPwaInUwp||this.capabilities.isPwaInWebView2)}wacHostHoverPrebootEnabledForFileType(e){const t=this.capabilities.wacHostHoverPrebootApps;return!!t&&t.has(e)}wacHostEnabledForFileType(e){const t=this.capabilities.wacHostApps;return this.wacHostEnabled()&&!!t&&t.has(e)}wacHostEnabled(){return this.shouldOpenWithUIHost}getWorkload(){return this.capabilities.pwaEnabled?"pwa":this.capabilities.isEmbedMode?"embed":"officehome"}updateWithOverrides(){const e=new Set(["featureFlagsEnabled","disableAnimation","createDocumentSupported"]),t=this.featureManagerService.registerFlagsAndGetConfig(p.parseBooleanFlagsAndFilter(this.capabilities,e)),i=Object.keys(t);for(const e of i)this.capabilities[e]=t[e]}}g.ɵprov=h.kc({factory:function(){return new g(h.lc(l.b),h.lc(s.a),h.lc(p),h.lc(m.a),h.lc(f.b))},token:g,providedIn:"root"})},"4CZh":function(e,t,i){"use strict";i.d(t,"b",(function(){return p})),i.d(t,"d",(function(){return f})),i.d(t,"a",(function(){return g})),i.d(t,"c",(function(){return b}));var n=i("tjsK"),r=i("8/lW"),a=new RegExp("[a-zA-Z0-9_\\-\\.]+(@|%40|%2540)[a-zA-Z0-9_\\-\\.]+\\.[a-zA-Z]{2,63}","g"),o=new RegExp("file(:|%3A|%253A).*","gi");function s(e){return e?e.replace(a,"email_removed").replace(o,"file_removed"):e}var l,c=[],u=[],d=!1,h=r.a.Full;function p(e,t,i,n,r,a){void 0===n&&(n={}),void 0===r&&(r=[]),void 0===a&&(a=!1),n.EventName=e,l&&l(n,t);var o={params:n,metrics:r,record:function(){return function(e,t,i,n){var r=i&&(i.EventName&&i.EventName.indexOf("Error")>-1||i.Error&&"OK"!==i.Error);if(!(h<t||d&&!r)){!function(e,t){Object.keys(e).forEach((function(i){var n=e[i];(function(e){return!!e&&e.hasOwnProperty("securityThreshold")})(n)&&(e[i]=t>=n.securityThreshold?n.defaultValue:n.fallbackValue)}))}(i,h);var a=i&&i.Error;a&&"string"==typeof a&&(i.Error=s(a));var o=i&&i.DebugInfo;o&&"string"==typeof o&&(i.DebugInfo=s(o)),u.length>0?u.forEach((function(t){t.logEvent(e,i,n)})):function(e){c.push(e)}({streamName:e,eventName:i.EventName,eventParams:i,metrics:n,securityThreshold:t})}}(t,i,n,r)}};return a&&o.record(),o}function m(){c.splice(0,c.length).forEach((function(e){p(e.eventName,e.streamName,e.securityThreshold,e.eventParams||{},e.metrics,!0)}))}function f(e,t,i,r){if(void 0===r&&(r=!1),u.length>0)throw new n.a("initializeInstrumentationService is not allowed to be called more than once");if(!e||0===e.length)throw new n.a("Must specify at least one event factory when calling initializeInstrumentation");u=e.slice(),l=t,"number"==typeof i&&(h=i),d=r,m()}function g(){m(),u.forEach((function(e){e.flush()}))}function b(){return h}},"4ach":function(e,t,i){"use strict";var n,r;i.d(t,"a",(function(){return n})),i.d(t,"c",(function(){return r})),i.d(t,"b",(function(){return a})),function(e){e.Users="users",e.Groups="groups"}(n||(n={})),function(e){e[e.Good=0]="Good",e[e.Normal=1]="Normal",e[e.Suspicious=2]="Suspicious",e[e.Bad=3]="Bad",e[e.Evil=4]="Evil"}(r||(r={}));class a{static getOwnerPrincipalTypeToFormType(e){return"user"===e.toLowerCase()?n.Users:"group"===e.toLowerCase()?n.Groups:void 0}static getExtensionToFormType(e){return"form"===e.toLowerCase()?n.Users:"groupform"===e.toLowerCase()?n.Groups:void 0}}},"4d0o":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("dFxn"),r=i("Mlb/");class a{constructor(e){this.config=e.parse("userStorageConfig")}}a.ɵprov=r.kc({factory:function(){return new a(r.lc(n.a))},token:a,providedIn:"root"})},"511z":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n=new(i("Mlb/").u)("SERVICE_WORKER_API_AVAILABLE")},"55A9":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("6UlS"),r=i("Mlb/");class a{constructor(){this.sidePopupMenuEmitter=new n.a(null)}}a.ɵprov=r.kc({factory:function(){return new a},token:a,providedIn:"root"})},"5FMq":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("EYJY"),r=i("70cc"),a=i("O6Zd"),o=i("Mlb/");class s{constructor(){this.contextMenu=new n.a}showMenu(e){this.updateNext(e,0)}closeMenu(e){this.updateNext(e,1)}subscribeToOpenEvents(e){return this.contextMenu.asObservable().pipe(Object(r.a)((e=>e&&0===e.type)),Object(a.a)((e=>({menu:e.menu,position:e.position,focusFirstItem:e.focusFirstItem})))).subscribe(e)}subscribeToCloseEvents(e){return this.contextMenu.asObservable().pipe(Object(r.a)((e=>e&&1===e.type)),Object(a.a)((e=>({menu:e.menu,position:e.position})))).subscribe(e)}updateNext(e,t){e&&e.menu&&e.position&&this.contextMenu.next({type:t,menu:e.menu,position:e.position,focusFirstItem:e.focusFirstItem})}}s.ɵprov=o.kc({factory:function(){return new s},token:s,providedIn:"root"})},"5MEU":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n=new(i("Mlb/").u)("WorkloadQueryParameter")},"5ZNw":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e,t,i,n,r,a=!1,o,s,l,c,u,d,h){this.announcementType=e,this.title=t,this.subTitle=i,this.iconClass=n,this.dismissCookieName=r,this.alignBottom=a,this.cssClass=o,this.fontCssClass=s,this.dismissObservable=l,this.dismissible=c,this.titleRedirectionSuggestion=u,this.dismissTimeoutInSecond=d,this.titleUseSubtitleStyle=h,this.importance=1,this.index=0}isValid(){return this.title&&this.title.length>0}}},"5aVq":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("QjXU"),r=i("70cc"),a=i("WKA6"),o=i("7Gwk"),s=i("BMb5"),l=i("Mlb/");class c{constructor(e,t){this.windowService=e,this.eventService=t,this.afterShellRendered=this.onEventFired("shellRendered"),this.afterShellPlusLoaded=this.onEventFired("shellPlusLoaded")}getShellShim(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return yield this.afterShellRendered,this.windowService.nativeWindow.O365Shell}))}onEventFired(e){return this.eventService.events.withScope(0).pipe(Object(r.a)((t=>t.name===e)),Object(a.a)(1)).toPromise()}}c.ɵprov=l.kc({factory:function(){return new c(l.lc(s.b),l.lc(o.a))},token:c,providedIn:"root"})},"6GOa":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("dFxn"),r=i("Mlb/");class a{constructor(e){this.config=e.parse("swayConfig")||{analyticsBatchSize:1,apiUrl:null,myEndpoint:null,thumbnailsEnabled:!1,uploadMaxFileSize:0,uploadSupportedExtensions:[]}}}a.ɵprov=r.kc({factory:function(){return new a(r.lc(n.a))},token:a,providedIn:"root"})},"6Po3":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("Mlb/");class r{constructor(e){this.ngZone=e,this.inRAF=!1}runAfterPaint(e,t=!0){return t?this.afterPaint(e):this.ngZone.runOutsideAngular((()=>this.afterPaint(e)))}runBeforeLayout(e,t=!0){return t?this.beforeLayout(e):this.ngZone.runOutsideAngular((()=>this.beforeLayout(e)))}cancel(e){e&&cancelAnimationFrame(e)}afterPaint(e){return this.beforeLayout((()=>{setTimeout(e,0)}))}beforeLayout(e){if(!this.inRAF)return requestAnimationFrame((()=>{this.inRAF=!0,e(),Promise.resolve().then((()=>{this.inRAF=!1}))}));e()}}r.ɵprov=n.kc({factory:function(){return new r(n.lc(n.F))},token:r,providedIn:"root"})},"6cfW":function(e,t,i){"use strict";function n(e){return e instanceof Error&&e.message&&"the operation is insecure."===e.message.toLowerCase()}i.d(t,"a",(function(){return n}))},"6ib3":function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.Audio="Audio",e.Designer="Designer",e.Excel="Excel",e.Fluid="Fluid",e.FluidActivityBlueprint="FluidActivityBlueprint",e.Forms="Forms",e.FormsQuiz="FormsQuiz",e.Image="Image",e.List="List",e.Media="Media",e.MeetingNotes="MeetingNotes",e.MeetingObject="MeetingObject",e.MindMeister="MindMeister",e.Monday="Monday",e.MyAnalytics="MyAnalytics",e.NewsArticle="NewsArticle",e.None="None",e.OneDrive="OneDrive",e.OneNote="OneNote",e.OneNoteClassNoteBook="OneNoteClassNoteBook",e.OneNotePage="OneNotePage",e.Outlook="Outlook",e.Pdf="Pdf",e.Photos="Photos",e.Platform="Platform",e.PlayList="PlayList",e.PlayLists="PlayLists",e.Portfolio="Portfolio",e.PowerBI="PowerBI",e.PowerPoint="PowerPoint",e.Project="Project",e.ProjectOperations="ProjectOperations",e.ScreenRecording="ScreenRecording",e.SharePoint="SharePoint",e.Spaces="Spaces",e.Stream="Stream",e.StreamsVideo="StreamsVideo",e.Sway="Sway",e.Text="Text",e.ThirdParty="ThirdParty",e.Todo="Todo",e.Trello="Trello",e.Unknown="Unknown",e.UpcomingMeeting="UpcomingMeeting",e.Video="Video",e.Visio="Visio",e.VisioBusinessWac="VisioBusinessWac",e.VisioFlowChartWac="VisioFlowChartWac",e.VisioGeneralWac="VisioGeneralWac",e.VisioNetworkWac="VisioNetworkWac",e.VisioSoftwareWac="VisioSoftwareWac",e.VisioStartWac="VisioStartWac",e.Whiteboard="Whiteboard",e.Word="Word",e.Yammer="Yammer"}(n||(n={}))},"6nG3":function(e,t,i){"use strict";var n;i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r})),function(e){e[e.O365Home=0]="O365Home",e[e.O365Personal=1]="O365Personal",e[e.O365Solo=2]="O365Solo",e[e.OtherSubscription=3]="OtherSubscription",e[e.Perpetual=4]="Perpetual",e[e.Perpetual2019=5]="Perpetual2019",e[e.O365HomeTrial=6]="O365HomeTrial",e[e.NonActive=7]="NonActive",e[e.NotSubscribed=8]="NotSubscribed",e[e.NotDetected=9]="NotDetected"}(n||(n={}));class r{}},"6u39":function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("6UlS"),r=i("URPu"),a=i("hhzZ"),o=i("7Gwk"),s=i("uUrA"),l=i("k+kJ"),c=i("vHlr"),u=i("Mlb/");class d{constructor(e,t,i,r){this.eventService=e,this.pwaConfigService=t,this.uploadButtonService=i,this.instrumentationService=r,this._modalInfo=new n.a(null),this.updateNextSessionId()}showModal(e,t,i){this._modalInfo.next({filePath:e,fileName:t,type:i})}get modalInfo(){return this._modalInfo.asObservable()}uploadFile(e,t){this.currentUploadSessionId=this.nextUploadSessionId,this.updateNextSessionId(),this.uploadButtonService.uploadFile(e,null,this.currentUploadSessionId,t,l.d.Button)}getLocalFileInfo(e,t){return new Promise((i=>{this.pwaConfigService.config.mock?i(new File([],t)):Windows.Storage.StorageFile.getFileFromPathAsync(e).then((e=>{if(!e)throw new Error("Null file returned for path");return Windows.Storage.FileIO.readBufferAsync(e).then((e=>e),(()=>{throw new Error("Unable to create buffer")}))}),(()=>{throw this.eventService.broadcastEvent({name:"needAccessToFileSystem",args:["allow-file-system-access-upload"]}),new Error("Unable to access local file")})).then((e=>{if(!e)throw new Error("Null buffer");try{const n=Windows.Storage.Streams.DataReader.fromBuffer(e),r=n.unconsumedBufferLength,a=new Uint8Array(r);for(let e=0;e<r;e++)a[e]=n.readByte();const o=new Blob([a]);o.lastModifiedDate=new Date,o.name=t,i(o)}catch(e){throw new Error("Error reading from buffer")}})).then(null,(e=>{const t={};t.Error=e?e.message:"",t.ItemCategory=l.d[l.d.Button],this.instrumentationService.logGenericEvent("Upload_Local_Error",t,[],2)}))}))}updateNextSessionId(){this.nextUploadSessionId=s.a.createGuid()}}d.ɵprov=u.kc({factory:function(){return new d(u.lc(o.a),u.lc(r.a),u.lc(c.a),u.lc(a.a))},token:d,providedIn:"root"})},"6wOV":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i("AY/E");class n{constructor(e,t){this.elementRef=e,this.peopleCardService=t}ngOnInit(){this.upn&&(this.renderPromise=this.peopleCardService.addPersonaCard(this.elementRef.nativeElement,this.upn))}ngOnDestroy(){this.renderPromise&&this.renderPromise.then((()=>{this.peopleCardService.removePersonaCard(this.elementRef.nativeElement,this.upn)}))}}},"7Gwk":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("70cc"),r=i("WKA6"),a=i("MFXD"),o=i("BMb5"),s=i("Mlb/");class l{constructor(e){this.windowService=e,this._events=new a.a,this.mutateGlobalWindowState()}broadcastEvent(e){this._events.next(e)}get events(){return this._events.asScopableObservable()}whenEventFired(e,t){return this.events.withScope(t).pipe(Object(n.a)((t=>t.name===e)),Object(r.a)(1)).toPromise()}mutateGlobalWindowState(){this.windowService.nativeWindow.ng2EventService=this}}l.ɵprov=s.kc({factory:function(){return new l(s.lc(o.b))},token:l,providedIn:"root"})},"7IJ8":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("QjXU"),r=i("Mlb/"),a=i("CMIS");i("hhzZ"),i("6Po3"),i("WLAd"),i("casz"),i("cgnd"),i("QhWD"),i("RsrG");class o{constructor(e,t,i,n,a,o,s,l,c){this.lazyViewLoaderService=e,this.viewRef=t,this.instrumentationService=i,this.clientStartupConfigService=n,this.scheduler=a,this.modulePriorityService=o,this.browserPaintService=s,this.ngZone=l,this.pageVisibilityService=c,this.componentLoaded=new r.q,this.outputsSubscriptionMap=new Map}ngOnInit(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){if(this.ngModulePath)try{yield this.loadComponent()}catch(e){const t=`Error message: ${(null==e?void 0:e.message)||"not available"}`,i=`Call stack: ${(null==e?void 0:e.stack)||"not available"}`;Object(a.a)({eventName:"ChunkLoadError",debugInfo:i,message:t}),this.instrumentationService.logDebugCacheEvent("Chunk_Load_Error",{Error:t,DebugInfo:i})}}))}ngDoCheck(){this.setInputsOutputs()}ngOnDestroy(){this.creationHandle&&this.browserPaintService.cancel(this.creationHandle),this.outputsSubscriptionMap.forEach((e=>e.unsubscribe())),this.viewRef.clear()}setInputsOutputs(){if(this.lazyComponentRef){for(const e in this.inputs)this.lazyComponentRef.instance[e]=this.inputs[e];for(const e in this.outputs){if(this.outputsSubscriptionMap.has(e))continue;const t=this.lazyComponentRef.instance[e];if(!(t&&t instanceof r.q))continue;const i=t.subscribe(this.outputs[e]);this.outputsSubscriptionMap.set(e,i)}}}loadComponent(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.lazyViewLoaderService.loadLazyViewFromModule(this.ngModulePath),t=()=>{this.lazyComponentRef=this.viewRef.createComponent(e),this.componentLoaded.emit(this.lazyComponentRef)};if("idle-callback"===this.clientStartupConfigService.config.chunkLoadStrategy&&this.pageVisibilityService.isVisible()){const e=this.modulePriorityService.getSchedulePriority(this.ngModulePath);this.scheduler.scheduleWork((()=>{this.ngZone.run((()=>{this.creationHandle=this.browserPaintService.runBeforeLayout((()=>{this.creationHandle=null,t(),this.setInputsOutputs()}))}))}),e)}else t()}))}}},"7J/E":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("A/um"),r=i("BaAg"),a=i("4ach"),o=i("JT1q"),s=i("fKR7"),l=(i("EYcb"),i("7Gwk"),i("TDzr"),i("55A9"),i("cgnd"),i("/I02"),i("PBJH"),i("IBRu"));class c{constructor(e,t,i,n,r,a,o){this.locService=e,this.contextService=t,this.sidePopupMenuService=i,this.formsService=n,this.eventService=r,this.errorDialog=a,this.clientStartupConfigService=o}sendMruItemState(e,t){this.eventService.broadcastEvent({name:"mruItemStateChange",args:[e,t]})}generateAdditionalActionsMenuItems(e,t,i){const o=[],{fileType:l,format:c,isDeleted:u,isLocal:d}=t;switch(l){case r.b.Forms:case r.b.FormsQuiz:const l=t.getFormEnumType();c===s.a.SharedForm&&o.push({id:"formsSharedUnpin",title:this.locService.RemoveFromSharedWithMe,ariaLabel:this.locService.RemoveFromSharedWithMe,icon:n.a.Unpin,executeAction:()=>Promise.resolve([{key:"delete",props:{index:e,item:t,deleteOption:5}}]),disabled:d}),c!==s.a.Form||u||t.ownerType===a.a.Groups||"poll"===l||"assignments"===l||i||o.push(this.generateFormsMoveAction(t,e)),c!==s.a.Form&&c!==s.a.SharedForm||u||"poll"===l||"assignments"===l||o.push(this.generateFormsCopyAction(t,i)),c===s.a.Form&&u&&!d&&o.push({id:"restore",title:this.locService.RestoreActionMenuLabel,ariaLabel:this.locService.RestoreActionMenuLabel,icon:n.a.Restore,executeAction:()=>(this.sendMruItemState(0,t),this.attachFormsErrorHandler(this.formsService.setFormsRecycleState(t.docId,t.ownerId,t.ownerType,!1).then((()=>this.formsService.pushFormsAnnouncements("FormsRestored",t.fileName))).then((()=>[{key:"delete",props:{index:e,item:t,deleteOption:4}}])).finally((()=>{this.sendMruItemState(1,t)})))),disabled:!1}),c!==s.a.Form||d||o.push({id:"delete",title:this.locService.DeleteActionMenuLabel,ariaLabel:this.locService.DeleteActionMenuLabel,icon:n.a.Delete,executeAction:()=>{let i;return this.sendMruItemState(0,t),i=u?this.formsService.hardDeleteForm(t.docId,t.ownerId,t.ownerType).then((()=>this.formsService.pushFormsAnnouncements("FormsPermanentlyDeleted",t.fileName))):this.formsService.setFormsRecycleState(t.docId,t.ownerId,t.ownerType,!0).then((()=>this.formsService.pushFormsAnnouncements("FormsMoveToRecycleBin"))),this.attachFormsErrorHandler(i.then((()=>[{key:"delete",props:{index:e,item:t,deleteOption:u?2:1}}])).finally((()=>{this.sendMruItemState(1,t)})))},disabled:!1})}return o}updateActionItemsOnInflated(e,t,i){var n,o;const l=[];switch(t.fileType){case r.b.Forms:case r.b.FormsQuiz:t.format===s.a.Recent&&"poll"!==t.getFormEnumType()&&"assignments"!==t.getFormEnumType()&&void 0!==(null===(n=t.metaData)||void 0===n?void 0:n.formsResponseCount)&&null!==(null===(o=t.metaData)||void 0===o?void 0:o.formsResponseCount)&&(t.ownerType===a.a.Groups||i||l.push({start:1,deleteCount:0,item:this.generateFormsMoveAction(t,e)}),l.push({start:1,deleteCount:0,item:this.generateFormsCopyAction(t,i)}))}return l}generateFormsCopyAction(e,t){return{id:"copy",title:this.locService.CopyActionMenuLabel,ariaLabel:this.locService.CopyActionMenuLabel,icon:n.a.Copy,executeAction:()=>{let i;this.sendMruItemState(0,e);const n=e.ownerType;return e.ownerType===a.a.Users?i=t?e.ownerId:this.clientStartupConfigService.config.objectId:e.ownerType===a.a.Groups&&(i=e.ownerId),this.attachFormsErrorHandler(this.formsService.postCopyForm(e.docId,e.title,e.ownerTenantId,e.ownerId,i,e.ownerType,n).then((t=>(this.formsService.setFormsCopySuccessAnnouncement(t.title,n,e.format!==s.a.Form,i,e.createdBy),[{key:"add",props:{addOption:1,addedItem:Object(o.b)(t,`${r.a.fileTypeNameFromType(r.b.Forms)}_item_${t.id}`,`${r.a.fileTypeNameFromType(r.b.Forms)}Impression`,this.contextService.isRtl,this.clientStartupConfigService.config.authType,!1,null,e.ownerType)}}]))).finally((()=>{this.sendMruItemState(1,e)})))},disabled:e.isLocal}}generateFormsMoveAction(e,t){return{id:"move",title:this.locService.MoveActionMenuLabel,ariaLabel:this.locService.MoveActionMenuLabel,icon:n.a.Move,executeAction:()=>{const[i,n]=Object(l.a)();return this.sidePopupMenuService.sidePopupMenuEmitter.next({isShown:!0,type:0,movingFileItem:e,index:t,resolveMoveModel:n}),i.then((i=>{const n=e;this.sendMruItemState(0,n);const r=i.moveTargetId,o=i.moveTargetName;return this.attachFormsErrorHandler(this.formsService.postMoveForms(n.docId,n.ownerType,n.ownerId,a.a.Groups,r).then((i=>(this.formsService.setFormsMoveToGroupSuccessAnnouncement(n.fileName,r,o),e.createdBy=o,e.ownerType=a.a.Groups,e.ownerId=r,e.docId=i.id,[{key:"delete",props:{index:t,item:e,deleteOption:3}},{key:"disableAction",props:{id:"move"}}]))).finally((()=>{this.sendMruItemState(1,n)})))}))},disabled:e.isLocal}}attachFormsErrorHandler(e){return e.catch((e=>{var t,i,n;let r;switch(null===(n=null===(i=null===(t=e.httpResponse)||void 0===t?void 0:t.data)||void 0===i?void 0:i.error)||void 0===n?void 0:n.code){case"6102":r="AutoBlockedForm";break;case"6100":r="TakenDownForm";break;default:r="Generic"}throw this.errorDialog.showErrorDialog({category:"ActionMenu",error:r}),e}))}}},"7Rc8":function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return o}));var n,r=i("tm5M"),a=i("Mlb/");!function(e){e[e.Unknown=0]="Unknown",e[e.SkyDrive=1]="SkyDrive",e[e.SkyDrivePro=2]="SkyDrivePro",e[e.SharePointOnline=3]="SharePointOnline"}(n||(n={}));class o{}o.ɵprov=a.kc({factory:function(){return(e=>e.getMruService())(a.lc(r.a))},token:o,providedIn:"root"})},"7ma0":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("Mlb/"),r=i("4/We");const a=new n.u("AAD_APP_ID",{providedIn:"root",factory:()=>Object(n.db)(r.a).capabilities.pwaEnabled?"0ec893e0-5785-4de6-99da-4ed124e5296c":"4345a7b9-9a63-4910-a426-35363201d503"})},"7wk3":function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("vk2e"),r=i("BaAg"),a=i("6Po3"),o=i("Z0U4"),s=i("WLAd"),l=i("Uqr9"),c=i("Mlb/");class u{constructor(e,t,i,n,r){this.performanceService=e,this.platformId=t,this.pageVisibilityService=i,this.browserPaintService=n,this.queuedEvents=new Set,this.markedEvents=new Set,this.setupOnHiddenListener(),r.subscribeToRouteChangeStart((e=>this.currentRoute=e.currentRoute))}recordWhenPainted(e){const t=e+(this.currentRoute&&this.currentRoute.route?`_${this.currentRoute.route}${this.currentRoute.app?r.b[this.currentRoute.app]:""}`:"");Object(n.t)(this.platformId)&&!this.markedEvents.has(t)&&this.pageVisibilityService.isVisible()&&(this.queuedEvents.add(e),this.markedEvents.add(t),this.paintListenerHandle||(this.paintListenerHandle=this.browserPaintService.runAfterPaint((()=>{this.pageVisibilityService.isVisible()&&this.queuedEvents.forEach((e=>{this.performanceService.mark(`Paint_${e}`)})),this.resetListener()}),!1)))}setupOnHiddenListener(){this.pageVisibilityService.addOnVisibilityChanged((e=>{"hidden"===e&&this.cancelPaintListener()}))}cancelPaintListener(){this.paintListenerHandle&&this.browserPaintService.cancel(this.paintListenerHandle),this.resetListener()}resetListener(){this.queuedEvents.clear(),this.paintListenerHandle=null}}u.ɵprov=c.kc({factory:function(){return new u(c.lc(l.b),c.lc(c.I),c.lc(s.a),c.lc(a.a),c.lc(o.a))},token:u,providedIn:"root"})},"8/lW":function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.Security=0]="Security",e[e.Basic=1]="Basic",e[e.Enhanced=2]="Enhanced",e[e.Full=3]="Full"}(n||(n={}))},"8wW2":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n,r=i("cenr"),a=i("V9hE"),o=i("a3FV"),s=i("CMIS"),l="UnknownError";function c(){if(!n){var e=new Map,t=function(t,i){var n="",c="";t=t||new Error(l);var u=!1;try{var d=t.filename;d?n="Error location: "+(d=d.replace(/^.*[\\\/]/,""))+", line: "+t.lineno+", col: "+t.colno:t.id?n="Error id: "+t.id:(n="Error location: unknown",u=!0);var h=t.error||t;h.originalError?(n+="\nHandled error is a wrapper with message: "+h.message,c="Wrapper call stack: "+(h.stack||"Call stack trace is not available"),c+="\nOriginal call stack: "+((h=h.originalError).stack||"Call stack trace is not available")):c="Call stack: "+(h.stack||"Call stack trace is not available"),h.message&&(n+="\nError message: "+h.message)}catch(e){n="Error caught inside error logger: "+(e&&e.message||l),c="Call stack: "+(e&&e.stack||"Call stack trace is not available"),i="React",console.log(e)}finally{(function(t,i,n,l){var c;void 0===l&&(l=!1);try{var u=function(t){return 1+(e.get(t)||0)}(t);if(e.set(t,u),function(e){var t=e.toString().length,i=Math.pow(10,t-1);return i<2||e%i==0}(u)){var d=((c={}).Error=t,c.DebugInfo={value:i,kind:2},c.ItemCategory=n,c.ItemCount=u.toString(),c);Object(r.a)(o.a.UnhandledException,d),l&&(d.DebugInfo=i,Object(a.a)(o.a.UnhandledException,d)),Object(s.a)({eventName:"Unhandled_Exception",errorType:"Unhandled_Exception",errorCategory:n,occurrenceCount:u,message:t,debugInfo:i})}}catch(e){console.log(e)}})(n,c,i,u),console.log(t)}},i=function(e,i){(function(e){if(e&&e.stack&&!e.promise)return!1;if(e&&e.promise&&e.rejection){var t=e.rejection;if(t.stack&&"Error"!==t.name)return!1}return!0})(e)||(function(e,t){e&&"object"==typeof e&&t&&(e.id=t)}(e,i),t(e,"React"))};!function(){var e=window.onerror;window.onerror=function(n,r,a,o,s){var c=null;if("object"==typeof n&&n.type&&"error"===n.type.toLowerCase()?c=n:s?((c=s).message=s.message||n,Object.assign&&Object.assign(c,{filename:r,lineno:a,colno:o})):"string"==typeof n?(c=new Error(n||l),Object.assign&&Object.assign(c,{filename:r,lineno:a,colno:o})):(c=new Error(l),Object.assign&&Object.assign(c,{filename:r,lineno:a,colno:o})),t(c,"Global"),e)try{e.apply(window,[n,r,a,o,s])}catch(e){i(e)}}}(),n={handleError:i,handleCacheObservableError:function(e,t,n){e&&(e.networkError&&i(e.networkError,n),e.cacheError&&i(e.cacheError,t))}}}return n}},9260:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("QjXU"),r=(i("lrJm"),i("hhzZ"),i("R7NL"),i("BaAg")),a=(i("QOOv"),i("RR/o")),o=(i("7ma0"),i("kpuN"),i("wwmn"),i("casz"),i("ZtId"),i("BMb5"),i("pOWU")),s=(i("4/We"),i("cgnd"),i("/I02"),i("uUrA")),l=i("oAX+");class c extends o.a{constructor(e,t,i,n,r,a,o,s,l,c,u,d,h,p){super(e,n,r,"Substrate",i,o,s,d),this.capabilitiesService=t,this.mruConfigService=a,this.globalErrorHandler=l,this.startupConfigService=c,this.updateContentService=u,this.windowService=h,this.aadAppId=p,this.fetchRequestIndex=0;const m=this.mruConfigService.config;this.allApps=["Word","Excel","PowerPoint","OneNote","Video","PlayList"],m.recommendedPdfEnabled&&this.allApps.push("Pdf"),m.recommendedVisioEnabled&&this.allApps.push("Visio"),m.recommendedFluidEnabled&&this.allApps.push("Fluid","Bohemia","Loop"),this.sources=["EmailAttachment","OneDrive","Sharepoint"],this.capabilitiesService.capabilities.isPwaInUwp&&this.sources.push("LocalFile"),this.baseUrl=(this.inMockMode?this.contextService.sharedContext.officeHomeApiRoot:m.substrateApiEndpoint)+`/${m.recommendedB2ApiRootPath}/`,this.recommendedDataStreams=new Map}getRecommendedDocs(e){const t=this.getUrl(e);if(this.recommendedDataStreams.has(t))return this.recommendedDataStreams.get(t);const i=this.capabilitiesService.capabilities.prefetchDataEnabled?this.prefetchRecommendedDocs(t):this.fetchRecommendedDocs("network-first",t,e),n=this.updateContentService.getOrAddUpdateStream(this.getUpdateStreamKey(t),(()=>this.fetchRecommendedDocs("network-first",t,e))),r=l.a.createResultsWithCacheObservable(this.fetchRecommendedDocs("cache-only",t,e),i,n,(e=>this.recommendedDataStreams.delete(t)));return this.recommendedDataStreams.set(t,r),r}updateRecommendedDocs(e){return this.updateContentService.pushUpdate(this.getUpdateStreamKey(this.getUrl(e)))}removeDocument(e,t){const i=s.a.createGuid(),n=this.createRequestConfig(i);return new Promise(((i,r)=>{this.post("Recommended_Delete_Request","Recommended_Delete",this.baseUrl+this.mruConfigService.config.recommendedApiDismissedDocumentsPath,{id:e,until:t},(e=>{e.then((()=>i(null)))}),r,n)}))}fetchRecommendedDocs(e,t,i){return new Promise(((n,r)=>{const a=s.a.createGuid(),o=this.createRequestConfig(a);this.get("Recommended_Request","Recommended",t,(t=>{t.instrument(((e,t)=>{if(t.RequestId=this.getRequestIdFromResponse(e),t.DebugInfo=this.getServerDebugInfo(e),t.Index=(this.fetchRequestIndex++).toString(),t.ImpressionId=!!e.headers&&e.headers.get(c.clientRequestIdHeader)||a,t.DocumentType=i?this.getTypesParam(i):"All",e.ok&&e.data){let i=0;e.data.documents_group&&e.data.documents_group.documents&&(i=e.data.documents_group.documents.length,t.ResourceIdDistribution=e.data.documents_group.documents.map((e=>e.resource_id)).toString()),t.ActualSize=i.toString()}})).then((t=>this.processLocalRecommendedData(t.data).then((i=>{n({items:i||[],impressionId:!!t.headers&&t.headers.get(c.clientRequestIdHeader)||a,fromCache:"cache-only"===e})})))).catch((e=>{this.globalErrorHandler.handleError(e,"QG6EV")}))}),r,o,e)}))}prefetchRecommendedDocs(e){return this.windowService.nativeWindow.prefetchRecommendedDataPromise?this.windowService.nativeWindow.prefetchRecommendedDataPromise.then((e=>e?this.processLocalRecommendedData(e).then((t=>({items:t,impressionId:e.recommendedRequestId||"",fromCache:!1}))):Promise.reject("Prefetch failed"))):this.fetchRecommendedDocs("network-first",e)}handleQueryParam(e,t,i){"mockrecommended"===e&&this.mockRequestHeader&&i.headers.set(this.mockRequestHeader,t)}static fileType(e){let t=r.a.fileTypeFromExtension(e.extension);return t&&t!==r.b.None||(t=c.fileTypeFromAppName(e.app)||r.b.Unknown),t}static fileTypeFromAppName(e){return e?r.a.fileTypeNameToFileType(e):null}createRequestConfig(e){const t=this.startupConfigService.config,i=new Map([["X-AnchorMailbox",`${t.objectId}@${t.tenantId}`],["X-Office-Application",this.contextService.sharedContext.recommendedIceApplicationId.toString()],["X-Office-Scenario",this.contextService.getCurrentPageForLogging()],["X-RoutingParameter-SessionKey",t.objectId],["X-Ms-ClientAppId",this.aadAppId],[c.clientRequestIdHeader,e]]);return this.capabilitiesService.capabilities.threeSRdlFlightHeader&&i.set("X-Client-Flights",this.capabilitiesService.capabilities.threeSRdlFlightHeader),{headers:i}}getUrl(e){const t=this.getTypesParam(e),i=this.sources.join(",");return`${this.baseUrl}${this.mruConfigService.config.recommendedB2ApiFilesPath}?${c.countParam}${this.mruConfigService.config.numRecommendedToRequest}&${c.skipCacheParam}&${c.appsParam}${t}&${c.locParam}${this.contextService.sharedContext.officeMarket}&${c.sourcesParam}${i}`}getTypesParam(e){return(e&&e.size?this.allApps.filter((t=>e.has(r.a.fileTypeNameToFileType(t)))):this.allApps).join(",")}getUpdateStreamKey(e){return`recommended-${e}`}convertToMruDataItem(e,t=!1){var i;const n=e.activity_info?e.activity_info.badge:void 0,o=n&&n.timestamp?new Date(n.timestamp):null,s="PlayList"===e.app,l="EmailAttachment"===e.service_info.service_id||"FP_EXCHANGE_ORGID"===e.service_info.service_id;let u,d=null;return l&&(d={AttachmentType:1,ConversationId:"",Subject:n&&n.conversation_info?n.conversation_info.subject:""}),this.capabilitiesService.capabilities.recommendedTeamsLinkEnabled&&n&&n.sharing_action&&1===n.sharing_action.medium&&(u=n.sharing_action.web_url),{Application:e.app,Category:"Document",DocId:e.onedrive_info&&e.onedrive_info.item_id,DriveId:e.onedrive_info&&e.onedrive_info.drive_id,Extension:e.extension||r.a.getFileExtensionFromUrl(e.url),FileName:e.title,Title:e.title,Url:l||s||t?e.web_url:e.url,WebUrl:e.web_url,LastAccessedTime:o,FileType:r.b[c.fileType(e)],PathArray:null,Provenance:r.e[r.e.Substrate],ResourceId:e.resource_id,UrlAlreadyEncoded:!0,Activity:e.activity_info?a.b.convertMruActivityToActivityDescription(e.activity_info):void 0,IsCollab:!!e.activity_info&&e.activity_info.is_collab,IsEmailAttachment:l,IsLocal:t,OneDriveInfo:e.onedrive_info,SharepointInfo:e.sharepoint_info,SPOId:e.id,EmailReference:d,NavigationId:e.activity_info&&e.activity_info.badge&&e.activity_info.badge.navigation_info?e.activity_info.badge.navigation_info.id:null,TeamsDeepLink:u,IconUrl:null===(i=e.app_info)||void 0===i?void 0:i.icon_url}}processLocalRecommendedData(e){var t;return Object(n.__awaiter)(this,void 0,void 0,(function*(){const i=(null===(t=null==e?void 0:e.documents_group)||void 0===t?void 0:t.documents)||[];return Promise.all(i.map((e=>this.checkLocalFileAndProcess(e)))).then((e=>e.filter((e=>null!==e&&e.Activity&&e.Activity.formatString))))}))}getServerDebugInfo(e){if(!e||!e.headers)return"";const t=e.headers;return`BE: ${t.get("X-CalculatedBETarget")||""}. FE: ${t.get("X-FEServer")||""}.`}checkLocalFileAndProcess(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return new Promise((t=>{var i;if("LocalFile"!==(null===(i=e.service_info)||void 0===i?void 0:i.service_id))t(this.convertToMruDataItem(e));else if(this.capabilitiesService.capabilities.isPwaInUwp){const i=e.web_url;try{Windows.Storage.StorageFile.getFileFromPathAsync(i).then((i=>{t(i?this.convertToMruDataItem(e,!0):null)}),(()=>{t(null)}))}catch(e){t(null)}}else t(null)}))}))}}c.clientRequestIdHeader="client-request-id",c.countParam="show=",c.skipCacheParam="skipCache=false",c.appsParam="apps=",c.locParam="rs=",c.sourcesParam="sources="},"94Ef":function(e,t,i){"use strict";i.d(t,"a",(function(){return b})),i.d(t,"b",(function(){return y}));var n=i("Mlb/"),r=i("pzhl"),a=i("PkQn"),o=i("4/We"),s=i("vk2e"),l=i("tuJr"),c=i("s+Eq"),u=i("5FMq"),d=i("M56G"),h=i("jrGV"),p=i("hZW2"),m=i("W3Zz"),f=i("hhzZ"),g=i("PBJH"),b=n.Fb({encapsulation:2,styles:[],data:{}});function v(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,6,"div",[["class","actions-menu-item__flex-content"],["role","menuitem"]],null,null,null,null,null)),(e()(),n.Hb(1,0,null,null,1,"ohp-icon-font",[["size","16"]],null,null,null,r.b,r.a)),n.Gb(2,638976,null,0,a.a,[o.a],{color:[0,"color"],cssClass:[1,"cssClass"],iconFontCssClass:[2,"iconFontCssClass"],iconFontType:[3,"iconFontType"],size:[4,"size"]},null),(e()(),n.Hb(3,0,null,null,3,"div",[["class","list-item__title menu-item__title ms-fcl-bl"]],null,null,null,null,null)),n.Gb(4,278528,null,0,s.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(5,{"menu-item__title--disabled":0}),(e()(),n.gc(6,null,["",""]))],(function(e,t){e(t,2,0,t.context.item.iconColor,n.Ob(1,"actions-menu-item__icon ms-fcl-bl ",t.context.item.disabled?" menu-item__icon--disabled":"",""),t.context.item.iconCssClass,t.context.item.icon,"16");var i=e(t,5,0,t.context.item.disabled);e(t,4,0,"list-item__title menu-item__title ms-fcl-bl",i)}),(function(e,t){e(t,6,0,t.context.item.title)}))}function S(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,8,"ohp-dropdown-menu",[],null,[[null,"toggleMenu"],[null,"selectItem"],[null,"focusLink"]],(function(e,t,i){var n=!0,r=e.component;return"toggleMenu"===t&&(n=!1!==r.onToggleMenu(i)&&n),"selectItem"===t&&(n=!1!==r.onSelectItem(i)&&n),"focusLink"===t&&(n=!1!==r.onFocusLink(i)&&n),n}),l.b,l.a)),n.Gb(1,4440064,[[1,4]],1,c.a,[n.h,u.a],{menuModel:[0,"menuModel"],mobileContextMenu:[1,"mobileContextMenu"],leftAlignedCard:[2,"leftAlignedCard"],hideContent:[3,"hideContent"]},{toggleMenu:"toggleMenu",selectItem:"selectItem",focusLink:"focusLink"}),n.cc(603979776,2,{menuItems:1}),(e()(),n.Hb(3,0,null,0,3,"div",[["ohpMenuLinkContent",""]],null,null,null,null,null)),n.Gb(4,16384,null,0,c.c,[],null,null),(e()(),n.Hb(5,0,null,null,1,"ohp-icon-font",[["iconFontName","Ellipsis"],["size","16"]],null,null,null,r.b,r.a)),n.Gb(6,638976,null,0,a.a,[o.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null),(e()(),n.qb(0,null,null,1,null,v)),n.Gb(8,16384,[[2,4]],0,c.b,[n.S],null,null)],(function(e,t){var i=t.component;e(t,1,0,i.dropdownMenuModel,i.mobileMenusEnabled,i.leftAlignedCard,i.actionContextMenuEnabled),e(t,6,0,(i.iconClass?i.iconClass+" ":"")+(i.fluentRefresh?"actions-menu__icon--fluent"+(i.isOpen?" ms-fcl-tp":""):"actions-menu__icon ms-fcl-ns ms-fcl-nd-h ms-fcl-nd-f"),"Ellipsis","16",!0)}),null)}function y(e){return n.jc(0,[n.cc(671088640,1,{dropdownMenu:0}),(e()(),n.qb(16777216,null,null,1,null,S)),n.Gb(2,16384,null,0,s.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,(null==i.dropdownMenuModel||null==i.dropdownMenuModel.items?null:i.dropdownMenuModel.items.length)||i.actionContextMenuEnabled)}),null)}n.Db("ohp-actions-menu",d.a,(function(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-actions-menu",[],null,null,null,y,b)),n.Gb(1,770048,null,0,d.a,[h.a,o.a,p.a,n.o,m.b,f.a,g.a,n.K],null,null)],(function(e,t){e(t,1,0)}),null)}),{menuModel:"menuModel",listItemIndex:"listItemIndex",iconClass:"iconClass",area:"area",dataSecurity:"dataSecurity",leftAlignedCard:"leftAlignedCard",documentName:"documentName",horizontalEllipsis:"horizontalEllipsis",actionContextMenuEnabled:"actionContextMenuEnabled",actionContextMenu:"actionContextMenu"},{menuToggled:"menuToggled",menuFocused:"menuFocused"},[])},"9InZ":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},"9KSV":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=new RegExp("[a-zA-Z0-9_\\-\\.]+(@|%40|%2540)[a-zA-Z0-9_\\-\\.]+\\.[a-zA-Z]{2,63}","gm"),r=new RegExp("file(:|%3A|%253A).*","gim"),a=new RegExp("([&?]q=)(.+?)(?=[&].*| |, |$)","gmi");function o(e){return e?e.replace(/[\n\r\t\b]/gm,"").replace(n,"email_removed").replace(r,"file_removed").replace(a,"$1query_removed"):e}},"9MHL":function(e,t,i){"use strict";i.d(t,"a",(function(){return k}));var n=i("6UlS"),r=i("lrJm"),a=i("3GGT"),o=i("hhzZ"),s=i("BaAg"),l=i("p6Zr"),c=i("Dpxn"),u=i("TIi1"),d=i("BMb5"),h=i("4/We"),p=i("cgnd"),m=i("/I02"),f=i("PBJH");class g{static resolveGraphError(e,t){const i=e.httpResponse||e;if(i&&"number"==typeof i.status){const e=i.status,n=i.data;if(n&&n.error){const e=[];let i=n.error;for(;i;)e.push(i),i=i.innererror;for(i=e.pop();i;){const n=t(i.code);if(void 0!==n)return n;i=e.pop()}}return t(e)}}}var b=i("ZBli"),v=i("k+kJ"),S=i("JScD"),y=i("Uqr9");class C{constructor(e,t){this.totalBytes=t,this.startTime=y.a.now(),this.expirationTime=this.startTime+e,this.progressPoints=0}doesActivityHaveRemainingCapacity(e){const t=this.getRateRatio(e);return void 0===t||t<=1}didActivityHaveExtraCapacity(){const e=y.a.now();return this.expirationTime-e>e-this.startTime}getRateRatio(e){this.progressPoints++;const t=y.a.now(),i=t-this.startTime,n=this.expirationTime-t;let r;return this.progressPoints>=4&&i>=4e3&&n>0&&i>0&&(r=(this.totalBytes-e)/n/(e/i)),r}}var w=i("IAGz");class I{constructor(e,t,i){this.oneDriveService=e,this.windowService=i,this.uploadConfig=t.config}advanceState(e,t,i){const{sessionUrl:n,nextExpectedRanges:r}=t;let a;return a=n?r?this.uploadItemState(e,t,i):this.getStatusState(e,t,i):this.createSessionState(e,t,i),a.then((e=>e.error?this.handleGeneralErrorState(e,i):this.getState(e,{waitDuration:void 0,clientAttemptsRemaining:void 0,serverAttemptsRemaining:void 0})))}createSessionState(e,t,i){return this.oneDriveService.createUploadSession(e.file,e.sessionId,null,null,i).then((e=>this.getState(t,{nextExpectedRanges:e.nextExpectedRanges,sessionUrl:e.uploadUrl})),(e=>this.getState(t,{error:e})))}getStatusState(e,t,i){return this.oneDriveService.getUploadSessionStatus(t.sessionUrl,e.sessionId,i).then((e=>this.getState(t,{nextExpectedRanges:e.nextExpectedRanges})),(e=>this.getState(t,{error:e})))}uploadItemState(e,t,i){const n=e.file.size,r=this.getNextRange(n,t.nextExpectedRanges);let a;return a=r&&r.start<n?this.uploadFragmentState(r,e,t,i):this.cancelSessionState(e,t,i),a.then((e=>e.error?this.handleUploadItemErrorState(e,i):e))}uploadFragmentState(e,t,i,n){const{sessionUrl:r,speed:a=this.uploadConfig.initialSpeed}=i,{start:o,end:s}=e;t.updateProgress(o);const l=this.getFragmentSize(a),c=Math.min(o+l,s),u=a>this.uploadConfig.minSpeed?this.uploadConfig.fragmentTimeoutInMs:this.uploadConfig.fragmentTimeoutInMs*this.uploadConfig.slowFragmentTimeoutMultiplier,d=new C(u,c-o),h=t.file,p=new w.a;return n.onCancel((()=>{p.cancel()})),new Promise((e=>{this.oneDriveService.uploadFragment(r,o,c,h.size,h.slice(o,c),t.sessionId,(n=>{const r=o+n.loaded;a>this.uploadConfig.minSpeed&&!d.doesActivityHaveRemainingCapacity(r-o)&&(p.cancel(),e(this.getState(i,{speed:Math.max(a*this.uploadConfig.slowSpeedDowngradeRatio,this.uploadConfig.minSpeed),nextExpectedRanges:void 0}))),t.updateProgress(r)}),p,u).then((n=>{t.updateProgress(c),i=this.isDriveItem(n)?this.getState(i,{item:n}):this.getState(i,{nextExpectedRanges:n.nextExpectedRanges,speed:Math.min(d.didActivityHaveExtraCapacity()?a*this.uploadConfig.speedUpgradeRatio:a,1)}),e(i)}),(t=>{e(this.getState(i,{error:t}))}))}))}cancelSessionState(e,t,i){return this.oneDriveService.cancelUploadSession(t.sessionUrl,e.sessionId,i).then((()=>this.getState(t,{sessionUrl:void 0})),(()=>this.getState(t,{sessionUrl:void 0})))}handleUploadItemErrorState(e,t){const{speed:i=1}=e;return e=this.getState(e,{nextExpectedRanges:void 0}),this.handleErrorState(e,(n=>{switch(n){case a.a.Offline:case a.a.Unknown:return this.windowService.nativeWindow.navigator.onLine?Promise.resolve(this.getState(e,{speed:Math.max(i*this.uploadConfig.speedDowngradeRatio,this.uploadConfig.minSpeed)})):void 0;case"uploadSessionFailed":case"uploadSessionNotFound":case a.a.NotFound:return Promise.resolve(this.getState(e,{error:void 0,sessionUrl:void 0}));case"invalidRange":case a.a.RangeNotSatisfiable:return this.wait(this.uploadConfig.standardWaitDurationInMs,t).then((()=>this.getState(e,{error:void 0})))}}))}handleGeneralErrorState(e,t){const{waitDuration:i=this.uploadConfig.initialWaitDurationInMs,clientAttemptsRemaining:n=this.uploadConfig.numClientAttempts,serverAttemptsRemaining:r=this.uploadConfig.numServerAttempts}=e;return this.handleErrorState(e,(o=>{switch(o){case"unauthenticated":case a.a.Unauthorized:case"lockMismatch":case a.a.Locked:case a.a.NotImplemented:case"quotaLimitReached":case a.a.InsufficientStorage:case a.a.Offline:return}if("number"==typeof o){if(o>=400&&o<500)return;if(0===o||o>=500&&o<600){if(!r)return;return this.wait(i,t,!0).then((()=>this.getState(e,{error:void 0,waitDuration:Math.min(2*i,this.uploadConfig.maxWaitDurationInMs),serverAttemptsRemaining:Math.max(r-1,0)})))}if(!n)return;return this.wait(this.uploadConfig.standardWaitDurationInMs,t).then((()=>this.getState(e,{error:void 0,waitDuration:void 0,clientAttemptsRemaining:Math.max(n-1,0)})))}}))}handleErrorState(e,t){const{error:i}=e;let n=g.resolveGraphError(i,t);return void 0===n&&(n=Promise.resolve(e)),n}getState(e,t){return Object.assign(Object.assign({},e),t)}getNextRange(e,t=[]){return t.reduce(((t,i)=>{const[n,r]=i.split("-",2),a=parseInt(n,10);let o;return o=!t||a<t.start&&a<e?{start:a,end:""===r?e:Math.min(parseInt(r,10)+1,e)}:t,o}),void 0)}isDriveItem(e){return!!e.id}getFragmentSize(e){const t=e*this.uploadConfig.maxFragmentSize;let i;return i=t>this.uploadConfig.discreteChunkSize?t-t%this.uploadConfig.discreteChunkSize:t-t%this.uploadConfig.minFragmentSize,Math.min(Math.max(i,this.uploadConfig.minFragmentSize),this.uploadConfig.maxFragmentSize)}wait(e,t,i=!1){let n;const r=new Promise((t=>{n=setTimeout((()=>{t()}),e)}));let a;const o=new Promise((e=>{a=()=>{i&&e()},this.windowService.nativeWindow.addEventListener("online",a)})),s=t?t.onCancel((()=>Promise.reject(null))):new Promise((()=>{}));return new Promise((e=>{Promise.race([r,o,s]).then((()=>{e()}),(()=>{})).then((()=>{this.windowService.nativeWindow.removeEventListener("online",a),clearTimeout(n)}))}))}}var T=i("Mlb/");class k{constructor(e,t,i,n,r,a,o,s,l){this.contextService=e,this.locService=t,this.oneDriveService=i,this.uploadConfigService=n,this.urlLauncherService=r,this.windowService=a,this.capabilitiesService=o,this.globalErrorHandler=s,this.clientStartupConfigService=l,this.setupUploadPromise(),this.uploadConfigService.config&&(this.stateMachine=new I(this.oneDriveService,this.uploadConfigService,this.windowService))}upload(e,t,i){const r=this.uploadConfigService.config;if(!r)return null;const a=new v.b(t,e,i),o=new n.a(a);return a.cancellationToken.onCancel((()=>{a.sessionUrl&&!a.finished()&&this.oneDriveService.cancelUploadSession(a.sessionUrl,a.sessionId),a.state=v.c.Cancelled,o.next(a)})),a.markCompletedAndOpenedInOfficeHome=()=>{a.state=v.c.CompletedAndOpened,o.next(a)},this.isValidFileType(e)?this.startUpload(a,o):(a.error=this.suggestOneDriveErrorWithText(r.oneDriveResources.errorTitle,this.locService.format(r.oneDriveResources.unsupportedFile,this.locService.OpenOneDrive),v.a.InvalidFileType,a),a.state=v.c.Failed,o.next(a)),o.asObservable()}setupUploadPromise(){return this.uploadEnabledPromise=new Promise((e=>{this.capabilitiesService.capabilities.oneDriveUploadEnabled&&this.uploadConfigService.config?this.oneDriveService.getMyDriveRootUrl().then((t=>{e(!!t)})).catch((t=>{var i;this.globalErrorHandler.handleError(t,"IRW0y");const n=null===(i=null==t?void 0:t.networkError)||void 0===i?void 0:i.httpResponse,r=this.clientStartupConfigService.config.authType===p.a.MSA;e(!(this.capabilitiesService.capabilities.isPwaInUwp||!r&&!this.uploadConfigService.config.capPopupEnabled||(null==n?void 0:n.status)!==a.a.TokenUnavailable||!r&&"CAP_Error"!==(null==n?void 0:n.data)))})):e(!1)})),this.uploadEnabledPromise}startUpload(e,t){e.state=v.c.Started,t.next(e),this.uploadToOneDrive(e).then((i=>{-1!==e.file.type.indexOf("video")&&(i.webUrl=b.a.appendQueryParam(i.webUrl,"web","1")),e.result=i,e.state=v.c.Completed,t.next(e)}),(i=>{e.error=this.getUploadSessionError(i,e,t),e.state=v.c.Failed,t.next(e)}))}isValidFileType(e){const t=s.a.fileTypeFromFileName(e.name);return this.uploadConfigService.config.uploadFileTypes.has(t)}uploadToOneDrive(e){return(e.file.size<this.uploadConfigService.config.simpleUploadMaxSize?this.uploadSmall(e):this.uploadLarge(e)).then((t=>{const i={};t.webDavUrl&&(i.canonicalUrl=t.webDavUrl);let n=t.webUrl;const r=s.a.fileTypeFromFileName(e.file.name);if(this.uploadConfigService.config.editableFileTypes.has(r)){const e="action=edit";n=n.replace(new RegExp("([?&])action[^&]*"),"$1"+e),-1===n.lastIndexOf(e)&&(n=b.a.appendQuery(n,e))}return i.webUrl=n,i}))}uploadSmall(e){return this.oneDriveService.uploadFile(e.file,e.sessionId,null,null,(t=>e.updateProgress(t.loaded)),e.cancellationToken)}uploadLarge(e){return this.uploadState(e,{})}uploadState(e,t){const{sessionUrl:i,item:n,error:r}=t;return e.sessionUrl=i,new Promise(((a,o)=>{n?a(n):r&&!i?o(r):r?this.oneDriveService.cancelUploadSession(i,e.sessionId,e.cancellationToken).catch((()=>{})).then((()=>o(r))):this.stateMachine.advanceState(e,t,e.cancellationToken).then((t=>{this.uploadState(e,t).then(a,o)}),o)}))}getUploadSessionError(e,t,i){const n=this.uploadConfigService.config.oneDriveResources;if(!e.httpResponse||e.clientError)return{title:n.errorTitle,type:v.a.Unknown,message:""};const r=this.uploadConfigService.config.commonResources;return g.resolveGraphError(e,(e=>{switch(e){case"quotaLimitReached":case a.a.InsufficientStorage:return this.suggestOneDriveErrorWithText(n.errorTitle,n.outOfSpace,v.a.OutOfSpace,t);case"maxFileSizeExceeded":case a.a.RequestEntityTooLarge:return{title:n.errorTitle,type:v.a.FileTooLarge,message:n.largeFile};case a.a.Offline:return this.retryErrorWithText(n.errorTitle,r.checkConnection,v.a.BadConnection,t,i);case a.a.TokenUnavailable:case a.a.TokenRefreshFailed:return{title:n.errorTitle,type:v.a.Auth,message:""}}}))||{title:n.errorTitle,type:v.a.Unknown,message:""}}retryErrorWithText(e,t,i,n,r){const a=this.uploadConfigService.config.commonResources;return{title:e,type:i,message:t,recourseAction:{text:a.retryButtonTitle,ariaLabel:a.retryButtonAriaLabel,action:()=>{this.startUpload(n,r)},clickData:this.recourseClickDataWithId("upload-retry",n.sessionId,n.uploadSource)}}}suggestOneDriveErrorWithText(e,t,n,r){return this.contextService.sharedContext.oneDriveUrl?{title:e,type:n,message:t,recourseAction:{text:this.locService.OpenOneDrive,ariaLabel:this.locService.OpenOneDrive,action:()=>{this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((e=>{e.launchUrl(this.contextService.sharedContext.oneDriveUrl,{action:"OpenOneDriveUploadAction"})})):this.urlLauncherService.openUrl(this.contextService.sharedContext.oneDriveUrl,"OpenOneDriveUploadAction")},clickData:this.recourseClickDataWithId("upload-open-onedrive",r.sessionId,r.uploadSource,l.a.OneDrive)}}:{title:e,type:v.a.Unknown,message:""}}recourseClickDataWithId(e,t,i,n){const r={};return r.UploadSessionId=t,r.ElementId=e,r.Referral=n,r.Area=o.b.UploadDialog,r.ItemCategory=v.d[i],{eventName:"Upload_Click",params:r,metrics:[]}}}k.ɵprov=T.kc({factory:function(){return new k(T.lc(m.a),T.lc(f.a),T.lc(c.a),T.lc(S.a),T.lc(u.a),T.lc(d.b),T.lc(h.a),T.lc(r.b),T.lc(p.b))},token:k,providedIn:"root"})},"9WrL":function(e,t,i){"use strict";i.d(t,"a",(function(){return Q}));var n,r=i("DQbD"),a=i("GmnP"),o=i("FHrx"),s=i("JWB6"),l=i("6u39"),c=i("fpaX"),u=i("hhzZ"),d=i("Vwd8"),h=i("7ma0"),p=i("kpuN"),m=i("AXqk"),f=i("W3Zz"),g=i("EYcb"),b=i("U8M1"),v=i("Z0U4"),S=i("wwmn"),y=i("Uqr9"),C=i("casz"),w=i("EUVs"),I=i("4/We"),T=i("cgnd"),k=i("/I02"),A=i("JH4S"),_=i("ConB");!function(e){e.Slow2g="Slow2g",e.Standard2g="Standard2g",e.Standard3g="Standard3g",e.Standard4g="Standard4g",e.Unknown="Unknown"}(n||(n={}));var P=i("zPZ9"),E=i("8/lW"),F=i("+1lv"),O=i("pdjy"),D=i("uV9m"),M=i("TfV2"),R=i("O6Zd");const x=e=>{switch(e){case"MetaOSApp":return"MetaOSApp";case"CreateFile":return"CreateFile";case"StartPage":return"StartPage";case"ContentPage":return"ContentPage";case"VerifyIdentity":return"VerifyIdentity";case"OpenFailed":return"OpenFailed";case"ActionMenu":return"ActionMenu";default:return"InvalidInput"}};var L=i("BaAg"),U=i("jCfB");let N=!1;function W(e){if(!e.route)return;const t=e.route;switch(t){case"M365Apps":const i=e;if(i)return{route:t,appId:i.appId,entityId:i.entityId,subEntityId:i.subPageId};break;default:return{route:t,app:L.b[e.app]}}}function j(e){if(!(null==e?void 0:e.route))return;const t=e.route;switch(e.route){case"M365Apps":return{route:"M365Apps",app:e.appId,entityId:e.entityId,subPageId:e.subEntityId};default:return{route:t,app:L.b[e.app]}}}function H(e,t){var i,n,r,a,o,s,l;return{isAdmin:null===(i=null==e?void 0:e.user)||void 0===i?void 0:i.isAdmin,isDynamics:null===(n=null==e?void 0:e.user)||void 0===n?void 0:n.isDynamics,isEdu:null===(r=null==e?void 0:e.user)||void 0===r?void 0:r.isEdu,isEduFaculty:null===(a=null==e?void 0:e.user)||void 0===a?void 0:a.isEduFaculty,isEduStudent:null===(o=null==e?void 0:e.user)||void 0===o?void 0:o.isEduStudent,isFirstVisit:null==t?void 0:t.isFirstVisit(),isIw:null===(s=null==e?void 0:e.user)||void 0===s?void 0:s.isIw,isSmb:null===(l=null==e?void 0:e.user)||void 0===l?void 0:l.isSmb}}function B(e){switch(e){case"officehome":case"officehomereact":return"Web";case"pwa":return"HWA";case"embed":return"Embed";default:return"Web"}}function G(e){switch(e){case"pwa":return"Universal";default:return"Web"}}function q(e){switch(e.getDeviceInfo().platform.platformType){case f.d.AndroidPhone:return"AndroidPhone";case f.d.AndroidTablet:return"AndroidTablet";case f.d.Chromebook:return"Chromebook";case f.d.Linux:return"Linux";case f.d.Mac:return"Mac";case f.d.PC:return"PC";case f.d.WindowsPhone:return"WindowsPhone";case f.d.iPad:return"iPad";case f.d.iPhone:return"iPhone";default:return"Other"}}function V(e,t){if(t.capabilities.isPwaInWebView2)return"WebView2";if(t.capabilities.isPwaInUwp){const t=new RegExp("1[0-9]{2}10");return(null==e?void 0:e.build)&&t.test(e.build.toString())?"UWP_fallback":"UWP"}}function $(e){switch(e){case 4:return O.d;case 3:return O.b;case 2:return O.c;case 1:return O.a;case 0:return O.e}}function z(e){switch(e){case"EU":return"EU";default:return}}var Z=i("Mlb/"),K=i("5MEU"),J=i("OtXi");class Q{constructor(e,t,i,n,r,a,o,s,l,c,u,d,h,p,m,f,g,b,v,S,y,C,w,I,T,k){this.clientStartupConfigService=e,this.aadAppId=t,this.accessTokenService=i,this.capabilitiesService=n,this.contextService=r,this.errorDialogService=a,this.fluidHostContext=o,this.fluidInstrumentationService=s,this.instrumentationService=l,this.officeHomeApiConfigService=c,this.officeRouteService=u,this.performanceService=d,this.ariaEventFactoryService=h,this.scheduler=p,this.serviceWorkerStateService=m,this.dataSecurityService=f,this.deviceDetector=g,this.ngZone=b,this.wacContentService=v,this.workloadQueryParam=S,this.uploadLocalFileService=y,this.userContextService=C,this.userProfileService=w,this.encryptionConfigService=I,this.wrapperVersion=T,this.floodgateService=k}bootstrapOfficeStart(){return function(e,t,r,a,o,s,l,c,u,d,h,p,m,f,g,b,v,S,y,C,I,k,A,O,Z,K){const J={aadAppId:e,buildVersion:"0ded6a5a-54e3-1d68-dd1e-8c8254010961",cdnDomain:h.config.officeStartCdnDomain,correlationId:h.config.sharedClientStartupContext.correlationId,dataBoundary:z(h.config.dataBoundary),defaultLinkTarget:a.sharedContext.defaultLinkTarget,deploymentEnvironment:h.config.sharedClientStartupContext.deploymentEnvironment,geoName:h.config.sharedClientStartupContext.geoName,getAccessToken:(e,i,n,r,a,o,s,l)=>t.getAccessToken(e,i,n,!1===s,{category:l?x(l.category):void 0,fileType:l?L.a.fileTypeNameToFileType(l.fileType):void 0},void 0,r,o).then((e=>({success:e.success,token:e.token,format:e.format,source:e.source,expiryMs:e.expiryMs,error:e.error,clientId:e.clientId,scope:e.scope}))),getCsrfToken:()=>a.getCsrfToken(),getIdentity:()=>Promise.resolve({isMsa:h.config.authType===T.a.MSA,objectId:h.config.objectId,puid:h.config.puid,tenantId:h.config.tenantId,encryptionConfig:null==O?void 0:O.config,userPrincipalName:h.config.userPrincipalName}),inMockMode:a.sharedContext.inMockMode,isCorpNet:h.config.sharedClientStartupContext.corpNet,jwtAuthEnabled:u.config.jwtAuthEnabled,officeHomeApiRoot:a.sharedContext.officeHomeApiRoot,officeStartManifestVersion:a.sharedContext.officeStartManifestVersion,preferredCulture:a.sharedContext.officeMarket,requestOrigin:h.config.sharedClientStartupContext.requestOrigin,router:{getCurrentRoute:()=>j(d.getCurrentRoute()),getCurrentPageForLogging:()=>d.getCurrentPageForLogging(),getRouteObservable:()=>d.getRouteChangeEndObservable().pipe(Object(R.a)((e=>j(e.currentRoute)))),getUrlForRoute:(e,t)=>d.getUrlForRoute(W(e),t),navigateTo:(e,t,i,n,r)=>S.runTask((()=>d.navigateTo(W(e),t,i,n,r))),openHostedDocument:(e,t,i,n,r,a)=>{if(n)return l.logPerformanceBootStart(s.getBootId()),s.hostScenarioName=r,s.hostScenarioStartTime=t,d.navigateTo({route:"Content",app:L.b.Fluid},!1,w.a.getWacParams(e.driveId,e.docId,e.canonicalUrl,e.sharepointIds?{siteUrl:e.sharepointIds.siteUrl}:void 0));{const n=null==a?void 0:a.actnavid,r=y.bootstrapAndRoute(function(e,t,i){return{docId:e.docId,docUrl:e.canonicalUrl,driveId:e.driveId,fileType:L.b[e.fileType],fileName:e.fileName,wdOrigin:t,applicationUrlParams:i}}(e,i,a),n?{[U.a.Nav]:n}:void 0,t);return Promise.resolve(!!r)}}},sessionId:h.config.sharedClientStartupContext.sessionId,stringsContainerName:"officestartstrings",workload:C,oneDriveUrl:a.sharedContext.oneDriveUrl,oneDriveResourceId:a.sharedContext.oneDriveResourceId,sharePointResourceId:a.sharedContext.sharePointResourceId,loginHint:h.config.loginHint,uiContext:{openUploadLocalModal:(e,t,i)=>I.showModal(e,t,i),showErrorDialog:e=>o.showErrorDialog(Object.assign(Object.assign({},e),{category:e.category,error:e.error,fileType:L.b[e.fileType]}))},recordFloodgate:e=>null==K?void 0:K.recordFloodgate(e)};if(!N){N=!0,i.e(121).then(i.bind(null,"kje2")).then((e=>{e.initializeInstrumentation([{logEvent:(e,t,i)=>m.createEvent(e,t,i).record(),flush:()=>{m.flush()}}],(t=>{e.applyCommonStateParams(t,d.getCurrentPageForLogging()?d.getCurrentPageForLogging():"OfficeHome",d.getInitialPageForLogging()?d.getInitialPageForLogging():"OfficeHome",_.a[f.currentState],E.a[b.securityLevel.toString()],n[v.getNetworkInfo()])}))})),Object(P.b)(J);const e=h.config.sharedClientStartupContext.clientOTelImmediateSchedulePriorityEnabled?0:h.config.sharedClientStartupContext.clientOTelHighSchedulePriorityEnabled?1:h.config.sharedClientStartupContext.clientOTelMediumSchedulePriorityEnabled?2:3;g.scheduleWork((()=>{Object(F.b)({appName:h.config.sharedClientStartupContext.oTelAppName,appPlatform:G(C),appWorkload:B(C),appWorkloadType:Z?V(Z,r):void 0,bundleBuildDate:h.config.sharedClientStartupContext.buildDateUtc,bundleBuildId:h.config.sharedClientStartupContext.buildId,correlationId:h.config.sharedClientStartupContext.correlationId,dataBoundary:z(h.config.dataBoundary),deploymentEnvironment:J.deploymentEnvironment,deviceType:q(v),domainOrigin:h.config.sharedClientStartupContext.domainOrigin,ecsRing:h.config.sharedClientStartupContext.ecsRing,firstVisitAgeInDays:null==A?void 0:A.fullDaysSinceFirstVisit(),flights:h.config.sharedClientStartupContext.flights,identity:{isMsa:h.config.authType===T.a.MSA,objectId:h.config.objectId,puid:h.config.puid,tenantId:h.config.tenantId,encryptionConfig:null==O?void 0:O.config,userPrincipalName:h.config.userPrincipalName},initialPageName:d.getInitialPageForLogging()?d.getInitialPageForLogging():"OfficeHome",isCorpNet:h.config.sharedClientStartupContext.corpNet,IsEudbEndpointEnabled:h.config.sharedClientStartupContext.oTelEudbEndpointEnabled,IsSamplingEnabled:h.config.sharedClientStartupContext.oTelSamplingEnabled,isTestTraffic:a.sharedContext.inMockMode,networkType:n[v.getNetworkInfo()],oTelAriaNameSpace:h.config.sharedClientStartupContext.oTelNameSpace,oTelAriaTenant:h.config.sharedClientStartupContext.oTelAriaTenant,oTelEnabled:h.config.sharedClientStartupContext.oTelEnabled,preferredCulture:a.sharedContext.officeMarket,requestOrigin:J.requestOrigin,schedulerPriority:$(e),serverLocation:h.config.sharedClientStartupContext.geoName.toLowerCase(),serviceWorkerState:_.a[f.currentState],sessionId:J.sessionId,userSegment:H(k,A),win11DetectionEnabled:h.config.sharedClientStartupContext.oTelWin11DetectionEnabled}).then((()=>{Object(D.b)([{logEvent:F.c,flush:()=>{}}],(()=>j(d.getCurrentRoute())),{actionEnabled:h.config.sharedClientStartupContext.oTelClickEnabled,diagnosticEnabled:h.config.sharedClientStartupContext.oTelDiagnosticEnabled,errorEnabled:h.config.sharedClientStartupContext.oTelErrorEnabled,featureEnabled:h.config.sharedClientStartupContext.oTelFeatureEnabled,impressionEnabled:h.config.sharedClientStartupContext.oTelImpressionEnabled,pageViewEnabled:h.config.sharedClientStartupContext.oTelPageViewEnabled,perfEnabled:h.config.sharedClientStartupContext.oTelPerfEnabled,requestEnabled:h.config.sharedClientStartupContext.oTelRequestEnabled},{perfSamplingEnabled:h.config.sharedClientStartupContext.oTelSamplingPerformanceEnabled,requestSamplingEnabled:h.config.sharedClientStartupContext.oTelSamplingRequestEnabled},function(e){switch(e){case 1:return M.a.Basic;case 2:return M.a.Enhanced;case 0:return M.a.Security;case 3:return M.a.Full}}(b.securityLevel))})).catch((e=>{var t;const i={Error:(null===(t=null==e?void 0:e.toString)||void 0===t?void 0:t.call(e))||""};c.logDebugCacheEvent("OTEL_Initialization_Error",i)})),p.mark("OTEL_Ready")}),e)}return J}(this.aadAppId,this.accessTokenService,this.capabilitiesService,this.contextService,this.errorDialogService,this.fluidHostContext,this.fluidInstrumentationService,this.instrumentationService,this.officeHomeApiConfigService,this.officeRouteService,this.clientStartupConfigService,this.performanceService,this.ariaEventFactoryService,this.serviceWorkerStateService,this.scheduler,this.dataSecurityService,this.deviceDetector,this.ngZone,this.wacContentService,this.workloadQueryParam,this.uploadLocalFileService,this.userContextService,this.userProfileService,this.encryptionConfigService,this.wrapperVersion,this.floodgateService)}}Q.ɵprov=Z.kc({factory:function(){return new Q(Z.lc(T.b),Z.lc(h.a),Z.lc(p.a),Z.lc(I.a),Z.lc(k.a),Z.lc(g.a),Z.lc(r.a),Z.lc(a.a),Z.lc(u.a),Z.lc(S.a),Z.lc(v.a),Z.lc(y.b),Z.lc(c.a),Z.lc(C.a),Z.lc(s.a),Z.lc(m.a),Z.lc(f.b),Z.lc(Z.F),Z.lc(w.a),Z.lc(K.a),Z.lc(l.a),Z.lc(A.a),Z.lc(d.b),Z.lc(o.a,8),Z.lc(J.a,8),Z.lc(b.a,8))},token:Q,providedIn:"root"})},"9c4X":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("iXzu"),r=i("Mlb/");class a{constructor(e){this.ngZone=e}createAndObserve(e,t){const i=new n.a(e);return this.ngZone.runOutsideAngular((()=>{i.observe(t)})),i}}a.ɵprov=r.kc({factory:function(){return new a(r.lc(r.F))},token:a,providedIn:"root"})},"9gjh":function(e,t,i){"use strict";i.d(t,"a",(function(){return Oe})),i.d(t,"b",(function(){return tn}));var n=i("Mlb/"),r=i("EVbV"),a=i("Jn4Q"),o=i("dx17"),s=i("4/We"),l=i("hZW2"),c=i("C0xW"),u=i("7Gwk"),d=i("hhzZ"),h=i("PBJH"),p=i("kfAr"),m=i("AY/E"),f=i("1Bt+"),g=i("TIi1"),b=i("EUVs"),v=i("BMb5"),S=i("vk2e"),y=i("6wOV"),C=i("pzhl"),w=i("PkQn"),I=i("94Ef"),T=i("M56G"),k=i("jrGV"),A=i("W3Zz"),_=i("u51t"),P=i("g0MB"),E=i("w1PR");class F{constructor(e){this.locService=e,this.updateAriaLabel=new n.q}ngOnChanges(){if(this.state=this.analytics?"active":"inactive",this.analytics){const e=this.formatSingularOrPluralString(this.analytics.viewCount,this.locService.DocumentAnalyticsSingleTotalView,this.locService.DocumentAnalyticsMultipleTotalViews),t=this.locService.format(this.locService.DocumentAnalyticsAvgTimeSpent,this.getAvgTimeSpent(this.analytics.averageTimeSpentMs)),i=this.locService.format(this.locService.DocumentAnalyticsAvgCompletion,this.locService.localizedNumberString(Math.floor(100*this.analytics.averageCompletionRatio))),n=this.locService.format(this.locService.DocumentAnalyticsGlancedViews,this.locService.localizedNumberString(this.analytics.glancedReads)),r=this.formatSingularOrPluralString(this.analytics.quickReads,this.locService.DocumentAnalyticsSingleQuickRead,this.locService.DocumentAnalyticsMultipleQuickReads),a=this.formatSingularOrPluralString(this.analytics.deepReads,this.locService.DocumentAnalyticsSingleDeepRead,this.locService.DocumentAnalyticsMultipleDeepReads);this.generalInfo=this.locService.format(this.locService.DocumentAnalyticsTotalViewsAvgTimeSpentAndAvgCompletionFormat,e,t,i),this.detailedViewInfo=this.locService.format(this.locService.DocumentAnalyticsDetailedViewsInfoFormat,n,r,a),this.updateDescription()}}getAvgTimeSpent(e){const t=e/6e4;return t<F.spentTimeLessThanStringThreshold?this.locService.format(this.locService.DocumentAnalyticsLessThanAvgTimeSpent,this.locService.localizedNumberString(F.spentTimeLessThanStringThreshold)):this.locService.format(this.locService.DocumentAnalyticsAvgTimeSpentMinutes,this.locService.localizedNumberString(Math.round(t)))}formatSingularOrPluralString(e,t,i){return this.locService.format(1===e?t:i,this.locService.localizedNumberString(e))}updateDescription(){const e=this.locService.format(this.locService.DocumentDescriptiveAriaLabelAnalytics,this.generalInfo,this.detailedViewInfo);this.updateAriaLabel.emit(e)}}F.spentTimeLessThanStringThreshold=1;var O=n.Fb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"fadeIn",definitions:[{type:1,expr:"inactive => active",animation:[{type:6,styles:{opacity:0},offset:null},{type:4,styles:{type:6,styles:{opacity:1},offset:null},timings:"500ms 0ms linear"}],options:null}],options:{}}]}});function D(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,null,null,null,null,null,null,null)),(e()(),n.Hb(1,0,null,null,1,"div",[["class","analytics-description__data-piece-label ms-fcl-np"]],null,null,null,null,null)),(e()(),n.gc(2,null,["",""])),(e()(),n.Hb(3,0,null,null,1,"div",[["class","analytics-description__data-piece-label ms-fcl-np"]],null,null,null,null,null)),(e()(),n.gc(4,null,["",""]))],null,(function(e,t){var i=t.component;e(t,2,0,i.generalInfo),e(t,4,0,i.detailedViewInfo)}))}function M(e){return n.jc(2,[(e()(),n.Hb(0,0,null,null,2,"div",[],[[24,"@fadeIn",0]],null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,D)),n.Gb(2,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,2,0,t.component.analytics)}),(function(e,t){e(t,0,0,t.component.state)}))}n.Db("ohp-analytics-description",F,(function(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-analytics-description",[],null,null,null,M,O)),n.Gb(1,573440,null,0,F,[h.a],null,null)],null,null)}),{analytics:"analytics"},{updateAriaLabel:"updateAriaLabel"},[]);var R=i("7IJ8"),x=i("QhWD"),L=i("cgnd"),U=i("casz"),N=i("RsrG"),W=i("6Po3"),j=i("WLAd"),H=i("1GMS"),B=i("cAxl"),G=i("3bNC"),q=i("POe7"),V=i("QjXU"),$=i("+2OL"),z=i("JWB6"),Z=i("R7NL"),K=i("oAX+");class J{constructor(e,t,i,n){this.instrumentedHttp=e,this.domSanitizer=t,this.serviceWorkerStateService=i,this.serviceWorkerConfigService=n}transform(e){return K.a.createResultsWithCacheObservable(this.getData(e,"cache-only"),this.getData(e,"network-first")).results}getData(e,t){return Object(V.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.instrumentedHttp.get("Thumbnail_Cache_Pipe_Load","Thumbnail_Cache_Pipe_Load",e,{headers:"Controlled"===this.serviceWorkerStateService.currentState&&this.serviceWorkerConfigService.config.enabled?new Map([["X-SW-OHP-ThumbnailCacheable","ODSP_THUMBNAIL_CACHEABLE"]]):null,responseType:"blob"},t),n=URL.createObjectURL(i.data);return this.domSanitizer.bypassSecurityTrustUrl(n)}))}}var Q=i("pd4Y"),Y=i("uH9+");class X{transform(e){return{email:e.address,fullName:e.name}}}class ee{constructor(e,t){this.actionContextMenuService=e,this.deviceDetector=t}ngOnInit(){this.desktop=this.deviceDetector.isDesktopDevice()}onContextMenu(e){this.desktop&&this.model&&e&&!this.disabled&&(e.preventDefault(),this.actionContextMenuService.openMenu({id:this.model.id,itemIndex:this.model.itemIndex,actions:this.model.actions,groupInfo:this.model.groupInfo,mouseEvent:e,targetElement:void 0}))}}var te=i("ttrr"),ie=i("5FMq"),ne=i("R0N1"),re=i("/I02"),ae=i("xSeq"),oe=i("rbdM"),se=i("kq70"),le=i("7J/E"),ce=i("55A9"),ue=i("TDzr"),de=i("EYcb"),he=i("2lMP"),pe=i("qCYW"),me=i("Bc8L"),fe=i("QOOv"),ge=i("dOgD"),be=i("Z0U4"),ve=i("Dpxn"),Se=i("EqbI"),ye=i("Uqr9"),Ce=i("OPwp"),we=i("uNUv"),Ie=i("6u39"),Te=i("Xc4i"),ke=i("hoyd"),Ae=i("7Rc8"),_e=i("DQbD"),Pe=i("GmnP"),Ee=i("kpuN"),Fe=i("U8M1"),Oe=n.Fb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"fadeInIsNew",definitions:[{type:1,expr:"inactive => active",animation:[{type:6,styles:{opacity:0},offset:null},{type:4,styles:{type:6,styles:{opacity:1},offset:null},timings:"500ms 0ms linear"}],options:null}],options:{}},{type:7,name:"recommendedCardHover",definitions:[{type:0,name:"hovered",styles:{type:6,styles:{transform:"scale(1.05)"},offset:null},options:void 0},{type:1,expr:"* => hovered",animation:{type:4,styles:null,timings:"100ms linear"},options:null}],options:{}}]}});function De(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,2,"div",[["class","mru-list-item-overlay"]],null,null,null,null,null)),(e()(),n.Hb(1,0,null,null,1,"div",[["class","spinner-container spinner-container--wh-100"]],null,null,null,null,null)),(e()(),n.Hb(2,0,null,null,0,"div",[["class","ms-Spinner-circle ms-Spinner--large"]],null,null,null,null,null))],null,null)}function Me(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-activity-description",[],null,null,null,r.b,r.a)),n.Gb(1,5226496,null,0,a.a,[o.a,s.a,n.h,l.a,c.b,u.a,d.a,h.a,p.a,m.a,f.a,g.a,b.a,v.b],{activities:[0,"activities"],activityDeepLink:[1,"activityDeepLink"],docId:[2,"docId"],index:[3,"index"],fileType:[4,"fileType"],navId:[5,"navId"],numLines:[6,"numLines"],teamsDeepLink:[7,"teamsDeepLink"],area:[8,"area"]},null)],(function(e,t){var i=t.component;e(t,1,0,i.item.lastModifiedActivity,i.recommendedDeepLinkEnabled&&i.activityDeepLink,i.item.docId,i.index,i.item.fileType,i.item.navigationId,2,i.recommendedTeamsLinkEnabled&&i.teamsDeepLink,i.instrumentationArea)}),null)}function Re(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,6,"div",[["class","document-card__header"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"document-card__header--fluent":0}),(e()(),n.Hb(3,0,null,null,3,"ohp-activity-description",[],null,null,null,r.b,r.a)),n.Gb(4,5226496,null,0,a.a,[o.a,s.a,n.h,l.a,c.b,u.a,d.a,h.a,p.a,m.a,f.a,g.a,b.a,v.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],activityDeepLink:[2,"activityDeepLink"],docId:[3,"docId"],activityDescriptionInput:[4,"activityDescriptionInput"],index:[5,"index"],fileType:[6,"fileType"],navId:[7,"navId"],numLines:[8,"numLines"],teamsDeepLink:[9,"teamsDeepLink"],area:[10,"area"]},null),(e()(),n.qb(16777216,null,0,1,null,Me)),n.Gb(6,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.fluentRefresh);e(t,1,0,"document-card__header",n),e(t,4,1,[i.item.activities,i.item.lastViewedTime,i.recommendedDeepLinkEnabled&&i.activityDeepLink,i.item.docId,i.item.activity,i.index,i.item.fileType,i.item.navigationId,2,i.recommendedTeamsLinkEnabled&&i.teamsDeepLink,i.instrumentationArea]),e(t,6,0,i.item.lastModifiedActivity&&!i.item.activity)}),null)}function xe(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-activity-description",[],null,null,null,r.b,r.a)),n.Gb(1,5226496,null,0,a.a,[o.a,s.a,n.h,l.a,c.b,u.a,d.a,h.a,p.a,m.a,f.a,g.a,b.a,v.b],{activities:[0,"activities"],activityDeepLink:[1,"activityDeepLink"],docId:[2,"docId"],index:[3,"index"],fileType:[4,"fileType"],navId:[5,"navId"],numLines:[6,"numLines"],teamsDeepLink:[7,"teamsDeepLink"],area:[8,"area"]},null)],(function(e,t){var i=t.component;e(t,1,0,i.item.lastModifiedActivity,i.recommendedDeepLinkEnabled&&i.activityDeepLink,i.item.docId,i.index,i.item.fileType,i.item.navigationId,2,i.recommendedTeamsLinkEnabled&&i.teamsDeepLink,i.instrumentationArea)}),null)}function Le(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,8,"div",[["class","document-card__header"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"document-card__header--fluent":0}),n.Gb(3,212992,null,0,y.a,[n.o,m.a],{upn:[0,"upn"]},null),(e()(),n.Hb(4,0,null,null,4,"ohp-activity-description",[],null,null,null,r.b,r.a)),n.Gb(5,5226496,null,0,a.a,[o.a,s.a,n.h,l.a,c.b,u.a,d.a,h.a,p.a,m.a,f.a,g.a,b.a,v.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],showIcon:[2,"showIcon"],person:[3,"person"],activityDeepLink:[4,"activityDeepLink"],docId:[5,"docId"],activityDescriptionInput:[6,"activityDescriptionInput"],index:[7,"index"],fileType:[8,"fileType"],navId:[9,"navId"],numLines:[10,"numLines"],teamsDeepLink:[11,"teamsDeepLink"],area:[12,"area"]},null),n.ac(6,1),(e()(),n.qb(16777216,null,0,1,null,xe)),n.Gb(8,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,r=e(t,2,0,i.fluentRefresh);e(t,1,0,"document-card__header",r),e(t,3,0,i.item.activityUser.email);var a=i.item.activities,o=i.item.lastViewedTime,s=n.hc(t,5,3,e(t,6,0,n.Wb(t.parent.parent,0),null==i.item.activity?null:i.item.activity.people[0]));e(t,5,1,[a,o,!1,s,i.recommendedDeepLinkEnabled&&i.activityDeepLink,i.item.docId,i.item.activity,i.index,i.item.fileType,i.item.navigationId,2,i.recommendedTeamsLinkEnabled&&i.teamsDeepLink,i.instrumentationArea]),e(t,8,0,i.item.lastModifiedActivity&&!i.item.activity)}),null)}function Ue(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,0,"div",[["class","opacity-overlay"]],null,null,null,null,null))],null,null)}function Ne(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,0,"img",[["class","document-card__thumbnail"]],[[8,"src",4],[8,"alt",0]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.context.ngIf,n.Ob(1,"",t.component.thumbnailAltText,""))}))}function We(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"div",[["class","video-duration"]],null,null,null,null,null)),(e()(),n.gc(1,null,[" "," "]))],null,(function(e,t){e(t,1,0,t.component.item.mediaDuration)}))}function je(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,8,"div",[],null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,Ue)),n.Gb(2,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.Hb(3,0,null,null,3,"div",[["class","document-card__thumbnail-wrapper"]],[[8,"hidden",0]],null,null,null,null)),(e()(),n.qb(16777216,null,null,2,null,Ne)),n.Gb(5,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),n.Yb(131072,S.b,[n.h]),(e()(),n.qb(16777216,null,null,1,null,We)),n.Gb(8,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,i.streamsThumbnailLoaded),e(t,5,0,n.hc(t,5,0,n.Wb(t,6).transform(i.streamsVideoThumbnail))),e(t,8,0,i.item.mediaDuration)}),(function(e,t){e(t,3,0,!t.component.streamsThumbnailLoaded)}))}function He(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,0,"div",[["class","opacity-overlay"]],null,null,null,null,null))],null,null)}function Be(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,0,"img",[["class","document-card__thumbnail"]],[[8,"src",4],[8,"alt",0]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.context.ngIf,n.Ob(1,"",t.component.thumbnailAltText,""))}))}function Ge(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,3,"div",[["class","document-card--suggested-actions--fallback-background"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.n,[n.o,n.y,n.K],{ngStyle:[0,"ngStyle"]},null),n.Yb(131072,S.b,[n.h]),n.Zb(3,{"background-color":0})],(function(e,t){var i=t.component,r=e(t,3,0,n.hc(t,1,0,n.Wb(t,2).transform(i.workloadColorPromise)));e(t,1,0,r)}),null)}function qe(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,8,null,null,null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,He)),n.Gb(2,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.Hb(3,0,null,null,3,"div",[["class","document-card__thumbnail-wrapper"]],[[8,"hidden",0]],null,null,null,null)),(e()(),n.qb(16777216,null,null,2,null,Be)),n.Gb(5,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),n.Yb(131072,S.b,[n.h]),(e()(),n.qb(16777216,null,null,1,null,Ge)),n.Gb(8,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(0,null,null,0))],(function(e,t){var i=t.component;e(t,2,0,i.thumbnailLoaded),e(t,5,0,n.hc(t,5,0,n.Wb(t,6).transform(i.thumbnail))),e(t,8,0,!i.thumbnailLoaded&&i.fluentRefresh)}),(function(e,t){e(t,3,0,!t.component.thumbnailLoaded)}))}function Ve(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,0,"div",[["class","opacity-overlay"]],null,null,null,null,null))],null,null)}function $e(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,"img",[["class","document-card__thumbnail"]],[[8,"src",4],[8,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,i){var n=!0,r=e.component;return"load"===t&&(n=!1!==r.onThumbnailLoad()&&n),"error"===t&&(n=!1!==r.onThumbnailError()&&n),n}),null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"document-card__thumbnail-officefeed-news":0}),n.ac(3,1),n.Yb(131072,S.b,[n.h])],(function(e,t){var i=e(t,2,0,t.component.isNewsArticle);e(t,1,0,"document-card__thumbnail",i)}),(function(e,t){var i=t.component,r=n.hc(t,0,0,n.Wb(t,4).transform(n.hc(t,0,0,e(t,3,0,n.Wb(t.parent.parent.parent.parent,1),i.thumbnailUrl))));e(t,0,0,r,n.Ob(1,"",i.thumbnailAltText,""))}))}function ze(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,2,"img",[["class","document-card__thumbnail"]],[[8,"src",4],[8,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,i){var n=!0,r=e.component;return"load"===t&&(n=!1!==r.onThumbnailLoad()&&n),"error"===t&&(n=!1!==r.onThumbnailError()&&n),n}),null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"document-card__thumbnail-officefeed-news":0})],(function(e,t){var i=e(t,2,0,t.component.isNewsArticle);e(t,1,0,"document-card__thumbnail",i)}),(function(e,t){var i=t.component;e(t,0,0,i.thumbnailUrl,n.Ob(1,"",i.thumbnailAltText,""))}))}function Ze(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,9,null,null,null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,Ve)),n.Gb(2,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.Hb(3,0,null,null,6,"div",[["class","document-card__thumbnail-wrapper"]],[[8,"hidden",0]],null,null,null,null)),n.Gb(4,278528,null,0,S.n,[n.o,n.y,n.K],{ngStyle:[0,"ngStyle"]},null),n.Zb(5,{"background-color":0}),(e()(),n.qb(16777216,null,null,1,null,$e)),n.Gb(7,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,ze)),n.Gb(9,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,i.thumbnailLoaded);var n=e(t,5,0,i.item.thumbnails&&i.item.thumbnails.backgroundColor?i.item.thumbnails.backgroundColor:"transparent");e(t,4,0,n),e(t,7,0,i.thumbnailSWEnabled),e(t,9,0,!i.thumbnailSWEnabled)}),(function(e,t){e(t,3,0,!t.component.thumbnailLoaded)}))}function Ke(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"div",[],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{ngClass:[0,"ngClass"]},null)],(function(e,t){e(t,1,0,t.component.item.documentIconWithSize("64x64"))}),null)}function Je(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,0,"img",[["class","document-icon--64x64"]],[[8,"src",4]],null,null,null,null))],null,(function(e,t){e(t,0,0,n.Ob(1,"",t.component.item.iconUrl,""))}))}function Qe(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,"div",[["class","document-card__thumbnail-placeholder"]],null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,Ke)),n.Gb(2,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Je)),n.Gb(4,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,!i.item.iconUrl),e(t,4,0,i.item.iconUrl)}),null)}function Ye(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,"div",[["class","mru-list-item__icon-in-preview"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.n,[n.o,n.y,n.K],{ngStyle:[0,"ngStyle"]},null),n.Zb(2,{color:0}),(e()(),n.Hb(3,0,null,null,1,"ohp-icon-font",[["size","16"]],null,null,null,C.b,C.a)),n.Gb(4,638976,[[3,4],["fileIconElement",4]],0,w.a,[s.a],{iconFontCssClass:[0,"iconFontCssClass"],size:[1,"size"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.iconFontColor());e(t,1,0,n),e(t,4,0,i.iconFontClass(),"16")}),null)}function Xe(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"div",[["class","mru-list-item__icon-in-preview mru-list-item__document-icon-in-preview"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null)],(function(e,t){e(t,1,0,"mru-list-item__icon-in-preview mru-list-item__document-icon-in-preview",t.component.item.documentIconWithSize("20x20"))}),null)}function et(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,"div",[],null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,Ye)),n.Gb(2,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Xe)),n.Gb(4,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,i.iconFontClass()),e(t,4,0,!i.iconFontClass())}),null)}function tt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,null,null,null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,Qe)),n.Gb(2,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,et)),n.Gb(4,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(0,null,null,0))],(function(e,t){var i=t.component;e(t,2,0,!i.thumbnailLoaded&&!i.isStreamsVideo||!i.streamsThumbnailLoaded&&i.isStreamsVideo),e(t,4,0,!i.recommendedNewCards&&(i.thumbnailLoaded||i.streamsThumbnailLoaded&&i.isStreamsVideo)&&!i.isNewsArticle&&"borderless"!==i.uiCardType&&!i.fluentRefresh)}),null)}function it(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"div",[],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{ngClass:[0,"ngClass"]},null)],(function(e,t){e(t,1,0,t.component.item.documentIconWithSize("64x64"))}),null)}function nt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,0,"img",[["class","document-icon--64x64"]],[[8,"src",4]],null,null,null,null))],null,(function(e,t){e(t,0,0,n.Ob(1,"",t.component.item.iconUrl,""))}))}function rt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,"div",[["class","document-card__thumbnail-placeholder"]],null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,it)),n.Gb(2,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,nt)),n.Gb(4,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,!i.item.iconUrl),e(t,4,0,i.item.iconUrl)}),null)}function at(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,"div",[["class","mru-list-item__icon-in-preview"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.n,[n.o,n.y,n.K],{ngStyle:[0,"ngStyle"]},null),n.Zb(2,{color:0}),(e()(),n.Hb(3,0,null,null,1,"ohp-icon-font",[["size","16"]],null,null,null,C.b,C.a)),n.Gb(4,638976,[[3,4],["fileIconElement",4]],0,w.a,[s.a],{iconFontCssClass:[0,"iconFontCssClass"],size:[1,"size"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.iconFontColor());e(t,1,0,n),e(t,4,0,i.iconFontClass(),"16")}),null)}function ot(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"div",[["class","mru-list-item__icon-in-preview mru-list-item__document-icon-in-preview"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null)],(function(e,t){e(t,1,0,"mru-list-item__icon-in-preview mru-list-item__document-icon-in-preview",t.component.item.documentIconWithSize("20x20"))}),null)}function st(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,"div",[],null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,at)),n.Gb(2,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,ot)),n.Gb(4,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,i.iconFontClass()),e(t,4,0,!i.iconFontClass())}),null)}function lt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,null,null,null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,rt)),n.Gb(2,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,st)),n.Gb(4,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(0,null,null,0))],(function(e,t){var i=t.component;e(t,2,0,(!i.thumbnailLoaded||!i.thumbnailUrl)&&!i.isStreamsVideo||!i.streamsThumbnailLoaded&&i.isStreamsVideo),e(t,4,0,!i.recommendedNewCards&&(i.thumbnailUrl&&i.thumbnailLoaded||i.streamsThumbnailLoaded&&i.isStreamsVideo)&&!i.isNewsArticle&&"borderless"!==i.uiCardType&&!i.fluentRefresh)}),null)}function ct(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,12,"div",[["class","document-card__thumbnail-container"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"document-card__thumbnail-container--recommended":0,"document-card_thumbnail-container--rounded document-card__thumbnail-container--borderless":1,"document-card__thumbnail-container--rounded-card":2,"document-card__thumbnail-container--suggested-actions":3}),(e()(),n.qb(16777216,null,null,1,null,je)),n.Gb(4,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,qe)),n.Gb(6,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Ze)),n.Gb(8,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,tt)),n.Gb(10,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,lt)),n.Gb(12,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.isRecommended||i.isOfficeFeed,"borderless"===i.uiCardType,(i.isRecommended||i.isOfficeFeed)&&i.recommendedNewCards,i.fluentRefresh);e(t,1,0,"document-card__thumbnail-container",n),e(t,4,0,i.isStreamsVideo),e(t,6,0,i.thumbnailApiEnabled&&!i.isStreamsVideo&&!i.isNewsArticle&&!i.isMicrosoftForms),e(t,8,0,(!i.thumbnailApiEnabled||i.isNewsArticle||i.isMicrosoftForms)&&i.thumbnailUrl&&!i.isStreamsVideo),e(t,10,0,i.thumbnailApiEnabled),e(t,12,0,!i.thumbnailApiEnabled)}),null)}function ut(e){return n.jc(0,[(e()(),n.qb(0,null,null,0))],null,null)}function dt(e){return n.jc(0,[(e()(),n.qb(16777216,null,null,1,null,ut)),n.Gb(1,540672,null,0,S.o,[n.W],{ngTemplateOutlet:[0,"ngTemplateOutlet"]},null),(e()(),n.qb(0,null,null,0))],(function(e,t){e(t,1,0,n.Wb(t.parent.parent,38))}),null)}function ht(e){return n.jc(0,[(e()(),n.qb(0,null,null,0))],null,null)}function pt(e){return n.jc(0,[(e()(),n.qb(16777216,null,null,1,null,ht)),n.Gb(1,540672,null,0,S.o,[n.W],{ngTemplateOutlet:[0,"ngTemplateOutlet"]},null),(e()(),n.qb(0,null,null,0))],(function(e,t){e(t,1,0,n.Wb(t.parent.parent,39))}),null)}function mt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-activity-description",[],null,null,null,r.b,r.a)),n.Gb(1,5226496,null,0,a.a,[o.a,s.a,n.h,l.a,c.b,u.a,d.a,h.a,p.a,m.a,f.a,g.a,b.a,v.b],{activities:[0,"activities"],iconSize:[1,"iconSize"],activityDeepLink:[2,"activityDeepLink"],title:[3,"title"],docId:[4,"docId"],index:[5,"index"],fileType:[6,"fileType"],navId:[7,"navId"],numLines:[8,"numLines"],teamsDeepLink:[9,"teamsDeepLink"],area:[10,"area"]},null)],(function(e,t){var i=t.component;e(t,1,1,[i.item.lastModifiedActivity,20,i.recommendedDeepLinkEnabled&&i.activityDeepLink,i.recommendedNewCards&&i.item.title,i.item.docId,i.index,i.item.fileType,i.item.navigationId,2,i.recommendedTeamsLinkEnabled&&i.teamsDeepLink,i.instrumentationArea])}),null)}function ft(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,"div",[["class","list-item__flex-grow"]],null,null,null,null,null)),(e()(),n.Hb(1,0,null,null,3,"ohp-activity-description",[],null,null,null,r.b,r.a)),n.Gb(2,5226496,null,0,a.a,[o.a,s.a,n.h,l.a,c.b,u.a,d.a,h.a,p.a,m.a,f.a,g.a,b.a,v.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],iconSize:[2,"iconSize"],activityDeepLink:[3,"activityDeepLink"],title:[4,"title"],docId:[5,"docId"],activityDescriptionInput:[6,"activityDescriptionInput"],index:[7,"index"],fileType:[8,"fileType"],numLines:[9,"numLines"],teamsDeepLink:[10,"teamsDeepLink"],area:[11,"area"]},null),(e()(),n.qb(16777216,null,0,1,null,mt)),n.Gb(4,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,1,[i.item.activities,i.item.lastViewedTime,20,i.recommendedDeepLinkEnabled&&i.activityDeepLink,i.recommendedNewCards&&i.item.title,i.item.docId,i.item.activity,i.index,i.item.fileType,2,i.recommendedTeamsLinkEnabled&&i.teamsDeepLink,i.instrumentationArea]),e(t,4,0,i.item.lastModifiedActivity&&!i.item.activity)}),null)}function gt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,"div",[["class","document-card__menu"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"document-card__menu--hidden":0}),(e()(),n.Hb(3,0,null,null,1,"ohp-actions-menu",[],null,[[null,"menuToggled"],[null,"menuFocused"]],(function(e,t,i){var n=!0,r=e.component;return"menuToggled"===t&&(n=!1!==r.onActionsMenuToggle(i)&&n),"menuFocused"===t&&(n=!1!==(i?r.onFocus():r.onBlur())&&n),n}),I.b,I.a)),n.Gb(4,770048,[[10,4]],0,T.a,[k.a,s.a,l.a,n.o,A.b,d.a,h.a,n.K],{menuModel:[0,"menuModel"],listItemIndex:[1,"listItemIndex"],iconClass:[2,"iconClass"],area:[3,"area"],dataSecurity:[4,"dataSecurity"],leftAlignedCard:[5,"leftAlignedCard"],documentName:[6,"documentName"],actionContextMenuEnabled:[7,"actionContextMenuEnabled"],actionContextMenu:[8,"actionContextMenu"]},{menuToggled:"menuToggled",menuFocused:"menuFocused"})],(function(e,t){var i=t.component,n=e(t,2,0,!i.isTouch);e(t,1,0,"document-card__menu",n),e(t,4,0,i.contextMenu,i.index,i.fluentRefresh?"":"commanding-item__icon ms-fcl-nd",i.instrumentationArea,i.dataSecurityThreshold,i.leftAlignActionsMenu,i.item.fileName,i.actionContextMenuEnabled,i.actionContextMenu)}),null)}function bt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,6,"div",[["class","document-card__info centered-flex-container"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"document-card__info--expanded":0,"document-card__info--fluent":1}),(e()(),n.qb(16777216,null,null,1,null,ft)),n.Gb(4,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,gt)),n.Gb(6,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,"borderless"===i.uiCardType,i.fluentRefresh);e(t,1,0,"document-card__info centered-flex-container",n),e(t,4,0,i.showActivity),e(t,6,0,i.showActionsMenu)}),null)}function vt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,2,"div",[],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"document-card__title-icon--hidden":0})],(function(e,t){var i=t.component,n="document-card__title-icon "+i.item.documentIconWithSize("32x32"),r=e(t,2,0,i.isUpcomingMeeting||i.isMyAnalytics);e(t,1,0,n,r)}),null)}function St(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,0,"img",[["class","document-icon--32x32 document-card__title-icon"]],[[8,"src",4]],null,null,null,null))],null,(function(e,t){e(t,0,0,n.Ob(1,"",t.component.item.iconUrl,""))}))}function yt(e){return n.jc(0,[(e()(),n.Hb(0,0,[[1,0],["titleElement",1]],null,4,"span",[],[[8,"title",0]],[[null,"mouseenter"],[null,"mouseleave"],[null,"click"]],(function(e,t,i){var r=!0;return"mouseenter"===t&&(r=!1!==n.Wb(e,3).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==n.Wb(e,3).onMouseLeave()&&r),"click"===t&&(r=!1!==n.Wb(e,3).onClick()&&r),r}),null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{ngClass:[0,"ngClass"]},null),n.Zb(2,{"ms-fcl-tp-h ms-fcl-tdr-f ms-fcl-tdr-a mru-list-item__title--themed":0}),n.Gb(3,16384,null,0,_.a,[s.a,d.a],{area:[0,"area"]},null),(e()(),n.gc(4,null,["",""]))],(function(e,t){var i=t.component,n=e(t,2,0,i.clickableFolderEnabled);e(t,1,0,n),e(t,3,0,i.instrumentationArea)}),(function(e,t){var i=t.component;e(t,0,0,i.item.title),e(t,4,0,i.item.title)}))}function Ct(e){return n.jc(0,[(e()(),n.Hb(0,0,[[1,0],["titleElement",1]],null,4,"h4",[],[[8,"title",0]],[[null,"mouseenter"],[null,"mouseleave"],[null,"click"]],(function(e,t,i){var r=!0;return"mouseenter"===t&&(r=!1!==n.Wb(e,3).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==n.Wb(e,3).onMouseLeave()&&r),"click"===t&&(r=!1!==n.Wb(e,3).onClick()&&r),r}),null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{ngClass:[0,"ngClass"]},null),n.Zb(2,{"ms-fcl-tp-h ms-fcl-tdr-f ms-fcl-tdr-a mru-list-item__title--themed":0}),n.Gb(3,16384,null,0,_.a,[s.a,d.a],{area:[0,"area"]},null),(e()(),n.gc(4,null,["",""]))],(function(e,t){var i=t.component,n=e(t,2,0,i.clickableFolderEnabled);e(t,1,0,n),e(t,3,0,i.instrumentationArea)}),(function(e,t){var i=t.component;e(t,0,0,i.item.title),e(t,4,0,i.item.title)}))}function wt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,0,"span",[["class","ms-fcl-ns ms-fcl-tp-h ms-fcl-tdr-f ms-fcl-tdr-a attribution-link"],["role","link"],["tabindex","0"]],[[1,"data-href",0],[1,"aria-label",0],[8,"title",0],[8,"innerHTML",1]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.onPathClick(i)&&n),"keyup.enter"===t&&(n=!1!==r.onPathClick(i)&&n),"focus"===t&&(n=!1!==r.onFocus()&&n),"blur"===t&&(n=!1!==r.onBlur()&&n),n}),null,null))],null,(function(e,t){var i=t.component;e(t,0,0,n.Ob(1,"",i.item.isEmailAttachment?i.url:i.item.attributionUrl,""),i.openFolderAriaLabel,n.Ob(1,"",i.openFolderAriaLabel,""),i.shortPath)}))}function It(e){return n.jc(0,[(e()(),n.Hb(0,0,[[4,0],["attributionElement",1]],null,0,"span",[],[[8,"innerHTML",1]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.component.shortPath)}))}function Tt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,"div",[["class","list-item__text--small list-item__secondary ms-fcl-ns"]],null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,wt)),n.Gb(2,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,It)),n.Gb(4,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,i.clickableFolderEnabled&&(i.item.isEmailAttachment?i.url:i.item.attributionUrl)),e(t,4,0,!i.clickableFolderEnabled)}),null)}function kt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,"span",[["class","list-item__text--small list-item__title ms-fcl-ns"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"document-card__text--small":0}),(e()(),n.Hb(3,0,null,null,1,"span",[],[[8,"title",0]],null,null,null,null)),(e()(),n.gc(4,null,["",""]))],(function(e,t){var i=e(t,2,0,t.component.fluentRefresh);e(t,1,0,"list-item__text--small list-item__title ms-fcl-ns",i)}),(function(e,t){var i=t.component;e(t,3,0,i.item.createdBy),e(t,4,0,i.item.createdBy)}))}function At(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-icon-font",[["class","categories-card--center"],["size","16"]],[[1,"aria-label",0]],null,null,C.b,C.a)),n.Gb(1,638976,null,0,w.a,[s.a],{color:[0,"color"],cssClass:[1,"cssClass"],iconFontType:[2,"iconFontType"],size:[3,"size"],title:[4,"title"]},null)],(function(e,t){var i=t.component;e(t,1,0,i.categoryIcon.categoryFontIconColor,"categories-card--center"+(i.isCardCreateByLabel&&null!=i.item&&i.item.createdBy?" categories--padding-left":""),i.categoryIcon&&i.categoryIcon.categoryFontIcon,"16",i.categoryIcon.categoryTooltip)}),(function(e,t){e(t,0,0,t.component.categoryIcon.categoryAriaLabel)}))}function _t(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,"div",[["class","list-item__text--small list-item__tertiary ms-fcl-nd list-item--bottom"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"document-card__text--small":0}),(e()(),n.Hb(3,0,[[1,0],["titleElement",1]],null,1,"span",[],[[8,"title",0]],null,null,null,null)),(e()(),n.gc(4,null,["",""]))],(function(e,t){var i=e(t,2,0,t.component.fluentRefresh);e(t,1,0,"list-item__text--small list-item__tertiary ms-fcl-nd list-item--bottom",i)}),(function(e,t){var i=t.component;e(t,3,0,i.borderlessCardDetail1),e(t,4,0,i.borderlessCardDetail1)}))}function Pt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,18,"div",[["class","list-item__flex-grow"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"list-item--h-100":0}),(e()(),n.Hb(3,0,null,null,6,"div",[["class","list-item__title ms-fcl-nd"]],null,null,null,null,null)),n.Gb(4,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(5,{"list-item__title--double-line":0,"list-item__text--large":1,"list-item__text--large--fluent":2}),(e()(),n.qb(16777216,null,null,1,null,yt)),n.Gb(7,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Ct)),n.Gb(9,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Tt)),n.Gb(11,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.Hb(12,0,null,null,4,"div",[["style","display:flex;"]],null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,kt)),n.Gb(14,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,At)),n.Gb(16,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,_t)),n.Gb(18,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,"borderless"===i.uiCardType);e(t,1,0,"list-item__flex-grow",n);var r=e(t,5,0,"borderless"===i.uiCardType,!i.fluentRefresh,i.fluentRefresh);e(t,4,0,"list-item__title ms-fcl-nd",r),e(t,7,0,"borderless"!==i.uiCardType),e(t,9,0,"borderless"===i.uiCardType),e(t,11,0,!i.fluentRefresh&&!!i.shortPath&&"borderless"!==i.uiCardType),e(t,14,0,i.isCardCreateByLabel&&(null==i.item?null:i.item.createdBy)),e(t,16,0,i.categoryIcon&&i.categoryIcon.categoryFontIcon),e(t,18,0,i.isFormResponsesEnabled&&i.borderlessCardDetail1)}),null)}function Et(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,9,"div",[["class","list-item__flex-grow"]],null,[[null,"click"],[null,"keyup.enter"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.onPathClick(i)&&n),"keyup.enter"===t&&(n=!1!==r.onPathClick(i)&&n),n}),null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"list-item--h-100":0}),(e()(),n.Hb(3,0,null,null,6,"div",[["class","upcomingMeeting-card__join_text"]],null,null,null,null,null)),n.Gb(4,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(5,{"upcomingMeeting-card__join_text--fluent":0}),(e()(),n.Hb(6,0,null,null,1,"ohp-icon-font",[["size","16"]],null,null,null,C.b,C.a)),n.Gb(7,638976,null,0,w.a,[s.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null),(e()(),n.Hb(8,0,null,null,1,"span",[["role","link"],["tabindex","0"]],[[1,"data-href",0],[1,"aria-label",0],[8,"title",0]],[[null,"focus"],[null,"blur"]],(function(e,t,i){var n=!0,r=e.component;return"focus"===t&&(n=!1!==r.onFocus()&&n),"blur"===t&&(n=!1!==r.onBlur()&&n),n}),null,null)),(e()(),n.gc(9,null,[""," "]))],(function(e,t){var i=t.component,n=e(t,2,0,"borderless"===i.uiCardType);e(t,1,0,"list-item__flex-grow",n);var r=e(t,5,0,i.fluentRefresh);e(t,4,0,"upcomingMeeting-card__join_text",r),e(t,7,0,"upcomingMeeting-card_logo"+(i.fluentRefresh?" upcomingMeeting-card_logo--fluent":""),i.item.isTeamsMeeting?"Teams":"Calendar","16")}),(function(e,t){var i=t.component;e(t,8,0,i.item.joinUrl,i.item.joinMeetingText,i.item.joinMeetingText),e(t,9,0,i.item.joinMeetingText)}))}function Ft(e){return n.jc(0,[(e()(),n.Hb(0,0,[[8,0],["myAnalyticsAddToDoLink",1]],null,1,"span",[["class","myAnalytics-card_action_AddToTODo"],["role","link"],["tabindex","0"]],[[8,"title",0]],[[null,"focus"],[null,"blur"],[null,"click"],[null,"keyup.enter"]],(function(e,t,i){var n=!0,r=e.component;return"focus"===t&&(n=!1!==r.onFocus()&&n),"blur"===t&&(n=!1!==r.onBlur()&&n),"click"===t&&(n=!1!==r.onMyAnalyticsClick(i,r.PotentialActionType.PromoteTask)&&n),"keyup.enter"===t&&(n=!1!==r.onMyAnalyticsClick(i,r.PotentialActionType.PromoteTask)&&n),n}),null,null)),(e()(),n.gc(1,null,[""," "]))],null,(function(e,t){var i=t.component;e(t,0,0,i.addToToDoText),e(t,1,0,i.addToToDoText)}))}function Ot(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,2,"span",[["class","myAnalytics-card_viewInTodoIcon"]],null,null,null,null,null)),(e()(),n.Hb(1,0,null,null,1,"ohp-icon-font",[["cssClass","is-new-icon is-new-icon--tile ms-fcl-tp"],["iconFontName","ToDo"],["size","24"]],[[1,"aria-label",0]],null,null,C.b,C.a)),n.Gb(2,638976,null,0,w.a,[s.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],title:[3,"title"]},null)],(function(e,t){e(t,2,0,"is-new-icon is-new-icon--tile ms-fcl-tp","ToDo","24",t.component.viewInToDoText)}),(function(e,t){e(t,1,0,t.component.viewInToDoText)}))}function Dt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"span",[["class","myAnalytics-card_action_ViewInToDo"],["role","link"],["tabindex","0"]],[[8,"title",0]],[[null,"focus"],[null,"blur"],[null,"click"],[null,"keyup.enter"]],(function(e,t,i){var n=!0,r=e.component;return"focus"===t&&(n=!1!==r.onFocus()&&n),"blur"===t&&(n=!1!==r.onBlur()&&n),"click"===t&&(n=!1!==r.onViewToDoClick()&&n),"keyup.enter"===t&&(n=!1!==r.onViewToDoClick()&&n),n}),null,null)),(e()(),n.gc(1,null,[""," "]))],null,(function(e,t){var i=t.component;e(t,0,0,i.viewInToDoText),e(t,1,0,i.viewInToDoText)}))}function Mt(e){return n.jc(0,[(e()(),n.Hb(0,0,[[9,0],["myAnalyticsTaskDoneLink",1]],null,1,"span",[["class","myAnalytics-card_action_Done"],["role","link"],["tabindex","0"]],[[8,"title",0]],[[null,"focus"],[null,"blur"],[null,"click"],[null,"keyup.enter"]],(function(e,t,i){var n=!0,r=e.component;return"focus"===t&&(n=!1!==r.onFocus()&&n),"blur"===t&&(n=!1!==r.onBlur()&&n),"click"===t&&(n=!1!==r.onMyAnalyticsClick(i,r.PotentialActionType.MarkTaskAsDone)&&n),"keyup.enter"===t&&(n=!1!==r.onMyAnalyticsClick(i,r.PotentialActionType.MarkTaskAsDone)&&n),n}),null,null)),(e()(),n.gc(1,null,[""," "]))],null,(function(e,t){var i=t.component;e(t,0,0,i.doneText),e(t,1,0,i.doneText)}))}function Rt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,11,"div",[["class","list-item__flex-grow"]],null,[[null,"click"],[null,"keyup.enter"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.disableClick()&&n),"keyup.enter"===t&&(n=!1!==r.disableClick()&&n),n}),null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"list-item--h-100":0}),(e()(),n.Hb(3,0,null,null,8,"div",[["class","myAnalytics-card_action ms-fcl-tp"]],null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,Ft)),n.Gb(5,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Ot)),n.Gb(7,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Dt)),n.Gb(9,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Mt)),n.Gb(11,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,"borderless"===i.uiCardType);e(t,1,0,"list-item__flex-grow",n),e(t,5,0,i.myAnalyticsState===i.MYA_ITEM_VIEW_STATE),e(t,7,0,i.myAnalyticsState===i.MYA_ITEM_ADDED_STATE),e(t,9,0,i.myAnalyticsState===i.MYA_ITEM_ADDED_STATE),e(t,11,0,i.myAnalyticsState===i.MYA_ITEM_VIEW_STATE)}),null)}function xt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,"div",[["class","document-card__menu"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"document-card__menu--hidden":0}),(e()(),n.Hb(3,0,null,null,1,"ohp-actions-menu",[],null,[[null,"menuToggled"],[null,"menuFocused"]],(function(e,t,i){var n=!0,r=e.component;return"menuToggled"===t&&(n=!1!==r.onActionsMenuToggle(i)&&n),"menuFocused"===t&&(n=!1!==(i?r.onFocus():r.onBlur())&&n),n}),I.b,I.a)),n.Gb(4,770048,[[10,4]],0,T.a,[k.a,s.a,l.a,n.o,A.b,d.a,h.a,n.K],{menuModel:[0,"menuModel"],listItemIndex:[1,"listItemIndex"],iconClass:[2,"iconClass"],area:[3,"area"],dataSecurity:[4,"dataSecurity"],leftAlignedCard:[5,"leftAlignedCard"],documentName:[6,"documentName"],actionContextMenuEnabled:[7,"actionContextMenuEnabled"],actionContextMenu:[8,"actionContextMenu"]},{menuToggled:"menuToggled",menuFocused:"menuFocused"})],(function(e,t){var i=t.component,n=e(t,2,0,!i.isTouch);e(t,1,0,"document-card__menu",n),e(t,4,0,i.contextMenu,i.index,i.fluentRefresh?"":"commanding-item__icon ms-fcl-nd",i.instrumentationArea,i.dataSecurityThreshold,i.leftAlignActionsMenu,i.item.fileName,i.actionContextMenuEnabled,i.actionContextMenu)}),null)}function Lt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,14,"div",[["class","document-card__info centered-flex-container"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"document-card__info--expanded":0,"document-card__info--fluent":1}),(e()(),n.qb(16777216,null,null,1,null,vt)),n.Gb(4,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,St)),n.Gb(6,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Pt)),n.Gb(8,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Et)),n.Gb(10,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Rt)),n.Gb(12,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,xt)),n.Gb(14,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,"borderless"===i.uiCardType,i.fluentRefresh);e(t,1,0,"document-card__info centered-flex-container",n),e(t,4,0,i.fluentRefresh&&!i.mruAppType&&!i.item.iconUrl),e(t,6,0,i.fluentRefresh&&!i.mruAppType&&i.item.iconUrl),e(t,8,0,!i.isUpcomingMeeting&&!i.isMyAnalytics),e(t,10,0,i.isUpcomingMeeting),e(t,12,0,i.isMyAnalytics),e(t,14,0,i.showActionsMenu)}),null)}function Ut(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,16,"div",[["class","document-card ms-bgc-w"]],[[24,"@recommendedCardHover",0]],[[null,"mouseover"],[null,"mouseleave"]],(function(e,t,i){var n=!0,r=e.component;return"mouseover"===t&&(n=!1!==r.recommendedHover("hovered")&&n),"mouseleave"===t&&(n=!1!==r.recommendedHover("unhovered")&&n),n}),null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"carousel-card":0,"document-card--no-padding":1,"document-card--motion":2,"document-card--fluent":3}),(e()(),n.qb(16777216,null,null,1,null,Re)),n.Gb(4,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Le)),n.Gb(6,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,ct)),n.Gb(8,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,dt)),n.Gb(10,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,pt)),n.Gb(12,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,bt)),n.Gb(14,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Lt)),n.Gb(16,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.isRecommended||i.isOfficeFeed,"borderless"===i.uiCardType||i.fluentRefresh,i.recommendedNewCards,i.fluentRefresh);e(t,1,0,"document-card ms-bgc-w",n),e(t,4,0,i.showActivity&&!i.recommendedNewCards&&!i.isMyAnalytics),e(t,6,0,i.showActivity&&!i.recommendedNewCards&&i.isMyAnalytics),e(t,8,0,!i.isUpcomingMeeting&&!i.isMyAnalytics),e(t,10,0,i.isUpcomingMeeting),e(t,12,0,i.isMyAnalytics),e(t,14,0,i.recommendedNewCards),e(t,16,0,!i.recommendedNewCards)}),(function(e,t){e(t,0,0,t.component.isHovered)}))}function Nt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-activity-description",[],null,null,null,r.b,r.a)),n.Gb(1,5226496,null,0,a.a,[o.a,s.a,n.h,l.a,c.b,u.a,d.a,h.a,p.a,m.a,f.a,g.a,b.a,v.b],{activities:[0,"activities"],activityDeepLink:[1,"activityDeepLink"],docId:[2,"docId"],index:[3,"index"],fileType:[4,"fileType"],navId:[5,"navId"],numLines:[6,"numLines"],teamsDeepLink:[7,"teamsDeepLink"],area:[8,"area"]},null)],(function(e,t){var i=t.component;e(t,1,0,i.item.lastModifiedActivity,i.recommendedDeepLinkEnabled&&i.activityDeepLink,i.item.docId,i.index,i.item.fileType,i.item.navigationId,2,i.recommendedTeamsLinkEnabled&&i.teamsDeepLink,i.instrumentationArea)}),null)}function Wt(e){return n.jc(0,[(e()(),n.qb(0,null,null,0))],null,null)}function jt(e){return n.jc(0,[(e()(),n.qb(16777216,null,null,1,null,Wt)),n.Gb(1,540672,null,0,S.o,[n.W],{ngTemplateOutlet:[0,"ngTemplateOutlet"]},null),(e()(),n.qb(0,null,null,0))],(function(e,t){e(t,1,0,n.Wb(t.parent.parent,38))}),null)}function Ht(e){return n.jc(0,[(e()(),n.qb(0,null,null,0))],null,null)}function Bt(e){return n.jc(0,[(e()(),n.qb(16777216,null,null,1,null,Ht)),n.Gb(1,540672,null,0,S.o,[n.W],{ngTemplateOutlet:[0,"ngTemplateOutlet"]},null),(e()(),n.qb(0,null,null,0))],(function(e,t){e(t,1,0,n.Wb(t.parent.parent,39))}),null)}function Gt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,0,"div",[["class","opacity-overlay"]],null,null,null,null,null))],null,null)}function qt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,3,"div",[["class","document-card--suggested-actions--fallback-background"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.n,[n.o,n.y,n.K],{ngStyle:[0,"ngStyle"]},null),n.Yb(131072,S.b,[n.h]),n.Zb(3,{"background-color":0})],(function(e,t){var i=t.component,r=e(t,3,0,n.hc(t,1,0,n.Wb(t,2).transform(i.workloadColorPromise)));e(t,1,0,r)}),null)}function Vt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,0,"img",[["class","document-card__thumbnail"]],[[8,"src",4],[8,"alt",0]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.context.ngIf,n.Ob(1,"",t.component.thumbnailAltText,""))}))}function $t(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,0,"div",[],[[8,"className",0]],null,null,null,null))],null,(function(e,t){e(t,0,0,n.Ob(1,"icon--suggested-actions--fallback ",t.component.suggestedActionsIcon(),""))}))}function zt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,15,null,null,null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,Gt)),n.Gb(2,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,qt)),n.Gb(4,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.Hb(5,0,null,null,5,"div",[["class","document-card__thumbnail-wrapper"]],[[8,"hidden",0]],null,null,null,null)),n.Gb(6,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(7,{"document-card__thumbnail-wrapper--centered":0}),(e()(),n.qb(16777216,null,null,2,null,Vt)),n.Gb(9,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),n.Yb(131072,S.b,[n.h]),(e()(),n.Hb(11,0,null,null,2,"div",[["class","document-card__icon-container ms-bgc-w"]],null,null,null,null,null)),(e()(),n.Hb(12,0,null,null,1,"div",[["class","mru-list-item__icon-in-preview icon--suggested-actions"]],null,null,null,null,null)),(e()(),n.Hb(13,0,null,null,0,"div",[],[[8,"className",0]],null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,$t)),n.Gb(15,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(0,null,null,0))],(function(e,t){var i=t.component;e(t,2,0,i.thumbnailLoaded),e(t,4,0,!i.thumbnailLoaded);var r=e(t,7,0,i.centerThumbnail);e(t,6,0,"document-card__thumbnail-wrapper",r),e(t,9,0,n.hc(t,9,0,n.Wb(t,10).transform(i.thumbnail))),e(t,15,0,!i.thumbnailLoaded)}),(function(e,t){var i=t.component;e(t,5,0,!i.thumbnailLoaded),e(t,13,0,n.Ob(1,"icon--suggested-actions--inner ",i.suggestedActionsIcon(),""))}))}function Zt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,0,"div",[["class","opacity-overlay"]],null,null,null,null,null))],null,null)}function Kt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,0,"div",[],[[8,"className",0]],null,null,null,null))],null,(function(e,t){e(t,0,0,n.Ob(1,"icon--suggested-actions--fallback ",t.component.suggestedActionsIcon(),""))}))}function Jt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,17,null,null,null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,Zt)),n.Gb(2,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.Hb(3,0,null,null,9,"div",[["class","document-card__thumbnail-wrapper"]],[[8,"hidden",0]],null,null,null,null)),n.Gb(4,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(5,{"document-card__thumbnail-wrapper--centered":0}),n.Gb(6,278528,null,0,S.n,[n.o,n.y,n.K],{ngStyle:[0,"ngStyle"]},null),n.Zb(7,{"background-color":0}),(e()(),n.Hb(8,0,null,null,4,"img",[["class","document-card__thumbnail"]],[[8,"src",4],[8,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,i){var n=!0,r=e.component;return"load"===t&&(n=!1!==r.onThumbnailLoad()&&n),"error"===t&&(n=!1!==r.onThumbnailError()&&n),n}),null,null)),n.Gb(9,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(10,{"document-card__thumbnail-officefeed-news":0}),n.ac(11,1),n.Yb(131072,S.b,[n.h]),(e()(),n.Hb(13,0,null,null,2,"div",[["class","document-card__icon-container ms-bgc-w"]],null,null,null,null,null)),(e()(),n.Hb(14,0,null,null,1,"div",[["class","mru-list-item__icon-in-preview icon--suggested-actions"]],null,null,null,null,null)),(e()(),n.Hb(15,0,null,null,0,"div",[],[[8,"className",0]],null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,Kt)),n.Gb(17,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(0,null,null,0))],(function(e,t){var i=t.component;e(t,2,0,i.thumbnailLoaded);var n=e(t,5,0,i.centerThumbnail);e(t,4,0,"document-card__thumbnail-wrapper",n);var r=e(t,7,0,i.item.thumbnails&&i.item.thumbnails.backgroundColor?i.item.thumbnails.backgroundColor:"transparent");e(t,6,0,r);var a=e(t,10,0,i.isNewsArticle);e(t,9,0,"document-card__thumbnail",a),e(t,17,0,!i.thumbnailLoaded)}),(function(e,t){var i=t.component;e(t,3,0,!i.thumbnailLoaded);var r=i.thumbnailSWEnabled?n.hc(t,8,0,n.Wb(t,12).transform(n.hc(t,8,0,e(t,11,0,n.Wb(t.parent.parent.parent,1),i.thumbnailUrl)))):i.thumbnailUrl;e(t,8,0,r,n.Ob(1,"",i.thumbnailAltText,"")),e(t,15,0,n.Ob(1,"icon--suggested-actions--inner ",i.suggestedActionsIcon(),""))}))}function Qt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,6,"div",[["class","document-card__thumbnail-container document-card__thumbnail-container--suggested-actions"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"document-card__thumbnail-container--recommended":0,"document-card_thumbnail-container--rounded document-card__thumbnail-container--borderless":1}),(e()(),n.qb(16777216,null,null,1,null,zt)),n.Gb(4,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Jt)),n.Gb(6,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.isRecommended||i.isOfficeFeed,"borderless"===i.uiCardType);e(t,1,0,"document-card__thumbnail-container document-card__thumbnail-container--suggested-actions",n),e(t,4,0,i.thumbnailApiEnabled),e(t,6,0,!i.thumbnailApiEnabled&&i.thumbnailUrl)}),null)}function Yt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-icon-font",[["cssClass","icon--primary-action ms-fcl-bl"]],null,null,null,C.b,C.a)),n.Gb(1,638976,null,0,w.a,[s.a],{cssClass:[0,"cssClass"],iconFontType:[1,"iconFontType"],size:[2,"size"]},null)],(function(e,t){e(t,1,0,"icon--primary-action ms-fcl-bl",t.component.primaryActionIconFont,16)}),null)}function Xt(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,0,"div",[["class","suggested-action--svg-icon ms-fcl-bl"]],[[8,"innerHTML",1]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.component.checklistIcon)}))}function ei(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,2,"div",[["class","suggested-action--svg-icon"]],[[8,"innerHTML",1]],null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"suggested-action--svg--teams":0,"ms-fcl-bl":1})],(function(e,t){var i=t.component,n=e(t,2,0,i.item.isTeamsMeeting,!i.item.isTeamsMeeting);e(t,1,0,"suggested-action--svg-icon",n)}),(function(e,t){e(t,0,0,t.component.meetingIcon)}))}function ti(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,0,"div",[["class","suggested-action--svg-icon ms-fcl-bl"]],[[8,"innerHTML",1]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.component.replyIcon)}))}function ii(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,2,"div",[["class","list-item-column column--commanding"]],null,null,null,null,null)),(e()(),n.Hb(1,0,null,null,1,"ohp-actions-menu",[],null,[[null,"menuToggled"],[null,"menuFocused"]],(function(e,t,i){var n=!0,r=e.component;return"menuToggled"===t&&(n=!1!==r.onActionsMenuToggle(i)&&n),"menuFocused"===t&&(n=!1!==(i?r.onFocus():r.onBlur())&&n),n}),I.b,I.a)),n.Gb(2,770048,[[10,4]],0,T.a,[k.a,s.a,l.a,n.o,A.b,d.a,h.a,n.K],{menuModel:[0,"menuModel"],listItemIndex:[1,"listItemIndex"],iconClass:[2,"iconClass"],dataSecurity:[3,"dataSecurity"],documentName:[4,"documentName"],horizontalEllipsis:[5,"horizontalEllipsis"],actionContextMenuEnabled:[6,"actionContextMenuEnabled"],actionContextMenu:[7,"actionContextMenu"]},{menuToggled:"menuToggled",menuFocused:"menuFocused"})],(function(e,t){var i=t.component;e(t,2,0,i.contextMenu,i.index,i.fluentRefresh?"":"commanding-item__icon ms-fcl-nd",i.dataSecurityThreshold,i.item.fileName,!0,i.actionContextMenuEnabled,i.actionContextMenu)}),null)}function ni(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,28,"div",[["class","document-card document-card--suggested-action ms-bgc-w"]],null,null,null,null,null)),(e()(),n.Hb(1,0,null,null,6,"div",[["class","document-card__header document-card__header--fluent"]],null,null,null,null,null)),(e()(),n.Hb(2,0,null,null,4,"ohp-activity-description",[],null,null,null,r.b,r.a)),n.Gb(3,5226496,null,0,a.a,[o.a,s.a,n.h,l.a,c.b,u.a,d.a,h.a,p.a,m.a,f.a,g.a,b.a,v.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],showIcon:[2,"showIcon"],person:[3,"person"],activityDeepLink:[4,"activityDeepLink"],title:[5,"title"],docId:[6,"docId"],activityDescriptionInput:[7,"activityDescriptionInput"],index:[8,"index"],fileType:[9,"fileType"],navId:[10,"navId"],numLines:[11,"numLines"],teamsDeepLink:[12,"teamsDeepLink"],area:[13,"area"],timestampAndTitleInSameLine:[14,"timestampAndTitleInSameLine"]},null),n.ac(4,1),(e()(),n.qb(16777216,null,0,1,null,Nt)),n.Gb(6,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.Hb(7,0,null,null,0,"div",[["class","suggested-action--dismiss ms-fcl-bl"],["tabindex","0"]],[[8,"innerHTML",1],[8,"title",0],[1,"aria-label",0]],[[null,"click"],[null,"mouseover"],[null,"mouseleave"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.removeItem(i)&&n),"mouseover"===t&&(n=!1!==r.dismissHover(!0)&&n),"mouseleave"===t&&(n=!1!==r.dismissHover(!1)&&n),n}),null,null)),(e()(),n.qb(16777216,null,null,1,null,jt)),n.Gb(9,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Bt)),n.Gb(11,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Qt)),n.Gb(13,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.Hb(14,0,null,null,14,"div",[["class","suggested-actions-buttons-container centered-flex-container"]],null,null,null,null,null)),(e()(),n.Hb(15,0,null,null,11,"div",[["class","section__buttons-container suggested-actions-buttons-container__cta"]],null,null,null,null,null)),(e()(),n.Hb(16,0,null,null,10,"button",[["class","generic-button document-card__button--suggested-actions generic-button--fluentvnext--default"]],null,[[null,"click"]],(function(e,t,i){var n=!0;return"click"===t&&(n=!1!==e.component.onSelectPrimaryAction(i)&&n),n}),null,null)),(e()(),n.qb(16777216,null,null,1,null,Yt)),n.Gb(18,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Xt)),n.Gb(20,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,ei)),n.Gb(22,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,ti)),n.Gb(24,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.Hb(25,0,null,null,1,"span",[["class","generic-button__text ms-fcl-bl"]],null,null,null,null,null)),(e()(),n.gc(26,null,["",""])),(e()(),n.qb(16777216,null,null,1,null,ii)),n.Gb(28,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,r=i.item.activities,a=i.item.lastViewedTime,o=!((null==i.item.activity||null==i.item.activity.people?null:i.item.activity.people.length)>0),s=n.hc(t,3,3,e(t,4,0,n.Wb(t.parent,0),(null==i.item.activity||null==i.item.activity.people?null:i.item.activity.people.length)>0&&(null==i.item.activity?null:i.item.activity.people[0])));e(t,3,1,[r,a,o,s,i.recommendedDeepLinkEnabled&&i.activityDeepLink,i.item.title,i.item.docId,i.item.activity,i.index,i.item.fileType,i.item.navigationId,2,i.recommendedTeamsLinkEnabled&&i.teamsDeepLink,i.instrumentationArea,!0]),e(t,6,0,i.item.lastModifiedActivity&&!i.item.activity),e(t,9,0,i.isUpcomingMeeting),e(t,11,0,i.isMyAnalytics),e(t,13,0,!i.isUpcomingMeeting&&!i.isMyAnalytics),e(t,18,0,i.primaryActionIconFont),e(t,20,0,!i.primaryActionIconFont&&i.showListSvg),e(t,22,0,!i.primaryActionIconFont&&i.showMeetingSvg),e(t,24,0,!i.primaryActionIconFont&&i.showReplySvg),e(t,28,0,i.showActionsMenu)}),(function(e,t){var i=t.component;e(t,7,0,i.dismissIsHover?i.dismissSquareFilled:i.dismissSquareRegular,i.dismissItemTitle,i.dismissItemTitle),e(t,26,0,i.primaryAction.title)}))}function ri(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,5,"img",[["class","generic-tile__thumbnail"]],[[8,"src",4],[8,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,i){var n=!0,r=e.component;return"load"===t&&(n=!1!==r.onThumbnailLoad()&&n),"error"===t&&(n=!1!==r.onThumbnailError()&&n),n}),null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Gb(2,278528,null,0,S.n,[n.o,n.y,n.K],{ngStyle:[0,"ngStyle"]},null),n.Zb(3,{"background-color":0}),n.ac(4,1),n.Yb(131072,S.b,[n.h])],(function(e,t){var i=t.component;e(t,1,0,"generic-tile__thumbnail","generic-tile__thumbnail--"+i.item.fileTypeName.toLowerCase());var n=e(t,3,0,i.item.thumbnails&&i.item.thumbnails.backgroundColor?i.item.thumbnails.backgroundColor:"transparent");e(t,2,0,n)}),(function(e,t){var i=t.component,r=n.hc(t,0,0,n.Wb(t,5).transform(n.hc(t,0,0,e(t,4,0,n.Wb(t.parent.parent.parent,1),i.thumbnailUrl))));e(t,0,0,r,n.Ob(1,"",i.thumbnailAltText,""))}))}function ai(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,3,"img",[["class","generic-tile__thumbnail"]],[[8,"src",4],[8,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,i){var n=!0,r=e.component;return"load"===t&&(n=!1!==r.onThumbnailLoad()&&n),"error"===t&&(n=!1!==r.onThumbnailError()&&n),n}),null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Gb(2,278528,null,0,S.n,[n.o,n.y,n.K],{ngStyle:[0,"ngStyle"]},null),n.Zb(3,{"background-color":0})],(function(e,t){var i=t.component;e(t,1,0,"generic-tile__thumbnail","generic-tile__thumbnail--"+i.item.fileTypeName.toLowerCase());var n=e(t,3,0,i.item.thumbnails&&i.item.thumbnails.backgroundColor?i.item.thumbnails.backgroundColor:"transparent");e(t,2,0,n)}),(function(e,t){var i=t.component;e(t,0,0,i.thumbnailUrl,n.Ob(1,"",i.thumbnailAltText,""))}))}function oi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,"div",[["class","document-tile__icon"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.n,[n.o,n.y,n.K],{ngStyle:[0,"ngStyle"]},null),n.Zb(2,{color:0}),(e()(),n.Hb(3,0,null,null,1,"ohp-icon-font",[["size","16"]],null,null,null,C.b,C.a)),n.Gb(4,638976,null,0,w.a,[s.a],{iconFontCssClass:[0,"iconFontCssClass"],size:[1,"size"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.iconFontColor());e(t,1,0,n),e(t,4,0,i.iconFontClass(),"16")}),null)}function si(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"div",[["class","document-tile__icon mru-list-item__document-icon-in-preview"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null)],(function(e,t){e(t,1,0,"document-tile__icon mru-list-item__document-icon-in-preview",t.component.item.documentIconWithSize("20x20"))}),null)}function li(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,10,"div",[],[[8,"hidden",0]],null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{ngClass:[0,"ngClass"]},null),n.Zb(2,{"generic-tile__images":0}),(e()(),n.qb(16777216,null,null,1,null,ri)),n.Gb(4,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,ai)),n.Gb(6,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,oi)),n.Gb(8,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,si)),n.Gb(10,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.thumbnailLoaded);e(t,1,0,n),e(t,4,0,i.thumbnailSWEnabled),e(t,6,0,!i.thumbnailSWEnabled),e(t,8,0,i.iconFontClass()),e(t,10,0,!i.iconFontClass())}),(function(e,t){e(t,0,0,!t.component.thumbnailLoaded)}))}function ci(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"div",[],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{ngClass:[0,"ngClass"]},null)],(function(e,t){e(t,1,0,t.component.item.documentIconWithSize("64x64"))}),null)}function ui(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,0,"img",[["class","document-icon--64x64"]],[[8,"src",4]],null,null,null,null))],null,(function(e,t){e(t,0,0,n.Ob(1,"",t.component.item.iconUrl,""))}))}function di(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,5,"div",[["class","generic-tile__fallback-image-container document-tile__fallback-image-container"]],null,null,null,null,null)),(e()(),n.Hb(1,0,null,null,4,"div",[["class","document-tile__fallback-image"]],null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,ci)),n.Gb(3,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,ui)),n.Gb(5,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,3,0,!i.item.iconUrl),e(t,5,0,i.item.iconUrl)}),null)}function hi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-icon-font",[["cssClass","is-new-icon is-new-icon--tile ms-fcl-tp"],["iconFontName","Glimmer"],["size","12"]],[[1,"aria-label",0]],null,null,C.b,C.a)),n.Gb(1,638976,null,0,w.a,[s.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],title:[3,"title"]},null)],(function(e,t){e(t,1,0,"is-new-icon is-new-icon--tile ms-fcl-tp","Glimmer","12",t.component.isNewTitle)}),(function(e,t){e(t,0,0,t.component.isNewTitle)}))}function pi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-icon-font",[["cssClass","document-tile__sharing document-tile__description__icon ms-fcl-np"],["iconFontName","People2"],["size","12"]],[[1,"aria-label",0]],null,null,C.b,C.a)),n.Gb(1,638976,null,0,w.a,[s.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){e(t,1,0,"document-tile__sharing document-tile__description__icon ms-fcl-np","People2","12")}),(function(e,t){e(t,0,0,t.component.sharedText)}))}function mi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,0,"span",[["class","ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a ms-fcl-ns attribution-link document-tile__attribution"],["role","link"],["tabindex","0"]],[[1,"aria-label",0],[1,"data-href",0],[8,"title",0],[8,"innerHTML",1]],[[null,"click"],[null,"keyup.enter"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.onPathClick(i)&&n),"keyup.enter"===t&&(n=!1!==r.onPathClick(i)&&n),n}),null,null))],null,(function(e,t){var i=t.component;e(t,0,0,i.openFolderAriaLabel,n.Ob(1,"",i.item.isEmailAttachment?i.url:i.item.attributionUrl,""),n.Ob(1,"",i.openFolderAriaLabel,""),i.shortPath)}))}function fi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,0,"span",[["class","document-tile__attribution list-item__text--small ms-fcl-ns"]],[[8,"innerHTML",1]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.component.shortPath)}))}function gi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,6,"div",[["class","document-tile__description"]],null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,pi)),n.Gb(2,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,mi)),n.Gb(4,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,fi)),n.Gb(6,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,i.showSharing&&(null==i.item.sharing?null:i.item.sharing.shared)),e(t,4,0,i.clickableFolderEnabled&&!!i.shortPath),e(t,6,0,!i.clickableFolderEnabled&&!!i.shortPath)}),null)}function bi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,23,"div",[["class","generic-tile"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"generic-tile--shadowed":0,"ms-bgc-nlh-h ms-bgc-nlp-a":1}),(e()(),n.Hb(3,0,null,null,4,"div",[["class","generic-tile__images_container"]],null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,li)),n.Gb(5,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,di)),n.Gb(7,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.Hb(8,0,null,null,9,"div",[["class","document-tile__title-and-icons"]],null,null,null,null,null)),(e()(),n.Hb(9,0,null,null,2,"span",[],[[24,"@fadeInIsNew",0]],null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,hi)),n.Gb(11,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.Hb(12,0,null,null,5,"div",[["class","document-tile__title list-item__text--medium ms-fcl-np"]],null,null,null,null,null)),(e()(),n.Hb(13,0,[[1,0],["titleElement",1]],null,4,"span",[],null,[[null,"mouseenter"],[null,"mouseleave"],[null,"click"]],(function(e,t,i){var r=!0;return"mouseenter"===t&&(r=!1!==n.Wb(e,16).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==n.Wb(e,16).onMouseLeave()&&r),"click"===t&&(r=!1!==n.Wb(e,16).onClick()&&r),r}),null,null)),n.Gb(14,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{ngClass:[0,"ngClass"]},null),n.Zb(15,{"ms-fcl-tda-h mru-list-item__title--hover":0}),n.Gb(16,16384,null,0,_.a,[s.a,d.a],{area:[0,"area"]},null),(e()(),n.gc(17,null,["",""])),(e()(),n.Hb(18,0,null,null,5,"div",[["class","document-tile__description-wrapper"]],null,null,null,null,null)),(e()(),n.Hb(19,0,null,null,4,"div",[["class","document-tile__description-container"]],null,null,null,null,null)),(e()(),n.Hb(20,0,null,null,3,"ohp-activity-description",[["iconCssClass","document-tile__description__icon"],["iconSize","12"]],null,null,null,r.b,r.a)),n.Gb(21,5226496,null,0,a.a,[o.a,s.a,n.h,l.a,c.b,u.a,d.a,h.a,p.a,m.a,f.a,g.a,b.a,v.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],iconCssClass:[2,"iconCssClass"],iconSize:[3,"iconSize"],activityDescriptionInput:[4,"activityDescriptionInput"],numLines:[5,"numLines"],useSolidIcon:[6,"useSolidIcon"]},null),(e()(),n.qb(16777216,null,0,1,null,gi)),n.Gb(23,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,r=e(t,2,0,!i.fluentRefresh,i.fluentRefresh);e(t,1,0,"generic-tile",r),e(t,5,0,i.thumbnailUrl),e(t,7,0,!i.thumbnailUrl||!i.thumbnailLoaded),e(t,11,0,i.isNew);var a=e(t,15,0,i.clickableFolderEnabled);e(t,14,0,a),e(t,16,0,i.instrumentationArea),e(t,21,0,i.showOnlyMruActivity?n.jb:i.item.activities,i.item.lastViewedTime,"document-tile__description__icon","12",i.mruActivity&&i.item.activity,1,!0),e(t,23,0,i.showSharing&&(null==i.item.sharing?null:i.item.sharing.shared)||!!i.shortPath)}),(function(e,t){var i=t.component;e(t,9,0,i.isNewAnimationState),e(t,17,0,i.item.title)}))}function vi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-icon-font",[["cssClass","is-new-icon ms-fcl-tp"],["iconFontName","Glimmer"],["size","12"]],[[1,"aria-label",0]],null,null,C.b,C.a)),n.Gb(1,638976,null,0,w.a,[s.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],title:[3,"title"]},null)],(function(e,t){e(t,1,0,"is-new-icon ms-fcl-tp","Glimmer","12",t.component.isNewTitle)}),(function(e,t){e(t,0,0,t.component.isNewTitle)}))}function Si(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-icon-font",[["iconFontName","People2"],["size","14"]],[[1,"aria-label",0]],null,null,C.b,C.a)),n.Gb(1,638976,null,0,w.a,[s.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],title:[3,"title"]},null)],(function(e,t){var i=t.component;e(t,1,0,"ms-fcl-np document-column--name__share-icon"+(i.showMobileShareAndActivity?" document-column--name__share-icon--mobile":""),"People2","14",i.sharedText)}),(function(e,t){e(t,0,0,t.component.sharedText)}))}function yi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),n.Hb(1,0,null,null,1,"span",[],[[8,"title",0]],null,null,null,null)),(e()(),n.gc(2,null,["",""]))],null,(function(e,t){var i=t.component;e(t,1,0,i.item.createdBy),e(t,2,0,i.item.createdBy)}))}function Ci(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-icon-font",[["class","categories-card--center"],["size","16"]],[[1,"aria-label",0]],null,null,C.b,C.a)),n.Gb(1,638976,null,0,w.a,[s.a],{color:[0,"color"],cssClass:[1,"cssClass"],iconFontCssClass:[2,"iconFontCssClass"],iconFontType:[3,"iconFontType"],size:[4,"size"],title:[5,"title"]},null)],(function(e,t){var i=t.component;e(t,1,0,i.categoryIcon.categoryFontIconColor,"categories-card--center categories-listview"+(i.isCardCreateByLabel&&null!=i.item&&i.item.createdBy?" categories--padding-left":""),i.categoryIcon.categoryFontIconCssClass?i.categoryIcon.categoryFontIconCssClass:"",i.categoryIcon&&i.categoryIcon.categoryFontIcon,"16",i.categoryIcon.categoryTooltip)}),(function(e,t){e(t,0,0,t.component.categoryIcon.categoryAriaLabel)}))}function wi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,0,null,null,null,null,null,null,null))],null,null)}function Ii(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,3,"ohp-activity-description",[],null,null,null,r.b,r.a)),n.Gb(1,5226496,null,0,a.a,[o.a,s.a,n.h,l.a,c.b,u.a,d.a,h.a,p.a,m.a,f.a,g.a,b.a,v.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],iconSize:[2,"iconSize"],activityDescriptionInput:[3,"activityDescriptionInput"],numLines:[4,"numLines"],mobileListItem:[5,"mobileListItem"],useSolidIcon:[6,"useSolidIcon"]},null),(e()(),n.qb(16777216,null,0,1,null,wi)),n.Gb(3,540672,null,0,S.o,[n.W],{ngTemplateOutlet:[0,"ngTemplateOutlet"]},null)],(function(e,t){var i=t.component;e(t,1,0,i.showOnlyMruActivity?n.jb:i.item.activities,i.item.lastViewedTime,12,i.mruActivity&&i.item.activity,1,!0,!0),e(t,3,0,n.Wb(t.parent,26))}),null)}function Ti(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,0,"span",[["class","ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a ms-fcl-ns attribution-link"],["role","link"],["tabindex","0"]],[[1,"aria-label",0],[1,"data-href",0],[8,"title",0],[8,"innerHTML",1]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.onPathClick(i)&&n),"keyup.enter"===t&&(n=!1!==r.onPathClick(i)&&n),"focus"===t&&(n=!1!==r.onFocus()&&n),"blur"===t&&(n=!1!==r.onBlur()&&n),n}),null,null))],null,(function(e,t){var i=t.component;e(t,0,0,i.openFolderAriaLabel,n.Ob(1,"",i.item.isEmailAttachment?i.url:i.item.attributionUrl,""),n.Ob(1,"",i.openFolderAriaLabel,""),i.item.attribution)}))}function ki(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),n.gc(1,null,[" "," "]))],null,(function(e,t){var i=t.component;e(t,1,0,null==i.item.emailReference?null:i.item.emailReference.Subject)}))}function Ai(e){return n.jc(0,[(e()(),n.Hb(0,0,[[4,0],["attributionElement",1]],null,0,"span",[],[[8,"innerHTML",1]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.component.item.attribution)}))}function _i(e){return n.jc(0,[(e()(),n.qb(16777216,null,null,1,null,Ti)),n.Gb(1,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,ki)),n.Gb(3,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Ai)),n.Gb(5,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(0,null,null,0))],(function(e,t){var i=t.component;e(t,1,0,i.clickableFolderEnabled&&!i.item.isEmailAttachment&&i.item.attribution),e(t,3,0,i.item.isEmailAttachment),e(t,5,0,!i.clickableFolderEnabled&&i.item.attribution)}),null)}function Pi(e){return n.jc(0,[(e()(),n.Hb(0,0,[[7,0],["shareTopLevel",1]],null,5,"span",[["aria-haspopup","true"],["class","commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a"],["keyboardFocusTooltip",""],["role","button"],["tabindex","0"]],[[1,"aria-label",0],[8,"title",0]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.onShareClick(i,"topLevel",r.ShareControlMode.Share)&&n),"keyup.enter"===t&&(n=!1!==r.onShareClick(i,"topLevel",r.ShareControlMode.Share)&&n),"focus"===t&&(n=!1!==r.onFocus()&&n),"blur"===t&&(n=!1!==r.onBlur()&&n),n}),null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"commanding-item--responsive":0,"commanding-item--disabled":1,"column--commanding-mobile":2}),n.Gb(3,4210688,null,0,P.a,[n.o,n.K,E.b],null,null),(e()(),n.Hb(4,0,null,null,1,"ohp-icon-font",[["cssClass","commanding-item__icon ms-fcl-nd"],["iconFontName","Share2"],["size","16"]],null,null,null,C.b,C.a)),n.Gb(5,638976,null,0,w.a,[s.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,!i.showMobileShareAndActivity,i.item.isLocal,i.showMobileShareAndActivity);e(t,1,0,"commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a",n),e(t,5,0,"commanding-item__icon ms-fcl-nd","Share2","16",!0)}),(function(e,t){var i=t.component;e(t,0,0,i.shareActionTitle,i.shareActionTitle)}))}function Ei(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,3,"span",[["aria-haspopup","true"],["class","commanding-item--responsive commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a"],["keyboardFocusTooltip",""],["role","button"],["tabindex","0"]],[[1,"aria-label",0],[8,"title",0]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.uploadLocal(i)&&n),"keyup.enter"===t&&(n=!1!==r.uploadLocal(i)&&n),"focus"===t&&(n=!1!==r.onFocus()&&n),"blur"===t&&(n=!1!==r.onBlur()&&n),n}),null,null)),n.Gb(1,4210688,null,0,P.a,[n.o,n.K,E.b],null,null),(e()(),n.Hb(2,0,null,null,1,"ohp-icon-font",[["cssClass","commanding-item__icon ms-fcl-nd"],["iconFontName","Upload"],["size","16"]],null,null,null,C.b,C.a)),n.Gb(3,638976,null,0,w.a,[s.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null)],(function(e,t){e(t,3,0,"commanding-item__icon ms-fcl-nd","Upload","16",!0)}),(function(e,t){var i=t.component;e(t,0,0,i.uploadLocalFileTitle,i.uploadLocalFileTitle)}))}function Fi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,5,"span",[["class","commanding-item--responsive commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a"],["keyboardFocusTooltip",""],["role","button"],["tabindex","0"]],[[1,"aria-label",0],[8,"title",0]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.pinItem(i,"topLevel")&&n),"keyup.enter"===t&&(n=!1!==r.pinItem(i,"topLevel")&&n),"focus"===t&&(n=!1!==r.onFocus()&&n),"blur"===t&&(n=!1!==r.onBlur()&&n),n}),null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"commanding-item--disabled":0}),n.Gb(3,4210688,null,0,P.a,[n.o,n.K,E.b],null,null),(e()(),n.Hb(4,0,null,null,1,"ohp-icon-font",[["cssClass","commanding-item__icon ms-fcl-nd"],["size","16"]],null,null,null,C.b,C.a)),n.Gb(5,638976,null,0,w.a,[s.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.item.isLocal);e(t,1,0,"commanding-item--responsive commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a",n),e(t,5,0,"commanding-item__icon ms-fcl-nd",i.pinActionIcon,"16",!0)}),(function(e,t){var i=t.component;e(t,0,0,i.pinActionTitle,i.pinActionTitle)}))}function Oi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,3,"span",[["class","commanding-item--responsive commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a"],["keyboardFocusTooltip",""],["role","button"],["tabindex","0"]],[[1,"aria-label",0],[8,"title",0]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.unpinItem(i,"topLevel")&&n),"keyup.enter"===t&&(n=!1!==r.unpinItem(i,"topLevel")&&n),"focus"===t&&(n=!1!==r.onFocus()&&n),"blur"===t&&(n=!1!==r.onBlur()&&n),n}),null,null)),n.Gb(1,4210688,null,0,P.a,[n.o,n.K,E.b],null,null),(e()(),n.Hb(2,0,null,null,1,"ohp-icon-font",[["cssClass","commanding-item__icon ms-fcl-nd"],["size","16"]],null,null,null,C.b,C.a)),n.Gb(3,638976,null,0,w.a,[s.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null)],(function(e,t){e(t,3,0,"commanding-item__icon ms-fcl-nd",t.component.unpinActionIcon,"16",!0)}),(function(e,t){var i=t.component;e(t,0,0,i.unpinActionTitle,i.unpinActionTitle)}))}function Di(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,12,"div",[["class","list-item-column column--commanding"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"column--commanding--hidden":0}),(e()(),n.qb(16777216,null,null,1,null,Pi)),n.Gb(4,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Ei)),n.Gb(6,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Fi)),n.Gb(8,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Oi)),n.Gb(10,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.Hb(11,0,null,null,1,"ohp-actions-menu",[],null,[[null,"menuToggled"],[null,"menuFocused"]],(function(e,t,i){var n=!0,r=e.component;return"menuToggled"===t&&(n=!1!==r.onActionsMenuToggle(i)&&n),"menuFocused"===t&&(n=!1!==(i?r.onFocus():r.onBlur())&&n),n}),I.b,I.a)),n.Gb(12,770048,[[10,4]],0,T.a,[k.a,s.a,l.a,n.o,A.b,d.a,h.a,n.K],{menuModel:[0,"menuModel"],listItemIndex:[1,"listItemIndex"],iconClass:[2,"iconClass"],dataSecurity:[3,"dataSecurity"],documentName:[4,"documentName"],actionContextMenuEnabled:[5,"actionContextMenuEnabled"],actionContextMenu:[6,"actionContextMenu"]},{menuToggled:"menuToggled",menuFocused:"menuFocused"})],(function(e,t){var i=t.component,n=e(t,2,0,!i.isTouch);e(t,1,0,"list-item-column column--commanding",n),e(t,4,0,i.shareControlEnabled),e(t,6,0,i.item.isLocal),e(t,8,0,!i.item.isPinned&&i.mruPinEnabled),e(t,10,0,i.item.isPinned&&i.mruPinEnabled),e(t,12,0,i.contextMenu,i.index,i.fluentRefresh?"":"commanding-item__icon ms-fcl-nd",i.dataSecurityThreshold,i.item.fileName,i.actionContextMenuEnabled,i.actionContextMenu)}),null)}function Mi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,0,"div",[["class","list-item-column column--commanding"]],null,null,null,null,null))],null,null)}function Ri(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,"div",[["class","list-item-column document-column--responses-forms"]],null,null,null,null,null)),(e()(),n.Hb(1,0,null,null,3,"div",[["class","list-item__text--small ms-fcl-ns"]],null,null,null,null,null)),n.Gb(2,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(3,{"list-item__last-accessed":0}),(e()(),n.gc(4,null,[" "," "]))],(function(e,t){var i=e(t,3,0,t.component.showActionsMenu);e(t,2,0,"list-item__text--small ms-fcl-ns",i)}),(function(e,t){e(t,4,0,t.component.borderlessCardDetail1)}))}function xi(e){return n.jc(0,[(e()(),n.Hb(0,0,[[5,0],["timestampElement",1]],null,4,"div",[["class","list-item__text--small ms-fcl-ns"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"list-item__last-accessed":0}),(e()(),n.gc(3,null,[" "," "])),n.ac(4,4)],(function(e,t){var i=e(t,2,0,t.component.showActionsMenu);e(t,1,0,"list-item__text--small ms-fcl-ns",i)}),(function(e,t){var i=t.component,r=n.hc(t,3,0,e(t,4,0,n.Wb(t.parent.parent,2),i.displayTime,i.shortDate,i.displayTimeString,!1));e(t,3,0,r)}))}function Li(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,2,"div",[["class","activity-user-name sharing-column-name ms-fcl-nd"]],[[8,"title",0]],null,null,null,null)),n.Gb(1,212992,null,0,y.a,[n.o,m.a],{upn:[0,"upn"]},null),(e()(),n.gc(2,null,[" "," "]))],(function(e,t){e(t,1,0,t.component.item.sharedByEmail)}),(function(e,t){var i=t.component;e(t,0,0,n.Ob(1,"",i.item.sharedByUsername,"")),e(t,2,0,i.item.sharedByUsername)}))}function Ui(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-icon-font",[["aria-hidden","true"],["cssClass","document-column--sharing__share-icon ms-fcl-np"],["iconFontName","People2"],["size","14"]],null,null,null,C.b,C.a)),n.Gb(1,638976,null,0,w.a,[s.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){e(t,1,0,"document-column--sharing__share-icon ms-fcl-np","People2","14")}),null)}function Ni(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,6,null,null,null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,Ui)),n.Gb(2,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.Hb(3,0,null,null,3,"div",[["class","list-item__text--small sharing-column--text ms-fcl-ns"]],[[8,"title",0]],null,null,null,null)),n.Gb(4,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(5,{"sharing-column--text-shared":0}),(e()(),n.gc(6,null,[" "," "]))],(function(e,t){var i=t.component;e(t,2,0,null==i.item.sharing?null:i.item.sharing.shared);var n=e(t,5,0,null==i.item.sharing?null:i.item.sharing.shared);e(t,4,0,"list-item__text--small sharing-column--text ms-fcl-ns",n)}),(function(e,t){var i=t.component;e(t,3,0,n.Ob(1,"",i.item.sharing?i.item.sharing.shared?i.sharedText:i.privateText:"","")),e(t,6,0,i.item.sharing?i.item.sharing.shared?i.sharedText:i.privateText:"")}))}function Wi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,6,"div",[["class","list-item-column"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"document-column--sharing":0,"document-column--sharing--right":1}),(e()(),n.qb(16777216,null,null,1,null,Li)),n.Gb(4,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Ni)),n.Gb(6,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.showActivity,!i.showActivity);e(t,1,0,"list-item-column",n),e(t,4,0,"shared-mru"===i.listId),e(t,6,0,"shared-mru"!==i.listId)}),null)}function ji(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-activity-description",[],null,null,null,r.b,r.a)),n.Gb(1,5226496,null,0,a.a,[o.a,s.a,n.h,l.a,c.b,u.a,d.a,h.a,p.a,m.a,f.a,g.a,b.a,v.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],activityDescriptionInput:[2,"activityDescriptionInput"],numLines:[3,"numLines"]},null)],(function(e,t){var i=t.component;e(t,1,0,i.showOnlyMruActivity?n.jb:i.item.activities,i.item.lastViewedTime,i.mruActivity&&i.item.activity,i.mruActivity&&i.item.activity?2:void 0)}),null)}function Hi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,"div",[["class","list-item-column document-column--activity"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"document-column--activity-hidden":0}),(e()(),n.qb(16777216,null,null,1,null,ji)),n.Gb(4,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.showMobileShareAndActivity);e(t,1,0,"list-item-column document-column--activity",n),e(t,4,0,i.activityEnabled)}),null)}function Bi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,2,"div",[["class","list-item-column document-column--analytics document-analytics-container"]],null,null,null,null,null)),(e()(),n.Hb(1,0,null,null,1,"ohp-analytics-description",[],null,[[null,"updateAriaLabel"]],(function(e,t,i){var n=!0;return"updateAriaLabel"===t&&(n=!1!==e.component.onAnalyticsDescriptionChanged(i)&&n),n}),M,O)),n.Gb(2,573440,null,0,F,[h.a],{analytics:[0,"analytics"]},{updateAriaLabel:"updateAriaLabel"})],(function(e,t){e(t,2,0,t.component.item.analytics)}),null)}function Gi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,43,"div",[["class","centered-flex-container list-item__height-restrictor"]],null,null,null,null,null)),(e()(),n.Hb(1,0,null,null,25,"div",[["class","list-item-column"]],null,null,null,null,null)),n.Gb(2,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Xb(3,3),(e()(),n.Hb(4,0,[[3,0],["fileIconElement",1]],null,0,"div",[],[[8,"className",0],[1,"title",0]],null,null,null,null)),(e()(),n.Hb(5,0,null,null,21,"div",[["class","clip"]],null,null,null,null,null)),(e()(),n.Hb(6,0,null,null,11,"div",[["class","centered-flex-container"]],null,null,null,null,null)),(e()(),n.Hb(7,0,null,null,5,"div",[["class","list-item__text--large list-item__title ms-fcl-nd"]],null,null,null,null,null)),(e()(),n.Hb(8,0,[[1,0],["titleElement",1]],null,4,"span",[],[[8,"title",0]],[[null,"mouseenter"],[null,"mouseleave"],[null,"click"]],(function(e,t,i){var r=!0;return"mouseenter"===t&&(r=!1!==n.Wb(e,11).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==n.Wb(e,11).onMouseLeave()&&r),"click"===t&&(r=!1!==n.Wb(e,11).onClick()&&r),r}),null,null)),n.Gb(9,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{ngClass:[0,"ngClass"]},null),n.Zb(10,{"ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a mru-list-item__title--themed":0}),n.Gb(11,16384,null,0,_.a,[s.a,d.a],{area:[0,"area"]},null),(e()(),n.gc(12,null,["",""])),(e()(),n.Hb(13,0,null,null,2,"span",[],[[24,"@fadeInIsNew",0]],null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,vi)),n.Gb(15,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Si)),n.Gb(17,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.Hb(18,0,null,null,8,"div",[["class","list-item__text--small list-item__secondary ms-fcl-ns"]],null,null,null,null,null)),(e()(),n.Hb(19,0,null,null,4,"div",[["style","display: flex"]],null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,yi)),n.Gb(21,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Ci)),n.Gb(23,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Ii)),n.Gb(25,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(e()(),n.qb(0,[["showPath",2]],null,0,null,_i)),(e()(),n.qb(16777216,null,null,1,null,Di)),n.Gb(28,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Mi)),n.Gb(30,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Ri)),n.Gb(32,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.Hb(33,0,null,null,4,"div",[["class","list-item-column"]],null,null,null,null,null)),n.Gb(34,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(35,{"document-column--last-opened":0,"document-column--last-opened--right":1,"document-column--last-opened--subset":2}),(e()(),n.qb(16777216,null,null,1,null,xi)),n.Gb(37,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Wi)),n.Gb(39,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Hi)),n.Gb(41,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Bi)),n.Gb(43,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,r=e(t,3,0,"document-column--name"+(i.showActivity||i.showAnalytics?"":"--subset"),i.mruAppSuffix?"document-column--name"+i.mruAppSuffix:"",i.showMobileShareAndActivity?"document-column--name-mobile":"");e(t,2,0,"list-item-column",r);var a=e(t,10,0,i.clickableFolderEnabled);e(t,9,0,a),e(t,11,0,i.instrumentationArea),e(t,15,0,i.isNew),e(t,17,0,i.showSharing&&(null==i.item.sharing?null:i.item.sharing.shared)),e(t,21,0,i.isCardCreateByLabel&&(null==i.item?null:i.item.createdBy)),e(t,23,0,i.categoryIcon&&i.categoryIcon.categoryFontIcon),e(t,25,0,i.showMobileShareAndActivity,n.Wb(t,26)),e(t,28,0,i.showActionsMenu),e(t,30,0,!i.showActionsMenu),e(t,32,0,i.isFormResponsesEnabled);var o=e(t,35,0,i.showActivity||i.showAnalytics,!i.showSharing&&!i.showActivity&&!i.showAnalytics,i.showSharing&&!i.showActivity&&!i.showAnalytics);e(t,34,0,"list-item-column",o),e(t,37,0,i.displayTime),e(t,39,0,i.showSharing),e(t,41,0,i.showActivity),e(t,43,0,i.showAnalytics)}),(function(e,t){var i=t.component;e(t,4,0,n.Ob(1,"list-item__icon ",i.item.documentIcon,""),i.item.fileTypeName),e(t,8,0,i.item.title),e(t,12,0,i.item.title),e(t,13,0,i.isNewAnimationState)}))}function qi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,6,null,null,null,null,null,null,null)),(e()(),n.Hb(1,0,[[6,0],["shareControl",1]],null,5,"div",[["class","share-control"]],null,null,null,null,null)),n.Gb(2,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(3,{"mru-list-item__share-control mru-list-item__share-control--columns":0}),(e()(),n.Hb(4,16777216,null,null,2,null,null,null,null,null,null,null)),n.Gb(5,475136,null,0,R.a,[x.a,n.W,d.a,L.b,U.a,N.a,W.a,n.F,j.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"],outputs:[2,"outputs"]},null),n.Zb(6,{file:0,index:1,mode:2})],(function(e,t){var i=t.component,n=e(t,3,0,i.showAsListItem());e(t,2,0,"share-control",n);var r=e(t,6,0,i.item,i.index,i.shareControlMode);e(t,5,0,"share-control#ShareControlModule",r,i.shareControlOutputs)}),null)}function Vi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"div",[["class","upcomingMeeting-card__default upcomingMeeting-card__title upcomingMeeting-card__title--suggested_action"]],[[8,"title",0]],null,null,null,null)),(e()(),n.gc(1,null,[" "," "]))],null,(function(e,t){var i=t.component;e(t,0,0,i.item.title),e(t,1,0,i.item.title)}))}function $i(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,3,"div",[["class","upcomingMeeting-card__default upcomingMeeting-card__location"]],[[8,"title",0]],null,null,null,null)),(e()(),n.Hb(1,0,null,null,1,"ohp-icon-font",[["cssClass","upcomingMeeting-card__location__icon"],["iconFontName","Location"],["size","16"]],null,null,null,C.b,C.a)),n.Gb(2,638976,null,0,w.a,[s.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null),(e()(),n.gc(3,null,[" "," "]))],(function(e,t){e(t,2,0,"upcomingMeeting-card__location__icon","Location","16")}),(function(e,t){var i=t.component;e(t,0,0,i.item.location),e(t,3,0,i.item.location)}))}function zi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,2,"ohp-person-picture",[],null,null,null,H.b,H.a)),n.Gb(1,573440,null,0,B.a,[G.a],{person:[0,"person"],isUpcomingMeeting:[1,"isUpcomingMeeting"],status:[2,"status"]},null),n.ac(2,1)],(function(e,t){var i=n.hc(t,1,0,e(t,2,0,n.Wb(t.parent.parent.parent,3),null==t.parent.context.$implicit?null:t.parent.context.$implicit.emailAddress));e(t,1,0,i,!0,null==t.parent.context.$implicit||null==t.parent.context.$implicit.status?null:t.parent.context.$implicit.status.response)}),null)}function Zi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,3,"div",[["class","upcomingMeeting-card__attendees__position"]],null,null,null,null,null)),n.Gb(1,212992,null,0,y.a,[n.o,m.a],{upn:[0,"upn"]},null),(e()(),n.qb(16777216,null,null,1,null,zi)),n.Gb(3,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,1,0,t.context.$implicit.emailAddress.address),e(t,3,0,null==t.context.$implicit?null:t.context.$implicit.emailAddress)}),null)}function Ki(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,2,"div",[["aria-hidden","true"],["class","person-picture-upcoming-meeting__display "]],null,null,null,null,null)),(e()(),n.Hb(1,0,null,null,1,"div",[["class","person-picture-upcoming-meeting__text person-picture-upcoming-meeting__placeholder__text"]],null,null,null,null,null)),(e()(),n.gc(2,null,[" +"," "]))],null,(function(e,t){var i=t.component;e(t,2,0,(null==i.item.attendees?null:i.item.attendees.length)-i.upcomingMeetingAttendeeDisplayMax)}))}function Ji(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,16,"div",[["class","document-card__thumbnail-container upcomingMeeting-card__details"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"document-card__thumbnail-container--suggested-actions":0}),(e()(),n.Hb(3,0,null,null,2,"div",[],null,null,null,null,null)),n.Gb(4,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{ngClass:[0,"ngClass"]},null),n.Zb(5,{"upcomingMeeting-card__left_rectangle":0,"upcomingMeeting-card__left_rectangle_dashed":1}),(e()(),n.qb(16777216,null,null,1,null,Vi)),n.Gb(7,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.Hb(8,0,null,null,1,"div",[["class","upcomingMeeting-card__default upcomingMeeting-card__time"]],null,null,null,null,null)),(e()(),n.gc(9,null,[" "," - "," "])),(e()(),n.qb(16777216,null,null,1,null,$i)),n.Gb(11,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.Hb(12,0,null,null,4,"div",[["class","upcomingMeeting-card__attendees"]],null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,Zi)),n.Gb(14,278528,null,0,S.j,[n.W,n.S,n.x],{ngForOf:[0,"ngForOf"]},null),(e()(),n.qb(16777216,null,null,1,null,Ki)),n.Gb(16,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.fluentRefresh);e(t,1,0,"document-card__thumbnail-container upcomingMeeting-card__details",n);var r=e(t,5,0,i.isUpcomingMeetingAccepted,!i.isUpcomingMeetingAccepted);e(t,4,0,r),e(t,7,0,i.item.title),e(t,11,0,i.item.location),e(t,14,0,null==i.item.attendees?null:i.item.attendees.slice(0,i.upcomingMeetingAttendeeDisplayMax)),e(t,16,0,i.upcomingMeetingAttendeeDisplayMax<(null==i.item.attendees?null:i.item.attendees.length))}),(function(e,t){var i=t.component;e(t,9,0,i.item.startTime,i.item.endTime)}))}function Qi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-icon-font",[["class","myAnalytics-card_icon"],["iconFontName","Outlook"],["size","24"]],null,null,null,C.b,C.a)),n.Gb(1,638976,null,0,w.a,[s.a],{iconFontName:[0,"iconFontName"],size:[1,"size"]},null)],(function(e,t){e(t,1,0,"Outlook","24")}),null)}function Yi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"span",[["class","myAnalytics-card_title ms-fcl-bl"]],[[8,"title",0]],null,null,null,null)),(e()(),n.gc(1,null,["",""]))],null,(function(e,t){var i=t.component;e(t,0,0,i.item.title),e(t,1,0,i.item.title)}))}function Xi(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,2,"div",[["class","document-card__icon-container ms-bgc-w"]],null,null,null,null,null)),(e()(),n.Hb(1,0,null,null,1,"ohp-icon-font",[["iconFontName","Outlook"],["size","20"]],null,null,null,C.b,C.a)),n.Gb(2,638976,null,0,w.a,[s.a],{iconFontName:[0,"iconFontName"],size:[1,"size"]},null)],(function(e,t){e(t,2,0,"Outlook","20")}),null)}function en(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,17,"div",[["class","document-card__thumbnail-container"]],null,null,null,null,null)),n.Gb(1,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"document-card__thumbnail-container--suggested-actions document-card__thumbnail-container--myAnalytics":0}),(e()(),n.qb(16777216,null,null,1,null,Qi)),n.Gb(4,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Yi)),n.Gb(6,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.Hb(7,0,null,null,8,"div",[],null,null,null,null,null)),(e()(),n.Hb(8,0,null,null,7,"span",[["class","myAnalytics-card_text__messageBy ms-fcl-bl"]],null,null,null,null,null)),n.Gb(9,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(10,{"myAnalytics-card_text__messageBy--suggested-action":0}),(e()(),n.gc(11,null,[" ",", "])),(e()(),n.Hb(12,0,null,null,3,"span",[["class","myAnalytics-card_text"]],[[8,"title",0]],null,null,null,null)),n.Gb(13,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(14,{"ms-fcl-bl":0,"myAnalytics-card_text--suggested-action":1}),(e()(),n.gc(15,null,["",""])),(e()(),n.qb(16777216,null,null,1,null,Xi)),n.Gb(17,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.showAsSuggestedAction()||i.fluentRefresh);e(t,1,0,"document-card__thumbnail-container",n),e(t,4,0,!i.showAsSuggestedAction()),e(t,6,0,!i.showAsSuggestedAction());var r=e(t,10,0,i.showAsSuggestedAction());e(t,9,0,"myAnalytics-card_text__messageBy ms-fcl-bl",r);var a=e(t,14,0,!i.showAsSuggestedAction(),i.showAsSuggestedAction());e(t,13,0,"myAnalytics-card_text",a),e(t,17,0,i.showAsSuggestedAction())}),(function(e,t){var i=t.component;e(t,11,0,i.item.insightDescriptionPrefix),e(t,12,0,i.item.insightDescription),e(t,15,0,i.item.insightDescription)}))}function tn(e){return n.jc(0,[n.Yb(0,q.a,[]),n.Yb(0,J,[Z.a,c.b,z.a,$.a]),n.Yb(0,f.a,[Q.a,h.a,Y.a]),n.Yb(0,X,[]),n.cc(671088640,1,{titleElement:0}),n.cc(671088640,2,{mruListItem:0}),n.cc(671088640,3,{fileIconElement:0}),n.cc(671088640,4,{attributionElement:0}),n.cc(671088640,5,{timestampElement:0}),n.cc(671088640,6,{shareControl:0}),n.cc(671088640,7,{shareTopLevelElement:0}),n.cc(671088640,8,{myAnalyticsAddToDoElement:0}),n.cc(671088640,9,{myAnalyticsTaskDoneElement:0}),n.cc(671088640,10,{actionsMenuElement:0}),(e()(),n.Hb(14,0,null,null,23,"div",[["class","list-item__body mru-item__body"]],null,[[null,"contextmenu"]],(function(e,t,i){var r=!0;return"contextmenu"===t&&(r=!1!==n.Wb(e,15).onContextMenu(i)&&r),"contextmenu"===t&&(r=!1!==n.Wb(e,16).onContextMenu(i)&&r),r}),null,null)),n.Gb(15,81920,null,0,ee,[k.a,A.b],{model:[0,"model"],disabled:[1,"disabled"]},null),n.Gb(16,81920,null,0,te.a,[ie.a,A.b],{model:[0,"model"],disabled:[1,"disabled"]},null),(e()(),n.qb(16777216,null,null,1,null,De)),n.Gb(18,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.Hb(19,0,[[2,0],["mruListItem",1]],null,16,"a",[["class","mru-list-item"],["data-clicklog","custom"],["ohpDefaultLinkTarget",""],["rel","noopener"]],[[8,"id",0],[8,"href",4],[1,"aria-label",0],[8,"target",0]],[[null,"click"],[null,"focus"],[null,"blur"],[null,"mouseenter"],[null,"mouseleave"]],(function(e,t,i){var r=!0,a=e.component;return"mouseenter"===t&&(r=!1!==n.Wb(e,24).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==n.Wb(e,24).onMouseLeave()&&r),"mouseenter"===t&&(r=!1!==n.Wb(e,26).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==n.Wb(e,26).onMouseLeave()&&r),"click"===t&&(r=!1!==a.onItemClick(i)&&r),"focus"===t&&(r=!1!==a.onFocus()&&r),"blur"===t&&(r=!1!==a.onBlur()&&r),r}),null,null)),n.Gb(20,278528,null,0,S.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(21,{"list-item__focused":0,"mru-list-item__padding":1,"mru-list-item__padding--mobile":2,"mru-list-item--local":3}),n.Gb(22,81920,null,0,ne.a,[re.a],null,null),n.Gb(23,4210688,null,0,ae.a,[n.o,n.h],{focusOnLoad:[0,"focusOnLoad"]},null),n.Gb(24,16384,null,0,oe.a,[s.a,b.a],{hoverDelay:[0,"hoverDelay"],itemInfo:[1,"itemInfo"]},null),n.Zb(25,{item:0,wdOriginType:1}),n.Gb(26,16384,null,0,se.a,[s.a,b.a],{hoverDelay:[0,"hoverDelay"],itemInfo:[1,"itemInfo"]},null),n.Zb(27,{item:0,wdOriginType:1}),(e()(),n.qb(16777216,null,null,1,null,Ut)),n.Gb(29,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,ni)),n.Gb(31,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,bi)),n.Gb(33,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Gi)),n.Gb(35,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,qi)),n.Gb(37,16384,null,0,S.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(0,[["upcomingMeetingTitle",2]],null,0,null,Ji)),(e()(),n.qb(0,[["myAnalyticsTitle",2]],null,0,null,en))],(function(e,t){var i=t.component;e(t,15,0,i.actionContextMenu,!i.actionContextMenuEnabled),e(t,16,0,i.contextMenu,i.actionsMenuOpen||i.actionContextMenuEnabled),e(t,18,0,i.mruItemState===i.MRU_ITEM_LOADING_STATE);var n=e(t,21,0,i.itemFocused||i.actionsMenuOpen,i.showAsListItem(),i.showAsListItem()&&i.showMobileShareAndActivity,i.item.isLocal);e(t,20,0,"mru-list-item",n),e(t,22,0),e(t,23,0,i.focusOnLoad);var r=i.wacHostHoverPrebootEnabled?500:i.showAsCard()?200:150,a=e(t,25,0,i.item,i.getWdOriginTaskForClick());e(t,24,0,r,a);var o=i.wacHostHoverPrebootEnabled?500:i.showAsCard()?200:150,s=e(t,27,0,i.item,i.getWdOriginTaskForClick());e(t,26,0,o,s),e(t,29,0,i.showAsCard()),e(t,31,0,i.showAsSuggestedAction()&&i.primaryAction),e(t,33,0,i.showAsTile()),e(t,35,0,i.showAsListItem()),e(t,37,0,i.showDesktopShareControl)}),(function(e,t){var i=t.component;e(t,19,0,i.listId+"-"+i.item.id,n.Ob(1,"",i.url,""),i.descriptiveAriaLabel,n.Wb(t,22).target)}))}n.Db("ohp-mru-item",he.a,(function(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,2,"ohp-mru-item",[],null,null,null,tn,Oe)),n.bc(512,null,le.a,le.a,[h.a,re.a,ce.a,ue.a,u.a,de.a,L.b]),n.Gb(2,770048,null,0,he.a,[o.a,s.a,L.b,pe.a,re.a,Q.a,A.b,l.a,c.b,u.a,d.a,me.a,h.a,fe.a,p.a,le.a,ge.a,be.a,ve.a,Se.a,ye.b,n.K,f.a,Ce.b,we.a,Ie.a,g.a,Te.a,b.a,v.b,ke.a,Ae.a,_e.a,Pe.a,Ee.a,Fe.a],null,null)],(function(e,t){e(t,2,0)}),null)}),{item:"item",index:"index",relativeIndex:"relativeIndex",view:"view",listId:"listId",focusOnLoad:"focusOnLoad",showActivity:"showActivity",showSharing:"showSharing",showAnalytics:"showAnalytics",mruAppType:"mruAppType",leftAlignActionsMenu:"leftAlignActionsMenu"},{addItem:"addItem",deleteItem:"deleteItem",changePinState:"changePinState"},[])},"A/um":function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.Accepted=1]="Accepted",e[e.Access=2]="Access",e[e.AccountActivity=3]="AccountActivity",e[e.Add=4]="Add",e[e.AddTo=5]="AddTo",e[e.Alert=6]="Alert",e[e.ArrowLeft=7]="ArrowLeft",e[e.ArrowRight=8]="ArrowRight",e[e.At=9]="At",e[e.Attach=10]="Attach",e[e.Calendar=11]="Calendar",e[e.Chat=12]="Chat",e[e.CheckMark=13]="CheckMark",e[e.ChevronDown=14]="ChevronDown",e[e.ChevronLeft=15]="ChevronLeft",e[e.ChevronRight=16]="ChevronRight",e[e.ChevronUp=17]="ChevronUp",e[e.CircleEmpty=18]="CircleEmpty",e[e.CircleInfo=19]="CircleInfo",e[e.Comment=20]="Comment",e[e.Compass=21]="Compass",e[e.ContactCardSettings=22]="ContactCardSettings",e[e.Copy=23]="Copy",e[e.Declined=24]="Declined",e[e.Delete=25]="Delete",e[e.Devices3=26]="Devices3",e[e.Diamond=27]="Diamond",e[e.Document=28]="Document",e[e.Download=29]="Download",e[e.Ellipsis=30]="Ellipsis",e[e.Excel=31]="Excel",e[e.FavoriteStar=32]="FavoriteStar",e[e.Filter=33]="Filter",e[e.FilterSolid=34]="FilterSolid",e[e.Folder=35]="Folder",e[e.FolderOpen=36]="FolderOpen",e[e.GiftCard=37]="GiftCard",e[e.Group=38]="Group",e[e.Hide=39]="Hide",e[e.HighLander=40]="HighLander",e[e.Link=41]="Link",e[e.ListBullets=42]="ListBullets",e[e.Location=43]="Location",e[e.Mail=44]="Mail",e[e.Minus=45]="Minus",e[e.Move=46]="Move",e[e.News=47]="News",e[e.Office2=48]="Office2",e[e.OfficeForms=49]="OfficeForms",e[e.OfficeStore=50]="OfficeStore",e[e.OfficeThreshold=51]="OfficeThreshold",e[e.OneDrive=52]="OneDrive",e[e.Onenote2=53]="Onenote2",e[e.Outlook=54]="Outlook",e[e.Page=55]="Page",e[e.Pencil=56]="Pencil",e[e.PencilSolid=57]="PencilSolid",e[e.People2=58]="People2",e[e.Permissions=59]="Permissions",e[e.SharePoint=60]="SharePoint",e[e.Person=61]="Person",e[e.PhotoVideoMedia=62]="PhotoVideoMedia",e[e.PinDown=63]="PinDown",e[e.PlayerSettings=64]="PlayerSettings",e[e.PlaylistMusic=65]="PlaylistMusic",e[e.Placeholder=66]="Placeholder",e[e.PollResults=67]="PollResults",e[e.PowerBI=68]="PowerBI",e[e.PowerPoint=69]="PowerPoint",e[e.Preview=70]="Preview",e[e.PreviewLink=71]="PreviewLink",e[e.Project=72]="Project",e[e.Publisher=73]="Publisher",e[e.Question=74]="Question",e[e.Restore=75]="Restore",e[e.Save=76]="Save",e[e.Search=77]="Search",e[e.Settings=78]="Settings",e[e.Share2=79]="Share2",e[e.SkypeForBusiness=80]="SkypeForBusiness",e[e.SortDown=81]="SortDown",e[e.SortUp=82]="SortUp",e[e.Stream=83]="Stream",e[e.Sway=84]="Sway",e[e.Sync=85]="Sync",e[e.System=86]="System",e[e.Task=87]="Task",e[e.Teams=88]="Teams",e[e.TentativelyAccepted=89]="TentativelyAccepted",e[e.TextDocument=90]="TextDocument",e[e.TileView=91]="TileView",e[e.ToDo=92]="ToDo",e[e.Trending=93]="Trending",e[e.Unfavorite=94]="Unfavorite",e[e.Unpin=95]="Unpin",e[e.Video=96]="Video",e[e.Visio=97]="Visio",e[e.Upload=98]="Upload",e[e.Waffle=99]="Waffle",e[e.Word=100]="Word",e[e.X=101]="X",e[e.X2=102]="X2"}(n||(n={}))},AGMK:function(e,t,i){"use strict";function n(){return document.visibilityState}function r(){return"visible"===n()}i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r}))},AXqk:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},"AY/E":function(e,t,i){"use strict";i.d(t,"a",(function(){return I}));var n=i("31lE"),r=i("laSs"),a=i("Dn7E"),o=i("mXGw"),s=i("xARA"),l=i("hhzZ"),c=i("4/We"),u=i("cgnd"),d=i("/I02"),h=i("JH4S"),p=i("kpuN"),m=i("Bc8L"),f=i("dFxn"),g=i("Mlb/");class b{constructor(e){this.config=e.parse("peopleCardConfig")}}b.ɵprov=g.kc({factory:function(){return new b(g.lc(f.a))},token:b,providedIn:"root"});var v=i("Uqr9"),S=i("casz"),y=i("w1PR"),C=i("TIi1"),w=i("BMb5");class I{constructor(e,t,i,n,r,a,o,s,l,c,u,d,h){if(this.accessTokenService=e,this.capabilitiesService=t,this.contextService=i,this.startupConfigService=n,this.instrumentationService=r,this.peopleCardConfigService=a,this.localAppLauncherService=o,this.urlLauncherService=s,this.windowService=l,this.scheduler=c,this.ngZone=u,this.themingService=d,this.userContextService=h,this.peopleCount=0,this.capabilitiesService.capabilities.darkModeEnabled){const e="rgba(255,255,255,0.75)";this.darkTheme={palette:{themeDarker:e,themeDark:e,themeDarkAlt:e,themePrimary:e,themeSecondary:e,themeTertiary:e,themeLight:e,themeLighter:e,themeLighterAlt:e,black:"#ffffff",blackTranslucent40:"rgba(255, 255, 255, 0.40)",neutralDark:"#ffffff",neutralPrimary:"#f8f8f8",neutralPrimaryAlt:"#f4f4f4",neutralSecondary:"#eaeaea",neutralTertiary:"#a6a6a6",neutralTertiaryAlt:"#767676",neutralQuaternary:"#6b6b6b",neutralQuaternaryAlt:"#707070",neutralLight:"#666666",neutralLighter:"#333333",neutralLighterAlt:"#212121",accent:e,white:"#333333",whiteTranslucent40:"rgba(0, 0, 0, 0.40)"}},this.darkModeSubscription=this.themingService.darkModeSubscription.subscribe((e=>{this.isDarkMode=e,this.lpc&&this.lpc.loadTheme(this.isDarkMode?this.darkTheme:void 0)}))}}addPersonaCard(e,t){return this.capabilitiesService.capabilities.peopleCardsEnabled?this.peopleCardConfigService.config?this.ngZone.runOutsideAngular((()=>this.bootstrap().then((()=>{this.lpc&&(this.lpc.addedPersonaToPageV2(e,{personaInfo:{identifiers:{Smtp:t,PersonaType:"User"}},externalAppSessionCorrelationId:this.startupConfigService.config.sharedClientStartupContext.correlationId,behavior:{onCardOpen:()=>{const i={};i.ElementId=e.id,i.ItemId=new l.d(t,n.AWTPiiKind.SmtpAddress),this.instrumentationService.logImpressionEvent("People_Card_Impression",i),Object(r.a)({eventName:"People_Card",area:"PeopleCard",id:e.id})},onCardClose:null,disableHover:!1}}),this.peopleCount++)})))):Promise.reject("peopleCardConfigService.config is not defined"):Promise.reject("People cards disabled")}addPersonaCardElement(e,t,i="",a=!0){return this.capabilitiesService.capabilities.peopleCardsEnabled?this.peopleCardConfigService.config?this.ngZone.runOutsideAngular((()=>this.bootstrap().then((()=>{this.lpc&&s.render(o.createElement(this.windowService.nativeWindow.LivePersonaCardHoverTargetV2,{cardParameters:{personaInfo:{identifiers:{AadObjectId:t,PersonaType:"User",Smtp:i}},externalAppSessionCorrelationId:this.startupConfigService.config.sharedClientStartupContext.correlationId,behavior:{onCardOpen:()=>{const i={};i.ElementId=e.id,i.ItemId=new l.d(t,n.AWTPiiKind.Identity),this.instrumentationService.logImpressionEvent("People_Card_Impression",i),Object(r.a)({eventName:"People_Card",area:"PeopleCard",id:e.id})},locationToOpen:a?"ExpandedView":"Card"}}},o.createElement("div",{id:"personCardClickElement"})),e)})))):Promise.reject("peopleCardConfigService.config is not defined"):Promise.reject("People cards disabled")}removePersonaCard(e,t){return this.capabilitiesService.capabilities.peopleCardsEnabled?this.peopleCardConfigService.config?this.initPromise?this.ngZone.runOutsideAngular((()=>this.initPromise.then((()=>{this.lpc&&(this.lpc.removedPersonaFromPage(e,t),this.peopleCount--)})))):Promise.reject("removePersonaCard is called without calling addPersonaCard first"):Promise.reject("peopleCardConfigService.config is not defined"):Promise.reject("People cards disabled")}bootstrap(){if(!this.initPromise)if(this.peopleCardConfigService.config){this.startTime=v.a.now();const e={actionCallbacks:this.capabilitiesService.capabilities.pwaEnabled?{openDocument:e=>{this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((t=>{t.launchApp({action:"OpenDocument",appName:e.Type,url:e.DownloadUrl}).then((e=>{if(!e.success)throw new Error("fallback to browser")})).catch((()=>{t.launchUrl(e.WebUrl,{action:"OpenDocFromPeopleCard"})}))})):this.localAppLauncherService.launchOfficeApp(e.Type,e.DownloadUrl).then((e=>{if(!e)throw new Error("fallback to browser")})).catch((()=>{this.urlLauncherService.openUrl(e.WebUrl,"OpenDocFromPeopleCard")}))},composeMail:e=>{this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((t=>{t.launchUrl(`mailto:${e}`,{action:"EmailFromPeopleCard"})})):this.urlLauncherService.openUrl(`mailto:${e}`,"EmailFromPeopleCard")},startChat:e=>{this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((t=>{t.launchUrl(e.imAddressUrl,{action:"OpenChatFromPeopleCard"})})):this.urlLauncherService.openUrl(e.imAddressUrl,"OpenChatFromPeopleCard")},handleContactNumber:e=>{this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((t=>{t.launchUrl(`tel:${e}`,{action:"HandleNumberFromPeopleCard"})})):this.urlLauncherService.openUrl(`tel:${e}`,"HandleNumberFromPeopleCard")}}:void 0,culture:this.contextService.sharedContext.officeMarket,region:this.peopleCardConfigService.config.region,clientType:this.peopleCardConfigService.config.clientType,clientContextType:this.peopleCardConfigService.config.clientContextType,clientCorrelationId:this.startupConfigService.config.sharedClientStartupContext.correlationId,logMessage:(e,t,i)=>{},getAuthToken:(e,t)=>{this.getAuthToken(((i,n)=>{i?e(i,this.startupConfigService.config.sharedClientStartupContext.correlationId):t(n,this.startupConfigService.config.sharedClientStartupContext.correlationId)}))},isConsumer:this.startupConfigService.config.authType===u.a.MSA,complianceEnvironment:this.getLpcEnvironment(),theme:this.isDarkMode?this.darkTheme:void 0},t=new Promise((e=>{this.scheduler.scheduleWork((()=>{this.importBootstrapper().then(e)}),4)}));this.initPromise=t.then((({initializeLivePersonaCardAsync:t})=>new Promise(((i,n)=>{this.scheduler.scheduleWork((()=>{t(e).then((()=>i(null))).catch(n)}),4)})))).then((()=>{this.windowService.ensureZoneJs(),this.lpc=this.windowService.nativeWindow.LPC;const e=v.a.now()-this.startTime;this.instrumentInitialization("Start",e)}),(e=>{this.windowService.ensureZoneJs();const t=v.a.now()-this.startTime;this.instrumentInitialization("Error",t,e)}))}else this.initPromise=Promise.reject("peopleCardConfigService.config is not defined");return this.initPromise}population(){return this.peopleCount}ngOnDestroy(){var e;null===(e=this.darkModeSubscription)||void 0===e||e.unsubscribe()}instrumentInitialization(e,t,i){const n={};n.State=e,n.Latency=Math.ceil(t).toString(),i&&(n.Error="string"==typeof i&&0===i.indexOf(I.errorPrefix)?i:""),this.instrumentationService.logGenericEvent("People_Card_Initialization",n),Object(a.a)({featureName:"PeopleCard",eventName:"People_Card_Initialization",params:n})}getAuthToken(e){this.accessTokenService.getAccessToken("Loki").then((t=>{e(t.token,t.error?`Error : ${t.error}`:"")}))}importBootstrapper(){return i.e(130).then(i.t.bind(null,"48C2",7))}getLpcEnvironment(){const e=this.peopleCardConfigService.config.complianceEnvironment;return this.userContextService.user.isGcc&&"Prod"===e?"GccModerate":e}}I.errorPrefix="LPCError: ",I.ɵprov=g.kc({factory:function(){return new I(g.lc(p.a),g.lc(c.a),g.lc(d.a),g.lc(u.b),g.lc(l.a),g.lc(b),g.lc(m.a),g.lc(C.a),g.lc(w.b),g.lc(S.a),g.lc(g.F),g.lc(y.b),g.lc(h.a))},token:I,providedIn:"root"})},Ax7d:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("O6Zd"),r=i("BaAg"),a=i("dFxn"),o=i("Mlb/"),s=i("5vx3");class l{constructor(e,t){this.breakpointObserver=t,this.manifestData=e.parse("webManifestConfig")||{name:null,short_name:null,start_url:null,scope:null,display:null,orientation:null,icons:[],background_color:null,theme_color:null},this.isStandalone=this.breakpointObserver.observe("(display-mode: standalone)").pipe(Object(n.a)((e=>e.matches)))}getManifestFileType(){return r.a.fileTypeNameToFileType(this.manifestData.short_name)}isOfficeApp(){return"Office"===this.manifestData.name}hasManifest(){return!!this.manifestData.name}}l.ɵprov=o.kc({factory:function(){return new l(o.lc(a.a),o.lc(s.a))},token:l,providedIn:"root"})},BJFG:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Bc8L"),r=i("Z0U4"),a=i("TIi1"),o=i("Mlb/");class s{constructor(e,t,i){this.localAppLauncherService=e,this.urlLauncherService=t,this.officeRouteService=i}launchApp(e,t,i,n=!1){return this.localAppLauncherService.launchOfficeApp(e.Text,"",!t||t.defaultPrevented||n?null:()=>t.preventDefault()).then((n=>n?"Native":this.launchOfficeWebApp(e,t,!0,i))).catch((()=>this.launchOfficeWebApp(e,t,n,i)))}launchOfficeWebApp(e,t,i,n){return e.InAppNav&&e.FileType?(!t||t.defaultPrevented||i||t.preventDefault(),this.officeRouteService.navigateTo({route:"Start",app:e.FileType}),Promise.resolve("StartPage")):i||!t||t.defaultPrevented?this.urlLauncherService.openUrl(e.Url,n).then((()=>"Web"),(()=>{})):Promise.resolve("Web")}}s.ɵprov=o.kc({factory:function(){return new s(o.lc(n.a),o.lc(a.a),o.lc(r.a))},token:s,providedIn:"root"})},BJbw:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("cgnd"),r=i("ZBli"),a=i("pjz5"),o=i("Mlb/");class s{constructor(e){const t=e.config.userPrincipalName,i=e.config.authType;if(t&&i!==n.a.Unknown){const e={};e[s.pvrQueryName]=i===n.a.OrgId?"OrgId":"WindowsLiveId",e[s.upnQueryName]=t,this.authParams=r.a.buildQueryPath(e)}}appendPvrAndUpnAuthParams(e){if(!e||!this.authParams)return e;const t=a.a.getLocation(e),i=a.a.getQueryParams(t.search);return i[s.pvrQueryName]||i[s.upnQueryName]?e:r.a.appendQuery(e,this.authParams)}}s.pvrQueryName="auth_pvr",s.upnQueryName="auth_upn",s.ɵprov=o.kc({factory:function(){return new s(o.lc(n.b))},token:s,providedIn:"root"})},BMb5:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return c}));var n,r=i("eevI"),a=i("O6Zd"),o=i("Y8if"),s=i("+3x0"),l=i("Mlb/");!function(e){e.LocalStorage="localStorage",e.SessionStorage="sessionStorage"}(n||(n={}));class c{constructor(){this._innerWidth=this.getWindow().innerWidth,this.getWindow().shellTokenRequestDictionary={},this.setupInnerWidthListener()}get innerWidth(){return this._innerWidth}get nativeWindow(){return this.getWindow()}ensureZoneJs(){try{Zone.assertZonePatched()}catch(e){window.Promise=window.ZoneJSBackupPromise}}isStandalonePwa(){return Object(r.a)(this.getWindow(),"appinstalled").pipe(Object(a.a)((e=>!0)),Object(o.a)(this.nativeWindow.matchMedia("(display-mode: standalone)").matches))}getStorage(e){if(!this.isStorageAvailable(e))return null;switch(e){case n.LocalStorage:return this.nativeWindow.localStorage;case n.SessionStorage:return this.nativeWindow.sessionStorage;default:return null}}isStorageAvailable(e){try{return!!window[e]}catch(e){return!1}}getWindow(){return window}setupInnerWidthListener(){Object(r.a)(this.getWindow(),"resize").pipe(Object(s.a)(10)).subscribe((()=>this._innerWidth=this.getWindow().innerWidth))}}c.ɵprov=l.kc({factory:function(){return new c},token:c,providedIn:"root"})},BYbh:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("dFxn"),r=i("Mlb/");class a{constructor(e){this.config=e.parse("bannerConfig")}}a.ɵprov=r.kc({factory:function(){return new a(r.lc(n.a))},token:a,providedIn:"root"})},BaAg:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"e",(function(){return r})),i.d(t,"d",(function(){return u})),i.d(t,"c",(function(){return d})),i.d(t,"a",(function(){return h}));var n,r,a=i("WFKr"),o=i("lwM0"),s=i("pjz5"),l=i("p6Zr");!function(e){e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.Word=2]="Word",e[e.Excel=3]="Excel",e[e.PowerPoint=4]="PowerPoint",e[e.Pdf=5]="Pdf",e[e.Audio=6]="Audio",e[e.Video=7]="Video",e[e.OneNote=8]="OneNote",e[e.OneNotePage=9]="OneNotePage",e[e.Visio=10]="Visio",e[e.Photos=11]="Photos",e[e.Text=12]="Text",e[e.Outlook=13]="Outlook",e[e.Sway=14]="Sway",e[e.OneNoteClassNoteBook=15]="OneNoteClassNoteBook",e[e.Forms=16]="Forms",e[e.FormsQuiz=17]="FormsQuiz",e[e.Project=18]="Project",e[e.ProjectOperations=19]="ProjectOperations",e[e.Portfolio=20]="Portfolio",e[e.NewsArticle=21]="NewsArticle",e[e.OneDrive=22]="OneDrive",e[e.SharePoint=23]="SharePoint",e[e.Fluid=24]="Fluid",e[e.FluidActivityBlueprint=25]="FluidActivityBlueprint",e[e.PowerBI=26]="PowerBI",e[e.StreamsVideo=27]="StreamsVideo",e[e.List=28]="List",e[e.UpcomingMeeting=29]="UpcomingMeeting",e[e.Yammer=30]="Yammer",e[e.Designer=31]="Designer",e[e.VisioBusinessWac=32]="VisioBusinessWac",e[e.VisioFlowChartWac=33]="VisioFlowChartWac",e[e.VisioGeneralWac=34]="VisioGeneralWac",e[e.VisioNetworkWac=35]="VisioNetworkWac",e[e.VisioSoftwareWac=36]="VisioSoftwareWac",e[e.ThirdParty=37]="ThirdParty",e[e.Trello=38]="Trello",e[e.VisioStartWac=39]="VisioStartWac",e[e.Stream=40]="Stream",e[e.MindMeister=41]="MindMeister",e[e.Monday=42]="Monday",e[e.Platform=43]="Platform",e[e.Whiteboard=44]="Whiteboard",e[e.MeetingNotes=45]="MeetingNotes",e[e.MyAnalytics=46]="MyAnalytics",e[e.MeetingObject=47]="MeetingObject",e[e.PlayLists=48]="PlayLists",e[e.PlayList=49]="PlayList",e[e.ScreenRecording=50]="ScreenRecording"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.OfficeGraph=1]="OfficeGraph",e[e.SharePoint=2]="SharePoint",e[e.Exchange=3]="Exchange",e[e.OfficeMru=4]="OfficeMru",e[e.AADGraph=5]="AADGraph",e[e.OneDriveBusiness=6]="OneDriveBusiness",e[e.Substrate=7]="Substrate"}(r||(r={}));const c=/http[s]?:\/\/[\S]*?-my\.sharepoint[\S]*?\.com/,u=/http[s]?:\/\/[\S]*?\.sharepoint[\S]*?\.com/,d=/http[s]?:\/\/d\.docs\.live\.net/;class h{constructor(e,t,i,r,a,o,s,l,c,u,d,p,m,f,g,b,v=!0,S=null,y=null,C=!1,w=0,I=!1,T=!1){if(this.id=e,this.impressionId=t,this.docId=i,this.driveId=r,this.fileName=a,this.title=o,this.url=s,this.webUrl=l,this.downloadUrl=c,this.lastModifiedTime=u,this.lastViewedTime=d,this.sharedTime=p,this.fileType=m,this.provenance=f,this.pathArray=g,this.lastModifiedBy=S,this.isLocal=I,this.isSafeLink=T,this.fileTypeName=h.fileTypeNameFromType(this.fileType),this.provenanceName=h.provenanceNameFromType(this.provenance),this.documentIcon=h.documentIconFromType(this.fileType),s&&!T){let e=s;if(!I&&(!C||C&&2===w)&&(m===n.Word||m===n.Excel||m===n.OneNote||m===n.PowerPoint||m===n.Visio||m===n.Fluid||m===n.Stream)){const t="web=1",i=-1===s.indexOf("?")?"?":"&";e=s+i+t}this.url=C||I?e:this.encodeUrl(e,v,this.fileType===n.Forms||this.fileType===n.Portfolio||this.fileType===n.Project||this.fileType===n.ProjectOperations)}this.downloadUrl&&(this.downloadUrl=this.encodeUrl(this.downloadUrl,v)),this.setupAttribution(y,b)}static setStreamExtensions(e){(null==e?void 0:e.length)>0&&(h.StreamExtensions=e,h.fileTypeStringToExtensions||h.createFileTypeStringToExtensionsValues(),h.fileTypeStringToExtensions[n[n.Stream]]=h.StreamExtensions,h.createExtensionToFileTypeValues())}static fileTypeToApp(e){return e===n.Forms||e===n.FormsQuiz?n.Forms:e}static fileTypeFromExtension(e){return h.extensionToFileType||h.createExtensionToFileTypeValues(),e?h.extensionToFileType[e.toLowerCase()]||n.Unknown:n.None}static fileExtensionsForType(e){return e&&e!==n.None?(h.fileTypeStringToExtensions||h.createFileTypeStringToExtensionsValues(),h.fileTypeStringToExtensions[n[e]]||[]):[]}static distributionFromFileTypes(e){return e?e.reduce(((e,t,i)=>e+(0===i?"":";")+h.fileTypeNameFromType(t)),""):""}static distributionFromFileItems(e){return e?h.distributionFromFileTypes(e.map((e=>e.fileType))):""}static fileIconNameFromType(e){switch(e){case n.Word:return"Word";case n.Excel:return"Excel";case n.PowerPoint:return"PowerPoint";case n.OneNote:return"OneNote";case n.Pdf:return"PDF";case n.Visio:return"Visio";case n.Sway:return"Sway";case n.Forms:return"Forms";case n.Project:return"Project";case n.ProjectOperations:return"ProjectOperations";case n.Portfolio:return"Portfolio";case n.Fluid:case n.FluidActivityBlueprint:return"Fluid";case n.PowerBI:return"PowerBI";case n.StreamsVideo:case n.Stream:case n.ScreenRecording:return"StreamsVideo";case n.Video:return"Video";case n.List:return"List";case n.PlayLists:return"PlayLists";case n.PlayList:return"PlayList";case n.Trello:return"Trello";case n.NewsArticle:return"NewsArticle";case n.Whiteboard:return"Whiteboard";case n.MeetingNotes:return"MeetingNotes";case n.Photos:return"Photos";case n.MeetingObject:return"MeetingObject";default:return"Document"}}static fileTypeNameFromType(e){switch(e){case n.Word:return"Word";case n.Excel:return"Excel";case n.PowerPoint:return"PowerPoint";case n.OneNote:case n.OneNoteClassNoteBook:case n.MeetingNotes:return"OneNote";case n.Pdf:return"PDF";case n.Visio:return"Visio";case n.Audio:return"Audio";case n.Video:return"Video";case n.Photos:return"Photos";case n.Outlook:return"Outlook";case n.Text:return"Text";case n.Sway:return"Sway";case n.Forms:case n.FormsQuiz:return"Forms";case n.Project:return"Project";case n.ProjectOperations:return"ProjectOperations";case n.Portfolio:return"Portfolio";case n.NewsArticle:return"NewsArticle";case n.Fluid:return"Loop components";case n.PowerBI:return"PowerBI";case n.StreamsVideo:return"Streams";case n.Stream:return"Stream";case n.ScreenRecording:return"ScreenRecording";case n.UpcomingMeeting:return"UpcomingMeeting";case n.List:return"List";case n.PlayLists:return"PlayLists";case n.PlayList:return"PlayList";case n.MindMeister:return"MindMeister";case n.Monday:return"monday.com";case n.Trello:return"Trello";case n.Platform:return"Platform";case n.Whiteboard:return"Whiteboard";case n.MeetingObject:return"Meeting Object";case n.MyAnalytics:return"MyAnalytics";case n.Designer:return"Designer";default:return"Document"}}static fileTypeNameToFileType(e){return e?"Custom"===e?n.ThirdParty:h.NameToFileType[e.toLowerCase()]||n.Unknown:n.Unknown}static fileTypeFromFileName(e){return h.fileTypeFromExtension(h.getFileExtension(e))}static provenanceNameFromType(e){switch(e){case r.AADGraph:return"AADGraph";case r.Exchange:return"Exchange";case r.OfficeGraph:return"OfficeGraph";case r.OfficeMru:return"OfficeMru";case r.SharePoint:return"SharePoint";case r.Substrate:return"Substrate";default:return"Unknown"}}static getFileExtension(e){if(!e)return"";const t=e.lastIndexOf(".");return-1===t?"":e.substring(t+1)}static getFileExtensionFromUrl(e){if(!e)return"";const t=e.lastIndexOf(".");return-1===t?"":e.substring(t+1).split("?")[0]}static documentIconFromType(e,t="32x32"){return e===n.Portfolio?`document-icon-sprite document-icon-sprite-${h.fileIconNameFromType(e).toLowerCase()}-${t}`:`document-icon--${t} document-icon--${h.fileIconNameFromType(e).toLowerCase()}`}static referralFromFileType(e){switch(e){case n.Word:return l.a.Word;case n.Excel:return l.a.Excel;case n.PowerPoint:return l.a.PowerPoint;case n.OneNote:return l.a.OneNote;case n.Sway:return l.a.Sway;case n.Visio:return l.a.Visio;case n.Project:case n.ProjectOperations:case n.Portfolio:return l.a.Project;case n.PowerBI:return l.a.PowerBI;default:return h.fileTypeNameFromType(e)}}static referralFromFileLocation(e){if(e&&e.length){if(e.match(c)||e.match(d))return l.a.OneDrive;if(e.match(u))return l.a.SharePoint}return null}static isConsumerDocument(e){return s.a.getHostName(e).lastIndexOf("live.net")>0}static fileNameWithoutExtension(e){if(!e)return e;const t=e.lastIndexOf(".");return-1===t?e:e.substring(0,t)}documentIconWithSize(e="32x32"){return h.documentIconFromType(this.fileType,e)}getClickData(e,t,i,n=!1){const r={};r.ImpressionId=this.impressionId,n?(r.ElementId=e,r.DocumentId=this.id):r.ElementId=this.id,r.Referral=h.referralFromFileType(this.fileType),r.Index=i.toString(),r.DocumentType=this.fileTypeName,r.Action=t;const a=this.timeSinceLastOpenInSeconds();return null!==a&&(r.InactivityDuration=a.toString()),{eventName:e,params:r,metrics:[]}}getClickDataForPath(e,t,i){const n=this.getClickData(e,t,i);return n&&n.params&&(n.params.Referral=h.referralFromFileLocation(this.url)),n}timeSinceLastOpenInSeconds(){return this.lastViewedTime?Math.round(((new Date).getTime()-this.lastViewedTime.getTime())/1e3):null}getId(){return this.id}static createExtensionToFileTypeValues(){h.fileTypeStringToExtensions||h.createFileTypeStringToExtensionsValues(),h.extensionToFileType={};for(const e in h.fileTypeStringToExtensions){if(!h.fileTypeStringToExtensions.hasOwnProperty(e))continue;const t=h.fileTypeStringToExtensions[e];t&&t.forEach((t=>{h.extensionToFileType[t]=n[e]}))}}static createFileTypeStringToExtensionsValues(){h.fileTypeStringToExtensions={},h.fileTypeStringToExtensions[n[n.Excel]]=["xls","xlsx","xlb","xlc","xlsb","xlsm","xlt","xltx","xltm","xlm","xla","xll","xlam","xlw","excel","csv"],h.fileTypeStringToExtensions[n[n.Visio]]=["vsd","vss","vst","vdx","vsx","vtx","vsl","vsu","vsw","vsdx","vsdm","vssm","vstx","vstm"],h.fileTypeStringToExtensions[n[n.PowerPoint]]=["ppt","pptx","pot","potx","potm","ppam","ppsx","ppsm","sldx","sldm","ppa","pps","pptm","powerpoint"],h.fileTypeStringToExtensions[n[n.Word]]=["doc","dot","docx","docm","dotx","dotm","docb","word"],h.fileTypeStringToExtensions[n[n.Photos]]=["jpg","png","jpeg","gif","svg","bmp","tif","tiff","heic"],h.fileTypeStringToExtensions[n[n.Video]]=h.StreamExtensions,h.fileTypeStringToExtensions[n[n.Outlook]]=["msg","eml"],h.fileTypeStringToExtensions[n[n.OneNote]]=["one"],h.fileTypeStringToExtensions[n[n.Pdf]]=["pdf"],h.fileTypeStringToExtensions[n[n.Audio]]=["mp3"],h.fileTypeStringToExtensions[n[n.Text]]=["txt"],h.fileTypeStringToExtensions[n[n.Fluid]]=["fluid","loop"],h.fileTypeStringToExtensions[n[n.Stream]]=h.StreamExtensions,h.fileTypeStringToExtensions[n[n.Whiteboard]]=["whiteboard"],h.fileTypeStringToExtensions[n[n.MeetingNotes]]=["note"]}encodeUrl(e,t,i){try{let n=e;return t&&(n=o.a.decodeUrl(e),n||(n=e)),o.a.encodeUrl(n,i)}catch(t){return e}}setupAttribution(e,t){if(this.fileType!==n.Sway&&this.fileType!==n.Forms&&this.fileType!==n.Project&&this.fileType!==n.ProjectOperations)if(this.attribution=a.a.Format(this.pathArray,t)[1],e)this.attributionUrl=e;else{const e=this.url?this.url.lastIndexOf(this.isLocal?"\\":"/"):-1;if(this.attributionUrl=-1===e?this.url:this.url.substring(0,e+1),this.attributionUrl&&this.attributionUrl.match(d)){const e=s.a.getLocation(this.attributionUrl).path;e.lastIndexOf("/",e.length-2)<=0&&(this.attributionUrl=`${this.attributionUrl}?id=root`)}}}}h.NameToFileType={none:n.None,unknown:n.Unknown,excel:n.Excel,onenote:n.OneNote,pdf:n.Pdf,powerpoint:n.PowerPoint,audio:n.Audio,video:n.Video,visio:n.Visio,word:n.Word,photos:n.Photos,text:n.Text,outlook:n.Outlook,sway:n.Sway,forms:n.Forms,formsquiz:n.FormsQuiz,project:n.Project,projectoperations:n.ProjectOperations,portfolio:n.Portfolio,news:n.NewsArticle,newsarticle:n.NewsArticle,onedrive:n.OneDrive,sharepoint:n.SharePoint,bohemia:n.Fluid,fluid:n.Fluid,loop:n.Fluid,"loop components":n.Fluid,powerbi:n.PowerBI,streamsvideo:n.StreamsVideo,yammer:n.Yammer,mindmeister:n.MindMeister,stream:n.Stream,monday:n.Monday,trello:n.Trello,platform:n.Platform,whiteboard:n.Whiteboard,meetingnotes:n.MeetingNotes,myanalytics:n.MyAnalytics,list:n.List,playlists:n.PlayLists,playlist:n.PlayList,"meeting object":n.MeetingObject,upcomingmeeting:n.UpcomingMeeting,screenrecording:n.ScreenRecording,designer:n.Designer},h.NameToProvenance={Unknown:r.Unknown,AADGraph:r.AADGraph,Exchange:r.Exchange,OfficeGraph:r.OfficeGraph,OfficeMru:r.OfficeMru,SharePoint:r.SharePoint,Substrate:r.Substrate},h.StreamExtensions=["mts","m2ts","ts","3g2","3gp","3gp2","3gpp","asf","wmv","avi","m4v","mov","mp4","mp4v","ogg","webm","movie","mkv","mpg","mpeg"]},Bc8L:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},Bmgn:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},Brer:function(e,t,i){"use strict";i.d(t,"a",(function(){return A}));var n=i("GMuP"),r=i("WKA6"),a=i("lrJm"),o=i("hhzZ"),s=i("R7NL"),l=i("BaAg"),c=i("p6Zr"),u=i("L/Tc"),d=i("fKR7"),h=i("4/We"),p=i("cgnd"),m=i("/I02"),f=i("oAX+"),g=i("ZBli"),b=i("pjz5"),v=i("kpuN"),S=i("pd4Y"),y=i("wwmn"),C=(i("Dpxn"),i("casz")),w=i("BMb5"),I=i("pOWU"),T=i("Mlb/"),k=i("vk2e");class A extends I.a{constructor(e,t,i,n,r,a,o,s,l,c,u,d){super(e,n,r,"SharePoint",a,o,c,d,"WLID1.1 "),this.capabilitiesService=t,this.dateService=s,this.windowService=l,this.globalErrorHandler=u,this.requestCache=new Map,this.itemPathPredicate=":/",this.requestConfig={headers:new Map([["accept","application/json"],["Prefer","allow-zerobyte"],["application","officehome"]])},this.inMockMode&&(this.itemPathPredicate="?path=");const h=this.contextService.sharedContext;this.isConsumer=i.config.authType===p.a.MSA,this.myDriveUrl=`${this.isConsumer?this.getConsumerBaseUrl():this.getCommercialBaseUrl(h.oneDriveResourceId)}/${A.drivePath}`}static getItemParams(e,t,i,n="",r="open"){const a=t?[...new Set(e.concat(A.WacDataSelectParams))]:e;return[a.length?`$select=${a.join(",")}`:"",i?"$expand=thumbnails":"",t?`action=${r}`:"",n?`$filter=${n}`:""].filter(Boolean).join("&")}static getWopiHostDataFromItem(e){var t,i,n,r,a,o,s;return{bundleUrl:null!==(i=null===(t=null==e?void 0:e.officeBundle)||void 0===t?void 0:t.url)&&void 0!==i?i:"",bundleVersion:null!==(r=null===(n=null==e?void 0:e.officeBundle)||void 0===n?void 0:n.version)&&void 0!==r?r:"",downloadUrl:(null==e?void 0:e["@content.downloadUrl"])||(null==e?void 0:e["@microsoft.graph.downloadUrl"]),eTag:null==e?void 0:e.eTag,fileName:null==e?void 0:e.name,fileSize:null==e?void 0:e.size,irmEnabled:null===(a=null==e?void 0:e.sensitivityLabel)||void 0===a?void 0:a.protectionEnabled,isNewFile:!1,readOnly:null===(o=null==e?void 0:e.currentUserRole)||void 0===o?void 0:o.readOnly,wac:null===(s=null==e?void 0:e.openWith)||void 0===s?void 0:s.wac,sharepointIds:null==e?void 0:e.sharepointIds}}getMyDriveRootUrl(e=0){if(!this.capabilitiesService.capabilities.oneDriveApisEnabled)return Promise.resolve(null);if(!this.myDriveRootUrlPromise){const t=new Promise(((t,i)=>{const n=this.getMyDriveRootUrlStream(e);n.results.pipe(Object(r.a)(1)).toPromise().then((e=>{e&&e.userRoot?t(e):i("No/Incomplete data returned.")})),n.initialCompletion.then((e=>{e&&(this.globalErrorHandler.handleCacheObservableError(e,"Escyx","TBMsL"),e.cacheError&&e.networkError&&i(e))}))}));this.myDriveRootUrlPromise=t}return this.myDriveRootUrlPromise}getMyDriveRootUrlStream(e=0){if(this.myDriveRootUrlStream)return this.myDriveRootUrlStream;const t=this.getMyDriveRootUrlInternal("cache-only",e),i=this.getMyDriveRootUrlInternal("network-first",e),n=f.a.createResultsWithCacheObservable(t,i,null,(e=>this.myDriveRootUrlStream=null));return this.myDriveRootUrlStream=n,this.myDriveRootUrlStream}getSharedItemWithThumbnail(e,t,i,n,r,a=!1,o=0){return this.getSharedItemWithParams(e,t,i,A.getItemParams(["id","sharepointIds","parentReference","createdDateTime"],r,!0),n,a,o)}getSharedItemWithoutThumbnail(e,t,i,n,r,a="open",o=!1,s=0){return this.getSharedItemWithParams(e,t,i,A.getItemParams(["id","sharepointIds","parentReference","createdDateTime"],r,!1,"",a),n,o,s)}getSharedItemWithThumbnailAndIds(e,t,i,n,r,a=!1,o=0){return this.getSharedItemWithParams(e,t,i,A.getItemParams(["id","sharepointIds"],r,!0),n,a,o)}getItemWithWacDataAndThumbnails(e,t,i=!1,n=0){return this.getItemWithParams(e.url,e.driveId,e.docId,t,A.getItemParams([],!0,!0),i,n)}getItemWithWacData(e,t,i,n,r="open",a=!1,o=0){return this.getItemWithParams(e,t,i,n,A.getItemParams([],!0,!1,null,r),a,o)}getItemAccessForUser(e,t,i,n){const r=this.getApiInfo(e,!0),a=`${r.baseUrl}/drives/${encodeURIComponent(t)}/items/${encodeURIComponent(i)}/oneDrive.checkAccess`;return new Promise(((e,t)=>{const i=this.getRequestConfig();i.headers.set("Content-Type","application/json"),this.post("Vroom_OneDrive_Item_Check_Access_Request","Vroom_OneDrive_Item_Check_Access",a,JSON.stringify({value:[{email:n}]}),(i=>{i.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((i=>{i&&i.data&&i.data.value&&i.data.value[0]?e(i.data.value[0]):t(new I.b(i,"No data returned"))})).catch((e=>{this.globalErrorHandler.handleError(e,"B95N9"),t(e)}))}),t,i,null,null,null,null,r.tokenType,r.resourceUrl,null,"network-only",null,null)}))}getEnterpriseTemplatesLibraries(){const e=A.getItemParams(["id","name","organizationAssets"],!1,!1,"organizationAssets/officeTemplateLibrary%20ne%20null"),t=`${this.getCommercialBaseUrl(this.contextService.sharedContext.sharePointResourceId,!1,!0)}/drives${e?"?"+e:""}`;return this.getDriveItems("Template_Libraries_Request","Template_Libraries",t,"cache-only").catch((()=>this.getDriveItems("Template_Libraries_Request","Template_Libraries",t,"network-first",void 0,null,0,"BrowseOrgTemplates","AUO")))}getDriveItemChildrenWithThumbnails(e,t,i="network-first",n,r){if(!e)return null;const a=A.getItemParams(["id","name","folder","webUrl","webDavUrl"],!1,!0),o=t?`items/${encodeURIComponent(t)}/`:"root/",s=`${this.getCommercialBaseUrl(this.contextService.sharedContext.sharePointResourceId)}/drives/${encodeURIComponent(e)}/${o}children${a?"?"+a:""}`;return this.getDriveItems("Vroom_Item_Request","Vroom_Item",s,i,void 0,null,0,n,r)}createNewFile(e,t,i=!1){const r=`${this.myDriveUrl}root/children?select=webDavUrl,${i?"openWith,":""}*`,a={name:e,file:{},"@name.conflictBehavior":"rename"};return new Promise(((e,i)=>{this.post("Vroom_Create_File_Request","Vroom_Create_File",r,a,(t=>{t.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((t=>{const n=t.data;n&&n.id?e(n):i(new I.b(t,"Could not parse drive item from Vroom response"))})).catch((e=>{if(e&&e.data){const t={};t.DebugInfo=JSON.stringify(e.data),t.HttpCode=e.status.toString(),this.instrumentationService.logDebugCacheEvent("Vroom_Create_File_Request",t),Object(n.a)({eventName:"Vroom_Create_File_Request",params:t})}this.globalErrorHandler.handleError(e,"vcXyA")}))}),(e=>{e&&e.httpResponse?i(e.httpResponse.data?{error:{code:`${e.httpResponse.status}`,data:`${e.httpResponse.data}`}}:{error:{code:`${e.httpResponse.status}`}}):i()}),this.getRequestConfig(),null,null,null,null,"OneDrive",this.contextService.sharedContext.oneDriveResourceId,null,null,!0,{category:"CreateFile",fileType:t})}))}uploadFile(e,t,i,n,r,a,o){return new Promise(((s,l)=>{e&&e.name||l(new I.b(null,"Invalid file"));const c=`${this.getUploadLocation(this.myDriveUrl,e,i,n)}content?@name.conflictBehavior=rename&select=webDavUrl,*`;this.put("Vroom_Upload_File_Request","Vroom_Upload_File",c,e,(i=>{i.instrument(((i,n)=>this.instrumentUploadResponse(i,n,e,t))).then((e=>{const t=e.data;t&&t.id?s(t):l(new I.b(e,"Could not parse drive item from Vroom response"))})).catch((e=>{this.globalErrorHandler.handleError(e,"dSenI")}))}),l,this.getRequestConfig(),r,null,a,o,"OneDrive",this.contextService.sharedContext.oneDriveResourceId)}))}getDownloadUrl(e){if(!(e&&e.itemId&&e.driveId&&e.itemUrl))return Promise.reject("Invalid params");const t=A.getItemParams(["id","content.downloadUrl"],!1,!1);return this.getItemWithParams(e.itemUrl,e.driveId,e.itemId,"network-only",t).then((e=>e["@content.downloadUrl"]?g.a.removeQueryParams(e["@content.downloadUrl"],["tempAuth","ApiVersion"],!1):Promise.reject("Missing downloadUrl")))}createUploadSession(e,t,i,n,r){return new Promise(((a,o)=>{e&&e.name||o(new I.b(null,"Invalid file"));const s=`${this.getUploadLocation(this.myDriveUrl,e,i,n)}${this.inMockMode?"":"oneDrive."}createUploadSession`;this.post("Vroom_Create_Upload_Session_Request","Vroom_Create_Upload_Session",s,{item:{"@name.conflictBehavior":"rename"}},(i=>{i.instrument(((i,n)=>{if(this.instrumentUploadResponse(i,n,e,t),i.ok){const e=i.data;n.Length=e&&e.uploadUrl?e.uploadUrl.length.toString():"0"}})).then((e=>{const t=e.data;t&&t.uploadUrl?a(t):o(new I.b(e,"Could not parse upload session from Vroom response"))})).catch((e=>{this.globalErrorHandler.handleError(e,"d9WE9")}))}),o,this.getRequestConfig(),null,null,r,null,"OneDrive",this.contextService.sharedContext.oneDriveResourceId)}))}cancelUploadSession(e,t,i){return this.cancelUploadSessionInternal(e,t,i,"OneDrive",this.contextService.sharedContext.oneDriveResourceId)}uploadFragment(e,t,i,n,r,a,o,s,l){return new Promise(((c,u)=>{e||u(new I.b(null,"Invalid session url"));const d="select=webDavUrl,*";e.endsWith(d)||(e=g.a.appendQuery(e,d));const h=new Map,p=Math.max(0,i-t);h.set("Content-Range",`bytes ${t}-${t+p-1}/${n}`),this.put("OneDrive_Graph_Upload_Fragment_Request","OneDrive_Graph_Upload_Fragment",e,r,(e=>{e.instrument(((e,i)=>{i.TotalSize=n.toString(),i.ActualSize=p.toString(),i.Index=t.toString(),i.UploadSessionId=a,i.RequestId=this.getRequestIdFromResponse(e)})).then((({data:e})=>c(e))).catch((e=>{this.globalErrorHandler.handleError(e,"t59Ym")}))}),u,{headers:h},o,null,s,l,"None")}))}getUploadSessionStatus(e,t,i){return this.getUploadSessionStatusInternal(e,t,i,"OneDrive",this.contextService.sharedContext.oneDriveResourceId)}getDocumentActivity(e,t,i=0){if(!e||!e.driveId||!e.docId)return Promise.reject(new I.b(null,"Drive and doc IDs are required"));const n=`${t}_${e.driveId}_${e.docId}_activity`,r=this.getRequestFromCache(n);if(r)return r;const a=new Promise(((r,a)=>{const o=this.getCommercialApiInfo(e.url);o||a("Invalid document url");const s=`${o.baseUrl}/drives/${encodeURIComponent(e.driveId)}/items/${encodeURIComponent(e.docId)}/activities`;this.get("Vroom_Activity_Request","Vroom_Activity",s,(t=>{t.instrument(((t,i)=>{if(i.RequestId=this.getSharepointRequestId(t),i.FileFormat=d.a[e.format],t&&t.ok&&t.data&&t.data.value){const e=t.data.value.length.toString();i.ActualSize=e,i.Distribution=this.distributionByActionType(t.data.value)}})).then((e=>{e&&e.data&&e.data.value?r(e.data.value.map((e=>{let t;return t=e.action.hasOwnProperty(A.mentionKey)?{type:u.a.Mention,data:e.action[A.mentionKey]}:e.action.hasOwnProperty(A.commentKey)?{type:u.a.Comment,data:e.action[A.commentKey]}:e.action.hasOwnProperty(A.editKey)?{type:u.a.Edit,data:e.action[A.editKey]}:{type:u.a.Unknown,data:null},{action:t,actor:e.actor,timestamp:this.getPreferredTime(e.times)}}))):a(new I.b(e,"No data returned"))})).catch((e=>{this.globalErrorHandler.handleError(e,"ACZGk")}))}),(e=>{this.requestCache.delete(n),a(e)}),this.getRequestConfig(),t,null,null,null,o.tokenType,o.resourceUrl,i)}));return this.requestCache.set(n,{promise:a,expiryTime:this.dateService.addSeconds(this.dateService.getCurrentDate(),this.contextService.sharedContext.activityLifetimeInSeconds)}),a}getUploadLocation(e,t,i,n){return`${e}${this.inMockMode?"upload/":`${n?`root${this.itemPathPredicate}${n}/`:i?`items/${i}${this.itemPathPredicate}`:`root${this.itemPathPredicate}`}${encodeURIComponent(t.name)}${this.itemPathPredicate}`}`}instrumentUploadResponse(e,t,i,n){t.TotalSize=i.size.toString(),t.UploadSessionId=n,t.RequestId=this.getRequestIdFromResponse(e)}getRootUrlsFromRootItem(e,t){let i=null;const n=e?e.webUrl:null;if(!n)return this.instrumentationService.logGenericEvent("OneDrive_Places_Bad_Url"),null;if(!this.isConsumer){const e=A.oneDriveBaseUrlSearchRegex.exec(n);e&&e.length&&(i=e[0])}return{tenantRoot:i,userRoot:n,fromCache:"cache-only"===t}}getSharesUrl(e){try{let t=this.windowService.nativeWindow.btoa(unescape(encodeURIComponent(e))),i=t.length-1;for(;"="===t.charAt(i);)--i;return t=t.slice(0,i+1).replace(/\+/g,"-").replace(/\//g,"_"),`shares/u!${t}/driveItem`}catch(e){return this.globalErrorHandler.handleError(e,"fYwwF"),null}}cancelUploadSessionInternal(e,t,i,n,r){return new Promise(((a,o)=>{e||o(new I.b(null,"Invalid session url")),this.delete("OneDrive_Graph_Cancel_Upload_Session_Request","OneDrive_Graph_Cancel_Upload_Session",e,null,(e=>{e.instrument(((e,i)=>{i.UploadSessionId=t,i.RequestId=this.getRequestIdFromResponse(e)})).then((()=>a(null))).catch((e=>{this.globalErrorHandler.handleError(e,"wQvvW")}))}),o,this.getRequestConfig(),i,null,n,r)}))}getUploadSessionStatusInternal(e,t,i,n,r){return new Promise(((a,o)=>{e||o(new I.b(null,"Invalid session url")),this.get("OneDrive_Graph_Upload_Status_Request","OneDrive_Graph_Upload_Status",e,(e=>{e.instrument(((e,i)=>{i.UploadSessionId=t,i.RequestId=this.getRequestIdFromResponse(e)})).then((({data:e})=>a(e))).catch((e=>{this.globalErrorHandler.handleError(e,"PPAU2")}))}),o,this.getRequestConfig(),"network-only",null,i,null,n,r)}))}getMyDriveRoot(e,t){return this.getMyDriveItem("root",e,t)}createSharingLink(e,t){if(this.isConsumer)return Promise.reject("api only available for commercial");const i=`${this.getCommercialBaseUrl(this.contextService.sharedContext.sharePointResourceId,!1,!0)}/drives/${encodeURIComponent(e)}/items/${encodeURIComponent(t)}/createLink`,n={type:"addressBar"},r=this.getRequestConfig();return r.headers.set("Content-Type","application/json"),new Promise(((e,t)=>{this.post("Vroom_Create_Link_Request","Vroom_Create_Link",i,JSON.stringify(n),(i=>{i.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((i=>{var n,r;(null==i?void 0:i.ok)&&(null===(r=null===(n=null==i?void 0:i.data)||void 0===n?void 0:n.link)||void 0===r?void 0:r.webUrl)?e(i.data.link.webUrl):t(i.statusText)})).catch((e=>{this.globalErrorHandler.handleError(e)}))}),t,r)}))}getThumbnailString(e){const t=new FileReader;return new Promise(((i,n)=>{e=`${this.isConsumer?this.getConsumerBaseUrl():this.getCommercialBaseUrl(this.contextService.sharedContext.oneDriveResourceId)}/${e}`;const r=this.getRequestConfig({responseType:"blob"}),a=this.getApiInfo(e);this.get("Vroom_Thumbnail_String_Request","Vroom_Thumbnail_String",e,(e=>{e.instrument(((e,t)=>{t.RequestId=this.getSharepointRequestId(e)})).then((e=>{e&&e.data?(t.onloadend=()=>{const e="string"==typeof t.result&&t.result||"";e.length>0?i(e):n()},t.onerror=n,t.onabort=n,t.readAsDataURL(e.data)):n()})).catch((e=>{this.globalErrorHandler.handleError(e,"AfEUN")}))}),n,r,"network-only",null,null,null,a.tokenType,a.resourceUrl)}))}getFluidEnabled(e){const t=`${this.getCommercialBaseUrl(this.contextService.sharedContext.sharePointResourceId,!1,!0)}/${A.drivePath}root/opStream/fluidEnabled`;return new Promise(((i,n)=>{this.get("Vroom_Get_Fluid_Enabled_Request","Vroom_Get_Fluid_Enabled",t,(e=>{e.then((({data:e})=>i(e.isFluidEnabled))).catch((e=>{this.globalErrorHandler.handleError(e,"PPAU2"),n()}))}),n,this.getRequestConfig(),e,null)}))}handleQueryParam(e,t,i){"mockvroom"===e&&this.mockRequestHeader&&(null==i||i.headers.set(this.mockRequestHeader,t))}getRequestIdFromResponse(e){var t;return this.isConsumer?this.getHeaderValue(e.headers,"ms-cv"):null!==(t=super.getRequestIdFromResponse(e))&&void 0!==t?t:this.getSharepointRequestId(e)}getMyDriveItem(e,t,i){return this.getDriveItem("Vroom_Item_Request","Vroom_Item",`${this.myDriveUrl}${e}`,t,null,"OneDrive",this.contextService.sharedContext.oneDriveResourceId,i)}getItemWithParams(e,t,i,n,r,a=!1,o=0){const s=this.getApiInfo(e);if(!s)return Promise.reject("Invalid document url");const l=`${s.baseUrl}/drives/${encodeURIComponent(t)}/items/${encodeURIComponent(i)}/${r?"?"+r:""}`,c=r.includes("openWith");return this.getDriveItem(c?"Vroom_Item_With_Wac_Data_Request":"Vroom_Item_Request",c?"Vroom_Item_With_Wac_Data":"Vroom_Item",l,n,null,s.tokenType,s.resourceUrl,o,c,a)}getSharedItemWithParams(e,t,i,n,r,a=!1,o=0){const s=this.getSharesUrl(e);if(!s)return Promise.reject(new I.b(null,"Failed to construct shares url"));const c=this.getApiInfo(e),u=this.inMockMode?`shares?itemUrl=${encodeURIComponent(s)}&currentDate=${this.dateService.getCurrentDateMinuteGranularity().toISOString()}`:`${s}${n?"?"+n:""}`,d=`${c.baseUrl}/${u}`,h=n.includes("openWith");return this.getDriveItem(h?"Vroom_Shares_With_Wac_Data_Request":"Vroom_Shares_Request",h?"Vroom_Shares_With_Wac_Data":"Vroom_Shares",d,r,((e,n)=>{if(n.RequestId=this.getSharepointRequestId(e),n.DocumentType=l.b[t],i&&(n.FileFormat=i),e.ok){const t=e.data,i=t?t.thumbnails:null;n.ItemCount=(i?i.length:0).toString()}}),c.tokenType,c.resourceUrl,o,h,a)}getDriveItem(e,t,i,n,r,a,o,s=0,l=!1,c=!1){const u=`${i}/${n}`,d=c?void 0:this.getRequestFromCache(u);if(d)return d;const h=new Promise(((l,c)=>{const d=this.getRequestConfig();d.headers.has(A.scenarioHeader)&&d.headers.delete(A.scenarioHeader),d.headers.has(A.scenarioTypeHeader)&&d.headers.delete(A.scenarioTypeHeader),this.get(e,t,i,(e=>{e.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e),r&&r(e,t)})).then((e=>{e&&e.data?l(e.data):c(new I.b(e,"No data returned"))})).catch((e=>{this.globalErrorHandler.handleError(e,"tIvZK")}))}),(e=>{this.requestCache.delete(u),c(e)}),d,n,null,null,null,a,o,s)}));return this.requestCache.set(u,{promise:h,expiryTime:l?this.dateService.addHours(this.dateService.getCurrentDate(),10):void 0}),h}getDriveItems(e,t,i,n,r,a,o=0,s,l){const c=`${i}/${n}`,u=this.getRequestFromCache(c);if(u)return u;const d=new Promise(((u,d)=>{const h=this.getRequestConfig();s?h.headers.has(A.scenarioHeader)?h.headers[A.scenarioHeader]=s:h.headers.set(A.scenarioHeader,s):h.headers.has(A.scenarioHeader)&&h.headers.delete(A.scenarioHeader),l?h.headers.has(A.scenarioTypeHeader)?h.headers[A.scenarioTypeHeader]=l:h.headers.set(A.scenarioTypeHeader,l):h.headers.has(A.scenarioTypeHeader)&&h.headers.delete(A.scenarioTypeHeader),this.get(e,t,i,(e=>{e.instrument(((e,t)=>{t.RequestId=this.getSharepointRequestId(e)})).then((e=>{e&&e.data?u(e.data):d(new I.b(e,"No data returned"))})).catch((e=>{this.globalErrorHandler.handleError(e,"QYFpr")}))}),(e=>{this.requestCache.delete(c),d(e)}),h,n,null,null,null,r,a,o)}));return this.requestCache.set(c,{promise:d}),d}distributionByActionType(e){return e?e.map((e=>{if(e&&e.action){const t=Object.keys(e.action);if(t&&t.length)return t[0]}return""})).reduce(((e,t,i)=>e+(0===i?"":";")+t),""):""}getPreferredTime(e){return e?e.observedTime?new Date(e.observedTime):e.recordedTime?new Date(e.recordedTime):null:null}getRequestFromCache(e){if(this.requestCache.has(e)){const t=this.requestCache.get(e);if(t.promise&&(!t.expiryTime||t.expiryTime>this.dateService.getCurrentDate()))return t.promise;this.requestCache.delete(e)}return null}getApiInfo(e,t){return this.isConsumer?this.getConsumerApiInfo(e):this.getCommercialApiInfo(e,t)}getConsumerApiInfo(e){const t=b.a.getLocation(e);return t&&t.protocol&&t.host?{baseUrl:this.getConsumerBaseUrl(),tokenType:"OneDrive",resourceUrl:this.contextService.sharedContext.oneDriveResourceId,hostname:t.hostname}:null}getCommercialApiInfo(e,t=!1){const i=b.a.getLocation(e);if(!i||!i.protocol||!i.host)return null;const n=`${i.protocol}//${i.host}`;return{baseUrl:this.getCommercialBaseUrl(n,!1,t),tokenType:this.getTokenType(n),resourceUrl:n,hostname:i.hostname}}getCommercialBaseUrl(e,t,i=!1){return e=this.inMockMode?`${this.contextService.sharedContext.officeHomeApiRoot}`:e,t?`${e}/_api`:i?`${e}/_api/v2.1`:`${e}/_api/v2.0`}getConsumerBaseUrl(){return this.inMockMode?this.contextService.sharedContext.officeHomeApiRoot:this.contextService.sharedContext.oneDriveConsumerApi}getTokenType(e){return l.a.referralFromFileLocation(e)===c.a.OneDrive?"OneDrive":"SharePoint"}getRequestConfig(e={}){return Object.assign(Object.assign(Object.assign({},this.requestConfig),{headers:new Map(this.requestConfig.headers)}),e)}getSharepointRequestId(e){return e.headers&&e.headers.get("SPRequestGuid")}getMyDriveRootUrlInternal(e,t){return this.getMyDriveRoot(e,t).then((t=>this.getRootUrlsFromRootItem(t,e)))}}A.WacDataSelectParams=["id","openWith","officebundle","currentUserRole","eTag","name","size","content.downloadUrl","file","sharepointIds","sensitivityLabel","webUrl"],A.mentionKey="mention",A.commentKey="comment",A.editKey="edit",A.drivePath="drive/",A.oneDriveBaseUrlSearchRegex=/^https?:\/\/(.(?!\/))*.\//i,A.scenarioHeader="scenario",A.scenarioTypeHeader="scenarioType",A.sharesFileTypes=new Set([l.b.Excel,l.b.PowerPoint,l.b.Visio,l.b.Word,l.b.OneNote]),A.ɵprov=T.kc({factory:function(){return new A(T.lc(v.a),T.lc(h.a),T.lc(p.b),T.lc(o.a),T.lc(s.a),T.lc(m.a),T.lc(y.a),T.lc(S.a),T.lc(w.b),T.lc(k.q),T.lc(a.b),T.lc(C.a))},token:A,providedIn:"root"})},CC5A:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r}));class n{constructor(e){this.onTabAddedOrUpdated=new Array,Object.assign(this,e)}updateOrAddTab(e,t=-1){const i=this.tabs;let n=!1,r=i.length;for(let t=0;t<i.length;t++)if(i[t].id===e.id){n=!0,r=t,i[t]=e;break}n||(-1===t||t>=i.length?i.push(e):i.splice(t,0,e));for(const t of this.onTabAddedOrUpdated)t(e,r,n)}registerOnTabAddedOrUpdated(e){this.onTabAddedOrUpdated.push(e)}}var r;!function(e){e[e.Unknown=0]="Unknown",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.Error=3]="Error"}(r||(r={}))},CCRL:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n=new(i("Mlb/").u)("LAZY_VIEW_ENTRY_COMPONENT")},CMIS:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("TfV2"),r=i("ZBSS"),a=i("uqr+"),o=i("dSKW"),s=i("uV9m");function l(e,t){void 0===t&&(t=n.a.Security),Object(s.e)("Error",function(e){var t,i,n,l,c={};if(c[r.y]="Error",c[r.z]=e.eventName,c[Object(a.a)([r.w,r.x])]=null!==(t=e.errorType)&&void 0!==t?t:"",c[Object(a.a)([r.w,r.j])]=null!==(i=e.area)&&void 0!==i?i:"",c[Object(a.a)([r.w,r.fb])]=null!==(n=e.subArea)&&void 0!==n?n:"",c[Object(a.a)([r.w,r.u])]=null!==(l=e.errorCategory)&&void 0!==l?l:"",e.occurrenceCount&&(c[Object(a.a)([r.w,r.v])]=e.occurrenceCount),Object(s.c)()){var u=Object(o.a)(Object(s.a)());c[Object(a.a)([r.w,r.V])]=u,c[Object(a.a)([r.w,r.W])]=Object(o.c)(u),c[Object(a.a)([r.w,r.U])]=Object(o.b)(u)}return c}(e),t)}},COYM:function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return l}));var n=i("BMb5"),r=i("Mlb/"),a=i("vk2e");const o=new r.u("CRYPTO_API_AVAILABLE",{providedIn:"root",factory:()=>function(e,t){if(!Object(a.t)(t))return!1;const i=e.nativeWindow.crypto;if(!i)return!1;if(!i.getRandomValues)return!1;const n=i.subtle;if(!n)return!1;const r=["encrypt","decrypt","importKey","digest"];for(const e of r)if(!(e in n))return!1;return!0}(Object(r.db)(n.b),Object(r.db)(r.I))}),s="CryptoAPI Not Available";class l{constructor(e,t){this.cryptoApiAvailable=e,this.windowService=t}get crypto(){if(!this.cryptoApiAvailable)throw new Error(s);return this.windowService.nativeWindow.crypto}}l.ɵprov=r.kc({factory:function(){return new l(r.lc(o),r.lc(n.b))},token:l,providedIn:"root"})},CVeG:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{static escapeHtml(e){return e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}static stripTags(e){return e?e.replace(/<.*?>/g,""):""}}},CfLe:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},Cin9:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("TfV2"),r=i("ZBSS"),a=i("dSKW"),o=i("uqr+"),s=i("uV9m");function l(e,t){void 0===t&&(t=n.a.Security),Object(s.e)("Performance",function(e){var t,i,n={};if(n[r.y]="Performance",n[r.z]=e.eventName,Object(s.c)()){var l=Object(a.a)(Object(s.a)());n[Object(o.a)([r.Y,r.V])]=l,n[Object(o.a)([r.Y,r.W])]=Object(a.c)(l),n[Object(o.a)([r.Y,r.U])]=Object(a.b)(l)}return n[Object(o.a)([r.Y,r.j])]=null!==(t=e.area)&&void 0!==t?t:"",n[Object(o.a)([r.Y,r.fb])]=null!==(i=e.subArea)&&void 0!==i?i:"",n[Object(o.a)([r.Y,r.S])]=e.latency,n}(e),t)}},ConB:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.Controlled="Controlled",e.SupportedNotControlled="SupportedNotControlled",e.Unknown="Unknown",e.Unsupported="Unsupported"}(n||(n={}))},D6F8:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},D8EG:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},DCBR:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("hhzZ");i("W3Zz"),i("hZW2"),i("4/We"),i("PBJH");class r{constructor(e,t,i,n,r,a){this.capabilitiesService=e,this.changeDetector=t,this.deviceDetector=i,this.documentService=n,this.instrumentationService=r,this.locService=a,this.cardIncrement=4,this.currentCarouselPage=0,this.maxCardsPerLine=4,this.cardMinWidth=217,this.cardMargin=12}ngOnInit(){this.sharedInit(),this.cards=this.carousel.cards,this.canSwipe=!this.deviceDetector.isDesktopDevice(),this.carousel.cards.length>0&&(this.maxCardContainerWidths=[this.maxCardContainerWidth(1),this.maxCardContainerWidth(2),this.maxCardContainerWidth(3),this.maxCardContainerWidth(4)])}navigateCards(e){const t=this.currentCarouselPage+e*this.cardIncrement;return t<this.cards.length&&t>=0&&(this.navigationAnnouncement="",e<0?setTimeout((()=>this.navigationAnnouncement=this.previousPage),0):setTimeout((()=>this.navigationAnnouncement=this.nextPage),0),this.currentCarouselPage=t,this.logNavClick(e),!0)}updateCarouselCardData(e=0){this.carouselElement&&(this.cardIncrement=this.getNumCards(e))}trackByIndex(e){return e}sharedInit(){this.cardMinWidth=this.capabilitiesService.capabilities.fluentRefresh&&this.componentArea!==n.b.AppCategory?368:217,this.cardMargin=this.capabilitiesService.capabilities.fluentRefresh&&this.componentArea!==n.b.AppCategory?20:12,this.disableAnimation=this.capabilitiesService.capabilities.disableAnimation,this.nextPage=this.locService.ButtonNextPage,this.previousPage=this.locService.ButtonPreviousPage}maxCardContainerWidth(e){return(this.cardMinWidth+this.cardMargin)*e}logNavClick(e){const t={};t.Index=this.currentCarouselPage.toString(),t.Increment=this.cardIncrement.toString(),t.TotalSize=this.cards.length.toString(),this.navClickLogging(t,e<0?"NavPrevious":"NavNext")}getNumCards(e=0){if(!this.cards||!this.cards.length)return 0;this.changeDetector.detectChanges();let t=this.carouselContainer.nativeElement.clientWidth+this.cardMargin;!e||this.capabilitiesService.capabilities.fluentRefresh&&this.componentArea!==n.b.AppCategory||(t-=this.cardMargin+e);for(let e=this.maxCardsPerLine;e>0;e--)if(t>=this.maxCardContainerWidths[e-1])return e}}},DQbD:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("4/We"),r=i("cgnd"),a=i("/I02"),o=i("JH4S"),s=i("Mlb/");class l{constructor(e,t,i,n){this.clientStartupConfigService=e,this.contextService=t,this.capabilitiesService=i,this.userContextService=n,this.bootId=0}get HostContext(){return this}get audience(){const e=this.capabilitiesService.capabilities.fluidAudience;return"Production"===e&&this.userContextService.user.isGcc?"GCC":e}get hostAppVersion(){return`${this.clientStartupConfigService.config.sharedClientStartupContext.buildId}`}get hostCorrelationId(){return`${this.clientStartupConfigService.config.sharedClientStartupContext.correlationId}.${this.bootId}`}getBootId(){return this.bootId}get hostSessionId(){return this.clientStartupConfigService.config.sharedClientStartupContext.correlationId}get hostLocaleContext(){return{uiLanguage:this.contextService.sharedContext.officeMarket.toLowerCase()}}get hostName(){return"Office.com"}get hostAppName(){return"Office.com"}get hostAppPlatform(){return"Web"}get userContext(){return{user:{id:this.clientStartupConfigService.config.puid,tenantId:this.clientStartupConfigService.config.tenantId}}}resetFluidHostContext(e){e&&(this.hostScenarioStartTime=void 0,this.hostScenarioName=void 0),this.bootId++}}l.ɵprov=s.kc({factory:function(){return new l(s.lc(r.b),s.lc(a.a),s.lc(n.a),s.lc(o.a))},token:l,providedIn:"root"})},Dn7E:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("TfV2"),r=i("ZBSS"),a=i("zGJG"),o=i("uqr+"),s=i("9KSV"),l=i("dSKW"),c=i("uV9m");function u(e,t){void 0===t&&(t=n.a.Security),Object(c.e)(function(e){return["Feature",e].join(a.a)}(e.featureName),function(e){var t,i,n={};for(var a in e.params)n[Object(o.a)([r.B,a])]="string"==typeof e[a]?Object(s.a)(e.params[a]):e.params[a];if(n[r.y]="Feature",n[r.z]=e.eventName,Object(c.c)()){var u=Object(l.a)(Object(c.a)());n[Object(o.a)([r.B,r.V])]=u,n[Object(o.a)([r.B,r.W])]=Object(l.c)(u),n[Object(o.a)([r.B,r.U])]=Object(l.b)(u)}return n[Object(o.a)([r.B,r.j])]=null!==(t=e.area)&&void 0!==t?t:"",n[Object(o.a)([r.B,r.fb])]=null!==(i=e.subArea)&&void 0!==i?i:"",n}(e),t)}},Dpxn:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},EUVs:function(e,t,i){"use strict";i.d(t,"a",(function(){return E}));var n=i("QjXU"),r=i("CMIS"),a=i("6UlS"),o=i("O6Zd"),s=i("WKA6"),l=i("qIlG"),c=i("2h3P"),u=i("S5zL"),d=i("RT4L"),h=i("hhzZ"),p=i("BaAg"),m=i("jCfB"),f=i("4/We"),g=i("/I02"),b=i("ufVG"),v=i("IBRu"),S=i("pjz5"),y=i("y9oG"),C=i("hZW2"),w=i("Z0U4"),I=i("5aVq"),T=i("Xc4i"),k=i("BMb5"),A=i("Mlb/"),_=i("qk26"),P=i("vk2e");class E{constructor(e,t,i,n,r,o,s,l,c,u,d){this.activatedRoute=e,this.capabilitiesService=t,this.contextService=i,this.documentService=n,this.instrumentationService=r,this.location=o,this.officeRouteService=s,this.reactShellConfigService=l,this.shellShimService=c,this.uiHostBootstrapperService=u,this.windowService=d,this._loadedDocuments=new a.a(new Map),this.capabilitiesService.wacHostEnabled()&&(this.setupAbandonListener(),this.capabilitiesService.capabilities.isEmbedMode||this.setupResetShellListener())}static getParamsForDocumentInfo(e,t={}){return this.getWacParams(e.driveId,e.docId,e.docUrl,t)}static getParamsForMruFileItem(e,t={}){return this.getWacParams(e.driveId,e.docId,e.canonicalUrl,t)}static getWacParams(e,t,i,n={}){return Object.assign(Object.assign({},n),{[m.a.DriveId]:e,[m.a.ItemId]:t,[m.a.DocUrl]:i})}static getDocumentInfoForMruFileItem(e,t){return{docId:e.docId,docUrl:e.canonicalUrl,driveId:e.driveId,fileType:e.fileType,fileName:e.fileName,wdOrigin:t}}static isValidDocumentInfo(e){return!!e.docId&&!!e.driveId||!!e.docUrl}bootstrapAndRouteMruFileItem(e,t,i={},n,r){this.bootstrapAndRoute(E.getDocumentInfoForMruFileItem(e,t),i,n,r?this.uiHostBootstrapperService.convertMruInflationPromise(r,t,n):void 0)}bootstrapAndRoute(e,t={},i,r){return Object(n.__awaiter)(this,void 0,void 0,(function*(){this.capabilitiesService.wacHostEnabledForFileType(e.fileType)&&(yield this.bootstrap(e,i,r))(t)}))}bootstrapZeroByteFile(e,t,i,r,a){if(!this.capabilitiesService.wacHostEnabledForFileType(e.fileType))return;const o=i.then((t=>{const i={docId:t.docId,driveId:t.driveId,docUrl:t.canonicalUrl,fileName:t.fileName,wdOrigin:e.wdOrigin,fileType:e.fileType,newFile:!0},n=`${this.windowService.nativeWindow.location.origin}${this.getContentPath(e.fileType)}?${this.getQueryParamString(E.getParamsForDocumentInfo(i))}`;return i.newFileInfo={NewFilePath:n,TemplateSource:r?{FileGetUrl:"",DocUniqueId:r}:void 0},i})),s=this.uiHostBootstrapperService.bootstrapZeroByteDocument(e,t,o,r,a);return()=>Object(n.__awaiter)(this,void 0,void 0,(function*(){this.logLoadStart(s),(yield this.updateBootedDocumentsMap(s))(),s.data.documentIdentifierPromise.then((e=>{this.updateInformation(s.bootedDocumentInfo.bootId,e)}))}))}bootstrapDocumentFromLoader(e,t,i=!1){var r,a,o;return Object(n.__awaiter)(this,void 0,void 0,(function*(){if(!this.capabilitiesService.wacHostEnabledForFileType(e.fileType))return;const n=yield this.hasLoadedDocumentsObservable().toPromise();if(i&&n)return;const s=this.getApplicationParamsFromDocument(e);e.applicationUrlParams=s;const l=e.applicationUrlParams.actnavid;l&&!(null===(o=null===(a=null===(r=this.activatedRoute)||void 0===r?void 0:r.snapshot)||void 0===a?void 0:a.queryParams)||void 0===o?void 0:o[m.a.Nav])&&this.officeRouteService.updateQueryParams({nav:l}),this.bootstrap(e,t)}))}loadMruItem(e,t,i=!1){return this.bootstrap({docId:e.docId,driveId:e.driveId,docUrl:e.canonicalUrl,fileType:e.fileType,wdOrigin:this.contextService.getWdOrigin(t)},Date.now(),void 0,i)}prebootDocument(e,t){this.uiHostBootstrapperService.prebootDocument({docId:e.docId,driveId:e.driveId,docUrl:e.url,fileType:e.fileType,wdOrigin:this.contextService.getWdOrigin(t)})}bootstrap(e,t=Date.now(),i,n=!1){if(!this.capabilitiesService.wacHostEnabledForFileType(e.fileType))return;const r=this.uiHostBootstrapperService.bootstrapItem(e,t,i);return this.logLoadStart(r),this.updateBootedDocumentsMap(r,n)}prebootApplication(e,t){if(e!==p.b.Visio)return;const i=this.uiHostBootstrapperService.bootstrapApplication(e,t);if(!i)return;const n=i.correlationAndBoot[1],r=new a.a({bootAndLoadInfo:i.loadData,visible:!1,bootCompleted:!1});this._loadedDocuments.next(new Map([[n,r]]))}updateBootedDocumentsMap(e,t=!1){var i;return Object(n.__awaiter)(this,void 0,void 0,(function*(){const[n,r,o]=Object(v.a)(),s=(yield this.getCurrentLoadedDocuments()).get(e.bootedDocumentInfo.bootId);if(s){const i=s.getValue();s.next(Object.assign(Object.assign({},i),{visible:!t,bootAndLoadInfo:e}))}else{const r={bootAndLoadInfo:e,visible:!t,bootCompleted:!1,routeEndPromise:n};this.locationSubscription&&!(null===(i=this.locationSubscription)||void 0===i?void 0:i.closed)||(this.locationSubscription=this.location.subscribe((e=>{var t;const i=null!==(t=e.url)&&void 0!==t?t:"",n=S.a.getQueryParams(i),r=this.getAppNameFromUrl(i),a=p.a.fileTypeNameToFileType(r),o=this.getDocumentInfoFromParams(n,a);o&&E.isValidDocumentInfo(o)&&this.bootstrapDocumentFromLoader(o,Date.now(),!1)})));const o=new a.a(r);this._loadedDocuments.next(new Map([[e.bootedDocumentInfo.bootId,o]]))}return(t={})=>{this.routeToContentPage(e.bootedDocumentInfo.documentInfo,t).then((e=>e?r():o()))}}))}updateInformation(e,t,i,n=!1){var r;const a=null===(r=this._loadedDocuments.getValue())||void 0===r?void 0:r.get(e);if(!a)return;const o=a.getValue();if(!o)return;const s=Object.assign(Object.assign({},o),{bootAndLoadInfo:{correlationId:o.bootAndLoadInfo.correlationId,bootedDocumentInfo:{bootId:e,documentInfo:null!=t?t:o.bootAndLoadInfo.bootedDocumentInfo.documentInfo},data:o.bootAndLoadInfo.data},visible:null!=i?i:o.visible});a.next(s),n&&o.routeEndPromise.then((()=>{const e=E.getParamsForDocumentInfo(s.bootAndLoadInfo.bootedDocumentInfo.documentInfo);this.officeRouteService.updateQueryParams(e)}))}unloadAllDocuments(){this.locationSubscription.unsubscribe(),this._loadedDocuments.next(new Map)}resetShell(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){if(this.capabilitiesService.capabilities.isEmbedMode)return;const e=this.documentService.nativeDocument.getElementById("ReactShellHeader");if(e&&e.childElementCount){this.documentService.removeCssClassFromElement(e,E.HiddenShellClass);const t=yield this.shellShimService.getShellShim();t.Notifications.UnmuteToasts&&t.Notifications.UnmuteToasts()}else{const e=this.reactShellConfigService.reactShellConfig.resourceUrl;e&&this.documentService.addScriptToPage(e,(()=>this.windowService.nativeWindow.bootstrapReactShell()),(()=>{const t={ShellBootAfterStartup:"true",ResourceUrl:e};this.instrumentationService.logErrorEvent("Shell_Bootstrapper_Load_Error",t),Object(r.a)({eventName:"Shell_Bootstrapper_Load",errorType:"Shell_Bootstrap_Error",message:"Fail to add shell bootstrap script to page.",debugInfo:JSON.stringify(t)})}))}}))}getLoadedDocumentsObservable(){return this._loadedDocuments.asObservable().pipe(Object(o.a)((e=>Array.from(e.keys()).map((t=>({bootId:t,data:e.get(t).asObservable()}))))))}hasLoadedDocumentsObservable(){return this._loadedDocuments.asObservable().pipe(Object(o.a)((e=>e.size>0)),Object(s.a)(1))}getCurrentLoadedDocuments(){return this._loadedDocuments.asObservable().pipe(Object(l.a)()).toPromise()}getDocumentInfoFromParams(e,t,i){var n;const r=e[m.a.ItemId],a=e[m.a.DriveId],o=null!==(n=this.decodeParamWithKey(e,m.a.DocUrl))&&void 0!==n?n:this.decodeParamWithKey(e,m.a.ContentUri),s=e[m.a.Nav];return{docId:r,driveId:a,docUrl:o,wdOrigin:null!=i?i:this.contextService.getWdOrigin("DIRECT"),applicationUrlParams:s?{actnavid:s}:void 0,fileType:t}}getWacHostControlQueryParams(e){return E.WacHostControlFileTypes.indexOf(e)>=0&&this.capabilitiesService.capabilities.wacHostControlFlight?this.capabilitiesService.capabilities.pwaEnabled?{wdwachostcf:"hwa"}:{wdwachostcf:"web"}:{}}markBootCompleted(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const t=this._loadedDocuments.getValue().get(e),i=yield t.asObservable().pipe(Object(l.a)()).toPromise();t.next(Object.assign(Object.assign({},i),{bootCompleted:!0}))}))}getApplicationParamsFromDocument({docUrl:e}){if(!e)return{};const t=S.a.getQueryParams(e),i=t?t.nav:void 0;return i?{actnavid:i}:{}}routeToContentPage(e,t){const i=E.getParamsForDocumentInfo(e,t);return this.officeRouteService.navigateTo({route:"Content",app:e.fileType},!1,i)}decodeParamWithKey(e,t){const i=e[t];if(i){let e=i;try{e=decodeURIComponent(i.replace(/\+/g," "))}catch(t){e=null!=i?i:void 0}return e}}getContentPath(e){return`${this.capabilitiesService.capabilities.startPageRootPath}${p.b[e].toLowerCase()}${this.capabilitiesService.capabilities.wacHostPagePath}`}getQueryParamString(e){return Object.keys(e).filter((t=>e[t])).reduce(((t,i)=>t+`&${i}=${e[i]}`),"").slice(1)}getAppNameFromUrl(e){if(e){const t=e.split("/");if(t.length>=3)return t[2]}}setupAbandonListener(){this.getLoadedDocumentsObservable().pipe(Object(c.a)()).subscribe((([e,t])=>{null==e||e.forEach((e=>Object(n.__awaiter)(this,void 0,void 0,(function*(){if(!(null==t?void 0:t.some((t=>e.bootId===t.bootId)))){const t=yield e.data.pipe(Object(l.a)()).toPromise();t.bootCompleted||this.logAbandon(t.bootAndLoadInfo)}}))))}))}setupResetShellListener(){this.hasLoadedDocumentsObservable().pipe(Object(u.a)(),Object(d.a)(1)).subscribe((e=>{e||this.resetShell()}))}logLoadStart(e){this.instrumentationService.logGenericEvent("WacDocument_Load_Start",Object(y.a)(e.correlationId,e.bootedDocumentInfo.documentInfo))}logAbandon(e){this.instrumentationService.logGenericEvent("WacDocument_Abandon",Object(y.a)(e.correlationId,e.bootedDocumentInfo.documentInfo))}}E.HiddenShellClass="hide-shell",E.WacHostControlFileTypes=[p.b.Word,p.b.Excel,p.b.PowerPoint],E.ɵprov=A.kc({factory:function(){return new E(A.lc(_.a),A.lc(f.a),A.lc(g.a),A.lc(C.a),A.lc(h.a),A.lc(P.g),A.lc(w.a),A.lc(b.a),A.lc(I.a),A.lc(T.a),A.lc(k.b))},token:E,providedIn:"root"})},EVbV:function(e,t,i){"use strict";i.d(t,"a",(function(){return T})),i.d(t,"b",(function(){return D}));var n=i("Mlb/"),r=i("pzhl"),a=i("PkQn"),o=i("4/We"),s=i("1GMS"),l=i("cAxl"),c=i("3bNC"),u=i("vk2e"),d=i("Jn4Q"),h=i("dx17"),p=i("hZW2"),m=i("C0xW"),f=i("7Gwk"),g=i("hhzZ"),b=i("PBJH"),v=i("kfAr"),S=i("AY/E"),y=i("1Bt+"),C=i("TIi1"),w=i("EUVs"),I=i("BMb5"),T=n.Fb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"fadeIn",definitions:[{type:1,expr:"inactive => active",animation:[{type:6,styles:{opacity:0},offset:null},{type:4,styles:{type:6,styles:{opacity:1},offset:null},timings:"500ms 0ms linear"}],options:null}],options:{}}]}});function k(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-icon-font",[],[[1,"aria-label",0]],null,null,r.b,r.a)),n.Gb(1,638976,null,0,a.a,[o.a],{cssClass:[0,"cssClass"],iconFontType:[1,"iconFontType"],size:[2,"size"]},null)],(function(e,t){var i=t.component;e(t,1,0,n.Ob(1,"ms-fcl-tp activity-icon ",i.iconCssClass,""),i.htmlDescription.icon,i.iconSize)}),(function(e,t){var i=t.component;e(t,0,0,null==i.htmlDescription||null==i.htmlDescription.activityDescription?null:i.htmlDescription.activityDescription.plainText)}))}function A(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-person-picture",[],null,null,null,s.b,s.a)),n.Gb(1,573440,null,0,l.a,[c.a],{person:[0,"person"],personPictureCard:[1,"personPictureCard"]},null)],(function(e,t){e(t,1,0,t.component.person,!0)}),null)}function _(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),n.gc(-1,null,[" - "]))],null,null)}function P(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,3,"span",[],null,null,null,null,null)),n.Gb(1,278528,null,0,u.i,[n.x,n.y,n.o,n.K],{ngClass:[0,"ngClass"]},null),n.Zb(2,{"activity-deep-link__underlined ms-fcl-tp":0}),(e()(),n.gc(3,null,["",""]))],(function(e,t){var i=t.component,n=e(t,2,0,i.teamsDeepLink&&i.activityDeepLinkHovered);e(t,1,0,n)}),(function(e,t){e(t,3,0,t.component.inTeams)}))}function E(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,7,"div",[["class","activity-description__date"]],[[8,"title",0]],null,null,null,null)),n.Gb(1,278528,null,0,u.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"activity-description__title--clipped":0,"activity-description__date--fluent ms-fcl-npa":1}),(e()(),n.gc(3,null,[" "," "])),(e()(),n.qb(16777216,null,null,1,null,_)),n.Gb(5,16384,null,0,u.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,P)),n.Gb(7,16384,null,0,u.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,!!i.title,i.fluentRefresh);e(t,1,0,"activity-description__date",n),e(t,5,0,i.teamsDeepLink),e(t,7,0,i.teamsDeepLink)}),(function(e,t){var i=t.component;e(t,0,0,n.Ob(1,"",i.secondLine,"")),e(t,3,0,i.secondLine)}))}function F(e){return n.jc(0,[(e()(),n.Hb(0,0,[[1,0],["descriptionElement",1]],null,7,"span",[["class","activity-description ms-fcl-ns"]],null,null,null,null,null)),n.Gb(1,278528,null,0,u.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"activity-description--clipped":0,"activity-description--card":1,"activity-description--card--fluent":2,"activity-description--mobile":3,"activity-description--motion-padding":4,"ms-fcl-ns":5,"ms-fcl-nd":6}),(e()(),n.Hb(3,0,null,null,2,"span",[],[[8,"innerHTML",1],[8,"title",0]],[[null,"mouseenter"]],(function(e,t,i){var n=!0;return"mouseenter"===t&&(n=!1!==e.component.onHover()&&n),n}),null,null)),n.Gb(4,278528,null,0,u.i,[n.x,n.y,n.o,n.K],{ngClass:[0,"ngClass"]},null),n.Zb(5,{"activity-deep-link ms-fcl-tp":0,"list-item__text--large activity-description__title--clipped ms-fcl-ns":1,"activity-description--large":2}),(e()(),n.qb(16777216,null,null,1,null,E)),n.Gb(7,16384,null,0,u.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.numLines,2===i.numLines&&!i.fluentRefresh,2===i.numLines&&i.fluentRefresh,i.mobileListItem&&2!==i.numLines,!!i.title,!i.fluentRefresh,i.fluentRefresh);e(t,1,0,"activity-description ms-fcl-ns",n);var r=e(t,5,0,i.activityDeepLink&&i.activityDeepLinkHovered,!!i.title,i.timestampAndTitleInSameLine);e(t,4,0,r),e(t,7,0,2===i.numLines)}),(function(e,t){var i=t.component;e(t,3,0,i.htmlDescription.html,n.Ob(1,"",null==i.htmlDescription||null==i.htmlDescription.activityDescription?null:i.htmlDescription.activityDescription.plainText,""))}))}function O(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,null,null,null,null,null,null,null)),n.Vb(null,0),(e()(),n.qb(0,null,null,0))],null,null)}function D(e){return n.jc(0,[n.cc(671088640,1,{descriptionElement:0}),(e()(),n.Hb(1,0,null,null,8,"div",[],[[24,"@fadeIn",0],[8,"id",0]],[[null,"mouseover"],[null,"mouseleave"]],(function(e,t,i){var n=!0,r=e.component;return"mouseover"===t&&(n=!1!==r.activityHovered()&&n),"mouseleave"===t&&(n=!1!==r.activityUnhovered()&&n),n}),null,null)),n.Gb(2,278528,null,0,u.i,[n.x,n.y,n.o,n.K],{ngClass:[0,"ngClass"]},null),n.Zb(3,{"activity-description__container":0,"activity-description__container--mobile":1}),(e()(),n.qb(16777216,null,null,1,null,k)),n.Gb(5,16384,null,0,u.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,A)),n.Gb(7,16384,null,0,u.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,F)),n.Gb(9,16384,null,0,u.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,O)),n.Gb(11,16384,null,0,u.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,3,0,!i.iconOnly,i.mobileListItem);e(t,2,0,n),e(t,5,0,(null==i.htmlDescription?null:i.htmlDescription.icon)&&i.showIcon),e(t,7,0,!i.showIcon&&(null==i.person?null:i.person.email)),e(t,9,0,(null==i.htmlDescription?null:i.htmlDescription.html)&&!i.iconOnly),e(t,11,0,!i.htmlDescription)}),(function(e,t){var i=t.component;e(t,1,0,i.activityState,i.docId?i.getActivityElementId():null)}))}n.Db("ohp-activity-description",d.a,(function(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-activity-description",[],null,null,null,D,T)),n.Gb(1,5226496,null,0,d.a,[h.a,o.a,n.h,p.a,m.b,f.a,g.a,b.a,v.a,S.a,y.a,C.a,w.a,I.b],null,null)],(function(e,t){e(t,1,0)}),null)}),{activities:"activities",lastViewedTime:"lastViewedTime",iconOnly:"iconOnly",showIcon:"showIcon",person:"person",iconCssClass:"iconCssClass",iconSize:"iconSize",activityDeepLink:"activityDeepLink",title:"title",docId:"docId",activityDescriptionInput:"activityDescriptionInput",index:"index",fileType:"fileType",navId:"navId",numLines:"numLines",mobileListItem:"mobileListItem",teamsDeepLink:"teamsDeepLink",area:"area",useSolidIcon:"useSolidIcon",timestampAndTitleInSameLine:"timestampAndTitleInSameLine"},{},["*"])},EYcb:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("6UlS"),r=i("Mlb/");class a{constructor(){this._error=new n.a(null)}showErrorDialog(e){this._error.next(e)}get error(){return this._error.asObservable()}}a.ɵprov=r.kc({factory:function(){return new a},token:a,providedIn:"root"})},EqbI:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("hhzZ"),r=i("R7NL"),a=i("/I02"),o=i("kpuN"),s=i("wwmn"),l=i("v3sZ"),c=i("casz"),u=i("pOWU"),d=i("Mlb/"),h=i("vk2e");class p extends u.a{constructor(e,t,i,n,r,a,o,s){super(e,t,i,"OneNote",n,r,o,s),this.oneNoteConfigService=a,this.COPY_CLASS_NOTEBOOK="/notebooks/saveacopy",this.CLIENT_DEV_MODE_RESOURCE_URL="https://www.onenote.com",this.BASE_URL="/api",this.VERSION="1.0",this.newPageHtml="<!DOCTYPE html>\n    <html>\n      <head>\n        <title>{PAGETITLE}</title>\n      </head>\n      <body>\n      </body>\n    </html>",this.getClassNoteBookPromise=null,this.inMockMode=n.sharedContext.inMockMode}getClassNoteBooks(){const e={};return this.getClassNoteBookPromise||(this.getClassNoteBookPromise=new Promise(((t,i)=>{this.get("Get_ClassNotebooks_Request","Get_ClassNotebooks",this.oneNoteConfigService.config.oneNoteApiPath+this.BASE_URL+"/v"+this.VERSION+"/me/notes/classnotebooks?hasaccessto=true&orderby=lastModifiedTime desc",(e=>{e.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((e=>{t(e.data.value)}))}),(e=>{this.getClassNoteBookPromise=null,i(e)}),e,"network-only")}))),this.getClassNoteBookPromise}generateSaveCopyClassNotebookLink(e,t,i){const n=this.inMockMode?this.CLIENT_DEV_MODE_RESOURCE_URL:this.oneNoteConfigService.config.oneNoteApiPath,r=e.indexOf("-"),a=e.substring(0,r),o=e.substring(r+1).toLowerCase();return`${n}${this.COPY_CLASS_NOTEBOOK}/?notebookId=${a}|{${o}}&notebookName=${t}&notebookUrl=${i}`}getNotebookSections(e,t,i){const n=`/myOrganization/siteCollections/${e}/sites/${t}/notes/notebooks/1-${i}/sections`,r={};return new Promise(((a,o)=>{this.get("Get_OneNote_Sections_Request","Get_OneNote_Sections",this.oneNoteConfigService.config.oneNoteApiPath+this.BASE_URL+"/v"+this.VERSION+n,(n=>{n.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((n=>{const r=(n&&n.data&&n.data.value||[]).map((n=>({name:n.name,siteId:e,webId:t,listItemUniqueId:i,sectionId:n.id,key:n.id})));a(r)}))}),(e=>{o(e)}),r,"network-only")}))}createPageInSection(e,t,i,n){const r={headers:new Map};r.headers.set("Content-Type","text/html");const a=`/myOrganization/siteCollections/${e}/sites/${t}/notes/sections/${i}/pages`;return new Promise(((e,t)=>{this.post("Get_OneNote_Page_Request","Get_OneNote_Page",this.oneNoteConfigService.config.oneNoteApiPath+this.BASE_URL+"/v"+this.VERSION+a,this.newPageHtml.replace("{PAGETITLE}",n),(i=>{i.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((i=>{const n=i.data;n&&n.links&&n.links.oneNoteWebUrl.href?e(n.links.oneNoteWebUrl.href):t("error parsing response")})).catch((e=>{t(e)}))}),(e=>{e&&e.httpResponse?t(e.httpResponse.data?{error:{code:`${e.httpResponse.status}`,data:`${e.httpResponse.data}`}}:{error:{code:`${e.httpResponse.status}`}}):t()}),r)}))}getRequestIdFromResponse(e){return e.headers.get("X-CorrelationId")}}p.ɵprov=d.kc({factory:function(){return new p(d.lc(o.a),d.lc(n.a),d.lc(r.a),d.lc(a.a),d.lc(s.a),d.lc(l.a),d.lc(h.q),d.lc(c.a))},token:p,providedIn:"root"})},Eu1D:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.Unknown=0]="Unknown",e[e.Disabled=1]="Disabled",e[e.Loading=2]="Loading",e[e.Displayed=3]="Displayed",e[e.Failed=4]="Failed"}(n||(n={}))},EuUe:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},Eup2:function(e,t,i){"use strict";i.d(t,"a",(function(){return C}));var n=i("Mlb/"),r=i("CMIS"),a=i("laSs"),o=i("lUkk"),s=i("Dn7E"),l=i("70cc"),c=i("O6Zd"),u=i("WKA6"),d=i("DCBR"),h=(i("lrJm"),i("vcPZ")),p=(i("SPVw"),i("kaEK")),m=i("0ZeC"),f=(i("dOgD"),i("CC5A")),g=i("hhzZ"),b=(i("Vwd8"),i("BaAg")),v=i("Eu1D"),S=(i("QOOv"),i("JT1q")),y=(i("7wk3"),i("AXqk"),i("W3Zz"));i("hZW2"),i("7Gwk"),i("U8M1"),i("rBEp"),i("Uqr9"),i("xoWf"),i("BMb5"),i("4/We"),i("cgnd"),i("/I02"),i("PBJH"),i("RJiy"),i("gO/A");class C extends d.a{constructor(e,t,i,r,a,o,s,l,c,u,d,h,p,m,f,g,b,v,S,y,C,w,I){super(e,t,d,p,m,h),this.capabilitiesService=e,this.changeDetector=t,this.recommendedService=i,this.contextService=r,this.floodgateService=a,this.globalErrorHandler=o,this.performanceService=s,this.jumpListService=l,this.browserPaintMeasurementService=c,this.mruConfigService=u,this.deviceDetector=d,this.locService=h,this.instrumentationService=m,this.dataSecurityService=f,this.eventService=g,this.userDataStorageService=b,this.featureCalloutService=v,this.userProfileService=S,this.officeFeedService=y,this.clientStartupContextService=C,this.windowService=w,this.visualService=I,this.currentCarouselPage=0,this.translateX="0",this.stateChanged=new n.q}ngOnInit(){this.sharedInit();const e=this.capabilitiesService.capabilities;this.stateChanged.emit({state:v.a.Loading}),this.mruConfig=this.mruConfigService.config,this.fluentRefresh=e.fluentRefresh,this.canSwipeRecommended=this.deviceDetector.isMobileDevice(),this.visibleCardPeek=this.fluentRefresh?0:40,this.appFilter=this.fileType?new Set([this.fileType]):null,this.fileType&&this.fileType===b.b.Stream&&(this.appFilter.add(b.b.Video),this.appFilter.add(b.b.PlayList)),this.isOfficeFeed=(this.mruConfig.officeFeedControlEnabled||this.mruConfig.officeFeedFlightEnabled)&&!this.isStartPage,this.listId=this.isOfficeFeed?C.officeFeedListId:C.recommendedListId,this.recommendedEnabled=this.mruConfig.recommendedEnabled&&this.fileType!==b.b.Sway&&this.fileType!==b.b.OneNote&&this.fileType!==b.b.Forms&&(this.fileType!==b.b.Visio||this.mruConfig.recommendedVisioEnabled),this.showAnalytics=this.mruConfig.analyticsEnabled&&this.fileType===b.b.Sway,this.showActivity=!this.showAnalytics&&this.mruConfig.activityEnabled&&this.fileType!==b.b.OneNote,this.showSharing=!this.showAnalytics&&this.mruConfig.sharingStatusEnabled,this.componentArea=this.isSuggestedActions?g.b.SuggestedActions:g.b.Recommended,this.recommendedMotion=this.mruConfig.recommendedMotionEnabled&&!this.canSwipeRecommended&&this.deviceDetector.deviceInfo.browser.browserType!==y.a.Safari,this.recommendedDocView=this.isSuggestedActions?"SuggestedAction":"Card";const t=e=>{this.eventService.broadcastEvent({name:"recommendedReady",args:[e]})};if(this.recommendedTitle=this.isSuggestedActions?this.locService.RecommendedActionsSectionTitle:this.locService.RecommendedDocumentsSectionTitle,this.recommendedEnabled){let e;this.isOfficeFeed?(e=this.officeFeedService.getOfficeFeed(),this.officefeedBounce=this.eventService.events.withScope(1).pipe(Object(l.a)((e=>"appTileClick"===e.name)),Object(c.a)((e=>e.args[0]))).subscribe((e=>{if(this.cards){const t=Math.min(this.currentCarouselPage+this.cardIncrement-1,this.cards.length-1),i=this.cards[t];i&&this.officeFeedService.logInstrumentation([i.feedbackId],["bounce"],[i.fromCache?"cache":"service"],[e])}}))):e=this.recommendedService.getRecommendedDocs(this.appFilter),e?(this.recommendedStream=e.results.subscribe((e=>this.processRecommendedTask(e))),e.results.pipe(Object(u.a)(1)).toPromise().then((e=>t(e.items.length))),e.initialCompletion.then((e=>{e&&(this.globalErrorHandler.handleCacheObservableError(e,"tCyIn","jtlYX"),this.stateChanged.emit({state:v.a.Failed}),t(0),e.cacheError&&e.networkError&&(this.eventService.broadcastEvent({name:"recommendedFailed",args:[]}),Object(r.a)({eventName:"Recommended_Error",area:this.componentArea})))}))):t(0)}else t(0);this.capabilitiesService.capabilities.visualBackgroundEnabled&&(this.visualRefreshSubscription=this.visualService.visualConfigSubscription.subscribe((e=>{e.visualBackgroundEnabled!==this.isVisualRefresh&&(this.isVisualRefresh=e.visualBackgroundEnabled)})))}onScrollFocus(e){(e?this.recommendedNavLeft:this.recommendedNavRight).nativeElement.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})}ngAfterViewChecked(){this.recommendedEnabled&&this.mruConfig.recommendedCalloutEnabled&&!this.recommendedCalloutPromise&&void 0!==this.carouselElement&&this.cards&&this.cards.length>0&&(this.recommendedCalloutPromise=this.userProfileService.doesMetricExist("Recommended_Callout_Impression",!0),this.recommendedCalloutPromise.then((e=>{e||this.userDataStorageService.get("SawRecommended",1).then((e=>{if(e)this.userProfileService.incrementMetric("Recommended_Callout_Impression");else{const e=this.documentService.nativeDocument.querySelector(".list-header__title--card-carousel");this.featureCalloutService.addCallout(new h.a(e,"Recommended",g.b.Documents,this.locService.RecommendedDocumentsCalloutTitle,this.locService.RecommendedDocumentsCalloutSubtitle,null,null,null,!1,!1,!0)),this.instrumentationService.logImpressionEvent("Recommended_Callout_Impression",{},["Recommended_Callout_Impression"]),Object(a.a)({eventName:"Recommended_Callout",area:"Recommended"})}}))})))}ngOnDestroy(){var e;this.recommendedStream&&this.recommendedStream.unsubscribe(),this.officefeedBounce&&this.officefeedBounce.unsubscribe(),null===(e=this.visualRefreshSubscription)||void 0===e||e.unsubscribe()}recommendedMotionDone(){this.recommendedMotion&&(this.motionState="",this.checkCorrectTranslation())}navigateCards(e){if(super.navigateCards(e)){if(this.isOfficeFeed){const e=this.cards.slice(this.currentCarouselPage,this.currentCarouselPage+this.cardIncrement);this.logOfficeFeedGeneralViews(e),this.loggedFirstScroll&&this.loggedLimitScroll||this.logOfficeFeedScroll()}if(this.recommendedMotion){const t=Math.min(this.currentCarouselPage+this.cardIncrement+1,this.cards.length-1);t>this.recommendedMotionList.length&&this.recommendedMotionList.push(...this.cards.slice(this.recommendedMotionList.length,t+1)),this.setRightOffset(),this.translateX=this.fluentRefresh?`translateX(${100*-e}%)`:`translateX(${100*-e}%) translateX(${e*(this.cardMargin+this.visibleCardPeek)}px)`,this.motionState="moving"}return this.statusAnnouncement="",this.changeDetector.detectChanges(),this.statusAnnouncement=-1===e?this.locService.RecommendedScrollPreviousAriaAnnouncement:this.locService.RecommendedScrollNextAriaAnnouncement,this.logRecommendedImpression(this.cards[this.currentCarouselPage].fromCache),!0}return!1}updateCarouselCardData(){if(super.updateCarouselCardData(this.recommendedMotion?this.visibleCardPeek:0),this.recommendedMotion&&this.checkCorrectTranslation(),this.canSwipeRecommended){const e=this.virtualCards&&this.virtualCards.first&&this.virtualCards.first.nativeElement?this.virtualCards.first.nativeElement.clientWidth:null;e&&this.eventService.broadcastEvent({name:"recommendedCardSize",args:[e,501.77>this.windowService.nativeWindow.innerWidth?2:766.98>this.windowService.nativeWindow.innerWidth?3:4]})}}onDeleteRecommendedItem(e){var t;const i=this.cards.indexOf(e.item);i>-1&&(this.cards.splice(i,1),this.currentCarouselPage>=this.cards.length&&(this.currentCarouselPage=Math.max(0,this.currentCarouselPage-this.cardIncrement)),this.recommendedMotion&&(this.recommendedMotionList=this.cards.slice(0,this.currentCarouselPage+this.cardIncrement+1))),this.isOfficeFeed?"myAnalyticsInsight"!==e.item.mruV2Category?this.officeFeedService.logInstrumentation([e.item.feedbackId],["neverShowAgain"],[e.item.fromCache?"cache":"service"]):this.officeFeedService.performAction(e.item.feedbackId,m.a.DismissAction,null===(t=e.item.potentialAction.filter((e=>e.name===m.a.DismissAction))[0])||void 0===t?void 0:t.actionPayload):this.recommendedService.removeDocument(e.item.spoId),this.cards.length>0&&this.logRecommendedImpression(this.cards[this.currentCarouselPage].fromCache),this.statusAnnouncement="",this.changeDetector.detectChanges(),this.statusAnnouncement=this.locService.RemoveDocumentAriaTitle}logNavClick(e){const t={};t.Index=this.currentCarouselPage.toString(),t.Increment=this.cardIncrement.toString(),t.TotalSize=this.cards.length.toString(),t.ItemCategory=this.listId,t.ImpressionId=this.impressionId;const i=e<0?"NavPrevious":"NavNext";this.instrumentationService.logClickEvent("Recommended_Nav_Click",i,this.componentArea,null,null,t),Object(o.a)({id:i,eventName:"Recommended_Nav_Click",result:"Navigate",target:"Recommended",area:this.componentArea}),Object(s.a)({featureName:"Recommended",eventName:"Recommended_Nav_Click",params:t,area:this.componentArea})}checkCorrectTranslation(){this.setRightOffset(),this.carouselElement.nativeElement.style.cssText=`${this.contextService.isRtl?"left":"right"}: ${this.calcTranslateX}`}setRightOffset(){if(this.cardIncrement){const e=this.currentCarouselPage/this.cardIncrement,t=Math.round(1e4*e)/100;this.calcTranslateX=this.fluentRefresh?`calc(${t}% + ${20*e}px)`:`calc(${t}% - ${this.visibleCardPeek*e}px)`}}processRecommendedTask(e){if(!e.items)return;this.impressionId=e.impressionId;const t=e.items.map(this.isOfficeFeed?(t,i)=>Object(S.d)(t,`mru_item_${i}`,e.impressionId,this.contextService.isRtl,this.clientStartupContextService.config.authType,e.fromCache):(t,i)=>Object(S.f)(t,`mru_item_${i}`,e.impressionId,this.contextService.isRtl,this.clientStartupContextService.config.authType,e.fromCache));if(this.cards&&this.copyInflationData(this.cards,t),this.cards=t,this.stateChanged.emit({state:v.a.Displayed}),this.performanceService.mark(e.fromCache?"Cached_Recommended_Ready":"Recommended_Ready"),this.browserPaintMeasurementService.recordWhenPainted("Recommended"),this.cards.length>0){if(this.maxCardContainerWidths=[this.maxCardContainerWidth(1),this.maxCardContainerWidth(2),this.maxCardContainerWidth(3),this.maxCardContainerWidth(4)],this.cardIncrement=this.getNumCards(this.recommendedMotion?this.visibleCardPeek:0),this.recommendedMotion&&(this.recommendedMotionList=this.cards.slice(0,Math.max(this.currentCarouselPage+this.cardIncrement,this.maxCardsPerLine)+1)),this.logRecommendedImpression(e.fromCache),this.isOfficeFeed){const e=this.cards.slice(0,this.cardIncrement);this.logOfficeFeedGeneralViews(e)}this.capabilitiesService.capabilities.recommendedFloodgate&&this.capabilitiesService.capabilities.showFloodgate&&this.floodgateService.recordFloodgate(["RecommendedImpressionGeneral"])}this.appFilter&&0!==this.appFilter.size||this.jumpListService.registerRecommendedJumpList(this.cards)}logOfficeFeedGeneralViews(e){const t=e.map((e=>e.feedbackId)),i=e.map((()=>"view")),n=e.map((e=>e.fromCache?"cache":"service"));this.officeFeedService.logInstrumentation(t,i,n)}logOfficeFeedScroll(){const e=[],t=[],i=[];if(this.loggedFirstScroll){if(this.currentCarouselPage+this.cardIncrement>=this.cards.length&&!this.loggedLimitScroll){const n=Math.min(this.currentCarouselPage+this.cardIncrement-1,this.cards.length-1);e.push(this.cards[n].feedbackId),t.push("scrollLimit"),i.push(this.cards[n].fromCache?"cache":"service"),this.loggedLimitScroll=!0}}else{const n=this.cards[this.currentCarouselPage-1];e.push(n.feedbackId),t.push("scrollStart"),i.push(n.fromCache?"cache":"service"),this.loggedFirstScroll=!0}t.length>0&&e.length>0&&i.length>0&&this.officeFeedService.logInstrumentation(e,t,i)}copyInflationData(e,t){for(const i of t){let t=null;e.some((e=>e.documentUrl===i.documentUrl&&(t=e,!0)))&&i.copyInflationData(t,this.mruConfig.mruActivityEnabled)}}logRecommendedImpression(e){const t=this.cards,i=t.slice(this.currentCarouselPage,Math.min(this.currentCarouselPage+this.cardIncrement,this.cards.length)),n=!i||this.dataSecurityService.securityLevel>=2?i:i.filter((e=>!e.isLocal)),r=b.a.distributionFromFileItems(n),o={};if(o.RenderSize=(n?n.length:0).toString(),o.Distribution=r,o.ElementId=this.listId,o.TotalSize=this.getNumLoggableItems(t).toString(),o.State="Card",o.TabState=f.a[f.a.Loaded],o.ImpressionId=this.impressionId,o.FromServiceWorkerCache=(!!e).toString(),o.Area=this.componentArea,this.capabilitiesService.capabilities.suggestedActionsEnabled&&(o.SuggestedActionsDistribution=this.getSuggestedActionsDistribution(this.cards)),void 0!==this.currentCarouselPage&&(o.Index=this.currentCarouselPage.toString()),void 0!==this.cardIncrement&&(o.Increment=this.cardIncrement.toString()),t.length>0){const e=t[0].timeSinceLastOpenInSeconds();null!==e&&(o.InactivityDuration=e.toString())}this.instrumentationService.logImpressionEvent("Recommended_Impression",o),Object(a.a)({eventName:"Recommended",area:"Recommended"})}getNumLoggableItems(e){return e?this.dataSecurityService.securityLevel>=2?e.length:e.filter((e=>!e.isLocal)).length:0}getSuggestedActionsDistribution(e){return e?e.reduce(((e,t,i)=>e+(0===i?"":";")+this.suggestedActionType(t)),""):""}suggestedActionType(e){switch(e.activity.reasonType){case p.a.MyAnalytics:return"add_todo";case p.a.Task:return"view_task";case p.a.Comment:case p.a.Mention:return"reply";case p.a.Edit:case p.a.Trending:return"view_changes";case p.a.Meeting:return"join_meeting";default:return"open_in_browser"}}}C.recommendedListId="recommended-mru",C.officeFeedListId="officefeed-mru"},"ExL+":function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("hhzZ"),r=i("R7NL"),a=i("BaAg"),o=i("/I02"),s=i("idgT"),l=i("kpuN"),c=i("dQLD"),u=i("wwmn"),d=i("casz"),h=i("hoyd"),p=i("pOWU"),m=i("Mlb/"),f=i("vk2e");class g extends p.a{constructor(e,t,i,n,r,a,o,s,l,c){super(e,t,i,"OfficeHome",n,r,a,o),this.odspConfigService=s,this.templatesConfigService=l,this.workloadsService=c,this.requestConfig={headers:new Map([["Accept","application/json"]])}}getOdspProvisioningStatus(e,t){if(this.getOdspProvisioningStatusCache)return this.getOdspProvisioningStatusCache;const i=new Promise(((i,n)=>{this.get("ODSP_Provisioning_Status","ODSP_Provisioning_Status",this.contextService.sharedContext.officeHomeApiRoot+this.odspConfigService.config.odspProvisioningStatusApiPath,(e=>{e.then((e=>{e.data.SharepointUrl||e.data.OneDriveUrl||(this.getOdspProvisioningStatusCache=null),i(e.data)}))}),(e=>{this.getOdspProvisioningStatusCache=null,n(e)}),this.requestConfig,"network-only",void 0,void 0,t,void 0,void 0,e)}));return this.getOdspProvisioningStatusCache=i,i}getLicenseStatus(e,t,i,n){if(this.getLicenseStatusCache)return this.getLicenseStatusCache;const r=new Promise(((r,o)=>{const s=this.templatesConfigService.resources(a.b.Visio);this.get("Visio_License_Status","Visio_License_Status",this.contextService.sharedContext.officeHomeApiRoot+s.LicenseStatusApiPath+`?app=${e}&scenarioId=${t}`,(e=>{e.then((e=>{e.data.App||e.data.IsLicensed||(this.getLicenseStatusCache=null),r(e.data)}))}),(e=>{this.getLicenseStatusCache=null,o(e)}),this.requestConfig,"network-only",void 0,void 0,n,void 0,void 0,i)}));return this.getLicenseStatusCache=r,r}checkInAppNavEnabled(e){return new Promise((t=>{this.workloadsService.getWorkloads().then((i=>{if(e){const n=i.find((t=>t.FileType===e));t(n&&n.InAppNav)}else{const e=i.find((e=>e.FileType===a.b.SharePoint)),n=i.find((e=>e.FileType===a.b.OneDrive));t(e&&e.InAppNav||n&&n.InAppNav)}}))}))}initializeProvisioningStatus(){this.checkInAppNavEnabled().then((e=>{e&&this.getOdspProvisioningStatus()}))}handleQueryParam(e,t){"mockshellservicemode"===e&&this.mockRequestHeader&&this.requestConfig.headers.set(this.mockRequestHeader,t)}}g.ɵprov=m.kc({factory:function(){return new g(m.lc(l.a),m.lc(n.a),m.lc(r.a),m.lc(o.a),m.lc(u.a),m.lc(f.q),m.lc(d.a),m.lc(c.a),m.lc(s.a),m.lc(h.a))},token:g,providedIn:"root"})},FHrx:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("dFxn"),r=i("Mlb/");class a{constructor(e){this.configParserService=e,this.config=this.configParserService.parse("serviceWorkerEncryptionConfig")||{cryptoKey:null,digestSaltBase64:null}}}a.ɵprov=r.kc({factory:function(){return new a(r.lc(n.a))},token:a,providedIn:"root"})},FZB6:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("6ib3"),r=i("dy1P"),a=i("rTyw"),o=i("Tqea");function s(e){switch(e){case n.a.Word:return r.a.WordOnline;case n.a.Excel:return r.a.ExcelOnline;case n.a.PowerPoint:return r.a.PowerPointOnline;case n.a.OneNote:return r.a.OneNoteOnline;case n.a.Sway:return r.a.Sway;case n.a.Visio:return r.a.VisioOnline;case n.a.Project:case n.a.ProjectOperations:case n.a.Portfolio:return r.a.Project;case n.a.PowerBI:return r.a.PowerBI;default:return Object(a.a)(Object(o.a)(e))}}},"Ft/N":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n="X-SW-OHP-FetchStrategy"},GMuP:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("TfV2"),r=i("ZBSS"),a=i("uqr+"),o=i("9KSV"),s=i("dSKW"),l=i("uV9m");function c(e,t){void 0===t&&(t=n.a.Security),Object(l.e)("Diagnostic",function(e){var t,i,n={};for(var c in e.params)n[Object(a.a)([r.p,c])]="string"==typeof e[c]?Object(o.a)(e.params[c]):e.params[c];if(n[r.y]="Diagnostic",n[r.z]=e.eventName,Object(l.c)()){var u=Object(s.a)(Object(l.a)());n[Object(a.a)([r.p,r.V])]=u,n[Object(a.a)([r.p,r.W])]=Object(s.c)(u),n[Object(a.a)([r.p,r.U])]=Object(s.b)(u)}return n[Object(a.a)([r.p,r.j])]=null!==(t=e.area)&&void 0!==t?t:"",n[Object(a.a)([r.p,r.fb])]=null!==(i=e.subArea)&&void 0!==i?i:"",n}(e),t)}},GPFm:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},GmnP:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("Dn7E"),r=i("CMIS"),a=i("lUkk"),o=i("laSs"),s=i("hhzZ"),l=i("Uqr9"),c=i("Mlb/");class u{constructor(e,t){this.instrumentationService=e,this.performanceService=t,this.performanceMarker=new Map}ngOnDestroy(){this.fluidCorrelationId=void 0}setCorrelationId(e){this.fluidCorrelationId=e}instrumentStart(e){const t={State:"Start"};this.instrumentationService.logGenericEvent(e,this.getInstrumentationParams(t)),Object(n.a)({featureName:"Fluid",eventName:e,params:t})}instrumentError(e,t,i){const n=i?JSON.stringify(i):"",a=this.getInstrumentationParams({Error:n});this.instrumentationService.logErrorEvent(e,a),Object(r.a)({errorType:"Fluid_Error",eventName:t,message:n,debugInfo:`FluidResource: ${a.ResourceId}`})}instrumentBootError(e,t){this.instrumentFailure("Load"===e?"FluidContent_Open":"FluidContent_CreateNew",t)}instrumentSuccess(e,t=!1,i,r){const a={State:"Success"};a.VersionHistory=t.toString(),i&&(a.DebugInfo=i),r&&(a.Consumer=r),this.instrumentationService.logGenericEvent(e,this.getInstrumentationParams(a)),Object(n.a)({featureName:"Fluid",eventName:e,params:a})}instrumentFailure(e,t,i=!1,r){const a={State:"Fail"};a.Error=t?JSON.stringify(t):"",a.VersionHistory=i?"true":"false",r&&(a.Consumer=r),this.instrumentationService.logGenericEvent(e,this.getInstrumentationParams(a)),Object(n.a)({featureName:"Fluid",eventName:e,params:a})}logPerformanceEventFromClick(e,t){var i;const{clickTimeMarker:n,instrumentationParams:r}=null!==(i=this.performanceMarker.get(e))&&void 0!==i?i:{clickTimeMarker:1,instrumentationParams:{ResourceId:this.fluidCorrelationId}};this.performanceService.mark(`${t}.${e}`,n,void 0,r)}logPerformanceBootStart(e){const t={ResourceId:this.fluidCorrelationId},i=this.performanceService.mark(`FluidContentPerformanceMarker.DocumentLoadStart.${e}`,0,void 0,t);this.performanceMarker.set(e,{clickTimeMarker:i,instrumentationParams:t})}instrumentClickEvent(e,t,i){this.instrumentationService.logClickEvent(e,t,i),Object(a.a)({id:t,eventName:e,area:i,result:"Navigate",target:"Other"})}instrumentImpressionEvent(e,t,i,n){this.instrumentationService.logImpressionEvent(e,this.getInstrumentationParams(n)),Object(o.a)({eventName:t,id:this.fluidCorrelationId,area:i})}getInstrumentationParams(e={}){return Object.assign({ResourceId:this.fluidCorrelationId},e)}}u.ɵprov=c.kc({factory:function(){return new u(c.lc(s.a),c.lc(l.b))},token:u,providedIn:"root"})},H2Bi:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r}));var n="office-start-simple-persistence",r="items"},H90i:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r})),i.d(t,"d",(function(){return a})),i.d(t,"c",(function(){return o}));const n="OfficeDotCom",r="OfficeDotComPrv";var a,o;!function(e){e.Home="MAIN",e.Start="START",e.Content="CONTENT",e.Templates="TEMPLATES",e.Search="SEARCH"}(a||(a={})),function(e){e.Web="WEB",e.HWA="HWA",e.PWA="PWA",e.NTP="NTP",e.Embed="EMBED"}(o||(o={}))},HQCr:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("rTyw"),r=i("lUkk");function a(e,t,i,a,o,s){var l=i?Object(n.a)(i):"";Object(r.a)({id:e,area:t,subArea:a||"Other",result:i?"Refer":"Navigate",target:l||"Other",type:o||"Click",targetId:l,eventName:s||""})}},HZp7:function(e,t,i){"use strict";i.d(t,"b",(function(){return c})),i.d(t,"a",(function(){return u}));var n,r,a=i("QjXU");function o(){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(e){switch(e.label){case 0:return[4,i.e(164).then(i.t.bind(null,"yfDh",7))];case 1:return[2,e.sent().default]}}))}))}function s(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e;return Object(a.__generator)(this,(function(t){switch(t.label){case 0:return n?[2,n]:"TextDecoder"in window?[2,n=new TextDecoder]:[4,o()];case 1:return e=t.sent(),[2,n=new e.TextDecoderLite]}}))}))}function l(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e;return Object(a.__generator)(this,(function(t){switch(t.label){case 0:return r?[2,r]:"TextEncoder"in window?[2,r=new TextEncoder]:[4,o()];case 1:return e=t.sent(),[2,r=new e.TextEncoderLite]}}))}))}function c(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){switch(t.label){case 0:return[4,l()];case 1:return[2,t.sent().encode(e)]}}))}))}function u(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){switch(t.label){case 0:return[4,s()];case 1:return[2,t.sent().decode(e)]}}))}))}},Hp80:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("70cc"),r=i("WKA6"),a=i("dFxn"),o=i("7Gwk"),s=i("uWZl"),l=i("4/We"),c=i("cgnd"),u=i("Mlb/");class d{constructor(e,t,i,n){this.capabilitiesService=e,this.configParserService=t,this.startupConfigService=i,this.eventService=n}getConfig(){if(!this.configPromise){if(this.startupConfigService.config.authType!==c.a.MSA)return Promise.reject();if(this.capabilitiesService.capabilities.isPwaInUwp)this.configPromise=Promise.resolve(this.configParserService.parse("workloadPublicData"));else{const e=this.eventService.events.withScope(0).pipe(Object(n.a)((e=>"primaryTokensLoaded"===e.name)),Object(r.a)(1)).toPromise(),t=s.a.fullPageReady();this.configPromise=Promise.race([e,t]).then((()=>this.configParserService.parse("workloadPublicData")))}}return this.configPromise}}d.ɵprov=u.kc({factory:function(){return new d(u.lc(l.a),u.lc(a.a),u.lc(c.b),u.lc(o.a))},token:d,providedIn:"root"})},IA5y:function(e,t,i){"use strict";i.d(t,"h",(function(){return a})),i.d(t,"e",(function(){return o})),i.d(t,"d",(function(){return s})),i.d(t,"g",(function(){return l})),i.d(t,"c",(function(){return c})),i.d(t,"j",(function(){return u})),i.d(t,"i",(function(){return d})),i.d(t,"f",(function(){return h})),i.d(t,"a",(function(){return p})),i.d(t,"b",(function(){return m}));var n=i("BaAg"),r=i("ksTh");function a(e){return e&&"EmailAttachment"===e.source}function o(e){switch(e){case n.b.Word:return"ms-word:ofe|u|";case n.b.Excel:return"ms-excel:ofv|ofc|u|";case n.b.Visio:return"ms-visio:ofe|u|";case n.b.PowerPoint:return"ms-powerpoint:ofe|u|";case n.b.OneNote:return"onenote:"}return null}function s(e){let t=n.b.None;return t="Custom"===e.type?n.b.ThirdParty:"Lists"===e.type?n.b.List:"Project"===e.type&&"ProjectOperations"===e.sub_type?n.b.ProjectOperations:e.extension?n.a.fileTypeFromExtension(e.extension):n.b[e.type]||n.b.None,t&&t!==n.b.None||(t=n.a.fileTypeNameToFileType(e.type)),t}function l(e){var t;return null===(t=e.user_relationship)||void 0===t?void 0:t.last_action_datetime}function c(e){var t;return null===(t=e.user_relationship)||void 0===t?void 0:t.last_access_datetime}function u(e){try{return e?new Date(e):null}catch(e){return null}}function d(e){if(e)return{last_access_datetime:u(e.last_access_datetime),last_modified_datetime:u(e.last_modified_datetime),last_shared_by_id:e.last_shared_by_id,last_shared_datetime:u(e.last_shared_datetime),save_for_later_datetime:u(e.save_for_later_datetime),last_shared_by_history:e.last_shared_by_history,last_shared_display_name:e.last_shared_display_name,last_action_datetime:u(e.last_action_datetime)}}function h(e){var t,i;if(!e||!e.headers)return"";const n=e.headers,a=n.get("X-CalculatedBETarget")||"",o=n.get("X-FEServer")||"",s=n.get(r.b);let l="";const c=null===(i=null===(t=e.data)||void 0===t?void 0:t.diagnostics_data)||void 0===i?void 0:i.extended_info;return c&&(l=`WorkingSetFilesPlugin:${c.WorkingSetFilesPlugin}, MruFilesPlugin:${c.MruFilesPlugin}, Version:${c.Version}`),`BE:${a}, FE:${o}|${l}, CID:${s}`}function p(e,t,i,n,a,o){return{headers:new Map([["X-AnchorMailbox",e],["X-Office-Application",t],["X-Office-Scenario",o],["X-RoutingParameter-SessionKey",i],["X-Ms-ClientAppId",n],[r.a,a]])}}function m(e){return{headers:new Map([[r.a,e]])}}},IAGz:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(){this.reset()}cancel(){this.cancelPromise()}onCancel(e){return this.promise.then(e)}reset(){this.promise=new Promise((e=>{this.cancelPromise=e}))}}},IBRu:function(e,t,i){"use strict";function n(){let e,t;return[new Promise(((i,n)=>{e=i,t=n})),e,t]}i.d(t,"a",(function(){return n}))},Ihso:function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"c",(function(){return a})),i.d(t,"b",(function(){return o}));var n=!1;function r(e){e&&cancelAnimationFrame(e)}function a(e){return n?void e():requestAnimationFrame((function(){n=!0,e(),Promise.resolve().then((function(){n=!1}))}))}function o(e){return a((function(){return setTimeout(e,0)}))}},JH4S:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("dFxn"),r=i("Mlb/");class a{constructor(e){this.user=e.parse("userContext")||{companyDisplayName:null,displayName:null,hasNoLicense:!1,isAdmin:!1,isEdu:!1,isEduFaculty:!1,isEduStudent:!1,isSmb:!1,isIw:!1,isDynamics:!1,isGcc:!1,isValid:!1,mruAvailable:!1,themed:!1,themeId:"Unknown",isFirstRelease:!1},this.user.mruAvailable=this.user.isValid&&!this.user.hasNoLicense}}a.ɵprov=r.kc({factory:function(){return new a(r.lc(n.a))},token:a,providedIn:"root"})},JScD:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("BaAg"),r=i("dFxn"),a=i("Mlb/");class o{constructor(e){this.config=e.parse("uploadConfig"),this.config&&(this.config.uploadFileTypes=new Set([n.b.Excel,n.b.Word,n.b.PowerPoint,n.b.Visio,n.b.Stream]),this.config.editableFileTypes=new Set([n.b.Excel,n.b.Word,n.b.PowerPoint]))}}o.ɵprov=a.kc({factory:function(){return new o(a.lc(r.a))},token:o,providedIn:"root"})},JT1q:function(e,t,i){"use strict";i.d(t,"e",(function(){return l})),i.d(t,"f",(function(){return c})),i.d(t,"d",(function(){return u})),i.d(t,"c",(function(){return d})),i.d(t,"b",(function(){return h})),i.d(t,"a",(function(){return p})),i.d(t,"g",(function(){return m})),i.d(t,"h",(function(){return f}));var n=i("BaAg"),r=i("lwM0"),a=i("4ach"),o=i("fKR7");function s(e){if(e){const t=r.a.decodeUrl(e);if(t){const e=t.split("://");if(e.length>1){const t=e[1].split("/");return t.pop(),t}}}return[]}function l(e,t,i,r,s,l,c){let u,d,h,p,m;const f=e.MetaData,g=n.a.fileTypeNameToFileType(e.FileType);if(f){f.SPListId&&f.SPListItemUniqueId&&f.SPSiteId&&f.SPSiteUrl&&f.SPWebId&&(u={listId:f.SPListId,listItemId:null,listItemUniqueId:f.SPListItemUniqueId,siteId:f.SPSiteId,siteUrl:f.SPSiteUrl,webId:f.SPWebId}),f.CreatedDate&&(d=new Date(f.CreatedDate)),f.DriveId&&(h=f.DriveId);const e=f.SwayMetaData;e&&(p=e.ThumbnailId,m=e.IsTransformedFromWord?r.SwayTransformedFromWord:null)}const b=e&&e.MetaData&&g===n.b.Forms?e.MetaData.FormsMetaData:null,v=new o.b(o.a.Recent,t,i,e.DocId||e.ServerDocId,h||e.DriveId,e.FileName,e.Title,e.Url,e.WebUrl,null,null,e.LastAccessedTime,null,g,0,n.a.NameToProvenance[e.Provenance],e.PathArray,s,l,c,e.Application,e.ResourceId,e.StorageHost,e.UrlAlreadyEncoded,e.IsPinned,null,g===n.b.PowerBI?e.MetaData.PowerBIMetaData.breadcrumb_url:null,e.Category,e.MruV2Type,e.MruId,e.Activity,!1,e.IsLocal,d,u,void 0!==e.Sharing?{shared:!!e.Sharing}:void 0,e.LifecycleInfo,null,null,null,null,{thumbnailId:p},m,null,!1,e.ServiceId,null,null,e.FeedbackId,e.ServerDocId,b?b.owner_name:e&&e.MetaData?e.MetaData.CreatedByUserName:null,null,e.Extension?a.b.getExtensionToFormType(e.Extension):b&&b.owner_type?a.b.getOwnerPrincipalTypeToFormType(b.owner_type):null,b?b.owner_id:null,b?b.owner_tenant_id:null,null,null,null,null,null,null,null,null,null,null,null,null,null,b?b.form_type:null,b?b.category:null);return v.metaData=b,v.extension=e.Extension,v}function c(e,t,i,r,a,l){let c;const u=e.SharepointInfo;u&&u.list_id&&u.list_item_unique_id&&u.site_id&&u.site_url&&u.web_id&&(c={listId:u.list_id,listItemId:null,listItemUniqueId:u.list_item_unique_id,siteId:u.site_id,siteUrl:u.site_url,webId:u.web_id});const d=new o.b(o.a.Recommended,t,i,e.DocId,e.DriveId,e.FileName,e.Title,e.Url,e.WebUrl,null,e.LastAccessedTime,e.LastAccessedTime,null,n.a.fileTypeNameToFileType(e.FileType),0,n.a.NameToProvenance[e.Provenance],e.IsEmailAttachment?[]:s(e.Url),r,a,l,e.Application,e.ResourceId,e.StorageHost,e.UrlAlreadyEncoded,e.IsPinned,null,null,e.Category,null,null,e.Activity,e.IsEmailAttachment,e.IsLocal,null,c,null,!1,e.EmailReference,null,null,null,null,null,e.SPOId,e.IsCollab,null,e.NavigationId,null,null,e.ServerDocId,null,e.TeamsDeepLink);return d.iconUrl=e.IconUrl,d.extension=e.Extension,d}function u(e,t,i,r,a,l,c=!1){let u;const d=e.SharepointInfo;let h;d&&(u={listId:d.list_id,listItemId:null,listItemUniqueId:d.list_item_unique_id,siteId:d.site_id,siteUrl:d.site_url,webId:d.web_id}),e.ThumbnailUrl&&(h={small:e.ThumbnailUrl,medium:e.ThumbnailUrl,large:e.ThumbnailUrl,recommendedThumbnail:e.ThumbnailUrl});const p=new o.b(c?o.a.Trending:function(e){let t=o.a.OfficeFeedDocument;switch(e.toLocaleLowerCase()){case"upcomingmeeting":t=o.a.UpcomingMeeting;break;case"newsarticle":t=o.a.News;break;case"streamsvideo":t=o.a.StreamsVideo;break;case"myanalyticsinsight":t=o.a.MyAnalytics}return t}(e.Category),t,i,e.DocId,e.DriveId,e.FileName,e.Title,e.Url,e.WebUrl,null,e.LastAccessedTime,e.LastAccessedTime,null,n.a.fileTypeNameToFileType(e.FileType),0,n.a.NameToProvenance[e.Provenance],e.PathArray||(e.IsEmailAttachment?[]:s(e.Url)),r,a,l,e.Application,e.ResourceId,e.StorageHost,e.UrlAlreadyEncoded,e.IsPinned,null,null,e.Category,null,null,e.Activity,e.IsEmailAttachment,!1,null,u,null,!1,e.EmailReference,null,null,null,null,null,e.SPOId,e.IsCollab,null,e.NavigationId,h,e.FeedbackId,e.ServerDocId,null,e.TeamsDeepLink,null,null,null,!1,!1,null,null,null,null,null,null,[],null,null,null,e.MediaDuration);return"upcomingmeeting"===e.Category.toLowerCase()?(p.startTime=e.MeetingStart,p.endTime=e.MeetingEnd,p.location=e.Location,p.attendees=e.Attendees,p.joinUrl=e.JoinUrl,p.organizer=e.Organizer,p.joinMeetingText=e.JoinMeetingText,p.isUpcomingMeetingAccepted=e.IsUpcomingMeetingAccepted,p.isTeamsMeeting=e.IsTeamsMeeting):"myanalyticsinsight"===e.Category.toLocaleLowerCase()&&(p.taskInsight=e.TaskInsight,p.potentialAction=e.PotentialAction,p.insightName=e.InsightName,p.insightDescription=e.InsightDescription,p.insightDescriptionPrefix=e.InsightDescriptionPrefix,p.activityUser=e.Actor,p.url=e.Url),p.iconUrl=e.IconUrl,p.extension=e.Extension,p}function d(e,t,i,r,a,l){return new o.b(o.a.NoteBook,t,i,e.id,null,e.displayName,e.displayName,e.links.oneNoteWebUrl.href,null,null,new Date(e.lastModifiedDateTime),null,null,n.b.OneNote,null,n.a.NameToProvenance[e.displayName],s(e.links.oneNoteWebUrl.href),r,a,l,n.a.fileTypeNameFromType(n.b.OneNote),null,null,!0,!1,{fullName:e.displayName,email:null},null,null,null,null,null,!1,!1,new Date(e.createdDateTime))}function h(e,t,i,r,a,s,l,c){return new o.b(l||o.a.Form,t,i,e.id,null,e.title,e.title,e.url,null,null,new Date(e.modifiedDate),null,new Date(e.dateTimeShared),n.b.Forms,0,null,null,r,a,s,n.b[n.b.Forms],null,null,!0,!1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,{thumbnailId:e.otherInfo&&e.otherInfo.Theme&&e.otherInfo.Theme.Name?e.otherInfo.Theme.Name:null,thumbnailUrl:e.background?e.background.resourceUrl:null,thumbnailFillColor:e.otherInfo?e.otherInfo.SecondaryCustomizedThemeColor:null},null,null,null,null,null,null,null,e.id,e.ownerDisplayName,null,c||e.ownerPrincipalType,e.ownerId,e.ownerTenantId,!!e.softDeleted,!1,null,null,null,null,null,null,null,null,null,null,null,e.type,e.category)}function p(e,t,i,r,a,l){return new o.b(o.a.ClassNoteBook,t,i,e.id,null,e.name,e.name,e.links.oneNoteWebUrl.href,null,null,new Date(e.lastModifiedTime),null,null,n.b.OneNote,null,n.a.NameToProvenance[e.name],s(e.links.oneNoteWebUrl.href),r,a,l,n.a.fileTypeNameFromType(n.b.OneNote),null,null,!0,!1,{fullName:e.lastModifiedBy,email:null},null,null,null,null,null,!1,!1,new Date(e.createdTime))}function m(e,t,i,r,a,l){let c;const u=e.SharepointIds;u&&u.ListId&&u.ListItemUniqueId&&u.SiteId&&u.SiteUrl&&u.WebId&&(c={listId:u.ListId,listItemId:null,listItemUniqueId:u.ListItemUniqueId,siteId:u.SiteId,siteUrl:u.SiteUrl,webId:u.WebId});const d=new Date(e.SharedDate),h=e.EmailReference&&1===e.EmailReference.AttachmentType;return new o.b(o.a.Shared,t,i,e.ItemId,e.DriveId,e.FileName,n.a.fileNameWithoutExtension(e.FileName),e.DocumentUrl,e.WebUrl,null,new Date(e.LastModifiedDate),null,d,n.a.fileTypeNameToFileType(e.Application),e.SharingType,n.a.NameToProvenance[e.FileName],h?[]:s(e.DocumentUrl),r,a,l,e.Application,e.ResourceId,e.StorageHost,!0,!1,null,null,null,null,null,null,!!e.EmailReference,!1,new Date(e.CreatedDate),c,null,void 0,e.EmailReference,e.SharedByUserName,e.SharedByUserEmail,null,null,null,null,null,null,null,null,null,e.ItemId,e.CreatedByUserName,null,e.OwnerType,e.OwnerId)}function f(e){return{DocId:e.docId,Extension:e.extension,FileName:e.fileName,Title:e.title,Url:e.documentUrl,WebUrl:e.webUrl,LastAccessedTime:e.lastViewedTime,FileType:e.fileTypeName,Provenance:e.provenanceName,PathArray:e.pathArray,IsPinned:e.isPinned,Application:e.application,ResourceId:e.resourceId,StorageHost:e.storageHost,Category:e.mruV2Category,MruV2Type:e.mruV2Type,MruId:e.mruV2Id,Activity:e.activity,DriveId:e.driveId,EmailReference:e.emailReference,IsEmailAttachment:e.isEmailAttachment,IsLocal:e.isLocal}}},JWB6:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("6UlS"),r=i("lrJm"),a=i("BMb5"),o=i("6cfW"),s=i("Mlb/"),l=i("511z");class c{constructor(e,t,i){if(this.hasServiceWorkerApi=e,this.windowService=t,this.globalErrorHandler=i,e){const e=t.nativeWindow.navigator.serviceWorker;e.controller?this.updateCurrentState("Controlled"):(this.updateCurrentState("SupportedNotControlled"),e.ready.then((()=>{e.controller&&this.updateCurrentState("Controlled")})).catch((e=>{this.updateCurrentState("Unsupported"),Object(o.a)(e)||i.handleError(e,"E5E2n")})))}else this.updateCurrentState("Unsupported")}get stateObservable(){return this.stateSubject.asObservable()}get currentState(){return this.currentServiceWorkerState}updateCurrentState(e){this.currentServiceWorkerState=e,this.stateSubject?this.stateSubject.next(e):this.stateSubject=new n.a(e),"Controlled"!==e&&"Unsupported"!==e||this.stateSubject.complete()}}c.ɵprov=s.kc({factory:function(){return new c(s.lc(l.a),s.lc(a.b),s.lc(r.b))},token:c,providedIn:"root"})},Jn4Q:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("QjXU"),r=i("lUkk"),a=i("Dn7E"),o=i("rTyw"),s=i("70cc"),l=i("kaEK"),c=i("Eup2"),u=(i("kfAr"),i("1Bt+"),i("A/um")),d=i("hhzZ"),h=i("BaAg"),p=i("jCfB"),m=i("fKR7"),f=(i("hZW2"),i("7Gwk"),i("AY/E"),i("TIi1"),i("EUVs"),i("BMb5"),i("4/We"),i("PBJH"),i("CVeG"));i("dx17");class g{constructor(e,t,i,n,r,a,o,s,l,c,u,h,p,m){this.activityDescriptionService=e,this.capabilitiesService=t,this.changeDetectorRef=i,this.documentService=n,this.domSanitizer=r,this.eventService=a,this.instrumentationService=o,this.locService=s,this.mruItemInflationService=l,this.peopleCardService=c,this.responsiveRelativeDatePipe=u,this.urlLauncherService=h,this.wacContentService=p,this.windowService=m,this.showIcon=!0,this.mobileListItem=!1,this.area=d.b.Recommended,this.useSolidIcon=!1,this.timestampAndTitleInSameLine=!1,this.activityDeepLinkHovered=!1}ngOnInit(){this.person=this.person,this.activityState=this.activities?"active":"inactive",this.iconSize=this.iconSize||16,this.shortDate=this.windowService.innerWidth<640,this.inTeams=this.locService.TimeSentInTeams,this.fluentRefresh=this.capabilitiesService.capabilities.fluentRefresh,this.locService.supportsLocaleSpecifiers&&(this.eventsSubscription=this.eventService.events.withScope(1).pipe(Object(s.a)((e=>"contentWidthChanged"===e.name))).subscribe((e=>{let t;[t]=e.args,this.shortDate=t<640,this.updateDescription()}))),this.updateDescription()}ngOnChanges(){this.updateDescription()}ngAfterViewInit(){this.softUpdatePeopleCards()}ngDoCheck(){this.softUpdatePeopleCards()}ngOnDestroy(){this.eventsSubscription&&this.eventsSubscription.unsubscribe(),this.removePeopleCards()}onHover(){this.updatePeopleCards()}activityHovered(){this.activityDeepLinkHovered=!0}activityUnhovered(){this.activityDeepLinkHovered=!1}clicked(e){if(!this.activityDeepLink&&!this.teamsDeepLink)return;e&&e.preventDefault();const t=this.activityDeepLink||this.teamsDeepLink;!this.teamsDeepLink&&this.capabilitiesService.capabilities.wacHostEnabled&&this.capabilitiesService.capabilities.wacHostApps.has(this.fileType)?(this.logClick(),this.wacContentService.bootstrapAndRoute({docUrl:t,fileType:this.fileType,wdOrigin:"",applicationUrlParams:{actnavid:this.navId}},{[p.a.Nav]:this.navId})):(this.urlLauncherService.openUrl(t,"RecommendedDeepLink"),this.logClick())}getActivityElementId(){return`${g.activitySectionId}-${this.docId}`}logClick(e=!1){const t={};t.ItemId=this.activityDeepLink?"activity-description":"teams-deep-link",t.Index=this.index.toString(),t.ItemCategory=c.a.recommendedListId,t.State=this.area===d.b.SuggestedActions?"SuggestedAction":"Card",t.ResourceId=this.docId,t.Area=this.area,t.DocumentType=h.b[this.fileType],t.ActivityDisplayed=this.activityReason?l.a[this.activityReason]:"",t.ClickDestination=e?"ContentPage":"ExternalPage";const i=m.b.referralFromFileType(this.fileType),n=this.area===d.b.SuggestedActions?"Suggested_Action_Click":"Recommended_Click";this.instrumentationService.logClickEvent(n,g.activitySectionId,this.area,i,"Web",t),Object(r.a)({id:g.activitySectionId,eventName:n,area:this.area,result:i?"Refer":"Navigate",target:i?Object(o.a)(i):"Other"}),Object(a.a)({featureName:"Recommended",eventName:n,params:t})}updateDescription(){const e=this.activityDescriptionInput||this.activityDescriptionService.activityDescription(this.activities,this.lastViewedTime,this.shortDate,2===this.numLines);let t=null;if(e&&(t=this.createDescription(e)),!t||this.htmlDescription&&t.html.toString()===this.htmlDescription.html.toString()?!t&&this.htmlDescription&&(this.removePeopleCards(),this.htmlDescription=null,this.dateString=null,this.activityState="inactive"):(this.removePeopleCards(),this.htmlDescription=t,this.dateString=this.getDateString(this.htmlDescription.activityDescription.timestamp),this.activityState="active",this.needPeopleCardUpdate=!0),this.secondLine=this.timestampAndTitleInSameLine?`${this.dateString} · ${this.title}`:this.title||this.dateString,this.capabilitiesService.capabilities.recommendedDeepLinkEnabled||this.capabilitiesService.capabilities.recommendedTeamsLinkEnabled){this.changeDetectorRef.detectChanges();const e=this.documentService.nativeDocument.getElementById(this.getActivityElementId());e&&(this.clickHandler&&e.removeEventListener("click",this.clickHandler),this.clickHandler=e=>this.clicked(e),e.addEventListener("click",this.clickHandler))}}createDescription(e){return this.activityReason=e?e.reasonType:void 0,e&&e.formatString?{activityDescription:e,html:this.generateHtml(e),icon:this.reasonTypeToIcon(e.reasonType,this.useSolidIcon)}:null}generateHtml(e){if(!e.people||!e.people.length)return e.formatString;let t=f.a.escapeHtml(e.formatString);if(this.activityDeepLink){const e=t.split(/(&lt;c[0-9]+&gt;.*?&lt;\/c[0-9]+&gt;)/);for(let t=0;t<e.length;t++)t%2==0&&(e[t]=` <span class='activity-deep-link__underlined'>${e[t].trim()}</span> `);t=e.join("").trim()}for(let i=0;i<e.people.length;i++){const n=e.people[i];n.tag&&(t=t.replace(new RegExp(`&lt;${n.tag.trim()}&gt;`,"g"),n.upn?`<span class="activity-user-name ms-fcl-nd ms-fcl-nd-h${this.fluentRefresh?" activity-user-name--fluent":""}" title="${f.a.escapeHtml(n.name)}" data-email="${f.a.escapeHtml(n.upn)}">`:"<span>"),t=t.replace(new RegExp(`&lt;/${n.tag.trim()}&gt;`,"g"),"</span>"))}return this.domSanitizer.bypassSecurityTrustHtml(t)}reasonTypeToIcon(e,t){switch(e){case l.a.Edit:return t?u.a.PencilSolid:u.a.Pencil;case l.a.Comment:return t?u.a.Chat:u.a.Comment;case l.a.Mention:return u.a.At;case l.a.Open:return u.a.FolderOpen;case l.a.Share:return u.a.People2;case l.a.Attachment:return u.a.Attach;case l.a.SnoozeExpiry:return u.a.Calendar;case l.a.Trending:return u.a.Trending;case l.a.News:return u.a.News;case l.a.Meeting:return u.a.Calendar;case l.a.Video:return u.a.Video;case l.a.Task:return u.a.Task;case l.a.Default:default:return u.a.Compass}}getDateString(e){const t=this.locService.localizedDateString(e);return this.responsiveRelativeDatePipe.transform(e,this.shortDate,t,!1)}softUpdatePeopleCards(){if(this.capabilitiesService.capabilities.peopleCardsEnabled){if(this.peopleCardService.population()>0)return void this.updatePeopleCards();if(this.queuedPeopleCardUpdate||!this.needPeopleCardUpdate)return;this.queuedPeopleCardUpdate=this.mruItemInflationService.waitOnInflations().then((()=>{this.updatePeopleCards(),this.queuedPeopleCardUpdate=null}))}}updatePeopleCards(){if(!(this.capabilitiesService.capabilities.peopleCardsEnabled&&this.needPeopleCardUpdate&&this.htmlDescription&&this.htmlDescription.activityDescription&&this.htmlDescription.activityDescription.people))return void(this.needPeopleCardUpdate=!1);if(!this.descriptionElement||!this.descriptionElement.nativeElement)return;this.changeDetectorRef.detectChanges();const e=this.descriptionElement.nativeElement.querySelectorAll(".activity-user-name");for(let t=0;t<e.length;t++){const i=e[t].getAttribute("data-email");this.peopleCardService.addPersonaCard(e[t],i)}this.needPeopleCardUpdate=!1}removePeopleCards(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){if(!(this.capabilitiesService.capabilities.peopleCardsEnabled&&this.htmlDescription&&this.htmlDescription.activityDescription&&this.htmlDescription.activityDescription.people&&this.descriptionElement&&this.descriptionElement.nativeElement))return;const e=this.descriptionElement.nativeElement.querySelectorAll(".activity-user-name");for(let t=0;t<e.length;t++){const i=e[t].getAttribute("data-email");try{yield this.peopleCardService.removePersonaCard(e[t],i)}catch(e){}}}))}}g.activitySectionId="activity-description-div"},KoFE:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("Mlb/");i("6Po3"),i("9c4X");class r{constructor(e,t,i){this.resizeObserverService=e,this.elementRef=t,this.browserPaintService=i,this.resize=new n.q}ngOnInit(){this.resizeObserver=this.resizeObserverService.createAndObserve((e=>this.onResize(e[0])),this.elementRef.nativeElement)}ngAfterViewInit(){this.browserPaintService.runAfterPaint((()=>{this.resize.emit(this.elementRef.nativeElement.getBoundingClientRect())}))}ngOnDestroy(){this.resizeObserver.disconnect()}onResize(e){e&&this.resize.emit(e.contentRect)}}},"L/Tc":function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.Edit=2]="Edit",e[e.Comment=3]="Comment",e[e.Mention=4]="Mention"}(n||(n={}))},"L9A/":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},LQqy:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var n=i("Dn7E"),r=i("70cc"),a=i("WKA6"),o=i("lrJm"),s=i("hhzZ"),l=i("dFxn"),c=i("6nG3"),u=i("7Gwk"),d=i("uWZl"),h=i("4/We"),p=i("cgnd"),m=i("Mlb/");class f{constructor(e,t,i,n,o,s,l){this.consumerLicenseService=e,this.capabilitiesService=t,this.configParserService=i,this.eventService=n,this.globalErrorHandler=o,this.instrumentationService=s,this.startupConfigService=l,this.eventService.events.withScope(1).pipe(Object(r.a)((e=>"convertedToPaid"===e.name)),Object(a.a)(1)).toPromise().then((()=>{this.refreshedConfig=this.configPromise.then((e=>e?{currentSkuInfo:{skuType:c.b.O365Personal,daysExpired:-365},expiredSkuInfo:e.expiredSkuInfo}:{currentSkuInfo:{skuType:c.b.NotDetected,daysExpired:-1},expiredSkuInfo:{skuType:c.b.NotDetected,daysExpired:-1}}))}))}getConfig(){if(this.refreshedConfig)return this.refreshedConfig;if(!this.configPromise){if(this.startupConfigService.config.authType!==p.a.MSA)return Promise.resolve({currentSkuInfo:{skuType:c.b.NotDetected,daysExpired:-1},expiredSkuInfo:{skuType:c.b.NotDetected,daysExpired:-1}});if(this.capabilitiesService.capabilities.pwaEnabled)this.configPromise=this.getPwaConfig();else{const e=this.eventService.events.withScope(0).pipe(Object(r.a)((e=>"primaryTokensLoaded"===e.name)),Object(a.a)(1)).toPromise(),t=d.a.fullPageReady();this.configPromise=Promise.race([e,t]).then((()=>this.configParserService.parse(f.consumerInstallConfigElementId)))}}return this.configPromise}getCurrentSku(){return new Promise((e=>{this.getConfig().then((t=>e(t&&t.currentSkuInfo?t.currentSkuInfo.skuType:c.b.NotDetected))).catch((()=>e(c.b.NotDetected)))}))}getPwaConfig(){return new Promise((e=>{try{const t=this.consumerLicenseService.getLicenses();t.results.subscribe((t=>{const i={State:"Succeeded"};i.DebugInfo="ProductIds: "+t.diagnosticInfo,i.SkuType=c.b[t.currentSkuInfo.skuType],i.ActiveDaysLeft=(-t.currentSkuInfo.daysExpired).toString(),i.ExpiredSkuType=c.b[t.expiredSkuInfo.skuType],i.DaysExpired=t.expiredSkuInfo.daysExpired.toString(),i.FromServiceWorkerCache=t.fromCache.toString(),this.instrumentationService.logGenericEvent("Bulk_License_Preview",i),Object(n.a)({featureName:"Upsell",eventName:"Bulk_License_Preview",area:"Other",params:{ElementId:"bulk-license-preview-api",State:"Succeeded",DebugInfo:`ProductIds: ${t.diagnosticInfo}`,SkuType:c.b[t.currentSkuInfo.skuType],ActiveDaysLeft:t.currentSkuInfo.daysExpired,ExpiredSkuType:c.b[t.expiredSkuInfo.skuType],DaysExpired:t.expiredSkuInfo.daysExpired,FromServiceWorkerCache:t.fromCache.toString()}}),e({currentSkuInfo:t.currentSkuInfo,expiredSkuInfo:t.expiredSkuInfo})})),t.initialCompletion.then((t=>{t&&(t.cacheError&&t.networkError?(this.logFailureEvent(),this.globalErrorHandler.handleError(t,"IMo7P"),e({currentSkuInfo:{skuType:c.b.NotDetected,daysExpired:-1},expiredSkuInfo:{skuType:c.b.NotDetected,daysExpired:-1}})):this.globalErrorHandler.handleCacheObservableError(t,"xJ743","QhHdV"))}))}catch(t){this.logFailureEvent(),e({currentSkuInfo:{skuType:c.b.NotDetected,daysExpired:-1},expiredSkuInfo:{skuType:c.b.NotDetected,daysExpired:-1}})}}))}logFailureEvent(){const e={State:"Failed"};e.SkuType=c.b[c.b.NotDetected],e.ActiveDaysLeft="-1",e.ExpiredSkuType=c.b[c.b.NotDetected],e.DaysExpired="-1",this.instrumentationService.logGenericEvent("Bulk_License_Preview",e),Object(n.a)({featureName:"Upsell",eventName:"Bulk_License_Preview",area:"Other",params:{ElementId:"bulk-license-preview-api",State:"Failed",SkuType:c.b[c.b.NotDetected],ActiveDaysLeft:-1,ExpiredSkuType:c.b[c.b.NotDetected],DaysExpired:-1}})}}f.consumerInstallConfigElementId="consumerInstallInfo",f.ɵprov=m.kc({factory:function(){return new f(m.lc(c.a),m.lc(h.a),m.lc(l.a),m.lc(u.a),m.lc(o.b),m.lc(s.a),m.lc(p.b))},token:f,providedIn:"root"})},M3TP:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},M56G:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("Mlb/"),r=i("lUkk");i("hhzZ"),i("jrGV"),i("W3Zz"),i("hZW2"),i("4/We"),i("PBJH"),i("s+Eq");class a{constructor(e,t,i,r,a,o,s,l){this.actionContextMenuService=e,this.capabilitiesService=t,this.documentService=i,this.elementRef=r,this.deviceDetector=a,this.instrumentationService=o,this.locService=s,this.renderer=l,this.leftAlignedCard=!1,this.horizontalEllipsis=!1,this.actionContextMenuEnabled=!1,this.menuToggled=new n.q,this.menuFocused=new n.q,this.mobileMenusEnabled=this.capabilitiesService.capabilities.mobileContextMenusEnabled}ngOnChanges(e){e.hasOwnProperty("menuModel")&&this.initializeDropdownMenuModel(this.menuModel)}ngOnInit(){this.fluentRefresh=this.capabilitiesService.capabilities.fluentRefresh||this.horizontalEllipsis,this.initializeDropdownMenuModel(this.menuModel),this.actionContextMenuEnabled&&(this.actionContextMenuClickHandler=e=>{this.elementRef.nativeElement.contains(e.target)||this.isOpen&&this.dropdownMenu.onToggleMenu(!1)},this.actionContextMenuClickListener=this.renderer.listen(this.documentService.nativeDocument,"click",this.actionContextMenuClickHandler))}ngOnDestroy(){this.actionContextMenuClickListener&&this.actionContextMenuClickListener()}onFocusLink(e){this.menuFocused.emit(e)}onToggleMenu(e){this.actionContextMenuEnabled&&this.onToggleActionContextMenu(e),e&&(this.menuModel.rightAligned=!0),this.isOpen=e,this.menuToggled.emit(e),this.instrumentToggle(e)}onSelectItem(e){e.item.executeAction(e.nativeDomEvent)}initializeDropdownMenuModel(e){if(this.dropdownMenuModel=e,!this.dropdownMenuModel)throw new Error("menuModel must be provided to actions-menu");this.dropdownMenuModel.linkAriaDescription=this.locService.format(this.locService.MruActionsMenuAriaDescription,this.documentName),this.dropdownMenuModel.linkTooltip=this.dropdownMenuModel.linkAriaLabel=this.locService.MruActionsMenuToolTip,this.dropdownMenuModel.linkCssClass=`actions-menu-link ${this.fluentRefresh?"commanding-item--fluent ms-fcl-npa ms-fcl-tp-h ms-fcl-tda-a":"ms-fcl-nd ms-bgc-g40-f ms-bgc-g40-h ms-bgc-g40-a commanding-item ms-bgc-g40-h"} ${this.deviceDetector.isDesktopDevice()?" actions-menu-link--hidden":""}`}onToggleActionContextMenu(e){e?(this.actionContextMenu.targetElement=this.dropdownMenu.dropdownLink.nativeElement,this.actionContextMenuService.openMenu(this.actionContextMenu)):this.actionContextMenuService.closeMenu(this.actionContextMenu)}instrumentToggle(e){if(this.actionContextMenuEnabled)return;const t=e?"Open":"Close",i={};i.RenderSize=this.menuModel.items.length.toString(),i.Index=this.listItemIndex.toString(),i.Action=t,this.instrumentationService.logClickEvent("Actions_Menu_Toggle","actions-menu-link",this.area,null,null,i,[],this.dataSecurity||0),Object(r.a)({id:"Actions_Menu_Toggle",area:this.area,result:t,target:"ActionsMenu"})}}},MFXD:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("EYJY"),r=i("FwwM");class a{constructor(){this.onlyFuture=new n.a,this.pastAndFuture=new r.a}withScope(e){switch(e){case 1:return this.onlyFuture.asObservable();case 0:return this.pastAndFuture.asObservable();default:throw new Error("Unknown Observable Scope")}}next(e){this.onlyFuture.next(e),this.pastAndFuture.next(e)}asScopableObservable(){return this}}},MMsA:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var n=i("QjXU"),r=i("Dn7E"),a=i("70cc"),o=i("WKA6"),s=i("lrJm"),l=i("hhzZ"),c=i("R7NL"),u=i("/I02"),d=i("dFxn"),h=i("Mlb/");class p{constructor(e){this.config=e.parse("authStateConfig")||{authTicketExpiryIntervalInMinutes:0,checkAuthStateEnabled:!1,checkAuthStateEndpoint:null,checkAuthStateIntervalInSeconds:0,reauthenticationForAccessTokenPermanentErrorIntervalInMinutes:0}}}p.ɵprov=h.kc({factory:function(){return new p(h.lc(d.a))},token:p,providedIn:"root"});var m=i("7Gwk"),f=i("Z0U4"),g=i("wwmn"),b=i("WLAd"),v=i("BMb5"),S=i("qk26");class y{constructor(e,t,i,n,r,a,o,s,l,c,u){this.contextService=e,this.configService=t,this.officeHomeApiConfigService=i,this.instrumentationService=n,this.instrumentedHttp=r,this.eventService=a,this.pageVisibilityService=o,this.route=s,this.globalErrorHandler=l,this.windowService=c,this.routeService=u,this.currentState="SignedIn",this.initialized=!1,this.checkAuthStateTimeout=null,this.accessTokenService=null}initialize(e){if(this.initialized)throw new s.a("Not allowed to call AuthStateService.initialize() more than once");this.initialized=!0,this.accessTokenService=e;const t=this.configService.config;if(!t.checkAuthStateEnabled||!t.checkAuthStateEndpoint)return;const i=this.contextService.sharedContext;this.checkAuthStateEndpoint=`${i.officeHomeApiRoot}/${t.checkAuthStateEndpoint}`,this.checkAuthStateRequestOptions={headers:new Map},this.queryParamProcessor=new Promise(((e,t)=>{i.inMockMode||e(),this.officeHomeApiConfigService.config.mockRequestHeader||e(),this.route.queryParams.pipe(Object(a.a)((e=>Object.keys(e).length>0)),Object(o.a)(1)).toPromise().then((t=>{for(const e in t)e&&t.hasOwnProperty(e)&&"mockchecklogin"===e.toLowerCase()&&this.checkAuthStateRequestOptions.headers.set(this.officeHomeApiConfigService.config.mockRequestHeader,t[e]);e()})).catch((e=>{this.globalErrorHandler.handleError(e,"Jrzf6"),t(e)}))})),this.watchAuthTicketExpiry(),this.watchAccessTokenPermanentError(),this.watchPageVisibilityChanges(),this.scheduleCheckAuthState(),this.setupActivityTimeoutSignoutListener()}getCurrentState(){return this.currentState}watchAuthTicketExpiry(){if(this.configService.config.authTicketExpiryIntervalInMinutes>0){let e;const t=6e4*this.configService.config.authTicketExpiryIntervalInMinutes,i=Date.now();this.routeService.subscribeToRouteChangeEnd((n=>{if("Content"===n.currentRoute.route)e&&(this.windowService.nativeWindow.clearTimeout(e),e=void 0);else if(!e){const n=Math.max(t-(Date.now()-i),0);e=this.windowService.nativeWindow.setTimeout((()=>{"SignedIn"===this.currentState&&this.updateCurrentState({LoginState:"Expired"})}),n)}}))}}watchAccessTokenPermanentError(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){if(yield this.accessTokenService.hasPermanentAuthError()){const e=this.configService.config.reauthenticationForAccessTokenPermanentErrorIntervalInMinutes;e>0&&this.windowService.nativeWindow.setTimeout((()=>{"SignedIn"===this.currentState&&this.updateCurrentState({LoginState:"ReauthenticationRequired"})}),6e4*e)}}))}watchPageVisibilityChanges(){this.windowService.nativeWindow.setTimeout((()=>{this.pageVisibilityService.addOnVisibilityChanged((()=>{this.pageVisibilityService.isVisible()&&this.checkAuthState()}))}),1e3*this.configService.config.checkAuthStateIntervalInSeconds)}scheduleCheckAuthState(){"SignedIn"===this.currentState&&!this.checkAuthStateTimeout&&this.configService.config.checkAuthStateIntervalInSeconds>0&&(this.checkAuthStateTimeout=this.windowService.nativeWindow.setTimeout((()=>this.checkAuthState()),1e3*this.configService.config.checkAuthStateIntervalInSeconds))}checkAuthState(){this.checkAuthStateTimeout&&(this.windowService.nativeWindow.clearTimeout(this.checkAuthStateTimeout),this.checkAuthStateTimeout=null),this.queryParamProcessor.then((()=>{if("SignedIn"===this.currentState&&this.pageVisibilityService.isVisible())return this.instrumentedHttp.get("Check_Login_Request","Check_Login",this.checkAuthStateEndpoint,this.checkAuthStateRequestOptions,"network-only").then((({data:e})=>{e&&"SignedIn"===this.currentState&&this.updateCurrentState(e)}))})).catch((e=>{this.globalErrorHandler.handleError(e,"QGMJO")})).then((()=>this.scheduleCheckAuthState()))}updateCurrentState(e){const t=e.LoginState;if(this.currentState===t)return;this.currentState=t;const i={};i.State=this.currentState,this.instrumentationService.logGenericEvent("Auth_State_Changed",i),Object(r.a)({featureName:"Auth",eventName:"Auth_State_Changed",params:i}),this.eventService.broadcastEvent({name:"authStateChanged",args:[e]})}setupActivityTimeoutSignoutListener(){this.windowService.nativeWindow.addEventListener("message",(e=>{if(e&&e.data){let t;try{t=JSON.parse(e.data)}catch(e){}t&&"abtSignOutEventForHost"===t.eventId&&this.updateCurrentState({LoginState:"SignedOutBasedOnActivityAuto"}),t&&"abtSignOutEventForHostUserGenerated"===t.eventId&&this.updateCurrentState({LoginState:"SignedOutBasedOnActivityUserClick"})}}))}}y.ɵprov=h.kc({factory:function(){return new y(h.lc(u.a),h.lc(p),h.lc(g.a),h.lc(l.a),h.lc(c.a),h.lc(m.a),h.lc(b.a),h.lc(S.a),h.lc(s.b),h.lc(v.b),h.lc(f.a))},token:y,providedIn:"root"})},MRNN:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i("Z0U4"),i("4/We"),i("/I02"),i("PBJH");class n{constructor(e,t,i,n){this.capabilitiesService=e,this.contextService=t,this.locService=i,this.officeRouteService=n,this.responsive=!1,this.focusOnLoad=!1}ngOnInit(){this.defaultAriaLabel=this.locService.CloseAppGalleryAriaLabel,this.isRtl=this.contextService.isRtl,this.routeSubscription=this.officeRouteService.subscribeToRouteChangeEnd((e=>this.backRoute=e.backRoute)),this.fluentRefresh=this.capabilitiesService.capabilities.fluentRefresh}ngOnDestroy(){this.routeSubscription&&this.routeSubscription.unsubscribe()}navigateBack(){this.backRoute&&this.backRoute.route?this.officeRouteService.back():this.defaultBackRoute&&this.officeRouteService.navigateTo(this.defaultBackRoute,!0)}}},MbTY:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("6UlS"),r=i("Mlb/");class a{constructor(){this._inputDialog=new n.a(null)}showInputDialog(e){this._inputDialog.next(e)}get inputDialog(){return this._inputDialog.asObservable()}}a.ɵprov=r.kc({factory:function(){return new a},token:a,providedIn:"root"})},"NL/U":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("oKW8");function r(e){return(Object(n.a)().getTime()-e.getTime())/1e3}},OOtI:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mlb/"),r=i("70cc"),a=(i("mNaV"),i("dOgD"),i("RJiy"),i("+YV+"),i("BaAg")),o=(i("QOOv"),i("7Rc8"),i("7Gwk"),i("gO/A"),i("4/We"),i("cgnd"));i("/I02"),i("PBJH"),i("JScD"),i("9MHL");class s{constructor(e,t,i,r,a,o,s,l,c,u,d,h,p,m,f){this.capabilitiesService=e,this.eventService=t,this.mruConfigService=i,this.locService=r,this.mruDataService=a,this.officeFeedService=o,this.createMenuService=s,this.recommendedService=l,this.oneDriveUploadService=c,this.uploadConfigService=u,this.clientStartupConfigService=d,this.startupConfigService=h,this.edgeworthDataService=p,this.contextService=m,this.visualService=f,this.mruOutputs={stateChanged:e=>this.onMruStateChange(e)},this.numLoggableItems=0,this.uploadEnabled=!1,this.mruStateChanged=new n.q}ngOnInit(){this.capabilities=this.capabilitiesService.capabilities,this.mruConfig=this.mruConfigService.config,this.sectionLandmarkAriaLabel=this.locService.MruSectionTitleShort,this.title=this.sectionLandmarkAriaLabel,this.isStartpage=!!this.fileType,this.appFilter=this.fileType?new Set([this.fileType]):null,this.fileType&&this.fileType===a.b.Stream&&this.appFilter.add(a.b.Video),this.edgeworthEnabled=this.capabilities.edgeworthEnabled&&this.fileType!==a.b.Forms&&this.fileType!==a.b.OneNote&&this.fileType!==a.b.Sway,this.edgeworthReactEnabled=this.capabilities.edgeworthReactEnabled,this.quickAccessEnabled=this.capabilities.quickAccessV1Enabled&&!this.isStartpage,this.recommendedReact=this.capabilities.recommendedReact,this.leftNavReact=this.capabilities.leftNavReact,this.isConsumer=this.startupConfigService.config.authType===o.a.MSA,this.noGutter=this.capabilities.fluentRefresh||this.quickAccessEnabled&&!this.isConsumer,this.createOnHomeEnabled=this.isConsumer&&this.capabilities.createCenterEnabled&&this.capabilities.createOnHomeEnabled&&!this.isStartpage,this.learningShelfEnabled=this.isConsumer&&this.capabilities.learningShelfEnabled&&!this.isStartpage,this.initializeUpload(),this.initializeCreateButton(),this.initializeRecommended(),this.edgeworthEnabled?(this.contextService.isEdgeworth=!0,this.edgeworthReactEnabled||this.edgeworthDataService.init(this.appFilter)):this.initializeMru(),this.capabilitiesService.capabilities.visualEnabled&&(this.visualConfigSubscription=this.visualService.visualConfigSubscription.subscribe((e=>{this.visualBackgroundEnabled=e.visualBackgroundEnabled})))}ngAfterViewInit(){this.capabilitiesService.capabilities.visualEnabled&&(this.getWidthRestrictorComputedStyle(),this.resizeSubscription=this.eventService.events.withScope(0).pipe(Object(r.a)((e=>"windowResized"===e.name))).subscribe((()=>{this.getWidthRestrictorComputedStyle()})))}ngOnDestroy(){var e;this.recommendedSubscription&&this.recommendedSubscription.unsubscribe(),this.mruSubscription&&this.mruSubscription.unsubscribe(),this.visualConfigSubscription&&this.visualConfigSubscription.unsubscribe(),null===(e=this.resizeSubscription)||void 0===e||e.unsubscribe()}onMruStateChange(e){this.mruStateChanged.emit(e)}initializeUpload(){this.capabilities.oneDriveUploadEnabled&&this.uploadConfigService.config&&this.fileType!==a.b.Sway&&this.fileType!==a.b.OneNote&&this.fileType!==a.b.Forms&&this.oneDriveUploadService.uploadEnabledPromise.then((e=>this.uploadEnabled=e))}initializeCreateButton(){this.createMenuService.createButtonEnabledPromise.then((e=>this.createButtonEnabled=e))}initializeRecommended(){if(this.mruConfig.recommendedEnabled&&this.fileType!==a.b.Sway&&this.fileType!==a.b.OneNote&&this.fileType!==a.b.Forms){const e=!this.mruConfig.officeFeedControlEnabled&&!this.mruConfig.officeFeedFlightEnabled||this.fileType?this.recommendedService.getRecommendedDocs(this.appFilter):this.officeFeedService.getOfficeFeed();this.recommendedSubscription=e.results.subscribe((e=>{this.eventService.broadcastEvent({name:"recommendedDataReady",args:[e.items.length]}),this.hasRecommendedDocs=e.items.length>0}))}}initializeMru(){this.recentMruStream=this.mruDataService.getMruDocuments(this.appFilter),this.mruSubscription=this.recentMruStream.results.subscribe((e=>{e.items.length?(this.initialDocsAvailable=!0,this.numLoggableItems=e.items.length):Promise.all([this.createMenuService.createButtonEnabledPromise,this.oneDriveUploadService.uploadEnabledPromise]).then((([e,t])=>this.showZeroExperience=this.fileType===a.b.Forms||this.mruConfig.showZeroExperience&&(e||t||this.clientStartupConfigService.config.authType===o.a.OrgId))),this.eventService.broadcastEvent({name:"mruDataReady",args:[e.items.length]})})),this.clientStartupConfigService.config.authType===o.a.MSA&&this.recentMruStream.initialCompletion.then((e=>{e&&e.cacheError&&e.networkError&&this.eventService.broadcastEvent({name:"mruFailed",args:[]})}))}getWidthRestrictorComputedStyle(){var e;if(null===(e=this.widthRestrictorElement)||void 0===e?void 0:e.nativeElement){const e=getComputedStyle(this.widthRestrictorElement.nativeElement);e&&this.eventService.broadcastEvent({name:"widthRestrictorComputedStyle",args:[e]})}}}},OPwp:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return m}));var n,r=i("EYJY"),a=i("70cc"),o=i("O6Zd"),s=i("BaAg"),l=i("p6Zr"),c=i("kpuN"),u=i("w1PR"),d=i("4/We"),h=i("pjz5"),p=i("Mlb/");!function(e){e[e.Share=1]="Share",e[e.CopyLink=2]="CopyLink",e[e.AtMention=3]="AtMention",e[e.LinkSettings=4]="LinkSettings",e[e.ManageAccess=5]="ManageAccess",e[e.Notify=6]="Notify",e[e.AddPeople=7]="AddPeople"}(n||(n={}));class m{constructor(e,t,i){this.accessTokenService=e,this.capabilitiesService=t,this.themingService=i,this.shareControl=new r.a,this.capabilitiesService.capabilities.darkModeEnabled&&(this.themeShadesSubscription=this.themingService.darkModeSubscription.subscribe((e=>{this.isDarkMode=e})))}static getShareControlModeFromString(e){switch(e){case"copy":return n.CopyLink;case"atMention":return n.AtMention;case"linkSettings":return n.LinkSettings;case"manageAccess":return n.ManageAccess;case"notify":return n.Notify;case"addPeople":return n.AddPeople;default:return n.Share}}ngOnDestroy(){this.themeShadesSubscription&&this.themeShadesSubscription.unsubscribe()}getToken(e,t,i,n=null){const r=h.a.getLocation(e),a=r?`${r.protocol}//${r.hostname}`:"";return null===n&&(n=this.getTokenType(e)),this.accessTokenService.getAccessToken(n,!1,a,t,{category:"Share",fileType:i})}getTokenType(e){return s.a.referralFromFileLocation(e)===l.a.OneDrive?"OneDrive":"SharePoint"}showControl(e){this.updateNext(e,0)}hideControl(e){this.updateNext(e,1)}subscribeToOpenEvents(e){return this.shareControl.asObservable().pipe(Object(a.a)((e=>e&&0===e.type)),Object(o.a)((e=>e.shareControl))).subscribe(e)}subscribeToCloseEvents(e){return this.shareControl.asObservable().pipe(Object(a.a)((e=>e&&1===e.type)),Object(o.a)((e=>e.shareControl))).subscribe(e)}getDarkMode(){return this.isDarkMode}updateNext(e,t){e&&e.file&&null!=e.index&&this.shareControl.next({type:t,shareControl:e})}}m.ɵprov=p.kc({factory:function(){return new m(p.lc(c.a),p.lc(d.a),p.lc(u.b))},token:m,providedIn:"root"})},OWzB:function(e,t,i){"use strict";i.d(t,"a",(function(){return G}));var n=i("lUkk"),r=i("WKA6"),a=i("lrJm"),o=i("DQbD"),s=i("BaAg"),l=i("4ach"),c=i("7Rc8"),u=i("4/We"),d=i("cgnd"),h=i("/I02"),p=i("PBJH"),m=i("ZBli");class f{static hasNoInvalidCharacter(e,t){for(const i of t)if(-1!==e.indexOf(i))return!1;return!0}static hasNoDuplicates(e,t,i=!1){return i?f.hasNoDuplicatesCaseInsensitiveTrimmed(e,t):-1===t.indexOf(e)}static isNotStartingWithSpace(e){return!e||e&&" "!==e[0]}static isContainingLessThanLimitedCharacters(e,t){return e.length<=t}static isNotEmptyString(e){return null!=e&&e.length>0}static hasNoDuplicatesCaseInsensitiveTrimmed(e,t){for(const i of t)if(e.trim().toLowerCase()===i.trim().toLowerCase())return!1;return!0}}var g=i("hhzZ"),b=i("idgT"),v=i("kpuN"),S=i("dFxn"),y=i("Mlb/");class C{constructor(e){this.config=e.parse("createConfig")||{thirdPartyCreateAppIds:[],createSwayEndpointConsumer:""}}}C.ɵprov=y.kc({factory:function(){return new C(y.lc(S.a))},token:C,providedIn:"root"});var w=i("2CtU"),I=i("QjXU"),T=i("dy1P"),k=i("n826");class A{constructor(e,t,i){this.globalErrorHandler=e,this.oneDriveGraphService=t,this.instrumentationService=i}createStreamContent(e,t,i,r,a){const o=Date.now(),l=()=>Date.now()-o;t===s.b.PlayLists||t===s.b.PlayList?(this.performAction(e,s.b.PlayList,i||g.b.Templates,a),this.instrumentationService.logClickEvent("New_Playlist_Button_Click","CreateNewPlaylist",i||g.b.Templates,s.b.PlayList.toString()),r?r({type:"GoToBlankDoc",latency:l(),platform:"Web"}):Object(n.a)({result:"Refer",target:T.a.PlayLists,area:i||"Templates",id:"CreateNewPlaylist",eventName:"New_Playlist_Button_Click"})):t===s.b.Stream?(this.performAction(e,s.b.Stream,i||g.b.Templates),this.instrumentationService.logClickEvent("New_Video_Recorder_Button_Click","CreateNewVideoRecorder",i||g.b.Templates,s.b.Stream.toString()),r?r({type:"GoToBlankDoc",latency:l(),platform:"Web"}):Object(n.a)({result:"Refer",target:T.a.MicrosoftStream,area:i||"Templates",id:"CreateNewVideoRecorder",eventName:"New_Video_Recorder_Button_Click"})):t===s.b.ScreenRecording&&(this.performAction(e,s.b.ScreenRecording,i||g.b.Templates),this.instrumentationService.logClickEvent("New_Screen_Recorder_Button_Click","CreateNewScreenRecorder",i||g.b.Templates,s.b.Stream.toString()),r?r({type:"GoToBlankDoc",latency:l(),platform:"Web"}):Object(n.a)({result:"Refer",target:T.a.MicrosoftStream,area:i||"Templates",id:"CreateNewScreenRecorder",eventName:"New_Screen_Recorder_Button_Click"}))}performAction(e,t,i,n){return Object(I.__awaiter)(this,void 0,void 0,(function*(){try{const r=yield this.oneDriveGraphService.getMyDriveRootUrl(),a=r&&r.userRoot,o="Templates"===i?"StreamStartPage":i;if(a){const i=a.lastIndexOf("/Documents");-1===i&&(this.instrumentationService.logErrorEvent("OneDrive_User_RootUrl",this.createInstrumentationParams(e,t)),this.globalErrorHandler.handleError("userRootUrl not in expected format","sCtl9")),this.oneDriveUrl=a.substring(0,i);let r="";switch(t){case s.b.Stream:r=`${this.oneDriveUrl}/_layouts/15/stream.aspx?action=create&referrer=OfficeHome&referrerScenario=${o}&cid=${e}`;break;case s.b.ScreenRecording:r=`${this.oneDriveUrl}/_layouts/15/stream.aspx?action=create&referrer=OfficeHome&referrerScenario=${o}&captureMode=screenrecorder&cid=${e}`;break;default:r=n?`${this.oneDriveUrl}/_layouts/15/lists.aspx?openListTemplateId=3a867b4a-7429-0e1a-b02e-bf4b240ff1ce&workload=Stream&cid=${e}`:`${this.oneDriveUrl}/_layouts/15/lists.aspx?openCreate=true&workload=Stream&cid=${e}`}window.open(r,"_blank")}}catch(i){return this.instrumentationService.logErrorEvent(t===s.b.PlayLists||t===s.b.PlayList?"New_Playlist_Button_Click":t===s.b.ScreenRecording?"New_Screen_Recorder_Button_Click":"New_Video_Recorder_Button_Click",this.createInstrumentationParams(e)),this.globalErrorHandler.handleError(i,"sCtl9")}}))}createInstrumentationParams(e,t){return t?{ResourceId:e,DocumentType:s.b[t]}:{ResourceId:e}}}A.ɵprov=y.kc({factory:function(){return new A(y.lc(a.b),y.lc(k.a),y.lc(g.a))},token:A,providedIn:"root"});var _=i("hZW2"),P=i("EYcb"),E=i("TDzr"),F=i("MbTY"),O=i("Bc8L"),D=i("Z0U4"),M=i("Dpxn"),R=i("v3sZ"),x=i("p6gk"),L=i("ExL+"),U=i("m+UP"),N=i("TIi1"),W=i("Brer"),j=i("EUVs"),H=i("BMb5"),B=i("hoyd");class G{constructor(e,t,i,n,r,a,o,l,c,u,h,p,m,f,g,b,v,S,y,C,w,I,T,k,A,_,P,E,F,O){this.accessTokenService=e,this.capabilitiesService=t,this.clientStartupConfigService=i,this.contextService=n,this.createConfigService=r,this.createOneNotePageDialogService=a,this.createStreamService=o,this.documentService=l,this.errorDialogService=c,this.fluidHostContext=u,this.formsService=h,this.globalErrorHandler=p,this.inputDialogService=m,this.instrumentationService=f,this.localAppLauncherService=g,this.locService=b,this.mruDataService=v,this.officeRouteService=S,this.oneDriveService=y,this.oneNoteGraphService=C,this.oneNoteConfigService=w,this.startupConfigService=I,this.shellService=T,this.swayService=k,this.templatesConfigService=A,this.urlLauncherService=_,this.vroomService=P,this.wacContentService=E,this.windowService=F,this.workloadsService=O;const D=this.capabilitiesService.capabilities;this.isPwa=D.pwaEnabled,this.isMsa=this.clientStartupConfigService.config.authType===d.a.MSA,this.fluidSupportEnabled=D.fluidSupportEnabled,this.wacHostApps=new Set(D.wacHostApps),this.numCreatesPending=0,this.createLcidEnabled=this.templatesConfigService.config.createLcidEnabled,this.createLinkCandidates=new Map;const M=D.createOneDriveDocApiEnabled;if(this.createLinkCandidates.set(s.b.Word,{title:b.CreateMenuLinkWordTitle,fileTypeName:b.CreateModalLinkWordTitle,appName:b.WordName,fileType:s.b.Word,newDocName:this.locService.NewWordDocumentFileName,fileExtension:"docx",workloadOnlineName:this.locService.WordName,spinnerColor:"#185ABD",canCreateBlankDocument:M,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!D.startPageApps.has(s.b.Word),createDocAspxEnabled:D.createDocAspxWordEnabled,docAspxId:1}),this.createLinkCandidates.set(s.b.Excel,{title:b.CreateMenuLinkExcelTitle,fileTypeName:b.CreateModalLinkExcelTitle,appName:b.ExcelName,fileType:s.b.Excel,newDocName:this.locService.NewExcelWorkbookFileName,fileExtension:"xlsx",workloadOnlineName:this.locService.ExcelName,spinnerColor:"#107C41",canCreateBlankDocument:M,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!D.startPageApps.has(s.b.Excel),createDocAspxEnabled:D.createDocAspxExcelEnabled,docAspxId:2}),this.createLinkCandidates.set(s.b.PowerPoint,{title:b.CreateMenuLinkPowerPointTitle,fileTypeName:b.CreateModalLinkPowerPointTitle,appName:b.PowerPointName,fileType:s.b.PowerPoint,newDocName:this.locService.NewPowerPointPresentationFileName,fileExtension:"pptx",workloadOnlineName:this.locService.PowerPointName,spinnerColor:"#C43E1C",canCreateBlankDocument:M,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!D.startPageApps.has(s.b.PowerPoint),createDocAspxEnabled:D.createDocAspxPowerPointEnabled,docAspxId:3}),this.createLinkCandidates.set(s.b.Sway,{title:b.CreateMenuLinkSwayTitle,fileTypeName:b.CreateModalLinkSwayTitle,appName:b.SwayName,fileType:s.b.Sway,workloadOnlineName:this.locService.MicrosoftSwayName,spinnerColor:"#038387",canCreateBlankDocument:D.swayCreateNewEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!D.startPageApps.has(s.b.Sway),createDocAspxEnabled:!1}),D.fluidCreateNewEnabled&&this.createLinkCandidates.set(s.b.Fluid,{title:b.CreateMenuLinkFluidTitle,fileTypeName:b.CreateModalLinkFluidTitle,appName:b.FluidName,fileType:s.b.Fluid,canCreateBlankDocument:this.fluidSupportEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1}),D.fluidCreateAbpEnabled&&this.createLinkCandidates.set(s.b.FluidActivityBlueprint,{title:b.CreateMenuLinkFluidAbpTitle,fileTypeName:b.CreateModalLinkFluidAbpTitle,appName:b.FluidName,fileType:s.b.FluidActivityBlueprint,canCreateBlankDocument:this.fluidSupportEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1}),D.startPageApps.has(s.b.Forms)&&(this.createLinkCandidates.set(s.b.Forms,{appName:b.FormsName,title:b.CreateMenuLinkFormsTitle,fileTypeName:b.CreateModalLinkFormsFormTitle,workloadOnlineName:b.FormsName,fileType:s.b.Forms,canCreateBlankDocument:!0,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1,spinnerColor:"#038387"}),this.createLinkCandidates.set(s.b.FormsQuiz,{appName:b.FormsName,title:b.CreateMenuLinkFormsQuizTitle,fileTypeName:b.CreateModalLinkFormsQuizTitle,workloadOnlineName:b.FormsName,fileType:s.b.FormsQuiz,canCreateBlankDocument:!0,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1,spinnerColor:"#038387"})),D.startPageApps.has(s.b.OneNote)&&this.oneNoteConfigService.config.enableOneNoteApis&&this.createLinkCandidates.set(s.b.OneNote,{title:b.CreateMenuLinkOneNoteTitle,fileTypeName:b.CreateModalLinkOneNoteTitle,appName:b.OneNoteName,fileType:s.b.OneNote,workloadOnlineName:this.locService.OneNoteName,spinnerColor:"#7719AA",canCreateBlankDocument:M,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!1,createDocAspxEnabled:!1}),D.createOneNotePageEnabled&&this.createLinkCandidates.set(s.b.OneNotePage,{title:b.CreateMenuLinkOneNotePageTitle,fileTypeName:b.CreateModalLinkOneNotePageTitle,appName:b.OneNoteName,fileType:s.b.OneNotePage,workloadOnlineName:this.locService.OneNoteName,spinnerColor:"#7719AA",canCreateBlankDocument:M,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!1,createDocAspxEnabled:!1}),D.startPageApps.has(s.b.Visio)?this.createLinkCandidates.set(s.b.Visio,{title:b.CreateMenuLinkVisioTitle,fileTypeName:b.CreateModalLinkVisioTitle,appName:b.VisioName,fileType:s.b.Visio,newDocName:this.locService.NewVisioDrawingFileName,fileExtension:"vsdx",workloadOnlineName:this.locService.VisioName,spinnerColor:"#4C68B1",canCreateBlankDocument:M,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!1,createDocAspxEnabled:D.createDocAspxVisioEnabled,docAspxId:8}):D.createVisioEnabled&&this.createLinkCandidates.set(s.b.Visio,{title:b.CreateMenuLinkVisioTitle,fileTypeName:b.CreateModalLinkVisioTitle,appName:b.VisioName,fileType:s.b.Visio,newDocName:this.locService.NewVisioDrawingFileName,fileExtension:"vsdx",workloadOnlineName:this.locService.VisioName,spinnerColor:"#4C68B1",canCreateBlankDocument:M&&D.createDocAspxVisioEnabled,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!0,createDocAspxEnabled:D.createDocAspxVisioEnabled,docAspxId:8}),D.createStreamDocumentEnabled&&D.startPageApps.has(s.b.Stream)&&this.createLinkCandidates.set(s.b.Stream,{title:b.CreateMenuLinkStreamTitle,fileTypeName:b.CreateModalLinkStreamTitle,appName:b.StreamName,fileType:s.b.Stream,fileExtension:"webm",workloadOnlineName:this.locService.StreamName,spinnerColor:"#BC1948",canCreateBlankDocument:!0,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1}),D.createDocumentSupported&&(D.createDocAspxWordEnabled||D.createDocAspxExcelEnabled||D.createDocAspxPowerPointEnabled)&&this.accessTokenService.getAccessToken("OneDrive"),this.appManifests=new Map([]),D.listsCreateEnabled&&this.appManifests.set("list",{name:b.ListsName,creationFileType:s.b[s.b.List],fileTypeNameLocalized:b.CreateFileTypeNameListsList,id:"ListsAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:b.CreateMenuLinkListsTitle,contentUrl:this.isMsa?"openCreate=true&workload=Office&ocid=OfficeConsumerWebCreate":"openCreate=true&workload=Office&ocid=OfficeWebCreate",websiteUrl:"",scopes:[]}],version:"1.0.0."}),D.yammerCreateEnabled&&this.appManifests.set("yammer",{name:b.YammerName,creationFileType:s.b[s.b.Yammer],fileTypeNameLocalized:b.CreateFileTypeNameYammerPost,id:"YammerAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:b.CreateMenuLinkYammerPostTitle,contentUrl:"",websiteUrl:"",scopes:[]}],version:"1.0.0."}),D.powerBiCreateEnabled&&this.appManifests.set("powerbi",{name:b.PowerBiName,creationFileType:s.b[s.b.PowerBI],fileTypeNameLocalized:b.CreateFileTypeNamePowerBiReport,id:"PowerBIAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:b.CreateMenuLinkPowerBiTitle,contentUrl:"",websiteUrl:"groups/me/quickcreate",scopes:[]}],version:"1.0.0."}),D.whiteboardCreateEnabled){if(!this.whiteboardTenantCheck){const e=this.vroomService.getFluidEnabled("cache-only").catch((()=>this.vroomService.getFluidEnabled("network-first")));this.whiteboardTenantCheck=function(e,t){const i=new Promise(((e,t)=>{setTimeout((()=>t(new Error("Timeout"))),5e3)}));return Promise.race([i,t])}(0,e)}this.whiteboardTenantCheck=this.whiteboardTenantCheck.then((e=>(e&&this.appManifests.set("whiteboard",{name:b.WhiteboardName,creationFileType:s.b[s.b.Whiteboard],fileTypeNameLocalized:b.CreateFileTypeNameWhiteboardWhiteboards,id:"WhiteboardAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:b.CreateMenuLinkWhiteboardTitle,contentUrl:"openCreate=true",websiteUrl:"",scopes:[]}],version:"1.0.0."}),e)))}else this.whiteboardTenantCheck=Promise.resolve(!0);D.createDesignerEnabled&&this.isMsa&&this.appManifests.set("designer",{name:"Designer",creationFileType:s.b[s.b.Designer],fileTypeNameLocalized:"Design",id:"DesignerAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:"designer",contentUrl:"",websiteUrl:"https://designer.microsoft.com/new?referrer=harmony",scopes:[]}],version:"1.0.0."})}getCreateLinks(e){return this.createLinksPromise||(this.createLinksPromise=new Promise((t=>{const i=[];this.workloadsService.getProvisionedWorkloads().then((n=>{n=n||[],(this.capabilitiesService.capabilities.fluidFirst?G.fluidFirstMenuOrdering:G.menuOrdering).forEach((t=>{let r;if(r=t===s.b.Fluid||t===s.b.FluidActivityBlueprint?this.getFluidWorkload(t):t===s.b.Trello?this.getThirdPartyWorkload(t):n.find((e=>e.FileType===t||t===s.b.FormsQuiz&&e.FileType===s.b.Forms||t===s.b.OneNotePage&&e.FileType===s.b.OneNote)),r){const n=this.getCreateLinkForWorkload(r,t===s.b.FormsQuiz?s.b.FormsQuiz:t===s.b.OneNotePage?s.b.OneNotePage:null,e);n&&i.push(n)}})),t(i)}))})).then((e=>{const t=[];G.thirdPartyOrdering.forEach((e=>{t.push(this.getThirdPartyAppsCreateLink(s.b[e].toLowerCase()))}));const i=[],n=()=>(G.firstPartyCreateIntentOrdering.forEach((e=>{i.push(this.getFirstPartyAppsCreateLink(s.b[e].toLowerCase()))})),this.getCreateTilesOrder().then((n=>Promise.all(i.concat(t)).then((t=>(t=t.filter((e=>!!e)),e.concat(t).sort(((e,t)=>n.indexOf(e&&e.workload?e.workload.FileType:s.b.None)-n.indexOf(t&&t.workload?t.workload.FileType:s.b.None)))))))));return this.whiteboardTenantCheck.then(n,n)}))),this.createLinksPromise}getCreateLinksForConsumer(){const e=[],t=this.createConfigService.config;return G.fileTypeToConsumerWorkloadIdMap.forEach(((i,n)=>{const r=this.createLinkCandidates.get(n);if(!r)return null;const a=n===s.b.Sway?m.a.appendQuery(t.createSwayEndpointConsumer,"campaign=OHPCreateNew"):null,o={ariaLabel:this.locService.format(this.locService.CreateMenuLinkAriaLabelFormat,r.title),title:r.title,fileTypeName:r.fileTypeName,appName:r.appName,icon:s.a.documentIconFromType(n===s.b.FormsQuiz?s.b.Forms:n,"32x32"),svgButtonBackground:G.getCreateButtonBackground(n),url:a,creationFileType:n,getId:()=>n===s.b.FormsQuiz?i+"Quiz":i};e.push(o)})),e}getCreateTilesOrder(){const e=this.capabilitiesService.capabilities.fluidFirst?G.fluidFirstCombinedMenuOrdering:G.combinedMenuOrdering;if(this.capabilitiesService.capabilities.createDynamicOrderingEnabled){const t=new Array;return this.mruDataService.getMruDocuments(new Set(G.combinedMenuOrdering)).results.pipe(Object(r.a)(1)).toPromise().then((i=>{if(!(i||i.items||i.items.length))return e;{const n=new Map;i.items.forEach((e=>{const t=e.FileType;n.set(t,n.has(t)?n.get(t)+1:1)}));const r=new Map([...n.entries()].sort(((e,t)=>t[1]-e[1])));for(const e of r.keys()){const i=s.a.fileTypeNameToFileType(e);t.push(i)}e.forEach((e=>{n.has(s.b[e])||t.push(s.b[s.b[e]])}))}return Promise.resolve(t)}))}return Promise.resolve(e)}createItem(e,t,i,n,r="",a,o,l,c=!1){const u=this.capabilitiesService.capabilities.scenarioId;switch(e){case s.b.Visio:return this.workloadsService.getWorkloads().then((d=>{const h=!!d.find((e=>e.FileType===s.b.Visio)),p=!!d.find((e=>"ShellDocuments"===e.Id));return h?this.createItemHelper(e,t,i,n,r,a,o,l,c):u?void this.shellService.getLicenseStatus(s.b[e],u).then((s=>s.IsLicensed?this.createItemHelper(e,t,i,n,r,a,o,l,c):this.errorDialogService.showErrorDialog({category:"StartPage",error:"NoLicenceVisio",fileType:e}))):this.errorDialogService.showErrorDialog(p?{category:"StartPage",error:"NoLicenceVisio",fileType:e}:{category:"StartPage",error:"NoLicence",fileType:e})}));case s.b.Stream:case s.b.ScreenRecording:return void this.createStreamService.createStreamContent(this.clientStartupConfigService.config.sharedClientStartupContext.correlationId,e,l,n);case s.b.PlayLists:case s.b.PlayList:return void(this.capabilitiesService.capabilities.createStreamPlaylistEnabled&&this.createStreamService.createStreamContent(this.clientStartupConfigService.config.sharedClientStartupContext.correlationId,s.b.PlayList,l,n,this.capabilitiesService.capabilities.createPlaylistWithNewUrlEnabled));default:return this.createItemHelper(e,t,i,n,r,a,o,l,c)}}createItemFromManifest(e,t){const i=Date.now(),n=this.isPwa?void 0:this.windowService.nativeWindow.open("","_blank");return new Promise((r=>this.requestNewItemFromManifest(e.FileType,e.IsThirdParty?e.ThirdPartyCreateUrl:e.Url,n,t,i,r)))}static getCreateButtonBackground(e){return s.b[e]+"_ButtonBackground"}createItemHelper(e,t,a,o,l="",c,u,d,h){const p=this.createLinkCandidates.get(e);if(!p)return o&&o({type:"Error",latency:0,errorMsg:"NotFound",debugInfo:`${s.b[e]} candidate not found`}),Promise.resolve();const m=()=>{const m=this.shouldOpenInUIHost(e,l);return new Promise((b=>{const v=u||this.getNewDocLinkTarget(e),S=e=>{o&&o(e),b("CreatePending"===e.type)};if(("_self"===v||m)&&this.numCreatesPending>0)S({type:"CreatePending",latency:-1,errorMsg:"MultipleCreates",debugInfo:`createsPending=${this.numCreatesPending}`});else if(this.numCreatesPending++,p.canCreateBlankDocument){const i=Date.now(),u=this.windowService.nativeWindow;let S;const y=n=>{if(p.createDocAspxEnabled&&!m){const r=this.getDocAspxApiUrl(p.docAspxId,this.getOriginParam(!0,!!a),i,a?a.AssetId:null,l),s=this.accessTokenService.getAccessToken("OneDrive");Promise.all([r,s]).then((r=>{const s=r[0],l=r[1];if(!l||!l.success)return void this.requestNewItem(p,e,i,t,S,b,o,n,a,c,null,d);let m;"_blank"===v?(S=u.open("","_blank"),this.newTabWindow=S):S=u,S&&S!==u?(S.document.write("<!doctype html> <html> <head> </head> <body> </body> </html> "),m=S.document):m=this.documentService.nativeDocument;const f=this.getDocaspxFormHtml(s,l.token);this.documentService.appendHTMLToElement(m.body,f);const g=m.getElementById("create-new-doc-form");if(g){const e=Date.now()-i;o&&o({type:"GoToBlankDocInstant",latency:e,platform:"Web",errorMsg:"Ok",debugInfo:"docaspx successful"}),g.submit(),b()}else this.requestNewItem(p,e,i,t,S,b,o,n,a,c,null,d,h)})).catch((()=>{this.requestNewItem(p,e,i,t,S,b,o,n,a,c,null,d,h)}))}else this.requestNewItem(p,e,i,t,S,b,o,n,a,c,l,d,h)},C={NativeWindow:()=>{S=u},Blank:()=>{this.capabilitiesService.capabilities.contentLauncherEnabled||(S=u.open("","_blank"),this.newTabWindow=S)}},w=this.isPwa||m||"_blank"!==v||this.fluidSupportEnabled&&e===s.b.Fluid?C.NativeWindow:C.Blank;switch(e){case s.b.OneNote:this.instrumentationService.logClickEvent("OneNote_Notebook_Create_Link_Click","OneNoteNotebookCreateLink",d),Object(n.a)({eventName:"OneNote_Notebook_Create_Link_Click",id:"OneNoteNotebookCreateLink",area:d||"InputDialog",result:"Open",target:"Other"});const t=this.templatesConfigService.resources(e);return void this.inputDialogService.showInputDialog(class{static createOnenoteNotebookDialog(e,t,i,n,r){const a=[e=>f.isNotEmptyString(e)?null:{isValid:!1,message:""},t=>f.hasNoInvalidCharacter(t,["?","*","\\","/",":","<",">","|","'"])?null:{isValid:!1,message:e.CreateNewNoteBookNameInvalidChars},t=>f.isNotStartingWithSpace(t)?null:{isValid:!1,message:e.CreateNewNoteBookNameCannotStartWithSpace},t=>f.isContainingLessThanLimitedCharacters(t,128)?null:{isValid:!1,message:e.CreateNewNoteBookNameExceeds128Chars}],o=t=>{s.inputValidator=e=>l(e,[...a]),i.getNoteBooks(t).results.toPromise().then((t=>{if(t&&t.value&&t.value.length){const i=[].concat(a);i.push((i=>f.hasNoDuplicates(i,t.value.map((e=>e.displayName)),!0)?null:{isValid:!1,message:e.CreateNewNoteBookNameAlreadyExist})),s.inputValidator=e=>l(e,i)}}))},s={title:t.CreateNewBlankText,placeholder:t.CreateFileDialogOneNoteInputPlaceholder,dismissAction:r},l=(e,t)=>{for(const i of t){const t=i(e);if(t)return t}return{isValid:!0,message:""}};return s.inputValidator=e=>l(e,[...a]),o("cache-first-network-onmiss"),s.inputButtonModel={executeAction:e=>{n(e),o("network-first")},text:e.CreateFileDialogButtonText},s.componentArea=g.b.Templates,s}}.createOnenoteNotebookDialog(this.locService,t,this.oneNoteGraphService,(e=>{w(),y(e)}),(()=>{this.numCreatesPending--})));case s.b.OneNotePage:return this.instrumentationService.logClickEvent("OneNote_Page_Create_Link_Click","OneNotePageCreateLink",d),Object(n.a)({eventName:"OneNote_Page_Create_Link_Click",id:"OneNotePageCreateLink",area:d||"InputDialog",result:"Open",target:"Other"}),void this.mruDataService.getMruDocuments(new Set([s.b.OneNote])).results.pipe(Object(r.a)(1)).toPromise().then((e=>{this.createOneNotePageDialogService.showOneNotePageDialog({notebookItems:e&&e.items||[],onClick:()=>o({type:"GoToBlankDoc",latency:0})})}));default:w(),y()}}else{const e=()=>{if(t&&p.canFallbackToLandingPage)return this.capabilitiesService.capabilities.contentLauncherEnabled?void Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((e=>{e.launchUrl(t,{action:"CreateNewFallback"}).then((()=>{S({type:"GoToLanding",latency:0,platform:"Web",errorMsg:"Ok",debugInfo:"fallback to landing page"})})).catch((()=>{this.showError("Generic",p.fileType,"OpenFailed",t),S({type:"Error",latency:0,errorMsg:"LaunchFailed",debugInfo:"failed to launch fallback to landing page"})}))})):void this.urlLauncherService.openUrl(t,"CreateNewFallback").then((()=>{S({type:"GoToLanding",latency:0,platform:"Web",errorMsg:"Ok",debugInfo:"fallback to landing page"})})).catch((()=>{this.showError("Generic",p.fileType,"OpenFailed",t),S({type:"Error",latency:0,errorMsg:"LaunchFailed",debugInfo:"failed to launch fallback to landing page, contentLauncherNotEnabled"})}));this.showError("Generic",p.fileType),S({type:"Error",latency:0,errorMsg:p.canFallbackToLandingPage?t?"LaunchFailed":"NotFound":"Disabled",debugInfo:p.canFallbackToLandingPage?t?"launch office app failed":"fallback url undefined":"fallback disabled"})};this.launchOfficeApp(p.fileType).then((()=>{S({type:"GoToLanding",latency:0,platform:"Native",errorMsg:"Ok",debugInfo:"launch office app successful"})})).catch((()=>{e()}))}})).then((e=>{e||this.numCreatesPending--}))};return[s.b.Excel,s.b.Visio].includes(e)&&!a&&this.capabilitiesService.capabilities.pwaEnabled?this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((t=>t.launchApp({action:"OpenDocument",event:event,appName:s.b[e],url:""}).then((e=>e.success?(o&&o({type:"GoToLanding",latency:0,platform:"Native",errorMsg:"Ok",debugInfo:"launch app not supporting 0-byte successful"}),Promise.resolve()):m())).catch(m))):this.localAppLauncherService.launchOfficeApp(s.b[e],"",null,!0).then((e=>e?(o&&o({type:"GoToLanding",latency:0,platform:"Native",errorMsg:"Ok",debugInfo:"launch app not supporting 0-byte successful"}),Promise.resolve()):m())).catch(m):m()}getFirstPartyAppsCreateLink(e){return new Promise((t=>{const i=this.appManifests.get(e);i?this.getFirstPartyGenericWorkload(i).then((e=>t(e?this.getCreateLinkForFirstPartyWorkload(e):null))).catch((()=>t(null))):t(null)}))}getThirdPartyAppsCreateLink(e){return new Promise((t=>{const i=this.appManifests.get(e);if(i){const e=this.getThirdPartyGenericWorkload(i);t(e?this.getCreateLinkForThirdPartyWorkload(e):null)}else t(null)}))}getFirstPartyGenericWorkload(e){return this.workloadsService.getWorkloads().then((t=>{var i;let n,r=t.find((t=>{var i;return(null==t?void 0:t.AppId)===e.name||(null===(i=t.AppId)||void 0===i?void 0:i.includes(e.name.replace(/\s/g,"")))}));if(!r){if(e.creationFileType!==s.b[s.b.Designer])return null;r=this.getDesignerWorkload()}if(e.creationFileType===s.b[s.b.Designer])n=r.Url+`&cid=${this.clientStartupConfigService.config.sharedClientStartupContext.correlationId}`;else{const t=null===(i=r.Url)||void 0===i?void 0:i.split("?");n=`${t[0]}${t[0].endsWith("/")?"":"/"}${e.staticTabs&&e.staticTabs[0]&&e.staticTabs[0].websiteUrl?e.staticTabs[0].websiteUrl:""}?${t[1]?t[1]+"&":""}${e.staticTabs&&e.staticTabs[0]&&e.staticTabs[0].contentUrl?e.staticTabs[0].contentUrl+"&":""}cid=${this.clientStartupConfigService.config.sharedClientStartupContext.correlationId}`}return{getId:()=>e.name.replace(/\s/g,""),Id:e.name.replace(/\s/g,""),Referral:e.name.replace(/\s/g,""),FileType:e.creationFileType?s.a.fileTypeNameToFileType(e.creationFileType):void 0,FileTypeNameLocalized:e.fileTypeNameLocalized,Url:n,Color:r.Color,IconUnicodeCodepointCssClass:r.IconUnicodeCodepointCssClass,Text:e.name,SubText:void 0,Title:e.staticTabs&&e.staticTabs[0].name||e.name,IsThirdParty:!1,IsNativeClientOnlyApp:!1,IconFont:void 0,Size:void 0,ClickCount:void 0,FirstOccurrence:void 0,LastOccurrence:void 0,InAppNav:void 0,ThirdPartyIcon:void 0,HideTile:void 0,ChangeColorInDarkMode:void 0,AppId:e.id,CollectorId:void 0,ThirdPartyCreateUrl:""}}))}getThirdPartyGenericWorkload(e){return{getId:()=>e.name,Id:e.name,Referral:e.name,FileType:s.b.ThirdParty,Url:"",Color:e.accentColor,IconUnicodeCodepointCssClass:"",Text:e.name,SubText:void 0,Title:e.name,IsThirdParty:!0,IsNativeClientOnlyApp:!1,IconFont:void 0,Size:void 0,ClickCount:void 0,FirstOccurrence:void 0,LastOccurrence:void 0,InAppNav:void 0,ThirdPartyIcon:e.largeImageUrl&&""!==e.largeImageUrl?e.largeImageUrl:e.smallImageUrl,HideTile:void 0,ChangeColorInDarkMode:void 0,AppId:e.id,CollectorId:void 0,ThirdPartyCreateUrl:e.staticTabs&&e.staticTabs[0]&&e.staticTabs[0].contentUrl}}getThirdPartyWorkload(e){return e===s.b.Trello?{getId:()=>"ShellTrello",Id:"ShellTrello",Referral:"Trello",FileType:s.b.Trello,Url:"",Color:"#008FE4",IconUnicodeCodepointCssClass:"ms-ohp-svg-Icon ms-ohp-Icon ms-ohp-Icon--trelloLogo",Text:void 0,SubText:void 0,Title:void 0,IsThirdParty:!1,IsNativeClientOnlyApp:!1,IconFont:void 0,Size:void 0,ClickCount:void 0,FirstOccurrence:void 0,LastOccurrence:void 0,InAppNav:void 0,ThirdPartyIcon:void 0,HideTile:void 0,ChangeColorInDarkMode:void 0,AppId:void 0,CollectorId:void 0,ThirdPartyCreateUrl:void 0}:null}getDesignerWorkload(){return{getId:()=>"DesignerAppId",Color:"#593EF2",IconUnicodeCodepointCssClass:"",IconFont:void 0,Id:"DesignerAppId",Referral:"Designer",Size:void 0,Text:void 0,SubText:void 0,Title:void 0,Url:"https://designer.microsoft.com/new?referrer=harmony",ClickCount:void 0,FirstOccurrence:void 0,LastOccurrence:void 0,InAppNav:void 0,FileType:s.b.Designer,FileTypeNameLocalized:void 0,ThirdPartyIcon:void 0,IsThirdParty:!1,IsNativeClientOnlyApp:!1,HideTile:void 0,ChangeColorInDarkMode:void 0,AppId:void 0,CollectorId:void 0,ThirdPartyCreateUrl:void 0}}getFluidWorkload(e){const t={getId:()=>"ShellFluid",Id:"ShellFluid",Referral:"Fluid",FileType:s.b.Fluid,Url:"",Color:"#0078D4",IconUnicodeCodepointCssClass:"ms-ohp-svg-Icon ms-ohp-Icon ms-ohp-Icon--fluidLogo",Text:void 0,SubText:void 0,Title:void 0,IsThirdParty:!1,IsNativeClientOnlyApp:!1,IconFont:void 0,Size:void 0,ClickCount:void 0,FirstOccurrence:void 0,LastOccurrence:void 0,InAppNav:void 0,ThirdPartyIcon:void 0,HideTile:void 0,ChangeColorInDarkMode:void 0,AppId:void 0,CollectorId:void 0,ThirdPartyCreateUrl:void 0};switch(e){case s.b.Fluid:return t;case s.b.FluidActivityBlueprint:return t.getId=()=>"ShellFluidAbp",t.Id="ShellFluidAbp",t.FileType=s.b.FluidActivityBlueprint,t.Url="",t}}requestNewItem(e,t,n,r,a,o,c,u,d,h,p,m,f){const g=e=>{c&&c(e),o()},b=()=>Date.now()-n,v=(t,n,r)=>{const s=(i,n,a)=>{this.showError("OpenFailed"===i&&"GoToBlankDoc"===r?"OpenNewDocFailed":"Generic",e.fileType,i,"OpenFailed"===i?t:""),g({type:"Error",latency:b(),errorMsg:n,debugInfo:null!=a?a:""})};if(t)return this.isPwa?this.capabilitiesService.capabilities.contentLauncherEnabled?void Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((e=>{e.launchUrl(t,{action:"OpenDocument"}).then((()=>{g({type:n,latency:b(),platform:"Web",errorMsg:"Ok",debugInfo:"launch url successful"})}),(()=>{s("OpenFailed","LaunchFailed","launchUrl failed")}))})):void this.urlLauncherService.openUrl(t,r).then((()=>{g({type:n,latency:b(),platform:"Web",errorMsg:"Ok",debugInfo:"launch url successful"})}),(()=>{s("OpenFailed","LaunchFailed","launchUrl failed, contentLauncherNotEnabled")})):void 0!==a.open?(c&&c({type:n,latency:b(),platform:"Web",errorMsg:"Ok",debugInfo:"launch url successful"}),this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((e=>{e.launchUrl(t,{action:"OpenDocument",linkTarget:"_top",targetTab:a})})):a.open(t,"_top"),void o()):void s("OpenFailed","Generic",`openUrl failed, targetTab.open is ${a.open}`);s("CreateFile","NotFound","url not found")},S=(t,i,n,o)=>{const s=()=>{if(r&&e.canFallbackToLandingPage)v(r,"GoToLandingFallback","CreateNewFallback");else{this.showError(t,e.fileType);const a=b();g({type:"Error",latency:a,errorMsg:e.canFallbackToLandingPage&&!r?"NotFound":e.canFallbackToLandingPage?"LaunchFailed":i,debugInfo:e.canFallbackToLandingPage&&!r?"fallback url undefined":e.canFallbackToLandingPage?"launch office app failed":`fallback disabled, ${n}`,httpCode:null!=o?o:""})}};this.launchOfficeApp(e.fileType,"",a).then((()=>{g({type:"GoToLandingFallback",latency:b(),platform:"Native",errorMsg:"Ok",debugInfo:"launch office app successful"})})).catch((()=>{s()}))},y=()=>{let r=null,y=null,C="GoToBlankDoc";switch(t){case s.b.Sway:r=this.swayService.createNew().then((e=>({canonicalUrl:e,webUrl:e})));break;case s.b.OneNote:r=this.oneNoteGraphService.createNewNotebook(u).then((e=>{const t=this.addLoginHint(e.links.oneNoteWebUrl.href);return{canonicalUrl:t,webUrl:t}}));break;case s.b.Forms:r=d?this.formsService.createFormFromTemplate(d,l.a.Users).then((e=>({canonicalUrl:e,webUrl:e}))):this.formsService.createForm(s.b.Forms,h,m).then((e=>({canonicalUrl:e,webUrl:e}))),C="CreateNewFallback";break;case s.b.FormsQuiz:r=this.formsService.createForm(s.b.FormsQuiz,h,m).then((e=>({canonicalUrl:e,webUrl:e}))),C="CreateNewFallback";break;default:[y,r]=this.createOneDriveFile(e,d?d.AssetId:null,n)}const w=this.shouldOpenInUIHost(t,p)?this.wacContentService.bootstrapZeroByteFile({fileName:y,fileType:t,wdOrigin:this.getOriginParam(!1,!!d)},n,r,null==d?void 0:d.AssetId,p):void 0;let I=!1;this.capabilitiesService.capabilities.contentLauncherEnabled||w&&(e.canOpenBlankDocInNativeApp?this.localAppLauncherService.shouldOpenInOfficeApp(s.b[e.fileType]).then((e=>{e||I||(I=!0,c&&c({type:"GoToBlankDoc",latency:b(),platform:"Web",errorMsg:"Ok",debugInfo:"route to content page successful"}),w(),o())})):(I=!0,c&&c({type:"GoToBlankDoc",latency:b(),platform:"Web",documentUrlPromise:r.then((e=>e.canonicalUrl)),errorMsg:"Ok",debugInfo:"route to content page successful"}),f||w(),o())),r.then((t=>{if(!I)if(I=!0,this.capabilitiesService.capabilities.contentLauncherEnabled)Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((i=>{i.launchContent({action:"OpenDocument",document:{canonicalUrl:t.canonicalUrl,webUrl:t.webUrl,app:s.b[e.fileType],attribution:"",url:t.canonicalUrl,extension:"",title:e.appName,id:t.docId||"",isRedeemed:!0},useWebUrl:!0,wdOriginType:"NEW"}).then((e=>{e.success?g({type:"GoToBlankDoc",latency:b(),platform:"Native",errorMsg:"Ok",debugInfo:"launch content successful"}):this.launchWebApp(t,C,v,c,o,b,w)})).catch((()=>{this.launchWebApp(t,C,v,c,o,b,w)}))}));else{if(!e.canOpenBlankDocInNativeApp)return void this.launchWebApp(t,C,v,c,o,b,w);this.launchOfficeApp(e.fileType,t.canonicalUrl,this.isPwa?this.windowService.nativeWindow:a).then((()=>{g({type:"GoToBlankDoc",latency:b(),platform:"Native",errorMsg:"Ok",debugInfo:"launch office app successful"})})).catch((()=>{this.launchWebApp(t,C,v,c,o,b,w)}))}})).catch((e=>{this.globalErrorHandler.handleError(e,"foSs8");const t=e&&e.error&&e.error.code||"";"404"===t?S("OneDriveProvisioning","GraphError","OneDriveProvisioning Error",t):e&&e.error&&"CAP_Error"===e.error.data?S(this.isMsa?"Generic":"ConditionalAccessFallback","GraphError","Graph CAP_Error",t):this.isMsa&&"403"===t?S("OneDriveDisabled","GraphError","OneDriveDisabled",t):t?S("Generic","GraphError","Other graph error",t):S("Generic","Generic","Generic error")}))};if(a||(a=this.windowService.nativeWindow),this.isPwa||void 0!==a.open){if(a!==this.windowService.nativeWindow)try{const e=this.getLoadingPageHtml(t);a.document.write(e)}catch(e){return this.globalErrorHandler.handleError(e,"T3UKJ"),void S("Generic","Generic","failed to write loading html")}this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((e=>{e.launchTemplate(s.b[t],d?d.TemplateBinaryUrl:null).then((e=>{if(!e)throw new Error("launchOfficeAppWithTemplate failed");g({type:"GoToBlankDoc",latency:b(),platform:"Native",errorMsg:"Ok",debugInfo:"launchOfficeAppWithTemplate successful"})})).catch((()=>{t===s.b.Fluid||t===s.b.FluidActivityBlueprint?(this.numCreatesPending--,this.launchFluidExperience(t)):y()}))})):this.localAppLauncherService.launchOfficeAppWithTemplate(s.b[t],d?d.TemplateBinaryUrl:null).then((e=>{if(!e)throw new Error("launchOfficeAppWithTemplate failed");g({type:"GoToBlankDoc",latency:b(),platform:"Native",errorMsg:"Ok",debugInfo:"launchOfficeAppWithTemplate successful"})})).catch((()=>{t===s.b.Fluid||t===s.b.FluidActivityBlueprint?(this.numCreatesPending--,this.launchFluidExperience(t)):y()}))}else S("Generic","NotFound","open() is undefined")}requestNewItemFromManifest(e,t,n,r,a,o){const s=e=>{r&&r(e),o()},l=()=>Date.now()-a;this.launchWebApp({canonicalUrl:t,webUrl:t},"OpenFile",((t,a,c)=>{const u=(i,n,r)=>{this.showError("OpenNewDocFailed",e,i,"OpenFailed"===i?t:""),s({type:"Error",latency:l(),errorMsg:n,debugInfo:r})};return this.isPwa?this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((e=>e.launchUrl(t,{action:c.toString()}).then((()=>{s({type:a,latency:l(),platform:"Web",errorMsg:"Ok",debugInfo:"launch url successful"})}),(()=>{u("OpenFailed","LaunchFailed","failed to launch url")})))):this.urlLauncherService.openUrl(t,c).then((()=>{s({type:a,latency:l(),platform:"Web"})}),(()=>{u("OpenFailed","LaunchFailed","failed to launch url, contentLauncherNotEnabled")})):(r&&r({type:a,latency:l(),platform:"Web"}),this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((e=>e.launchUrl(t,{action:c.toString(),linkTarget:"_top",targetTab:n}))):(n.open(t,"_top"),void o()))}),r,o,(()=>Date.now()-a))}createOneDriveFile(e,t,i){const n=`${e.newDocName}.${e.fileExtension}`,r=this.shouldOpenInUIHost(e.fileType);return[n,new Promise(((a,o)=>{const s=Date.now();this.oneDriveService.createNewFile(n,e.fileType,r).then((e=>{const n={};e.webDavUrl&&(n.canonicalUrl=this.addLoginHint(e.webDavUrl));let o=this.addLoginHint(e.webUrl);const l="action=editnew";o=o.replace(new RegExp("([?&])action[^&]*"),"$1action=editnew"),-1===o.lastIndexOf(l)&&(o=m.a.appendQuery(o,l)),t&&(o+=`&wdTpl=${t}`),(t||this.createLcidEnabled)&&(o+=`&wdlcid=${this.contextService.sharedContext.officeMarketLcid}`);const c=this.capabilitiesService.capabilities.scenarioId;c&&(o+=`&wdscenarioid=${c}`);const u=this.getOriginParam(!1,!!t);o=m.a.appendQuery(o,`wdNewAndOpenCt=${i}&ct=${i}&wdPreviousSession=${this.startupConfigService.config.sharedClientStartupContext.correlationId}&wdOrigin=${u}`),n.webUrl=o,r&&(e.parentReference&&(n.docId=e.id,n.driveId=e.parentReference.driveId,n.fileName=e.name),n.wopiFetchData={fetchDiagnostics:{startTime:s},wopiHostData:W.a.getWopiHostDataFromItem(e)}),a(n)})).catch((e=>{this.globalErrorHandler.handleError(e,"dYEKI"),o(e||"Creating new file failed")}))}))]}getNewDocLinkTarget(e){const t=this.createLinkCandidates.get(e);return this.capabilitiesService.capabilities.capPopupEnabled&&(e===s.b.Word||e===s.b.Excel||e===s.b.PowerPoint||e===s.b.Visio||e===s.b.OneNote)&&this.accessTokenService.hasCAPError("Graph")||e===s.b.Fluid||e===s.b.FluidActivityBlueprint?"_self":this.isPwa||"_blank"===this.contextService.sharedContext.defaultLinkTarget&&(this.clientStartupConfigService.config.authType===d.a.OrgId||!t.canCreateBlankDocument)?"_blank":"_self"}showError(e,t,i="CreateFile",n){this.newTabWindow&&(this.newTabWindow.close(),this.newTabWindow=null),this.errorDialogService.showErrorDialog({category:i,error:e,fileType:t,inputText:n})}getLoadingPageHtml(e){let t=" <!doctype html> <html> <head> <title>TITLE</title> <meta charset=utf-8 /> <style>body{margin:0;padding:0}.parent{text-align:center;width:100%;height:100%}.title{font-family:'Segoe UI SemiLight','Segoe UI WPC Semilight','Segoe UI',Segoe,Tahoma,Helvetica,Arial,sans-serif;font-size:30px;margin-bottom:-12px}.load_center{position:absolute;left:0;right:0;bottom:50%}.spinner{display:inline-block;margin:25px auto;border-radius:50%;border:1.5px solid #d9d9d9;border-top-color:SPINNERCOLOR;width:40px;height:40px;-webkit-animation:spinAnimation 1.3s infinite cubic-bezier(.53,.21,.29,.67);animation:spinAnimation 1.3s infinite cubic-bezier(.53,.21,.29,.67)}@-webkit-keyframes spinAnimation{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes spinAnimation{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}</style> </head> <body> <div class=parent> <div class=load_center> <div class=title>ONLINEAPPNAME</div> <br> <span role=presentation class=spinner></span> </div> </div> </body> </html> ";return t=t.replace("TITLE",this.locService.CreateNewDocumentLoadingPageTitle),t=t.replace("SPINNERCOLOR",this.getWorkloadSpinnerColor(e)),t=t.replace("ONLINEAPPNAME",this.getWorkloadOnlineName(e)),t}getDocaspxFormHtml(e,t){return"<form id=create-new-doc-form method=post action=APIURL style=display:none target=_top><input id=create-new-doc-token name=access_token value=ONEDRIVETOKEN /></form> ".replace("APIURL",e).replace("ONEDRIVETOKEN",t)}getWorkloadOnlineName(e){const t=this.createLinkCandidates.get(e);return t?t.workloadOnlineName:""}getWorkloadSpinnerColor(e){const t=this.createLinkCandidates.get(e);return t&&t.spinnerColor?t.spinnerColor:"#2b579a"}getCreateLinkForWorkload(e,t,i){const n=t||e.FileType,r=this.createLinkCandidates.get(n);let a=e.Id;if(!r)return null;let o=e.Url;return n===s.b.Sway?o=m.a.appendQuery(o,"campaign=OHPCreateNew"):n!==s.b.Forms&&n!==s.b.FormsQuiz||(o=this.formsService.getCreateFormsLink(n,null,i),a=n===s.b.FormsQuiz?e.Id+"Quiz":e.Id),{ariaLabel:this.locService.format(this.locService.CreateMenuLinkAriaLabelFormat,r.title),title:r.title,fileTypeName:r.fileTypeName,appName:r.appName,icon:s.a.documentIconFromType(e.FileType,"32x32"),svgButtonBackground:G.getCreateButtonBackground(n),workload:e,url:o,creationFileType:n,getId:()=>a}}getCreateLinkForThirdPartyWorkload(e){return{ariaLabel:this.locService.format(this.locService.CreateMenuLinkAriaLabelFormat,e.Title),title:e.Text,fileTypeName:e.Text,appName:e.Text,icon:"",svgButtonBackground:"",workload:e,url:e.ThirdPartyCreateUrl,iconUrl:e.ThirdPartyIcon,creationFileType:s.b.ThirdParty,getId:()=>e.Id}}getCreateLinkForFirstPartyWorkload(e){return{ariaLabel:this.locService.format(this.locService.CreateMenuLinkAriaLabelFormat,e.Title),title:e.Title,fileTypeName:e.FileTypeNameLocalized,appName:e.Text,icon:e.FileType===s.b.List?null:e.FileType===s.b.Designer?"Designer_AppIcon":e.IconUnicodeCodepointCssClass,workload:e,url:e.Url,svgButtonBackground:G.getCreateButtonBackground(e.FileType),creationFileType:e.FileType,getId:()=>e.Id,createFromManifest:!0}}getDocAspxApiUrl(e,t,i,n,r){return new Promise(((a,o)=>{this.oneDriveService.getMyDriveRootUrl().then((s=>{const l=s.userRoot,c=l.lastIndexOf("/Documents");if(-1===c)return void o("docliburl not in expected format");let u=`${l.substring(0,c)}/_layouts/15/doc.aspx?action=editnew&doctype=${e}&wdOrigin=${t}&docliburl=${l}&ct=${i}`;n&&(u+=r?`&templateDriveId=${r}&templateItemId=${n}`:`&wdTpl=${n}`),(n||this.createLcidEnabled)&&(u+=`&wdlcid=${this.contextService.sharedContext.officeMarketLcid}`);const d=this.capabilitiesService.capabilities.scenarioId;d&&(u+=`&wdscenarioid=${d}`),this.capabilitiesService.capabilities.outgoingLoginHintEnabled&&(u+=`&login_hint=${encodeURIComponent(this.startupConfigService.config.loginHint)}`),a(u)})).catch((()=>{o("Failed to get doclib url")}))}))}getOriginParam(e,t){return this.contextService.getWdOrigin(t?e?"TEMPLATES-INSTANT":"TEMPLATES":e?"NEW-INSTANT":"NEW")}launchOfficeApp(e,t="",n){return this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((i=>i.launchApp({action:t?"OpenDocument":"OpenInApp",event:event,targetTab:n,appName:s.b[e],url:t,useUrl:!0}).then((e=>{if(!e.success)return Promise.reject()})))):this.localAppLauncherService.launchOfficeApp(s.b[e],t).then((e=>{if(!e)return Promise.reject()}))}shouldOpenInUIHost(e,t){return(!t||this.capabilitiesService.capabilities.wacHostOrgTemplatesEnabled)&&this.capabilitiesService.wacHostEnabledForFileType(e)&&this.wacHostApps&&this.wacHostApps.has(e)}launchWebApp(e,t,i,n,r,a,o){o?(n&&n({type:"GoToBlankDoc",latency:a(),platform:"Web"}),o(),r()):i(e.webUrl,"GoToBlankDoc",t)}launchFluidExperience(e){this.fluidHostContext.hostScenarioStartTime=Date.now(),this.setHostScenarioName(e),this.oneDriveService.getMyDriveRoot("network-first").then((t=>{const i=t.webUrl.lastIndexOf("/Documents");if(-1===i)return;const n=t.webUrl.substring(0,i);this.officeRouteService.navigateTo({route:"Content",app:s.b.Fluid},!1,{action:"editnew",abpId:e===s.b.Fluid?void 0:1,siteUrl:n,drive:t.parentReference.driveId})}))}addLoginHint(e){return m.a.appendLoginHint(e,this.startupConfigService.config.loginHint,this.capabilitiesService.capabilities.outgoingLoginHintEnabled)}setHostScenarioName(e){this.fluidHostContext.hostScenarioLifecycle="Create",this.fluidHostContext.hostScenarioName=e===s.b.Fluid?"Canvas":"BlueprintCanvas",this.fluidHostContext.hostScenarioEntryPoint=""}}G.menuOrdering=[s.b.Word,s.b.PowerPoint,s.b.Excel,s.b.Forms,s.b.FormsQuiz,s.b.OneNotePage,s.b.Sway,s.b.OneNote,s.b.Visio,s.b.FluidActivityBlueprint,s.b.Fluid,s.b.Stream],G.fluidFirstMenuOrdering=[s.b.FluidActivityBlueprint,s.b.Fluid,s.b.Word,s.b.PowerPoint,s.b.Excel,s.b.Forms,s.b.FormsQuiz,s.b.OneNotePage,s.b.Sway,s.b.OneNote,s.b.Visio,s.b.Stream],G.thirdPartyOrdering=[],G.firstPartyCreateIntentOrdering=[s.b.List,s.b.Yammer,s.b.PowerBI,s.b.Whiteboard,s.b.Designer],G.combinedMenuOrdering=[s.b.Word,s.b.PowerPoint,s.b.Excel,s.b.Forms,s.b.FormsQuiz,s.b.OneNote,s.b.List,s.b.OneNotePage,s.b.Sway,s.b.Visio,s.b.FluidActivityBlueprint,s.b.Fluid,s.b.Yammer,s.b.PowerBI,s.b.Whiteboard,s.b.Designer,s.b.Stream],G.fluidFirstCombinedMenuOrdering=[s.b.FluidActivityBlueprint,s.b.Fluid,s.b.Word,s.b.PowerPoint,s.b.Excel,s.b.Forms,s.b.FormsQuiz,s.b.OneNote,s.b.List,s.b.OneNotePage,s.b.Sway,s.b.Visio,s.b.Yammer,s.b.PowerBI,s.b.Whiteboard,s.b.Designer,s.b.Stream],G.fileTypeToConsumerWorkloadIdMap=new Map([[s.b.Word,"ShellWordOnline"],[s.b.PowerPoint,"ShellPowerPointOnline"],[s.b.Excel,"ShellExcelOnline"],[s.b.Forms,"ShellOfficeForms"],[s.b.FormsQuiz,"ShellOfficeForms"],[s.b.Sway,"ShellSway"]]),G.ɵprov=y.kc({factory:function(){return new G(y.lc(v.a),y.lc(u.a),y.lc(d.b),y.lc(h.a),y.lc(C),y.lc(w.a),y.lc(A),y.lc(_.a),y.lc(P.a),y.lc(o.a),y.lc(E.a),y.lc(a.b),y.lc(F.a),y.lc(g.a),y.lc(O.a),y.lc(p.a),y.lc(c.a),y.lc(D.a),y.lc(M.a),y.lc(x.a),y.lc(R.a),y.lc(d.b),y.lc(L.a),y.lc(U.a),y.lc(b.a),y.lc(N.a),y.lc(W.a),y.lc(j.a),y.lc(H.b),y.lc(B.a))},token:G,providedIn:"root"})},OtXi:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n=new(i("Mlb/").u)("WRAPPER_VERSION")},OyI4:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("BaAg"),r=i("pOWU"),a=i("uUrA");class o extends r.a{constructor(e,t,i,n,r,a,o,s,l,c,u,d){super(e,t,i,"MruPlusPlus",n,r,o,d),this.globalErrorHandler=s,this.startupConfigService=l;const h=this.contextService.sharedContext,p=a.config;this.supportedApps=u,this.serviceBaseUrl=this.inMockMode?`${h.officeHomeApiRoot}/${c}`:`${p.mruServiceRoot}/${c}`}requestParams(e,t){const i=t&&t.size?this.supportedApps.filter((e=>t.has(n.a.fileTypeNameToFileType(e)))):this.supportedApps;return`${o.appSpecifier}${i.join(",")}&${o.sizeSpecifier}${e}&${o.localeSpecifier}${this.contextService.sharedContext.officeMarket}`}getNewRequestConfig(e){return{headers:this.requestHeaders(e,a.a.createGuid())}}getRequestIdFromResponse(e){return super.getRequestIdFromResponse(e,"X-CorrelationId")}requestHeaders(e,t){const i=this.startupConfigService.config.sharedClientStartupContext,n=new Map([["X-Office-Platform","Web"],["X-Office-Application",this.contextService.sharedContext.iceApplicationId.toString()],["X-Office-Version",i.buildId],["X-CorrelationId",t]]);return e&&n.set("Content-Type","application/json"),n}}o.localeSpecifier="rs=",o.sizeSpecifier="show=",o.appSpecifier="apps="},PBJH:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("BaAg"),r=i("dFxn"),a=i("BMb5"),o=i("/I02"),s=i("Mlb/");class l{constructor(e,t,i){this.windowService=i,this.dateFormatOptionsMap=new Map,this.intlSupported=!0,this.officeMarket=e.sharedContext.officeMarket,this.setSupportsLocaleSpecifiers(),this.dateFormatOptionsMap.set(1,{year:"numeric",month:"short",day:"numeric"}),this.dateFormatOptionsMap.set(2,{year:"numeric",month:"long",day:"numeric",weekday:"long"}),this.dateFormatOptionsMap.set(3,{day:"numeric",weekday:"short"}),this.dateFormatOptionsMap.set(4,{day:"numeric",weekday:"long"}),this.dateFormatOptionsMap.set(5,{month:"short",day:"numeric"}),this.dateFormatOptionsMap.set(6,{weekday:"short"}),this.dateFormatOptionsMap.set(7,{hour:"numeric",minute:"numeric"}),this.intlDateFormatterMap=new Map,this.tryInitializeIntlFormatter();const n=t.parse("resourceStrings");n&&Object.assign&&Object.assign(this,n)}appResource(e,t){return this[`${e}${n.b[t]}`]||this[e]}format(e,...t){return class{static format(e,...t){if(!e)return e;let i=e;for(let e=0;e<t.length;e++){const n=new RegExp("\\{"+e+"\\}","gi");i=i.replace(n,(()=>t[e]))}return i}static getDuplicateItemName(e){const t=e.match(/(.*)\(([0-9]+)\)$/i),i=(e,t)=>e.trim()+` (${t})`;return t?i(t[1],parseInt(t[2])+1):i(e,2)}}.format(e,...t)}localizedDateString(e){return this.formatDate(e,0)}localizedDateStringMedium(e){return this.formatDate(e,1)}localizedDateStringLong(e){return this.formatDate(e,2)}localizedWeekdayDate(e){return this.formatDate(e,3)}localizedWeekdayDateLong(e){return this.formatDate(e,4)}localizedMonthDate(e){return this.formatDate(e,5)}localizedWeekday(e){return this.formatDate(e,6)}formatTimeFromDate(e){return this.intlSupported&&this.intlDateFormatterMap&&(this.intlDateFormatterMap.has(7)||this.tryInitializeIntlFormatter(7))?this.intlDateFormatterMap.get(7).format(e):this.supportsLocaleSpecifiers&&this.dateFormatOptionsMap?e.toLocaleTimeString(this.officeMarket,this.dateFormatOptionsMap.get(7)):e.toTimeString()}localizedNumberString(e){return this.intlNumberFormatter?this.intlNumberFormatter.format(e):this.supportsLocaleSpecifiers?e.toLocaleString(this.officeMarket):e.toString()}appName(e){switch(e){case n.b.Word:return this.WordName;case n.b.Excel:return this.ExcelName;case n.b.PowerPoint:return this.PowerPointName;case n.b.Sway:return this.SwayName;case n.b.OneNote:return this.OneNoteName;case n.b.Visio:return this.VisioName;case n.b.Forms:case n.b.FormsQuiz:return this.FormsName;case n.b.Stream:return this.StreamName;case n.b.Fluid:case n.b.FluidActivityBlueprint:return this.FluidName}return""}tryInitializeIntlFormatter(e){if(!this.intlSupported)return!1;try{if("Intl"in this.windowService.nativeWindow)return e?(this.intlDateFormatterMap.set(e,new Intl.DateTimeFormat(this.officeMarket,this.dateFormatOptionsMap.get(e))),this.dateFormatOptionsMap.delete(e),0===this.dateFormatOptionsMap.size&&(this.dateFormatOptionsMap=null)):(this.intlDateFormatterMap.set(0,new Intl.DateTimeFormat(this.officeMarket)),this.intlNumberFormatter=new Intl.NumberFormat(this.officeMarket)),!0}catch(e){}return this.intlSupported=!1,this.intlDateFormatterMap=null,this.intlNumberFormatter=null,this.dateFormatOptionsMap=null,!1}formatDate(e,t){if(this.intlSupported&&this.intlDateFormatterMap&&(this.intlDateFormatterMap.has(t)||this.tryInitializeIntlFormatter(t)))return this.intlDateFormatterMap.get(t).format(e);if(this.supportsLocaleSpecifiers){if(0===t)return e.toLocaleDateString(this.officeMarket);if(this.dateFormatOptionsMap){const i=this.dateFormatOptionsMap.get(t);return e.toLocaleDateString(this.officeMarket,i)}}return e.toDateString()}setSupportsLocaleSpecifiers(){this.supportsLocaleSpecifiers=(()=>{try{(0).toLocaleString("i")}catch(e){return"RangeError"===e.name}return!1})()}}l.ɵprov=s.kc({factory:function(){return new l(s.lc(o.a),s.lc(r.a),s.lc(a.b))},token:l,providedIn:"root"})},POe7:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{transform(e){if(e)return{email:e.upn,fullName:e.name}}}},PTf4:function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return o}));var n=i("BaAg");function r(e,t,i,r,a,o){if(i.config.moreTemplatesRedirectionEnabled)switch(e){case n.b.Visio:const e=Date.now();let s=i.config.visioMoreTemplatesUrl;s=`${s}&lpOrigin=OFFICECOM-WEB.START&correlationId=${a.config.sharedClientStartupContext.correlationId}&omkt=${t}&ds=${o.user.isGcc?"1":"0"}&ct=${e}`;const l=r.capabilities.scenarioId;return l&&(s=`${s}&scenarioid=${l}`),s;default:return}}function a(e,t,i){switch(e){case n.b.Visio:return!i.config.visioUnsupportedTemplatesLocales.includes(t);default:return!0}}function o(e,t,i){switch(i){case n.b.Stream:return e.format(e[t.config.streamPreviewString],t.config.streamDocumentationUrl,t.config.streamCrossLinkUrl);default:return}}},PZOQ:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i("PBJH");class n{constructor(e){this.locService=e}transform(e){return this.formatDataSize(e)}formatDataSize(e){let t=4,i=0;for(;i<1&&t>=0;)i=e/Math.pow(1024,t),t--;const n=i<10&&i%1>=.1?10:1;i=Math.round(i*n)/n;const r=this.locService.localizedNumberString(i);let a="";switch(t){case 3:a=this.locService.Terabytes;break;case 2:a=this.locService.Gigabytes;break;case 1:a=this.locService.Megabytes;break;case 0:a=this.locService.Kilobytes;break;case-1:a=this.locService.Bytes}return`${r} ${a}`}}},PkQn:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("Mlb/"),r=(i("4/We"),i("3anA"));i("A/um");class a{constructor(e){this.capabilitiesService=e,this.iconClicked=new n.q}ngOnInit(){this.classAttrValue=this.getClasses(),this.styleAttrValue=this.getStyle()}ngOnChanges(e){(e.hasOwnProperty("iconFontCssClass")||e.hasOwnProperty("iconFontType")||e.hasOwnProperty("iconFontName")||e.hasOwnProperty("cssClass"))&&(this.classAttrValue=this.getClasses()),(e.hasOwnProperty("size")||e.hasOwnProperty("color"))&&(this.styleAttrValue=this.getStyle())}handleClick(){this.iconClicked.emit()}getClasses(){let e=this.iconFontCssClass?this.iconFontCssClass:r.a.FluentIconCssClass;const t=this.capabilitiesService.capabilities.svgAppIconsEnabled;return this.iconFontCssClass||(this.iconFontName?e+=` ${r.a.getCssClassFromGlyphName(this.iconFontName,t)}`:void 0!==this.iconFontType&&(e+=` ${r.a.getCssClass(this.iconFontType,t)}`)),this.cssClass&&(e+=` ${this.cssClass}`),this.isThirdParty&&(e+=" ms-ohp-Icon"),e}getStyle(){const e=this.style?this.style:{};return this.size&&(e["font-size"]=`${this.size}px`),this.color&&(e.color=this.color),e}}},QOOv:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("dFxn"),r=i("Mlb/");class a{constructor(e){this.config=e.parse("mruConfig")||{activityEnabled:!1,activityStrings:{},addWacParams:!1,analyticsCachingEnabled:!1,analyticsEnabled:!1,clickableFolderEnabled:!1,copyLinkEnabled:!1,deferFeedWrite:!1,infiniteShowMoreEnabled:!1,isNewLifecycleEventEnabled:!1,isNewTimeWindowInHours:0,logThumbnailLoadSuccess:!1,maxInitialListItems:0,maxTotalListItems:0,mobileShareAndActivityEnabled:!1,mruActivityEnabled:!1,mruNumItemsToRequest:0,mruPinEnabled:!1,mruServiceRoot:null,newMruActions:!1,numRecommendedToRequest:0,officeFeedApiRootPath:"",officeFeedControlEnabled:!1,officeFeedFlightEnabled:!1,officeFeedFlightName:"",officeFeedFlightControlName:"",officeFeedExperimentName:"",officeFeedExperimentControlName:"",officeFeedFlight2Name:"",officeFeedFlight2ControlName:"",officeFeedExperiment2Name:"",officeFeedExperiment2ControlName:"",officeFeedFlight3Name:"",officeFeedFlight3ControlName:"",officeFeedExperiment3Name:"",officeFeedExperiment3ControlName:"",officeFeedNewSchemaEnabled:"",oneDriveDiscoverViewId:null,oneDriveRecentViewId:null,oneDriveSharedViewId:null,onlyMruActivityEnabled:!1,permissionsEnabled:!1,recommendedApiDismissedDocumentsPath:"",recommendedB2ApiRootPath:"",recommendedB2ApiFilesPath:"",recommendedB2EndpointEnabled:!1,recommendedCalloutEnabled:!1,recommendedEnabled:!1,recommendedFluidEnabled:!1,recommendedMotionEnabled:!1,recommendedNewCardsEnabled:!1,recommendedPdfEnabled:!1,recommendedRemoveItemEnabled:!1,recommendedVisioEnabled:!1,shareApiEndpoint:null,shareControlEnabled:!1,shareControlCAPPopupEnabled:!1,sharedAttachmentsEnabled:!1,sharedWithMeV2Enabled:!1,sharedWithMeViewEnabled:!1,sharingStatusEnabled:!1,showDownloadAction:!1,showZeroExperience:!1,substrateApiEndpoint:null,supportedFileTypes:[],supportedFileTypesSwM:[],swayTransformedFromWordAttributionEnabled:!1,tileViewEnabled:!1,thumbnailSWEnabled:!1,trendingAroundMeEnabled:!1,webUrlMruConsumerEnabled:!1,wordIconFontClass:"",excelIconFontClass:"",visioIconFontClass:"",powerPointIconFontClass:"",oneNoteIconFontClass:"",swayIconFontClass:"",formsIconFontClass:"",powerBIIconFontClass:"",streamIconFontClass:"",outlookIconFontClass:"",silentS2SFlow:!1,upcomingMeetingAttendeeDisplayMax:0,upcomingMeetingEnabled:!1,useFeedS2SApi:!1,myAnalyticsEnabled:!1}}}a.ɵprov=r.kc({factory:function(){return new a(r.lc(n.a))},token:a,providedIn:"root"})},QhWD:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("QjXU"),r=i("CCRL"),a=i("casz"),o=i("cgnd"),s=i("RsrG");class l{shouldLoad(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){}))}}class c{constructor(e,t){this.scheduler=e,this.modulePriorityService=t}shouldLoad(e){const t=this.modulePriorityService.getSchedulePriority(e);return new Promise((e=>this.scheduler.scheduleWork(e,t)))}}var u=i("Mlb/");class d{}d.ɵprov=u.kc({factory:function(){return((e,t,i)=>{try{switch(e.config.chunkLoadStrategy){case"idle-callback":return new c(t,i);case"noop":default:return new l}}catch(e){return new l}})(u.lc(o.b),u.lc(a.a),u.lc(s.a))},token:d,providedIn:"root"});class h{constructor(e,t,i){this.ngModuleLoader=e,this.injector=t,this.downloadStrategy=i,this.ngModuleCache=new Map}loadLazyViewFromModule(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){let t=this.ngModuleCache.get(e);t||(yield this.downloadStrategy.shouldLoad(e),t=(yield this.ngModuleLoader.load(e)).create(this.injector),this.ngModuleCache.set(e,t));const{injector:i,componentFactoryResolver:n}=t,a=i.get(r.a);return n.resolveComponentFactory(a)}))}}h.ɵprov=u.kc({factory:function(){return new h(u.lc(u.C),u.lc(u.r),u.lc(d))},token:h,providedIn:"root"})},QjXU:function(e,t,i){(function(i){var n,r,a,o,s,l,c,u,d,h,p,m,f,g,b,v,S,y,C,w,I,T,k,A;!function(_){var P="object"==typeof i?i:"object"==typeof self?self:"object"==typeof this?this:{};function E(e,t){return e!==P&&("function"==typeof Object.create?Object.defineProperty(e,"__esModule",{value:!0}):e.__esModule=!0),function(i,n){return e[i]=t?t(i,n):n}}void 0===(n=function(e){!function(e){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};r=function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)},a=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i},s=function(e,t,i,n){var r,a=arguments.length,o=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(o=(a<3?r(o):a>3?r(t,i,o):r(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},l=function(e,t){return function(i,n){t(i,n,e)}},c=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},u=function(e,t,i,n){return new(i||(i=Promise))((function(r,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function s(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?r(e.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(o,s)}l((n=n.apply(e,t||[])).next())}))},d=function(e,t){var i,n,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{i=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},h=function(e,t){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])},p=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},m=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,a=i.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o},f=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e},g=function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),r=0;for(t=0;t<i;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,r++)n[r]=a[o];return n},b=function(e,t,i){if(i||2===arguments.length)for(var n,r=0,a=t.length;r<a;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||t)},v=function(e){return this instanceof v?(this.v=e,this):new v(e)},S=function(e,t,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,r=i.apply(e,t||[]),a=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){r[e]&&(n[e]=function(t){return new Promise((function(i,n){a.push([e,t,i,n])>1||s(e,t)}))})}function s(e,t){try{!function(e){e.value instanceof v?Promise.resolve(e.value.v).then(l,c):u(a[0][2],e)}(r[e](t))}catch(e){u(a[0][3],e)}}function l(e){s("next",e)}function c(e){s("throw",e)}function u(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}},y=function(e){var t,i;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,r){t[n]=e[n]?function(t){return(i=!i)?{value:v(e[n](t)),done:"return"===n}:r?r(t):t}:r}},C=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e=p(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=e[i]&&function(t){return new Promise((function(n,r){!function(e,t,i,n){Promise.resolve(n).then((function(t){e({value:t,done:i})}),t)}(n,r,(t=e[i](t)).done,t.value)}))}}},w=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},I=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t},T=function(e){return e&&e.__esModule?e:{default:e}},k=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},A=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,i),i},e("__extends",r),e("__assign",a),e("__rest",o),e("__decorate",s),e("__param",l),e("__metadata",c),e("__awaiter",u),e("__generator",d),e("__exportStar",h),e("__values",p),e("__read",m),e("__spread",f),e("__spreadArrays",g),e("__spreadArray",b),e("__await",v),e("__asyncGenerator",S),e("__asyncDelegator",y),e("__asyncValues",C),e("__makeTemplateObject",w),e("__importStar",I),e("__importDefault",T),e("__classPrivateFieldGet",k),e("__classPrivateFieldSet",A)}(E(P,E(e)))}.apply(t,[t]))||(e.exports=n)}()}).call(this,i("pCvA"))},Qqp8:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("BaAg");function r(e){return e===n.b.Video||e===n.b.Stream||e===n.b.StreamsVideo}},QtYd:function(e,t,i){"use strict";i.d(t,"a",(function(){return Ue})),i.d(t,"b",(function(){return ze}));var n=i("Mlb/"),r=i("7IJ8"),a=i("QhWD"),o=i("hhzZ"),s=i("cgnd"),l=i("casz"),c=i("RsrG"),u=i("6Po3"),d=i("WLAd"),h=i("vk2e"),p=i("g0MB"),m=i("w1PR"),f=i("pzhl"),g=i("PkQn"),b=i("4/We"),v=i("9gjh"),S=i("7J/E"),y=i("PBJH"),C=i("/I02"),w=i("55A9"),I=i("TDzr"),T=i("7Gwk"),k=i("EYcb"),A=i("2lMP"),_=i("dx17"),P=i("qCYW"),E=i("pd4Y"),F=i("W3Zz"),O=i("hZW2"),D=i("C0xW"),M=i("Bc8L"),R=i("QOOv"),x=i("kfAr"),L=i("dOgD"),U=i("Z0U4"),N=i("Dpxn"),W=i("EqbI"),j=i("Uqr9"),H=i("1Bt+"),B=i("OPwp"),G=i("uNUv"),q=i("6u39"),V=i("TIi1"),$=i("Xc4i"),z=i("EUVs"),Z=i("BMb5"),K=i("hoyd"),J=i("7Rc8"),Q=i("DQbD"),Y=i("GmnP"),X=i("kpuN"),ee=i("U8M1"),te=i("gZ+X"),ie=i("mOWz"),ne=i("5WpM"),re=i("WJRI"),ae=i("kVgv"),oe=i("KoFE"),se=i("9c4X"),le=i("70cc"),ce=i("O6Zd"),ue=i("S5zL");class de extends ie.e{constructor(e){super(217,434,868),this.eventService=e,this.eventService.events.withScope(0).pipe(Object(le.a)((e=>"recommendedCardSize"===e.name)),Object(ce.a)((e=>({size:e.args[0],num:e.args[1]}))),Object(ue.a)(((e,t)=>e.size===t.size&&e.num===t.num))).subscribe((({size:e,num:t})=>{this.updateItemAndBufferSize(e,e*(t+1),e*(t+3))}))}}var he=i("Eup2"),pe=i("RJiy"),me=i("lrJm"),fe=i("rBEp"),ge=i("7wk3"),be=i("AXqk"),ve=i("xoWf"),Se=i("SPVw"),ye=i("Vwd8"),Ce=i("gO/A"),we=n.Fb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"fadeIn",definitions:[{type:1,expr:":enter",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{opacity:0},offset:null},{type:4,styles:{type:6,styles:{opacity:"{{ opacity }}"},offset:null},timings:"{{ fadeDuration }} 0ms linear"}],options:{params:{fadeDuration:"150ms",opacity:.5}}},options:{params:{fadeInDuration:"500ms",opacity:1}}},options:null}],options:{}},{type:7,name:"recommendedMotionTrigger",definitions:[{type:0,name:"moving",styles:{type:6,styles:{transform:"{{ translationParam }}"},offset:null},options:{params:{translationParam:"translateX(0)"}}},{type:1,expr:"*=>moving",animation:{type:4,styles:null,timings:"400ms ease-in-out"},options:null}],options:{}}]}});function Ie(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,3,"h3",[["class","ms-fcl-nd"],["id","recommendedHeader"]],null,null,null,null,null)),n.Gb(1,278528,null,0,h.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"list-header__title list-header__title--carousel":0,"list-header__title--fluent":1}),(e()(),n.gc(3,null,["",""]))],(function(e,t){var i=t.component,n=e(t,2,0,!i.fluentRefresh,i.fluentRefresh);e(t,1,0,"ms-fcl-nd",n)}),(function(e,t){e(t,3,0,t.component.recommendedTitle)}))}function Te(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,14,"div",[["class","carousel-nav"]],null,null,null,null,null)),n.Gb(1,278528,null,0,h.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"fluentvnext-background":0}),(e()(),n.Hb(3,0,[[3,0],["recommendedNavLeft",1]],null,5,"button",[["class","icon-button ms-bgc-g40-h ms-fcl-nd-h"],["data-clicklog","custom"],["id","recommended-nav-left"],["keyboardFocusTooltip",""]],[[1,"aria-label",0],[8,"title",0],[1,"aria-disabled",0],[8,"tabIndex",0]],[[null,"focus"],[null,"click"]],(function(e,t,i){var n=!0,r=e.component;return"focus"===t&&(n=!1!==r.onScrollFocus(!0)&&n),"click"===t&&(n=!1!==r.navigateCards(-1)&&n),n}),null,null)),n.Gb(4,278528,null,0,h.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(5,{"icon-button--disabled ms-fcl-nta":0,"ms-fcl-ns":1,"first-arrow":2,"icon-button--fluent":3}),n.Gb(6,4210688,null,0,p.a,[n.o,n.K,m.b],null,null),(e()(),n.Hb(7,0,null,null,1,"ohp-icon-font",[["cssClass","carousel-nav__arrow"],["iconFontName","ChevronLeft"],["size","16"]],null,null,null,f.b,f.a)),n.Gb(8,638976,null,0,g.a,[b.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null),(e()(),n.Hb(9,0,[[4,0],["recommendedNavRight",1]],null,5,"button",[["class","icon-button ms-bgc-g40-h ms-fcl-nd-h"],["data-clicklog","custom"],["id","recommended-nav-right"],["keyboardFocusTooltip",""]],[[1,"aria-label",0],[8,"title",0],[1,"aria-disabled",0],[8,"tabIndex",0]],[[null,"focus"],[null,"click"]],(function(e,t,i){var n=!0,r=e.component;return"focus"===t&&(n=!1!==r.onScrollFocus(!1)&&n),"click"===t&&(n=!1!==r.navigateCards(1)&&n),n}),null,null)),n.Gb(10,278528,null,0,h.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(11,{"icon-button--disabled ms-fcl-nta":0,"ms-fcl-ns":1,"icon-button--fluent":2}),n.Gb(12,4210688,null,0,p.a,[n.o,n.K,m.b],null,null),(e()(),n.Hb(13,0,null,null,1,"ohp-icon-font",[["cssClass","carousel-nav__arrow"],["iconFontName","ChevronRight"],["size","16"]],null,null,null,f.b,f.a)),n.Gb(14,638976,null,0,g.a,[b.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.isVisualRefresh);e(t,1,0,"carousel-nav",n);var r=e(t,5,0,0===i.currentCarouselPage,0!==i.currentCarouselPage,!i.fluentRefresh,i.fluentRefresh);e(t,4,0,"icon-button ms-bgc-g40-h ms-fcl-nd-h",r),e(t,8,0,"carousel-nav__arrow","ChevronLeft","16",!0);var a=e(t,11,0,i.currentCarouselPage+i.cardIncrement>=i.cards.length,i.currentCarouselPage+i.cardIncrement<i.cards.length,i.fluentRefresh);e(t,10,0,"icon-button ms-bgc-g40-h ms-fcl-nd-h",a),e(t,14,0,"carousel-nav__arrow","ChevronRight","16",!0)}),(function(e,t){var i=t.component;e(t,3,0,i.previousPage,i.previousPage,0===i.currentCarouselPage,0===i.currentCarouselPage?-1:0),e(t,9,0,i.nextPage,i.nextPage,i.currentCarouselPage+i.cardIncrement>=i.cards.length,i.currentCarouselPage+i.cardIncrement>=i.cards.length?-1:0)}))}function ke(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,5,"div",[],null,null,null,null,null)),n.Gb(1,278528,null,0,h.i,[n.x,n.y,n.o,n.K],{ngClass:[0,"ngClass"]},null),n.Zb(2,{"carousel-card--hidden":0,"carousel-card--display-none":1,"carousel-card-container carousel-card--peek":2,"carousel-card-container--fluent":3}),(e()(),n.Hb(3,0,null,null,2,"ohp-mru-item",[],null,[[null,"deleteItem"]],(function(e,t,i){var n=!0;return"deleteItem"===t&&(n=!1!==e.component.onDeleteRecommendedItem(i)&&n),n}),v.b,v.a)),n.bc(512,null,S.a,S.a,[y.a,C.a,w.a,I.a,T.a,k.a,s.b]),n.Gb(5,770048,null,0,A.a,[_.a,b.a,s.b,P.a,C.a,E.a,F.b,O.a,D.b,T.a,o.a,M.a,y.a,R.a,x.a,S.a,L.a,U.a,N.a,W.a,j.b,n.K,H.a,B.b,G.a,q.a,V.a,$.a,z.a,Z.b,K.a,J.a,Q.a,Y.a,X.a,ee.a],{item:[0,"item"],index:[1,"index"],relativeIndex:[2,"relativeIndex"],view:[3,"view"],listId:[4,"listId"],showActivity:[5,"showActivity"],showSharing:[6,"showSharing"],showAnalytics:[7,"showAnalytics"],mruAppType:[8,"mruAppType"]},{deleteItem:"deleteItem"})],(function(e,t){var i=t.component,n=e(t,2,0,"moving"!==i.motionState&&t.context.index<i.currentCarouselPage,"moving"!==i.motionState&&t.context.index>i.currentCarouselPage+i.cardIncrement+(i.visibleCardPeek?0:-1),!i.fluentRefresh,i.fluentRefresh);e(t,1,0,n),e(t,5,0,t.context.$implicit,t.context.index,t.context.index,i.recommendedDocView,i.listId,i.showActivity,i.showSharing,i.showAnalytics,i.fileType)}),null)}function Ae(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,2,null,null,null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,ke)),n.Gb(2,278528,null,0,h.j,[n.W,n.S,n.x],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),(e()(),n.qb(0,null,null,0))],(function(e,t){var i=t.component;e(t,2,0,i.recommendedMotionList,i.trackByIndex)}),null)}function _e(e){return n.jc(0,[(e()(),n.Hb(0,0,[[5,0],["virtualCard",1]],null,3,"div",[["class","carousel-card-container carousel-card--virtual-touch"]],null,null,null,null,null)),(e()(),n.Hb(1,0,null,null,2,"ohp-mru-item",[],null,[[null,"deleteItem"]],(function(e,t,i){var n=!0;return"deleteItem"===t&&(n=!1!==e.component.onDeleteRecommendedItem(i)&&n),n}),v.b,v.a)),n.bc(512,null,S.a,S.a,[y.a,C.a,w.a,I.a,T.a,k.a,s.b]),n.Gb(3,770048,null,0,A.a,[_.a,b.a,s.b,P.a,C.a,E.a,F.b,O.a,D.b,T.a,o.a,M.a,y.a,R.a,x.a,S.a,L.a,U.a,N.a,W.a,j.b,n.K,H.a,B.b,G.a,q.a,V.a,$.a,z.a,Z.b,K.a,J.a,Q.a,Y.a,X.a,ee.a],{item:[0,"item"],index:[1,"index"],relativeIndex:[2,"relativeIndex"],view:[3,"view"],listId:[4,"listId"],showActivity:[5,"showActivity"],showSharing:[6,"showSharing"],showAnalytics:[7,"showAnalytics"],mruAppType:[8,"mruAppType"]},{deleteItem:"deleteItem"})],(function(e,t){var i=t.component;e(t,3,0,t.context.$implicit,t.context.index+i.currentCarouselPage,t.context.index,i.recommendedDocView,i.listId,i.showActivity,i.showSharing,i.showAnalytics,i.fileType)}),null)}function Pe(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,5,null,null,null,null,null,null,null)),(e()(),n.Hb(1,0,null,null,4,"cdk-virtual-scroll-viewport",[["class","virtual-scroll-cards cdk-virtual-scroll-viewport"],["orientation","horizontal"]],[[2,"cdk-virtual-scroll-orientation-horizontal",null],[2,"cdk-virtual-scroll-orientation-vertical",null]],null,null,te.b,te.a)),n.bc(6144,null,ie.b,null,[ie.d]),n.Gb(3,245760,null,0,ie.d,[n.o,n.h,n.F,[2,ie.h],[2,ne.b],ie.f,[2,ie.i]],{orientation:[0,"orientation"]},null),(e()(),n.qb(16777216,null,0,1,null,_e)),n.Gb(5,409600,null,0,ie.c,[n.W,n.S,n.x,[1,ie.d],n.F],{cdkVirtualForOf:[0,"cdkVirtualForOf"],cdkVirtualForTrackBy:[1,"cdkVirtualForTrackBy"]},null)],(function(e,t){var i=t.component;e(t,3,0,"horizontal"),e(t,5,0,i.cards,i.trackByIndex)}),(function(e,t){e(t,1,0,"horizontal"===n.Wb(t,3).orientation,"horizontal"!==n.Wb(t,3).orientation)}))}function Ee(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,3,"div",[["class","carousel-card-container carousel-card--desktop"]],null,null,null,null,null)),(e()(),n.Hb(1,0,null,null,2,"ohp-mru-item",[],null,[[null,"deleteItem"]],(function(e,t,i){var n=!0;return"deleteItem"===t&&(n=!1!==e.component.onDeleteRecommendedItem(i)&&n),n}),v.b,v.a)),n.bc(512,null,S.a,S.a,[y.a,C.a,w.a,I.a,T.a,k.a,s.b]),n.Gb(3,770048,null,0,A.a,[_.a,b.a,s.b,P.a,C.a,E.a,F.b,O.a,D.b,T.a,o.a,M.a,y.a,R.a,x.a,S.a,L.a,U.a,N.a,W.a,j.b,n.K,H.a,B.b,G.a,q.a,V.a,$.a,z.a,Z.b,K.a,J.a,Q.a,Y.a,X.a,ee.a],{item:[0,"item"],index:[1,"index"],relativeIndex:[2,"relativeIndex"],view:[3,"view"],listId:[4,"listId"],showActivity:[5,"showActivity"],showSharing:[6,"showSharing"],showAnalytics:[7,"showAnalytics"],mruAppType:[8,"mruAppType"],leftAlignActionsMenu:[9,"leftAlignActionsMenu"]},{deleteItem:"deleteItem"})],(function(e,t){var i=t.component;e(t,3,0,t.context.$implicit,t.context.index+i.currentCarouselPage,t.context.index,i.recommendedDocView,i.listId,i.showActivity,i.showSharing,i.showAnalytics,i.fileType,!1)}),null)}function Fe(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,3,null,null,null,null,null,null,null)),(e()(),n.qb(16777216,null,null,2,null,Ee)),n.Gb(2,278528,null,0,h.j,[n.W,n.S,n.x],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),n.Yb(0,h.r,[]),(e()(),n.qb(0,null,null,0))],(function(e,t){var i=t.component;e(t,2,0,n.hc(t,2,0,n.Wb(t,3).transform(i.cards,i.currentCarouselPage,i.currentCarouselPage+i.cardIncrement)),i.trackByIndex)}),null)}function Oe(e){return n.jc(0,[n.cc(671088640,1,{carouselElement:0}),n.cc(671088640,2,{carouselContainer:0}),n.cc(671088640,3,{recommendedNavLeft:0}),n.cc(671088640,4,{recommendedNavRight:0}),n.cc(671088640,5,{virtualCards:1}),(e()(),n.Hb(5,0,null,null,1,"ohp-title-announcer",[],null,null,null,re.b,re.a)),n.Gb(6,49152,null,0,ae.a,[],{announcement:[0,"announcement"]},null),(e()(),n.Hb(7,0,[[2,0],["carouselContainer",1]],null,24,"div",[["class","carousel"]],[[8,"hidden",0],[24,"@fadeIn",0],[24,"@.disabled",0],[1,"aria-label",0]],null,null,null,null)),n.Gb(8,278528,null,0,h.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(9,{"carousel--fluent":0}),(e()(),n.Hb(10,0,null,null,6,"div",[],null,null,null,null,null)),n.Gb(11,278528,null,0,h.i,[n.x,n.y,n.o,n.K],{ngClass:[0,"ngClass"]},null),n.Zb(12,{"list-header--carousel--motion":0,"list-header list-header--carousel":1,"list-header--fluent":2}),(e()(),n.qb(16777216,null,null,1,null,Ie)),n.Gb(14,16384,null,0,h.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Te)),n.Gb(16,16384,null,0,h.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.Hb(17,0,null,null,14,"div",[],null,null,null,null,null)),n.Gb(18,278528,null,0,h.i,[n.x,n.y,n.o,n.K],{ngClass:[0,"ngClass"]},null),n.Zb(19,{"carousel--outer carousel--virtual-outer":0,"recommended-container__motion":1,"recommended-container__motion--fluent":2,"recommended-container__motion--hidden":3,"recommended-container__gap":4}),(e()(),n.Hb(20,0,[[1,0],["carouselElement",1]],null,11,"div",[],[[24,"@recommendedMotionTrigger",0]],[[null,"ohpResize"],[null,"@recommendedMotionTrigger.done"]],(function(e,t,i){var n=!0,r=e.component;return"ohpResize"===t&&(n=!1!==r.updateCarouselCardData()&&n),"@recommendedMotionTrigger.done"===t&&(n=!1!==r.recommendedMotionDone()&&n),n}),null,null)),n.Gb(21,278528,null,0,h.i,[n.x,n.y,n.o,n.K],{ngClass:[0,"ngClass"]},null),n.Zb(22,{"carousel--inner":0,"generic-tile-container generic-tile-container--card card__content":1,"recommended-inner__motion":2,"recommended-inner__motion--fluent":3,"generic-tile-container--card--fluent":4}),n.Gb(23,4407296,null,0,oe.a,[se.a,n.o,u.a],null,{resize:"ohpResize"}),n.Zb(24,{translationParam:0}),n.Zb(25,{value:0,params:1}),(e()(),n.qb(16777216,null,null,1,null,Ae)),n.Gb(27,16384,null,0,h.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Pe)),n.Gb(29,16384,null,0,h.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Fe)),n.Gb(31,16384,null,0,h.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,6,0,i.statusAnnouncement);var n=e(t,9,0,i.fluentRefresh);e(t,8,0,"carousel",n);var r=e(t,12,0,i.recommendedMotion,!i.fluentRefresh,i.fluentRefresh);e(t,11,0,r),e(t,14,0,i.cards&&i.cards.length>0),e(t,16,0,i.cards&&!i.canSwipeRecommended&&!(0===i.currentCarouselPage&&i.currentCarouselPage+i.cardIncrement>=i.cards.length));var a=e(t,19,0,i.canSwipeRecommended,i.recommendedMotion,i.recommendedMotion&&i.fluentRefresh,"moving"===i.motionState,i.recommendedMotion||i.fluentRefresh);e(t,18,0,a);var o=e(t,22,0,i.canSwipeRecommended,!i.canSwipeRecommended&&!i.recommendedMotion,i.recommendedMotion,i.recommendedMotion&&i.fluentRefresh,!i.recommendedMotion&&!i.canSwipeRecommended&&i.fluentRefresh);e(t,21,0,o),e(t,23,0),e(t,27,0,i.recommendedMotion),e(t,29,0,i.canSwipeRecommended),e(t,31,0,!i.canSwipeRecommended&&!i.recommendedMotion)}),(function(e,t){var i=t.component;e(t,7,0,!i.cards||!i.cards.length,void 0,i.disableAnimation,i.recommendedTitle);var n=e(t,25,0,i.motionState,e(t,24,0,i.translateX));e(t,20,0,n)}))}n.Db("ohp-recommended",he.a,(function(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,2,"ohp-recommended",[],null,null,null,Oe,we)),n.bc(4608,null,ie.h,de,[T.a]),n.Gb(2,8634368,null,0,he.a,[b.a,n.h,pe.a,C.a,ee.a,me.b,j.b,fe.a,ge.a,R.a,F.b,y.a,O.a,o.a,be.a,T.a,ve.a,Se.a,ye.b,L.a,s.b,Z.b,Ce.a],null,null)],(function(e,t){e(t,2,0)}),null)}),{carousel:"carousel",navClickLogging:"navClickLogging",fourCardsMax:"fourCardsMax",isSuggestedActions:"isSuggestedActions",componentArea:"componentArea",fileType:"fileType",isStartPage:"isStartPage"},{stateChanged:"stateChanged"},[]);var De=i("OOtI"),Me=i("+YV+"),Re=i("9MHL"),xe=i("JScD"),Le=i("mNaV"),Ue=n.Fb({encapsulation:2,styles:[],data:{}});function Ne(e){return n.jc(0,[(e()(),n.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),n.Gb(1,475136,null,0,r.a,[a.a,n.W,o.a,s.b,l.a,c.a,u.a,n.F,d.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),n.qb(0,null,null,0))],(function(e,t){e(t,1,0,"create-on-home#CreateOnHomeModule")}),null)}function We(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,2,"ohp-recommended",[],null,null,null,Oe,we)),n.bc(4608,null,ie.h,de,[T.a]),n.Gb(2,8634368,null,0,he.a,[b.a,n.h,pe.a,C.a,ee.a,me.b,j.b,fe.a,ge.a,R.a,F.b,y.a,O.a,o.a,be.a,T.a,ve.a,Se.a,ye.b,L.a,s.b,Z.b,Ce.a],{isSuggestedActions:[0,"isSuggestedActions"],fileType:[1,"fileType"],isStartPage:[2,"isStartPage"]},null)],(function(e,t){var i=t.component;e(t,2,0,i.isSuggestedActions,i.fileType,!!i.fileType)}),null)}function je(e){return n.jc(0,[(e()(),n.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),n.Gb(1,475136,null,0,r.a,[a.a,n.W,o.a,s.b,l.a,c.a,u.a,n.F,d.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),n.Zb(2,{fileType:0}),(e()(),n.qb(0,null,null,0))],(function(e,t){var i=e(t,2,0,t.component.fileType);e(t,1,0,"recommended-react#RecommendedReactModule",i)}),null)}function He(e){return n.jc(0,[(e()(),n.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),n.Gb(1,475136,null,0,r.a,[a.a,n.W,o.a,s.b,l.a,c.a,u.a,n.F,d.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),n.qb(0,null,null,0))],(function(e,t){e(t,1,0,"learning-shelf-react#LearningShelfReactModule")}),null)}function Be(e){return n.jc(0,[(e()(),n.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),n.Gb(1,475136,null,0,r.a,[a.a,n.W,o.a,s.b,l.a,c.a,u.a,n.F,d.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"],outputs:[2,"outputs"]},null),n.Zb(2,{headless:0,recentMruStreamData:1,fileType:2,maxInitialDocs:3,maxTotalDocs:4}),(e()(),n.qb(0,null,null,0))],(function(e,t){var i=t.component,n=e(t,2,0,i.headless,i.recentMruStream,i.fileType,i.maxInitialDocs,i.maxTotalDocs);e(t,1,0,"mru#MruModule",n,i.mruOutputs)}),null)}function Ge(e){return n.jc(0,[(e()(),n.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),n.Gb(1,475136,null,0,r.a,[a.a,n.W,o.a,s.b,l.a,c.a,u.a,n.F,d.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),n.Zb(2,{fileType:0}),(e()(),n.qb(0,null,null,0))],(function(e,t){var i=e(t,2,0,t.component.fileType);e(t,1,0,"edgeworth#EdgeworthModule",i)}),null)}function qe(e){return n.jc(0,[(e()(),n.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),n.Gb(1,475136,null,0,r.a,[a.a,n.W,o.a,s.b,l.a,c.a,u.a,n.F,d.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),n.qb(0,null,null,0))],(function(e,t){e(t,1,0,"quick-access#QuickAccessReactModule")}),null)}function Ve(e){return n.jc(0,[(e()(),n.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),n.Gb(1,475136,null,0,r.a,[a.a,n.W,o.a,s.b,l.a,c.a,u.a,n.F,d.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),n.Zb(2,{fileType:0}),(e()(),n.qb(0,null,null,0))],(function(e,t){var i=e(t,2,0,t.component.fileType);e(t,1,0,"ew-react#EdgeworthReactModule",i)}),null)}function $e(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,22,"div",[["class","mru-section section--fluent"],["id","mru-section"],["role","region"]],[[1,"aria-label",0]],null,null,null,null)),(e()(),n.Hb(1,0,null,null,1,"h2",[["class","visually-hidden"]],null,null,null,null,null)),(e()(),n.gc(2,null,["",""])),(e()(),n.Hb(3,0,[[1,0],["widthRestrictorElement",1]],null,19,"div",[],null,null,null,null,null)),n.Gb(4,278528,null,0,h.i,[n.x,n.y,n.o,n.K],{ngClass:[0,"ngClass"]},null),n.Zb(5,{"width-restrictor width-restrictor--responsive":0,"width-restrictor--no-gutter":1}),(e()(),n.qb(16777216,null,null,1,null,Ne)),n.Gb(7,16384,null,0,h.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.Hb(8,0,null,null,4,null,null,null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,We)),n.Gb(10,16384,null,0,h.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,je)),n.Gb(12,16384,null,0,h.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,He)),n.Gb(14,16384,null,0,h.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Be)),n.Gb(16,16384,null,0,h.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Ge)),n.Gb(18,16384,null,0,h.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,qe)),n.Gb(20,16384,null,0,h.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Ve)),n.Gb(22,16384,null,0,h.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,5,0,!i.noGutter,i.noGutter);e(t,4,0,n),e(t,7,0,i.createOnHomeEnabled),e(t,10,0,!i.recommendedReact),e(t,12,0,i.recommendedReact),e(t,14,0,i.learningShelfEnabled),e(t,16,0,(i.initialDocsAvailable||i.showZeroExperience)&&!i.edgeworthEnabled),e(t,18,0,i.edgeworthEnabled&&!i.edgeworthReactEnabled&&!i.quickAccessEnabled),e(t,20,0,i.edgeworthEnabled&&i.quickAccessEnabled),e(t,22,0,i.edgeworthEnabled&&i.edgeworthReactEnabled&&!i.quickAccessEnabled)}),(function(e,t){var i=t.component;e(t,0,0,i.sectionLandmarkAriaLabel),e(t,2,0,i.sectionLandmarkAriaLabel)}))}function ze(e){return n.jc(0,[n.cc(671088640,1,{widthRestrictorElement:0}),(e()(),n.Hb(1,0,null,null,4,"div",[["class","mru-component"]],null,null,null,null,null)),n.Gb(2,278528,null,0,h.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(3,{"section--first":0}),(e()(),n.qb(16777216,null,null,1,null,$e)),n.Gb(5,16384,null,0,h.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,3,0,i.firstSection&&(!i.leftNavReact||i.isConsumer)&&!i.visualBackgroundEnabled);e(t,2,0,"mru-component",n),e(t,5,0,i.initialDocsAvailable||i.showZeroExperience||i.hasRecommendedDocs||i.edgeworthEnabled)}),null)}n.Db("ohp-documents-component",De.a,(function(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-documents-component",[],null,null,null,ze,Ue)),n.Gb(1,4440064,null,0,De.a,[b.a,T.a,R.a,y.a,J.a,L.a,Me.a,pe.a,Re.a,xe.a,s.b,s.b,Le.a,C.a,Ce.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{firstSection:"firstSection",fileType:"fileType",headless:"headless",maxInitialDocs:"maxInitialDocs",maxTotalDocs:"maxTotalDocs",isSuggestedActions:"isSuggestedActions"},{mruStateChanged:"mruStateChanged"},[])},R0N1:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i("/I02");class n{constructor(e){this.contextService=e}ngOnInit(){this.target=this.contextService.sharedContext.defaultLinkTarget}}},R7NL:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var n=i("nTqU"),r=i("tyUq"),a=i("GMuP"),o=i("9W+p"),s=i("+2OL"),l=i("Ft/N"),c=i("JWB6"),u=i("3GGT"),d=i("wwmn"),h=i("Uqr9"),p=i("BMb5"),m=i("cgnd"),f=i("/I02"),g=i("hhzZ"),b=i("Mlb/"),v=i("5MEU");class S{constructor(e){this.promise=e}get[Symbol.toStringTag](){return"Promise"}instrument(e){return this.instrumentCallback=e,this}then(e,t){return this.promise.then(e,t)}catch(e){return this.promise.catch(e)}finally(e){return this.promise.finally(e)}}class y{constructor(e,t,i,n,r,a,o,s,l){this.httpClient=e,this.contextService=t,this.startupConfigService=i,this.instrumentationService=n,this.windowService=r,this.serviceWorkerStateService=o,this.serviceWorkerConfigService=s,this.workloadQueryParameterValue=l,this.officeHomeApiConfig=a.config}request(e,t,i,s,l,c,d,p){const m=h.a.now();let f=0;const b="cache-only"===s,v=new Promise(((e,t)=>{if(b){const e=this.serviceWorkerConfigService.config.enabled;if(!e||"Controlled"!==this.serviceWorkerStateService.currentState)return void t(y.failedResponseWithCode(u.a.NotImplemented,i,b,`Cache is not available. Service Worker is in ${e?this.serviceWorkerStateService.currentState:"disabled"} state`))}this.prepareRequest(i,s);const r={};i.headers&&i.headers.forEach(((e,t)=>{r[t]=e}));const a=!!l||!!c,h=a?"events":"response",m={headers:new n.i(r),params:new n.j({fromObject:i.params}),method:i.method,reportProgress:a,responseType:i.responseType,observe:h},f=new n.k(i.method,i.url,i.body,m),g=e=>{let t;return e instanceof n.l?t=e.body:e instanceof n.f&&(t=e.error),{data:t,status:e.status,headers:e.headers,config:i,ok:e.ok,statusText:e.statusText,fromCache:b}},v=this.httpClient.request(f).pipe(Object(o.a)(p||this.officeHomeApiConfig.defaultTimeoutInMs)).subscribe((t=>{t instanceof n.l?e(g(t)):t.type===n.g.UploadProgress&&l?l(t):t.type===n.g.DownloadProgress&&c&&c(t)}),(e=>{if("TimeoutError"===e.name)return void t(y.failedResponseWithCode(u.a.Timeout,i,b));const n=this.windowService.nativeWindow.navigator;t(!n||"boolean"!=typeof n.onLine||n.onLine?g(e):y.failedResponseWithCode(u.a.Offline,i,b))}));d&&d.onCancel((()=>v.unsubscribe()))})),C=new S(v),w=i=>{if(i.fromCache&&!i.ok&&i.status===u.a.NotImplemented)return;f=Math.ceil(h.a.now()-m);let n=i.status;null==n&&(n=y.unknownStatusCode);const o=i.statusText;let s,l=o;null==o?(s=y.unknownError,l=y.unknownError):s="ok"===o.toLowerCase()?o:new g.d(o);const c={};C.instrumentCallback&&C.instrumentCallback(i,c),c.hasOwnProperty("HttpCode")&&(n=c.HttpCode,delete c.HttpCode),Object(r.a)({eventName:t,error:l,latency:f,fromCache:i.fromCache,httpCode:n}),0!==Object.keys(c).length&&Object(a.a)({eventName:t,params:c}),this.instrumentationService.generateRequestEvent(e,n,f,s,i.fromCache,c).record()},I=d?d.onCancel((()=>Promise.resolve(y.failedResponseWithCode(u.a.Cancelled,i,b)))):new Promise((()=>{}));return Promise.race([v,I]).then(w,w),C}get(e,t,i,n,r,a,o,s){const l=Object.assign({},n);return l.url=i,l.method="GET",this.request(e,t,l,r,null,a,o,s)}post(e,t,i,n,r={},a,o,s,l,c){const u=Object.assign({},r);return u.url=i,u.method="POST",u.body=n,this.request(e,t,u,c||"network-only",a,o,s,l)}put(e,t,i,n,r={},a,o,s,l){const c=Object.assign({},r);return c.url=i,c.method="PUT",c.body=n,this.request(e,t,c,"network-only",a,o,s,l)}delete(e,t,i,n,r={},a,o){const s=Object.assign({},r);return s.url=i,s.method="DELETE",s.body=n,this.request(e,t,s,"network-only",null,null,a,o)}patch(e,t,i,n,r={},a,o,s,l){const c=Object.assign({},r);return c.url=i,c.method="PATCH",c.body=n,this.request(e,t,c,"network-only",a,o,s,l)}static failedResponseWithCode(e,t,i,r){return{data:null,status:e,headers:new n.i,config:t,ok:!1,statusText:r||u.a[e],fromCache:i}}prepareRequest(e,t){if("Controlled"===this.serviceWorkerStateService.currentState&&this.serviceWorkerConfigService.config.enabled&&(e.headers?e.headers.forEach(((t,i)=>{if(void 0===t){e.headers.set(i,"");const t={ItemCategory:"Malformed Request"};t.Error=`Undefined header passed to Service Worker: ${i}`,this.instrumentationService.logGenericEvent("Unhandled_Exception",t)}})):e.headers=new Map,e.headers.set(l.a,t)),0===e.url.lastIndexOf(`${this.contextService.sharedContext.officeHomeApiRoot}/`,0)){e.headers||(e.headers=new Map);const t=this.officeHomeApiConfig,i=this.startupConfigService.config;t.correlationIdHeader&&i.sharedClientStartupContext.correlationId&&e.headers.set(t.correlationIdHeader,i.sharedClientStartupContext.correlationId),t.userIdHeader&&i.puid&&e.headers.set(t.userIdHeader,i.puid),t.tenantIdHeader&&i.tenantId&&e.headers.set(t.tenantIdHeader,i.tenantId),t.authTypeHeader&&i.authTypeString&&e.headers.set(t.authTypeHeader,i.authTypeString),t.authVersionHeader&&i.authVersion&&e.headers.set(t.authVersionHeader,i.authVersion),e.params||(e.params={}),t.workloadQueryParameter&&(e.params[t.workloadQueryParameter]=this.workloadQueryParameterValue),i.sharedClientStartupContext.testTraffic&&t.testTrafficHeader&&e.headers.set(t.testTrafficHeader,"1"),!i.sharedClientStartupContext.corpNet&&t.externalTrafficHeader&&e.headers.set(t.externalTrafficHeader,"1"),(t.flightOverridesParamName&&t.flightOverrides||t.featureOverridesParamName&&t.featureOverrides)&&(t.flightOverridesParamName&&t.flightOverrides&&!e.params.hasOwnProperty(t.flightOverridesParamName)&&(e.params[t.flightOverridesParamName]=t.flightOverrides),t.featureOverridesParamName&&t.featureOverrides&&!e.params.hasOwnProperty(t.featureOverridesParamName)&&(e.params[t.featureOverridesParamName]=t.featureOverrides))}}}y.unknownError="NotAvailable",y.unknownStatusCode=-1,y.ɵprov=b.kc({factory:function(){return new y(b.lc(n.c),b.lc(f.a),b.lc(m.b),b.lc(g.a),b.lc(p.b),b.lc(d.a),b.lc(c.a),b.lc(s.a),b.lc(v.a))},token:y,providedIn:"root"})},RJiy:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var n=i("lrJm"),r=i("hhzZ"),a=i("R7NL"),o=i("QOOv"),s=i("7ma0"),l=i("kpuN"),c=i("wwmn"),u=i("casz"),d=i("ZtId"),h=i("BMb5"),p=i("4/We"),m=i("cgnd"),f=i("/I02"),g=i("9260"),b=i("Mlb/"),v=i("vk2e");class S{constructor(e,t,i,n,r,a,o,s,l,c,u,d,h,p){this.recommendedDataService=new g.a(e,t,i,n,r,a,o,s,l,c,u,d,h,p)}getRecommendedService(){return this.recommendedDataService}}S.ɵprov=b.kc({factory:function(){return new S(b.lc(l.a),b.lc(p.a),b.lc(f.a),b.lc(r.a),b.lc(a.a),b.lc(o.a),b.lc(c.a),b.lc(v.q),b.lc(n.b),b.lc(m.b),b.lc(d.a),b.lc(u.a),b.lc(h.b),b.lc(s.a))},token:S,providedIn:"root"});class y{}y.ɵprov=b.kc({factory:function(){return(e=>e.getRecommendedService())(b.lc(S))},token:y,providedIn:"root"})},"RR/o":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return d}));var n,r=i("kaEK"),a=i("BaAg"),o=i("o2Lt"),s=i("pOWU"),l=i("CVeG"),c=i("oAX+"),u=i("OyI4");!function(e){e[e.Default=0]="Default",e[e.FrequentlyOpen=1]="FrequentlyOpen",e[e.RecentlyOpen=2]="RecentlyOpen",e[e.WeeklyOpen=3]="WeeklyOpen",e[e.SingleEditYou=4]="SingleEditYou",e[e.MultipleEditYouAndOthers=5]="MultipleEditYouAndOthers",e[e.SingleCommentYou=6]="SingleCommentYou",e[e.MultipleCommentYouAndOthers=7]="MultipleCommentYouAndOthers",e[e.CommentReplyYou=8]="CommentReplyYou",e[e.SharedWithMe=9]="SharedWithMe",e[e.EmailAttachment=10]="EmailAttachment",e[e.SingleMentionYou=11]="SingleMentionYou",e[e.MultipleMentionYouAndOthers=12]="MultipleMentionYouAndOthers",e[e.CommentReplyOthers=13]="CommentReplyOthers",e[e.SnoozeExpiry=14]="SnoozeExpiry",e[e.CommentReplyToYou=15]="CommentReplyToYou",e[e.SingleEditOthers=16]="SingleEditOthers",e[e.MultipleEditOthers=17]="MultipleEditOthers",e[e.SingleCommentOthers=18]="SingleCommentOthers",e[e.MultipleCommentOthers=19]="MultipleCommentOthers",e[e.SingleMentionOthers=20]="SingleMentionOthers",e[e.MultipleMentionOthers=21]="MultipleMentionOthers",e[e.Trending=22]="Trending",e[e.Meeting=23]="Meeting",e[e.PeakMoment=24]="PeakMoment",e[e.HighEngagement=25]="HighEngagement",e[e.SingleMentionedYou=26]="SingleMentionedYou",e[e.MultipleMentionedYou=27]="MultipleMentionedYou",e[e.SingleTaskActivityByYou=28]="SingleTaskActivityByYou",e[e.MultipleTaskActivityByYou=29]="MultipleTaskActivityByYou",e[e.SingleTaskActivityByOthers=30]="SingleTaskActivityByOthers",e[e.MultipleTaskActivityByOthers=31]="MultipleTaskActivityByOthers",e[e.SingleTaskActivityYouAssignee=32]="SingleTaskActivityYouAssignee",e[e.MultipleTaskActivityYouAssignee=33]="MultipleTaskActivityYouAssignee",e[e.SingleTaskActivityYouCreator=34]="SingleTaskActivityYouCreator",e[e.MultipleTaskActivityYouCreator=35]="MultipleTaskActivityYouCreator"}(n||(n={}));class d extends u.a{constructor(e,t,i,n,r,a,o,s,l,c,u,d,h,p,m,f,g){super(e,t,i,n,r,o,s,l,c,"v2/recent",o.config.supportedFileTypes,h),this.userContextService=a,this.mruConfigService=o,this.performanceService=u,this.updateContentService=d,this.windowService=p,this.capabilitiesService=m,this.urlAuthenticatorService=f,this.deviceDetector=g,this.fetchRequestIndex=0,this.mruDataStreams=new Map,this.windowService=p}static convertMruActivityToActivityDescription(e){let t=e.badge.message_format,i=null;for(;null!==(i=d.activityRegex.exec(t));){const n=i[1];t=t.replace(i[0],(()=>`<c${n}>${e.badge.users[n].display_name}</c${n}>`))}return{formatString:t,plainText:l.a.stripTags(t),people:(e.badge.users||[]).map((function(e,t){return{upn:e.upn,tag:`c${t}`,name:e.display_name}})),reasonType:d.convertMruReasonTypeToActivityReason(e.badge.type),timestamp:e.badge.timestamp?new Date(e.badge.timestamp):null}}static convertMruReasonTypeToActivityReason(e){switch(e){case n.FrequentlyOpen:case n.RecentlyOpen:case n.WeeklyOpen:return r.a.Open;case n.SingleEditYou:case n.MultipleEditOthers:case n.MultipleEditYouAndOthers:case n.SingleEditOthers:return r.a.Edit;case n.SingleCommentYou:case n.SingleCommentOthers:case n.MultipleCommentOthers:case n.MultipleCommentYouAndOthers:case n.CommentReplyYou:case n.CommentReplyOthers:case n.CommentReplyToYou:return r.a.Comment;case n.SharedWithMe:return r.a.Share;case n.EmailAttachment:return r.a.Attachment;case n.SingleMentionYou:case n.MultipleMentionYouAndOthers:case n.SingleMentionOthers:case n.MultipleMentionOthers:case n.SingleMentionedYou:case n.MultipleMentionedYou:return r.a.Mention;case n.SnoozeExpiry:return r.a.SnoozeExpiry;case n.Trending:case n.PeakMoment:case n.HighEngagement:return r.a.Trending;case n.Meeting:return r.a.Meeting;case n.SingleTaskActivityByYou:case n.MultipleTaskActivityByYou:case n.SingleTaskActivityByOthers:case n.MultipleTaskActivityByOthers:case n.SingleTaskActivityYouAssignee:case n.MultipleTaskActivityYouAssignee:case n.SingleTaskActivityYouCreator:case n.MultipleTaskActivityYouCreator:return r.a.Task;default:return r.a.Default}}getMruDocuments(e){const t=this.getUrl(e),i=!(!e||!e.size);if(this.mruDataStreams.has(t))return this.mruDataStreams.get(t);let n;i&&this.mostRecentUnfilteredDocs&&this.mostRecentUnfilteredDocs.items&&(n=this.mostRecentUnfilteredDocs.items.filter((t=>e.has(a.a.fileTypeNameToFileType(t.FileType)))));const r=n&&n.length?Promise.resolve({items:n,impressionId:d.mruPlusPlusV2ImpressionId,fromCache:!0}):this.fetchMru(t,"cache-only",i),o=this.capabilitiesService.capabilities.prefetchDataEnabled?this.prefetchMru(i,t):this.fetchMru(t,"network-first",i),s=this.updateContentService.getOrAddUpdateStream(this.getUpdateStreamKey(t),(()=>this.fetchMru(t,"network-first",i))),l=c.a.createResultsWithCacheObservable(r,o,s,(e=>this.mruDataStreams.delete(t)),{items:[],impressionId:d.mruPlusPlusV2ImpressionId,fromCache:!1});if(this.mruDataStreams.set(t,l),this.mruConfigService.config.silentS2SFlow){const t=this.getS2SUrl(e);this.fetchMru(t,"network-only",i,!0)}return l}updateMruDocuments(e){return this.updateContentService.pushUpdate(this.getUpdateStreamKey(this.getUrl(e)))}removeDocument(e){return new Promise(((t,i)=>{this.delete("Mru_Delete","Mru_Delete",this.serviceBaseUrl,{category:e.Category,type:e.MruV2Type,app:e.Application,mru_id:e.MruId,url:e.Url},(e=>{e.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((()=>t(null)))}),i,this.getNewRequestConfig(!0))}))}updatePinnedState(e){return new Promise(((t,i)=>{this.post("Mru_Update_Pin","Mru_Update_Pin",this.serviceBaseUrl,{category:e.Category,type:e.MruV2Type,app:e.Application,mru_id:e.MruId,url:e.Url,is_pinned:e.IsPinned},(e=>{e.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((()=>t(null)))}),i,this.getNewRequestConfig(!0))}))}writeMruDocument(e){return new Promise(((t,i)=>{const n={category:e.Category,type:e.MruV2Type,app:e.Application,mru_id:e.MruId,url:e.Url,extension:a.a.getFileExtensionFromUrl(e.Url),title:e.Title,onedrive_info:{drive_id:e.DriveId,item_id:e.DocId}};this.post("Mru_Write","Mru_Write",this.serviceBaseUrl,n,(e=>{e.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((()=>t(null)))}),i,this.getNewRequestConfig(!0))}))}handleQueryParam(e,t,i){"mockmru"===e&&this.mockRequestHeader&&i.headers.set(this.mockRequestHeader,t)}isAuthError(e){return super.isAuthError(e,"MruPlusPlus")||-1===e}static isPwaProject(e){return e.meta_data&&"PJO"===e.meta_data.type&&e.app.toLowerCase()===a.b[a.b.Project].toLowerCase()}static fileType(e){let t=a.a.fileTypeFromExtension(e.extension);return t&&t!==a.b.None||(t="Project"===e.app&&e.meta_data&&"ProjectOperations"===e.meta_data.type?a.b.ProjectOperations:a.a.fileTypeNameToFileType(e.app)),t}getUrl(e){if(this.startupConfigService.config.sharedClientStartupContext.useMruS2SFlow)return this.getS2SUrl(e);const t=this.requestParams(this.mruConfigService.config.mruNumItemsToRequest,e);return`${this.serviceBaseUrl}/docs?${t}`}getS2SUrl(e){const t=this.requestParams(this.mruConfigService.config.mruNumItemsToRequest,e);return`${this.contextService.sharedContext.officeHomeApiRoot}/api/mru?${t}`}getUpdateStreamKey(e){return`mruplusplusv2-${e}`}fetchMru(e,t,i,n=!1){return new Promise(((r,o)=>{if(!this.userContextService.user.mruAvailable)return void o(new s.b(null,"User does not have an MRU"));let l,c,u,h;this.startupConfigService.config.sharedClientStartupContext.useMruS2SFlow||n?(l="None",c={},u="Mru_S2S_Request",h="Mru_S2S"):(l="MruPlusPlus",c=this.getNewRequestConfig(!1),u="Mru_Request",h="Mru"),this.get(u,h,e,(t=>{t.instrument(((t,i)=>{i.RequestId=this.getRequestIdFromResponse(t),i.Index=(this.fetchRequestIndex++).toString(),i.ImpressionId=d.mruPlusPlusV2ImpressionId;const n=t.headers;n&&(i.PartnerGeo=n.get("X-OfficeCluster")),t.data&&t.data.diagnostics_data&&void 0!==t.data.diagnostics_data.total_duration&&(i.MruDuration=t.data.diagnostics_data.total_duration.toString());const r=this.performanceService.getResourceTimingEntries(e);if(r&&r.length){const e=r[r.length-1];e.workerStart&&e.responseStart&&(i.ServiceWorkerProcessingLatency=Math.ceil(e.responseStart-e.workerStart).toFixed())}if(t.ok&&t.data){let e;e=t.data.documents&&t.data.documents.items?t.data.documents.items:[];const n=e.length;this.mruConfigService.config.mruPinEnabled&&this.mruConfigService.config.recommendedEnabled&&e.sort(((e,t)=>new Date(t.time_stamp).getTime()-new Date(e.time_stamp).getTime())),i.ActualSize=n.toString(),i.Distribution=a.a.distributionFromFileTypes(e.map((e=>d.fileType(e)))),i.MruPlusPlusV2MetaDataDistribution=e.map((e=>this.checkMetaData(e)?1:0)).toString(),this.mruConfigService.config.recommendedEnabled&&(i.ResourceIdDistribution=e.slice(0,12).map((e=>e.resource_id)).toString())}})).then((({data:e,fromCache:t})=>{if(n)r();else{const n=this.processMruData(e,i,t);r(n)}})).catch((e=>{this.globalErrorHandler.handleError(e,"hJU2J")}))}),o,c,t,null,null,null,l)}))}prefetchMru(e,t){return this.windowService.nativeWindow.prefetchMruDataPromise?new Promise((t=>{this.windowService.nativeWindow.prefetchMruDataPromise.then((i=>{const n=this.processMruData(i,e,!1);t(n)})).catch((e=>{this.globalErrorHandler.handleError(e,"hJU2J")}))})):this.fetchMru(t,"network-first",e)}checkMetaData(e){return e.onedrive_info&&!!e.onedrive_info.drive_id&&!!e.onedrive_info.item_id&&e.creation_info&&!!e.creation_info.timestamp&&e.sharepoint_info&&!!e.sharepoint_info.site_url}mruItemFromMruPlusPlusV2Item(e){const t=this.mruConfigService.config,i=new Date(e.time_stamp),n=t.swayTransformedFromWordAttributionEnabled;e.onedrive_info=e.onedrive_info||{},e.sharepoint_info=e.sharepoint_info||{},e.creation_info=e.creation_info||{},e.meta_data=e.meta_data||{};const r={DriveId:e.onedrive_info.drive_id,ItemId:e.onedrive_info.item_id,CreatedByUserEmail:e.creation_info.user_info&&e.creation_info.user_info.upn,CreatedByUserName:e.creation_info.user_info&&e.creation_info.user_info.display_name,CreatedDate:e.creation_info.timestamp,SPListId:e.sharepoint_info.list_id,SPListItemUniqueId:e.sharepoint_info.list_item_unique_id,SPSiteId:e.sharepoint_info.site_id,SPSiteUrl:e.sharepoint_info.site_url,SPWebId:e.sharepoint_info.web_id,SwayMetaData:{ThumbnailId:e.meta_data.SwayThumbnail,IsTransformedFromWord:n&&!!e.meta_data.SwayIsTransformedFromWord&&"true"===e.meta_data.SwayIsTransformedFromWord.toString().toLowerCase()},FormsMetaData:{category:e.meta_data.category,form_type:e.meta_data.form_type,owner_id:e.meta_data.owner_id,owner_name:e.meta_data.owner_name,owner_tenant_id:e.meta_data.owner_tenant_id,owner_type:e.meta_data.owner_type,primary_color:e.meta_data.primary_color,background_image:e.meta_data.background_image},PowerBIMetaData:{breadcrumb_url:e.meta_data.breadcrumb_url}},o=t.mruActivityEnabled,s=e.service_info?e.service_info.friendly_service_name:"";s&&(e.display_path=e.display_path||[],e.display_path.unshift(s));let l=!1;const c=d.fileType(e);return c!==a.b.MeetingNotes&&c!==a.b.Whiteboard||(l=!0),{DocId:r.ItemId,DriveId:r.DriveId,Extension:e.extension,FileName:e.title,Title:e.title,Url:l?e.web_url:e.url,WebUrl:e.web_url,LastAccessedTime:i,FileType:a.b[c],Provenance:a.e[a.e.OfficeMru],PathArray:e.display_path,IsPinned:e.is_pinned,Application:e.app,ResourceId:e.resource_id,Category:e.category,MruV2Type:e.type,MruId:e.mru_id,UrlAlreadyEncoded:!0,MetaData:r,Activity:e.activity_info&&o?d.convertMruActivityToActivityDescription(e.activity_info):void 0,Sharing:e.sharing_info&&o?e.sharing_info.state:void 0,LifecycleInfo:e.lifecycle_info&&o?!!e.lifecycle_info.flags:void 0,ServiceId:e.service_info?e.service_info.service_id:"",ServerDocId:e.server_doc_id}}convertToMruData(e,t=!1){let i;i=e.documents&&e.documents.items?e.documents.items:[];let n=i.filter((e=>("Sway"===e.app||"Portfolio"===e.app||"Project"===e.app||"Forms"===e.app||"Bohemia"===e.app||"Fluid"===e.app||"PowerBI"===e.app||-1===e.url.lastIndexOf("?"))&&!d.isPwaProject(e))).map((e=>this.mruItemFromMruPlusPlusV2Item(e)));const r=this.deviceDetector.isMobileDevice()||this.deviceDetector.isTabletDevice();return n.forEach((e=>{a.b[e.FileType]===a.b.Forms&&(e.Url=this.urlAuthenticatorService.appendPvrAndUpnAuthParams(e.Url),r&&(e.Url=e.Url.replace(o.b,o.a)))})),n=n.filter((e=>{var t,i,n;return a.b[e.FileType]!==a.b.Forms||"survey"!==(null===(n=null===(i=null===(t=e.MetaData)||void 0===t?void 0:t.FormsMetaData)||void 0===i?void 0:i.form_type)||void 0===n?void 0:n.toLowerCase())})),this.mruConfigService.config.mruPinEnabled&&n.sort(((e,t)=>t.LastAccessedTime.getTime()-e.LastAccessedTime.getTime())),{items:n,impressionId:d.mruPlusPlusV2ImpressionId,fromCache:t}}processMruData(e,t,i=!1){const n=this.convertToMruData(e,i);return t||(this.mostRecentUnfilteredDocs=n),n}}d.mruPlusPlusV2ImpressionId="MruPlusPlusV2Impression",d.activityRegex=new RegExp("{([0-9]+)}")},RitX:function(e,t,i){"use strict";i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return f}));var n=i("Mlb/"),r=i("vk2e"),a=i("mu6k"),o=i("W3Zz"),s=i("hZW2"),l=i("PBJH"),c=i("BMb5"),u=n.Fb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"openAndClose",definitions:[{type:1,expr:"* => openMobile",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{transform:"translate3d(0, 100%, 0)"},offset:null},{type:4,styles:{type:6,styles:{transform:"translate3d(0, 0, 0)"},offset:null},timings:"{{ slideDuration }} cubic-bezier(0.1, 0.9, 0.2, 1)"}],options:{params:{slideDuration:"300ms"}}},options:null},options:null},{type:1,expr:"* => open",animation:[{type:6,styles:{height:0},offset:null},{type:4,styles:{type:6,styles:{height:"*"},offset:null},timings:"300ms cubic-bezier(.1,.9,.2,1)"}],options:null},{type:1,expr:"open => closing",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{opacity:1},offset:null},{type:4,styles:{type:6,styles:{opacity:0},offset:null},timings:"{{ fadeDuration }} 0ms linear"}],options:{params:{fadeDuration:"100ms"}}},options:null},options:null}],options:{}}]}});function d(e){return n.jc(0,[(e()(),n.qb(0,null,null,0))],null,null)}function h(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,3,null,null,null,null,null,null,null)),(e()(),n.qb(16777216,null,null,2,null,d)),n.Gb(2,540672,null,0,r.o,[n.W],{ngTemplateOutletContext:[0,"ngTemplateOutletContext"],ngTemplateOutlet:[1,"ngTemplateOutlet"]},null),n.Zb(3,{item:0,index:1}),(e()(),n.qb(0,null,null,0))],(function(e,t){var i=t.component,n=e(t,3,0,t.parent.context.$implicit,t.parent.context.index);e(t,2,0,n,i.menuItemTemplate)}),null)}function p(e){return n.jc(0,[(e()(),n.Hb(0,0,[[2,0],["menuItem",1]],null,4,"li",[["tabindex","-1"]],[[8,"id",0],[1,"aria-label",0],[1,"aria-describedby",0],[1,"role",0],[1,"data-clicklog",0],[1,"data-area",0],[1,"aria-posinset",0],[1,"aria-setsize",0],[1,"aria-selected",0],[1,"aria-checked",0]],[[null,"click"],[null,"mouseenter"],[null,"keydown"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.onSelectItem(e.context.$implicit,e.context.index,i)&&n),"mouseenter"===t&&(n=!1!==r.setActiveIndex(e.context.index)&&n),"keydown"===t&&(n=!1!==r.handleKey(i)&&n),n}),null,null)),n.Gb(1,278528,null,0,r.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"menu-item--mobile":0}),(e()(),n.qb(16777216,null,null,1,null,h)),n.Gb(4,16384,null,0,r.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,r=n.Ob(1,"menu-item ms-bgc-g40-h ms-bgc-w ms-bgc-g40-f ms-bgc-g40-a ",t.context.$implicit.cssClass,""),a=e(t,2,0,i.mobileMenu);e(t,1,0,r,a),e(t,4,0,i.menuItemTemplate)}),(function(e,t){var i=t.component;e(t,0,0,i.getIdForItem(t.context.$implicit),t.context.$implicit.ariaLabel,t.context.$implicit.ariaDescribedBy,i.ariaRole,i.menuModel.customLogging?"custom":"",i.menuModel.customLogging?"":i.menuModel.hostComponentArea,t.context.index+1,i.menuModel.items.length,i.menuModel.announceItemIsSelected&&t.context.$implicit.ariaSelected,i.menuModel.announceItemIsSelected&&t.context.$implicit.ariaChecked)}))}function m(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,5,"div",[],[[1,"aria-label",0],[24,"@openAndClose",0]],[[null,"@openAndClose.done"]],(function(e,t,i){var n=!0;return"@openAndClose.done"===t&&(n=!1!==e.component.onAnimationCompleted(i)&&n),n}),null,null)),n.Gb(1,278528,null,0,r.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(2,{"menu--right":0,"menu--center":1,"menu--bottom":2,"context-menu--mobile":3}),(e()(),n.Hb(3,0,null,null,2,"ul",[["aria-haspopup","true"],["class","officeHome-callout-main menu__content ms-bgc-w"]],[[8,"id",0],[1,"role",0],[1,"aria-label",0]],null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,p)),n.Gb(5,278528,null,0,r.j,[n.W,n.S,n.x],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null)],(function(e,t){var i=t.component,r=n.Ob(1,"menu officeHome-callout ",i.menuModel.cssClass,""),a=e(t,2,0,i.menuModel.rightAligned&&!i.leftAlignedCard,i.menuModel.centerAligned,i.menuModel.bottomAligned,i.mobileMenu);e(t,1,0,r,a),e(t,5,0,i.menuModel.items,i.trackById)}),(function(e,t){var i=t.component;e(t,0,0,i.menuAriaLabel,i.animationState),e(t,3,0,n.Ob(1,"",i.menuModel.id,"-dropdown"),"menuitemcheckbox"===i.ariaRole||"radio"===i.ariaRole?"menu":"listbox",i.menuAriaLabel)}))}function f(e){return n.jc(0,[n.cc(671088640,1,{menuWrapper:0}),n.cc(671088640,2,{dropdownItems:1}),(e()(),n.qb(16777216,null,null,1,null,m)),n.Gb(3,16384,null,0,r.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,3,0,t.component.open)}),null)}n.Db("ohp-menu",a.a,(function(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,2,"ohp-menu",[],null,null,null,f,u)),n.Gb(1,4440064,null,1,a.a,[o.b,s.a,n.h,l.a,n.K,n.o,c.b],null,null),n.cc(603979776,1,{menuItems:1})],(function(e,t){e(t,1,0)}),null)}),{menuModel:"menuModel",animateClose:"animateClose",mobileMenu:"mobileMenu",leftAlignedCard:"leftAlignedCard",multiSelect:"multiSelect",contextAriaLabel:"contextAriaLabel",ariaRole:"ariaRole",selectedIndex:"selectedIndex"},{selectItem:"selectItem",closeMenu:"closeMenu"},[])},RsrG:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("Mlb/");class r{getSchedulePriority(e){switch(e){case"appbar#AppBarModule":case"app-gallery-angular#AppGalleryModule":case"app-gallery-react#AppGalleryReactModule":case"create-on-home#CreateOnHomeModule":case"edgeworth#EdgeworthModule":case"ew-react#EdgeworthReactModule":case"fluent-theme-provider#FluentThemeProviderModule":case"learning-shelf-react#LearningShelfReactModule":case"left-nav-react#LeftNavReactModule":case"mru#MruModule":case"new-consumer-experience#NewConsumerExperienceModule":case"new-user-shelf#NewUserShelfModule":case"quick-access#QuickAccessReactModule":case"recommended-react#RecommendedReactModule":case"workspace-nav#WorkspaceNavModule":return 0;case"auto-suggest#AutoSuggestModule":case"install#InstallModule":case"install-react#InstallReactModule":case"create-center#CreateCenterModule":case"create-center-react#CreateCenterReactModule":case"create-menu#CreateMenuModule":case"first-run#FirstRunModule":case"first-run-react#FirstRunReactModule":case"first-run-wrapper#FirstRunWrapperModule":case"places#PlacesModule":case"upload-button#UploadButtonModule":case"welcome-badge#WelcomeBadgeReactModule":return 1;case"upload-dialog#UploadDialogModule":case"banner#BannerModule":case"fluid-content#FluidContentModule":case"wac-content#WacContentModule":return 2;default:return 3}}}r.ɵprov=n.kc({factory:function(){return new r},token:r,providedIn:"root"})},RtYo:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.ActionContextMenuIcon="ActionContextMenuIcon",e.RenderIcon="RenderIcon",e.Url="Url",e.Svg="Svg",e.Brand="Brand"}(n||(n={}))},Ry9Z:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("BaAg"),r=i("QOOv"),a=i("m+UP"),o=i("Mlb/");class s{constructor(e,t){this.mruConfigService=e,this.swayService=t}getAnalytics(e,t){return"cache-only"===t&&!this.mruConfigService.config.analyticsCachingEnabled||e.fileType!==n.b.Sway?Promise.resolve(void 0):this.swayService.getAnalytics(e.url,t).then((e=>s.convertFromSwayAnalytics(e)))}prefetchAnalytics(e,t){if(t&&!this.mruConfigService.config.analyticsCachingEnabled)return;const i=e.filter((e=>e.fileType===n.b.Sway)).map((e=>e.url));this.swayService.prefetchAnalytics(i,t?"cache-only":"network-first")}static convertFromSwayAnalytics(e){if(e)return{viewCount:e.viewCount,averageTimeSpentMs:e.averageTimeSpent,averageCompletionRatio:e.AverageScrollDistance,glancedReads:e.glancedReads,quickReads:e.quickReads,deepReads:e.deepReads}}}s.ɵprov=o.kc({factory:function(){return new s(o.lc(r.a),o.lc(a.a))},token:s,providedIn:"root"})},"S8t+":function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("ERl3"),r=i("jV/k"),a=i("O6Zd"),o=i("vfyW"),s=i("uzn7"),l=i("3XMr"),c=i("Mlb/");class u{constructor(e,t){this.localStorageService=e,this.edgeworthDeltaSyncService=t,this.init()}getLastUiSyncTimestamp(){const e=this.localStorageService.get(u.UiSyncTimestampStorageKeyPrefix);return e?new Date(e):null}setLastUiSyncTimestamp(e){this.localStorageService.set(u.UiSyncTimestampStorageKeyPrefix,e.toISOString())}init(){this.uiTimestamp=Object(n.a)(Object(r.a)(this.getLastUiSyncTimestamp()),this.edgeworthDeltaSyncService.syncTimestampUpdated.pipe(Object(a.a)((()=>new Date)),Object(o.a)((e=>{this.setLastUiSyncTimestamp(e)}))))}}u.UiSyncTimestampStorageKeyPrefix=`_Edgeworth${window.ewWorkload}LastUiSyncTimestamp`,u.ɵprov=c.kc({factory:function(){return new u(c.lc(s.a),c.lc(l.a))},token:u,providedIn:"root"})},SPVw:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("6UlS"),r=i("uzn7"),a=i("Mlb/");class o{constructor(e){this.localStorageService=e,this._callouts=new n.a([]),this.callouts=this._callouts.asObservable()}addCallout(e){e.isValid()&&!this.calloutDismissed(e)&&(!e.completed&&this.calloutCompleted(e)&&(e.completed=!0),this._callouts.next(this._callouts.getValue().concat(e)))}addCallouts(e){const t=e.filter((e=>!(!e.isValid()||this.calloutDismissed(e)||(!e.completed&&this.calloutCompleted(e)&&(e.completed=!0),0))));this._callouts.next(this._callouts.getValue().concat(t))}clearCallouts(){this._callouts.next([])}dismissCallout(e){e.persistCompletion&&this.localStorageService.set(this.getCompletedKey(e.calloutType),!0),e.persistDismissal&&this.localStorageService.set(this.getDismissKey(e.calloutType),!0)}calloutDismissed(e){if(!e.persistDismissal)return!1;const t=this.getDismissKey(e.calloutType);return!!this.localStorageService.get(t)}calloutCompleted(e){if(!e.persistCompletion)return!1;const t=this.getCompletedKey(e.calloutType);return!!this.localStorageService.get(t)}getDismissKey(e){return`${o.calloutDismissedKeyPrefix}_${e}`}getCompletedKey(e){return`${o.calloutCompletedKeyPrefix}_${e}`}}o.calloutDismissedKeyPrefix="_FeatureCalloutDismissed",o.calloutCompletedKeyPrefix="_FeatureCalloutCompleted",o.ɵprov=a.kc({factory:function(){return new o(a.lc(r.a))},token:o,providedIn:"root"})},"T/SX":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},T6pR:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},TDzr:function(e,t,i){"use strict";i.d(t,"a",(function(){return x}));var n=i("WKA6"),r=i("5ZNw"),a=i("hhzZ"),o=i("R7NL"),s=i("p6Zr"),l=i("H90i"),c=i("JT1q"),u=i("7Rc8"),d=i("fKR7"),h=i("/I02"),p=i("clUe");class m{static objectToArrayHelper(e){return Array.isArray(e)?e:e?[e]:[]}}var f=i("uUrA"),g=i("pjz5"),b=i("BaAg"),v=i("4ach"),S=i("cgnd"),y=i("PBJH"),C=i("oAX+"),w=i("ZBli"),I=i("kpuN"),T=i("W3Zz"),k=i("7Gwk"),A=i("zwsB"),_=i("o2Lt"),P=i("Z0U4"),E=i("wwmn"),F=i("casz"),O=i("BJbw"),D=i("pOWU"),M=i("Mlb/"),R=i("vk2e");class x extends D.a{constructor(e,t,i,n,r,a,o,s,l,c,u,d,h,p,m,f,g){super(e,i,n,"Forms",r,o,c,u),this.eventService=t,this.locService=a,this.formsConfigService=s,this.officeRouteService=l,this.startupConfigService=d,this.clientStartupConfigService=h,this.urlAuthenticatorService=p,this.deviceDetector=m,this.templatesService=f,this.mruDataService=g,this.getFormsGroupsDataStreamCache=null,this.getMyFormsDataStreamCache=null,this.getSharedFormsDataStreamCache=null,this.getMyFormsResponsesCache=null,this.getFormsThemeMappingSetCache=null,this.getFormDataPromisesCache={},this.getFormsGroupMembersStreamCache={},this.getFormsInGroupDataStreamCache={};const b=this.clientStartupConfigService.config;this.startupConfigService.config.authType===S.a.MSA?(this.tenantId=this.formsConfigService.config.formsMsaTenantId,this.guid=this.convertConsumerPuidToGuid(b.puid)):(this.tenantId=b.tenantId,this.guid=b.objectId)}onInitFormsStartPage(){this.accessTokenService.getAccessToken("Forms",!1,null,!0,{category:"CreateFile",fileType:b.b.Forms}),this.setFormsCompromisedUserAlert()}getFormsTermsOfServiceUrl(){return this.formsConfigService.config.termsOfServiceLinkOrgId}getForm(e,t,i,n){return!n&&this.getFormDataPromisesCache[e]||(this.getFormDataPromisesCache[e]=new Promise(((n,r)=>{this.get("Get_Form","Get_Form",this.formsConfigService.config.formsApiPath+x.GET_FORM(this.tenantId,t,i,e),(e=>{e.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((e=>{if(e&&e.data&&e.data.id){const i=this.getFormUrl(e.data.id);e.data=Object.assign(Object.assign({},e.data),{fromCache:e.fromCache}),e.data.url=i,e.data.ownerPrincipalType=t,e.data.otherInfo&&(e.data.otherInfo=JSON.parse(e.data.otherInfo)),n(e.data)}}))}),r,this.getRequestConfig(),"network-first")}))),this.getFormDataPromisesCache[e]}unpinSharedForm(e){return new Promise(((t,i)=>{this.delete("Forms_Shared_UnpinRequest","Forms_Shared_Unpin",this.formsConfigService.config.formsApiPath+x.SHARED_FORM(e),null,(e=>{e.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((e=>{t(e.data)}))}),(e=>{i(e)}),this.getRequestConfig())}))}postCopyForm(e,t,i,n,r,a,o){const s=o===v.a.Groups;return new Promise(((l,c)=>{const u={newOwnerId:r,newTenantId:this.tenantId,isNewOwnerGroup:s,patchProperties:{title:t}},d=e=>{e.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((e=>{const t=e.data.otherInfo,i=this.getFormUrl(e.data.id),n=Object.assign(Object.assign({},e.data),{otherInfo:JSON.parse(t),url:i});this.clearCache(o,r),h.unsubscribe(),l(n)}))},h=(s?this.getFormsInGroup(r):this.getMyForms()).results.subscribe((r=>{if(!r||!r.fromCache){if(r&&r.value){const e=r.value.filter((e=>!e.softDeleted)).map((e=>e.title));u.patchProperties.title=function(e,t){if(-1!==t.indexOf(e)){let i=e+" ",n=1;const r=e&&e.match(/([\s\S]+)\(([1-9]\d*)\)$/);for(r&&3===r.length&&(i=r[1],n=parseInt(r[2],10));-1!==t.indexOf(e);)e=`${i}(${++n})`}return e}(t,e)}this.post("Forms_Copy_Request","Forms_Copy",this.formsConfigService.config.formsApiPath+x.COPY_FORMS_PATH(i,a,n,e),u,d,(e=>{c(e)}),this.getRequestConfig())}}))}))}createForm(e,t,i){return new Promise((n=>{n(this.getCreateFormsLink(e,(t||{type:"users"}).identifier,i))}))}createFormFromTemplate(e,t,i){const r=i||this.guid;return new Promise(((i,a)=>{this.templatesService.getTemplateContent(b.b.Forms,e.AssetId,e.TemplateBinaryUrl).results.pipe(Object(n.a)(1)).subscribe((n=>{this.post("Form_Create_Form_From_Template","Form_Create_Form_From_Template",this.formsConfigService.config.formsApiPath+x.CREATE_FORM_FROM_TEMPLATE(this.tenantId,t,r),n.data.Content.Value,(t=>{t.instrument(((t,i)=>{i.RequestId=this.getRequestIdFromResponse(t),i.ElementId=e.AssetId})).then((e=>{i(this.getCreateFormFromTemplateLink(e.data.id))}))}),(e=>{a(e)}),this.getRequestConfig(),null,null,null,null,void 0,null,null,null,!0,{category:"CreateFile",fileType:b.b.Forms})}))}))}postMoveForms(e,t,i,n,r){return new Promise(((a,o)=>{this.post("Recycle_Form_Request","Recycle_Form",this.formsConfigService.config.formsApiPath+x.MOVE_FORM_PATH(this.tenantId,t,i,e),{isNewOwnerGroup:n===v.a.Groups,newOwnerId:r},(e=>{e.instrument(((e,t)=>(t.RequestId=this.getRequestIdFromResponse(e),e))).then((e=>{this.clearCache(t,i),this.clearCache(n,r),a(e.data)}))}),(e=>{o(e)}),this.getRequestConfig())}))}getFormAuthenticatedCdn(e){const t=this.clientStartupConfigService.config.sharedClientStartupContext,i="prodprv"===t.deploymentEnvironment&&"scu"===t.geoName;let n=this.urlAuthenticatorService.appendPvrAndUpnAuthParams(this.formsConfigService.config.formsCdnPath+(e?_.c:this.deviceDetector.isMobileDevice()||this.deviceDetector.isTabletDevice()?_.a:_.b));return n=w.a.appendAndReplaceQueryParams(n,{origin:i?l.b:l.a,lang:this.contextService.sharedContext.officeMarket,sessionId:this.startupConfigService.config.sharedClientStartupContext.sessionId},!1,!0),n}getFormGroupThumbnailUrl(e){return this.getImage(this.formsConfigService.config.formsApiPath+x.MY_FORMS_GROUP_THUMBNAIL_PATH(e),"Forms_Group_Thumbnail_Fetch","Forms_Group_Thumbnail_Fetch")}getFormsInGroup(e,t){if(t&&(this.getFormsInGroupDataStreamCache[e]=null),this.getFormsInGroupDataStreamCache[e])return this.getFormsInGroupDataStreamCache[e];const i=t=>new Promise(((i,n)=>{this.get("Forms_From_Group_Request","Forms_From_Group",this.formsConfigService.config.formsApiPath+x.FORMS_FROM_GROUP(this.tenantId,e),(e=>{e.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((e=>{e&&e.data&&e.data.value&&(e.data=Object.assign(Object.assign({},e.data),{fromCache:e.fromCache}),e.data.value=m.objectToArrayHelper(e.data.value),e.data.value.forEach((e=>{e.otherInfo&&(e.otherInfo=JSON.parse(e.otherInfo)),e.ownerPrincipalType=v.a.Groups,e.url=this.getFormUrl(e.id)})),i(e.data))}))}),(e=>{n(e)}),this.getRequestConfig(),t)})),n=i("cache-only"),r=i("network-first"),a=C.a.createResultsWithCacheObservable(n,r,null,(t=>{this.getFormsInGroupDataStreamCache[e]=null}));return this.getFormsInGroupDataStreamCache[e]=a,this.getFormsInGroupDataStreamCache[e]}getFormsGroupMembers(e){if(this.getFormsGroupMembersStreamCache[e])return this.getFormsGroupMembersStreamCache[e];const t=t=>new Promise(((i,n)=>{this.get("Forms_Group_Members_Request","Forms_Group_Members",this.formsConfigService.config.formsApiPath+x.FORMS_GROUP_MEMBERS(e),(e=>{e.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((e=>{i(e.data)}))}),(e=>{n(e)}),this.getRequestConfig(),t)})),i=t("cache-only"),n=t("network-first"),r=C.a.createResultsWithCacheObservable(i,n,null,(t=>this.getFormsGroupMembersStreamCache[e]=null));return this.getFormsGroupMembersStreamCache[e]=r,r}getFormsGroups(){if(this.getFormsGroupsDataStreamCache)return this.getFormsGroupsDataStreamCache;const e=e=>new Promise(((t,i)=>{this.get("Forms_Groups_Request","Forms_Groups",this.formsConfigService.config.formsApiPath+x.MY_FORMS_GROUPS,(e=>{e.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((e=>{this.mruDataService.getMruDocuments(new Set([b.b.Forms])).results.subscribe((i=>{const n=new Map;i.items.forEach(((e,t)=>{"GroupForm"===e.Extension&&void 0===n[e.MetaData.FormsMetaData.owner_id]&&(n[e.MetaData.FormsMetaData.owner_id]=t)})),e.data.value.sort(((e,t)=>n[e.id]>=0&&n[t.id]>=0?n[e.id]-n[t.id]:n[e.id]>=0?-1:1)),t(e.data)})),this.mruDataService.getMruDocuments(new Set([b.b.Forms])).initialCompletion.then((i=>{i&&i.cacheError&&i.networkError&&t(e.data)}))}))}),(e=>{i(e)}),this.getRequestConfig(),e)})),t=e("cache-only"),i=e("network-first"),n=C.a.createResultsWithCacheObservable(t,i,null,(e=>this.getFormsGroupsDataStreamCache=null));return this.getFormsGroupsDataStreamCache=n,n}setFormsRecycleState(e,t,i,n){const r=n?"Recycle_Form_Request":"Restore_Form_Request",a=n?"Recycle_Form":"Restore_Form";return new Promise(((o,s)=>{this.patch(r,a,this.formsConfigService.config.formsApiPath+x.FORM_EDIT_OR_DELETE_PATH(this.tenantId,i,t,e),{softDeleted:n?1:0},(e=>{e.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((()=>{this.clearCache(i,t),o()}))}),(e=>{s(e)}),this.getRequestConfig())}))}hardDeleteForm(e,t,i){return new Promise(((n,r)=>{this.delete("Forms_Delete_Request","Forms_Delete",this.formsConfigService.config.formsApiPath+x.FORM_EDIT_OR_DELETE_PATH(this.tenantId,i,t,e),{},(e=>{e.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((()=>{this.clearCache(i,t),n()}))}),(e=>{r(e)}))}))}getCreateFormsLink(e,t,i){const n="Create",r="CreateQuiz",a=(e,t,i)=>`Action=${t}&Title=${e}${i?"&GroupId="+i:""}`;let o=this.getFormAuthenticatedCdn(!1);const s={Action:null,Fragment:null};if(e===b.b.Forms)s.Fragment=a(this.locService.NewFormsSurveyFileName,n,t),s.Action=n;else{if(e!==b.b.FormsQuiz)return null;o=o.replace(_.a,_.b),s.Fragment=a(this.locService.NewFormsQuizFileName,r,t),s.Action=r}return o=w.a.appendAndReplaceQueryParams(o,s,!0),this.appendQueryInformation(o,!0,i)}getFormUrl(e){return`${this.getFormAuthenticatedCdn(!1)}#FormId=${e}`}getAllMyFormsLink(){return Object.assign(Object.assign({},{title:this.locService.AllMyFormsRedirectLabel,tooltip:this.locService.AllMyFormsRedirectTooltip,ariaLabel:this.locService.AllMyFormsRedirectTooltip,referral:s.a.Forms,zeroTitle:this.locService.AllMyFormsRedirectLabel}),this.formsConfigService.config.neoPortalPageEnabled?{url:this.urlAuthenticatorService.appendPvrAndUpnAuthParams(this.getFormAuthenticatedCdn(!0))}:{onClick:()=>{this.officeRouteService.navigateTo({app:b.b.Forms,route:"MyForms"})}})}getCreateFormFromTemplateLink(e){let t=this.getFormAuthenticatedCdn(!1);return t=w.a.appendAndReplaceQueryParams(t,{Action:"CreateByTemplate",Fragment:`FormId=${e}`},!0),this.appendQueryInformation(t,!0)}getFormGroupMemberThumbnailUrl(e,t){return this.getImage(this.formsConfigService.config.formsApiPath+x.FORMS_MEMBER_THUMBNAIL_PATH(e,t),"Forms_Members_Thumbnail_Fetch","Forms_Members_Thumbnail_Fetch")}getMyFormsResponses(){return this.getMyFormsResponsesCache||(this.getMyFormsResponsesCache=new Promise(((e,t)=>{this.get("Forms_Responses","Forms_Responses",this.formsConfigService.config.formsApiPath+x.FORMS_RESPONSE_COUNT_PATH,(i=>{i.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((i=>{i&&i.data?e(m.objectToArrayHelper(i.data.value)):t()}))}),t,this.getRequestConfig(),"network-first")}))),this.getMyFormsResponsesCache}getSharedForms(){if(this.getSharedFormsDataStreamCache)return this.getSharedFormsDataStreamCache;const e=e=>new Promise(((t,i)=>{this.get("Shared_Forms_Request","Shared_Forms",this.formsConfigService.config.formsApiPath+x.SHARED_FORMS_PATH,(e=>{e.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((e=>{e&&e.data&&e.data.value?(e.data.value.sort(((e,t)=>e.modifiedDate===t.modifiedDate?0:e.modifiedDate<t.modifiedDate?1:-1)),e.data.value.forEach((e=>{e.id&&(e.url=this.getFormUrl(e.id),e.ownerPrincipalType=v.b.getOwnerPrincipalTypeToFormType(e.ownerType||e.ownerPrincipalType||e.OwnerPrincipalType))})),t(e.data)):i()}))}),(e=>{i(e)}),this.getRequestConfig(),e)})),t=e("cache-only"),i=e("network-first"),n=C.a.createResultsWithCacheObservable(t,i,null,(e=>this.getSharedFormsDataStreamCache=null));return this.getSharedFormsDataStreamCache=n,n}setFormsCompromisedUserAlert(){this.getReputationTierCache||(this.getReputationTierCache=this.getUserReputationTier()),this.getReputationTierCache.then((e=>{e===v.c.Bad&&this.pushFormsAnnouncements("FormsCompromisedUser")}))}pushFormsAnnouncements(e,t){const i="announcement-background-color-wrapper--alert",n="announcement-section__title--black announcement-close__button--black";switch(e){case"FormsCompromisedUser":this.eventService.broadcastEvent({name:"newAnnouncement",args:[new r.a(e,this.locService.FormsCompromisedUserAlertMessage,null,"","",!1,"announcement-background-color-wrapper--error",n,null,null,{text:this.locService.TermsOfUseLink,url:this.getFormsTermsOfServiceUrl(),shouldFocusOnInit:!1})]});break;case"FormsMoveToRecycleBin":const a=this.locService.FormsMoveToRecycleBinMessageNew;a&&this.eventService.broadcastEvent({name:"newAnnouncement",args:[new r.a(e,a,null,"","",!1,i,n,null,null,null,5)]});break;case"FormsRestored":this.eventService.broadcastEvent({name:"newAnnouncement",args:[new r.a(e,this.locService.format(this.locService.FormsRestoredMessage,`"${t}"`),null,"","",!1,i,n)]});break;case"FormsPermanentlyDeleted":this.eventService.broadcastEvent({name:"newAnnouncement",args:[new r.a(e,this.locService.format(this.locService.FormsPermanentlyDeletedMessage,`"${t}"`),null,"","",!1,i,n)]})}}setFormsCopySuccessAnnouncement(e,t,i,n,a){let o,s,l;switch(t){case v.a.Users:s=this.locService.FormsCopyToMyFormsMessage,l=this.locService.AllMyFormsRedirectLabel,o=this.officeRouteService.getUrlForRoute({app:b.b.Forms,route:"MyForms"});break;case v.a.Groups:s=this.locService.FormsCopyToGroupMessage,l=a,o=this.officeRouteService.getUrlForRoute({app:b.b.Forms,route:"GroupForms"},{groupId:n})}this.eventService.broadcastEvent({name:"newAnnouncement",args:[new r.a("FormsCopied",this.locService.format(s,`"${e}"`),null,"","",!1,"announcement-background-color-wrapper--alert","announcement-section__title--black announcement-close__button--black",null,null,i?{url:o,text:l,shouldFocusOnInit:!0}:null)]})}setFormsMoveToGroupSuccessAnnouncement(e,t,i){const n=this.officeRouteService.getUrlForRoute({app:b.b.Forms,route:"GroupForms"},{groupId:t});this.eventService.broadcastEvent({name:"newAnnouncement",args:[new r.a("FormsMoveToGroup",this.locService.format(this.locService.FormsMoveToGroupMessage,`"${e}"`),null,"","",!1,"announcement-background-color-wrapper--alert","announcement-section__title--black announcement-close__button--black",null,null,{url:n,text:i,shouldFocusOnInit:!0})]})}getMyForms(e){if(e&&(this.getMyFormsDataStreamCache=null),this.getMyFormsDataStreamCache)return this.getMyFormsDataStreamCache;const t=e=>new Promise(((t,i)=>{this.get("My_Forms_Request","My_Forms",this.formsConfigService.config.formsApiPath+x.MY_FORMS_PATH,(e=>{e.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((e=>{e.data=Object.assign(Object.assign({},e.data),{fromCache:e.fromCache}),e&&e.data&&e.data.value&&(e.data.value=m.objectToArrayHelper(e.data.value),e.data.value.forEach((e=>{e.ownerPrincipalType=v.a.Users,e.otherInfo&&(e.otherInfo=JSON.parse(e.otherInfo)),e.url=this.getFormUrl(e.id)})),e.data.value=e.data.value.sort(((e,t)=>new Date(t.modifiedDate).getTime()-new Date(e.modifiedDate).getTime()))),t(e.data)}))}),(e=>{i(e)}),this.getRequestConfig(),e)})),i=t("cache-only"),n=t("network-first"),r=C.a.createResultsWithCacheObservable(i,n,null,(e=>{this.getMyFormsDataStreamCache=null}));return this.getMyFormsDataStreamCache=r,this.getMyFormsDataStreamCache}fetchFormThumbnail(e){const t=()=>this.inMockMode?`${location.origin}${x.FORMS_THUMBNAIL_MOCK_PATH}`:`${this.formsConfigService.config.formsApiPath}`,i=t=>({defaultImage:`${t}/Images/Theme/${this.getFormsDefaultImageName(e.fileName)}`,defaultColor:this.formsConfigService.config.defaultThumbnailColor}),n=t=>{e.thumbnails.backgroundColor=t},r=t=>{e.thumbnails.small=t,e.thumbnails.medium=t,e.thumbnails.large=t,e.thumbnails.recommendedThumbnail=t},a=()=>new Promise((a=>{var o,s;const l=t(),c=i(l);let u=e.metaData&&e.metaData.background_image?this.inMockMode?`${l}${g.a.getLocation(e.metaData.background_image).path}`:e.metaData.background_image:c.defaultImage,h=e.metaData&&e.metaData.primary_color?e.metaData.primary_color:c.defaultColor;if(e.format===d.a.Recent)return n(h),r(u),void a();e.thumbnailInfo&&e.thumbnailInfo.thumbnailFillColor&&(h=e.thumbnailInfo.thumbnailFillColor),"Customized Theme"===(null===(o=e.thumbnailInfo)||void 0===o?void 0:o.thumbnailId)&&(null===(s=e.thumbnailInfo)||void 0===s?void 0:s.thumbnailUrl)?(u=e.thumbnailInfo.thumbnailUrl,n(h),r(u),a()):e.thumbnailInfo&&e.thumbnailInfo.thumbnailId?this.getFormsThemingData().then((t=>{const i=t[e.thumbnailInfo.thumbnailId];i&&(i.SecondaryColor&&(h=i.SecondaryColor),i.BackgroundImage&&(u=this.inMockMode?`${location.origin}${x.FORMS_THUMBNAIL_MOCK_PATH}${i.BackgroundImage}`:`${this.formsConfigService.config.formsApiPath}${i.BackgroundImage}`)),n(h),r(u),a()})).catch((()=>{n(h),r(u),a()})):(n(h),r(u),a())}));return e.format===d.a.SharedForm?new Promise((o=>{this.getForm(e.serverDocId,e.ownerType,e.ownerId).then((t=>{const i=Object(c.b)(t,null,null,null,this.clientStartupConfigService.config.authType,t.fromCache);e.thumbnailInfo=i.thumbnailInfo,a().then(o).catch(o)})).catch((()=>{const e=i(t());n(e.defaultColor),r(e.defaultImage),o()}))})):a()}handleQueryParam(e,t){"mockformsservicemode"===e&&this.mockRequestHeader&&this.getRequestConfig().headers.set(this.mockRequestHeader,t.toString())}getRequestIdFromResponse(e){return this.getHeaderValue(e.headers,"x-correlationid")}getImage(e,t,i){return new Promise(((n,r)=>{this.get(t,i,e,(e=>{e.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((e=>{if(e&&e.data){const t=new FileReader;t.addEventListener("load",(()=>{let e=t.result.toString();e=e.replace("data:image/pjpeg","data:image/jpeg"),n(e)}),!1),t.readAsDataURL(e.data)}}))}),(e=>{r(e)}),{responseType:"blob"},"network-only")}))}appendQueryInformation(e,t,i){const n=this.officeRouteService.getCurrentRoute();return w.a.appendAndReplaceQueryParams(e,{route:i||(n&&n.route?n.route:void 0)},t)}getRequestConfig(){return{headers:new Map([["Accept","application/json"],["x-ms-form-request-source","ms-startpage"],["x-usersessionid",this.startupConfigService.config.sharedClientStartupContext.sessionId],["x-correlationid",f.a.createGuid()],["x-anchormailbox",`${this.guid}@${this.tenantId}`]])}}clearCache(e,t){switch(e){case v.a.Groups:if(!t)break;this.getFormsInGroupDataStreamCache[t]=null;break;case v.a.Users:this.getMyFormsDataStreamCache=null}}convertConsumerPuidToGuid(e){return"00000000-0000-0000-".concat(e.slice(0,4),"-",e.slice(4))}getFormsDefaultImageName(e){e=e||"Untitled form";const t=this.formsConfigService.config.defaultImagesAvailable;return`default-${Math.abs(class{static toHash(e){let t,i,n=0;if(0===e.length)return n;for(t=0;t<e.length;t++)i=e.charCodeAt(t),n=(n<<5)-n+i,n|=0;return n}}.toHash(e))%t+1}.png`}getFormsThemingData(){return this.getFormsThemeMappingSetCache||(this.getFormsThemeMappingSetCache=new Promise(((e,t)=>{this.get("Forms_Theme_Request","Forms_Theme",this.formsConfigService.config.formsApiPath+`${this.inMockMode?x.FORMS_THEMES_MOCK:x.FORMS_THEMES}`,(t=>{t.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((t=>{e(t.data)}))}),(e=>{this.getFormsThemeMappingSetCache=null,t(e)}),this.getRequestConfig(),"network-first",null,null,null,"None")}))),this.getFormsThemeMappingSetCache}getUserReputationTier(){return new Promise(((e,t)=>{this.get("Get_User_Reputation_Tier","Get_User_Reputation_Tier",this.formsConfigService.config.formsApiPath+x.USER_REPUTATION_TIER_PATH,(i=>{i.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((i=>{i&&i.data?e(i.data):t()}))}),(e=>{t(e)}),this.getRequestConfig(),"network-only")}))}}x.BASE_URL="/formapi/api",x.SHARED_FORMS_PATH=`${x.BASE_URL}/me/sharedWithMeForms`,x.MY_FORMS_PATH=`${x.BASE_URL}/me/light/forms?$select=id,title,modifiedDate,settings,ownerId,ownerTenantId,category,background,otherInfo,softDeleted,status,type&$filter=type+ne+%27survey%27`,x.FORMS_RESPONSE_COUNT_PATH=`${x.BASE_URL}/light/GetRespCounts()`,x.FORMS_THUMBNAIL_MOCK_PATH="/content/mockData/shared/services/mockData/form/thumbnails",x.FORMS_THEMES_MOCK="/Themes",x.FORMS_THEMES="/Themes.json",x.MY_FORMS_GROUPS=`${x.BASE_URL}/groups`,x.USER_REPUTATION_TIER_PATH=`${x.BASE_URL}/userReputationTier`,x.GET_FORM=(e,t,i,n)=>`${x.BASE_URL}/${e}/${t}/${i}/light/forms('${n}')?$select=id,rowCount,background,otherInfo,settings,type,category`,x.COPY_FORMS_PATH=(e,t,i,n)=>`${x.BASE_URL}/${e}/${t}/${i}/light/forms('${n}')/CopyToUser`,x.MOVE_FORM_PATH=(e,t,i,n)=>`${x.BASE_URL}/${e}/${t}/${i}/light/forms('${n}')/MoveForm`,x.FORMS_MEMBER_THUMBNAIL_PATH=(e,t)=>`${x.BASE_URL}/groups('${e}')/members('${t}')/photo/$value`,x.FORMS_GROUP_MEMBERS=e=>`${x.BASE_URL}/groups('${e}')/members`,x.FORM_EDIT_OR_DELETE_PATH=(e,t,i,n)=>`${x.BASE_URL}/${e}/${t}/${i}/forms('${n}')`,x.FORMS_FROM_GROUP=(e,t)=>`${x.BASE_URL}/${e}/groups/${t}/light/forms?$select=id,title,modifiedDate,ownerId,ownerTenantId,softDeleted,category,rowCount,background,otherInfo,type&$filter=type+ne+%27survey%27`,x.MY_FORMS_GROUP_THUMBNAIL_PATH=e=>`${x.BASE_URL}/groups('${e}')/photo/$value`,x.SHARED_FORM=e=>`${x.BASE_URL}/light/sharedWithMeForms('${e}')`,x.CREATE_FORM_FROM_TEMPLATE=(e,t,i)=>`${x.BASE_URL}/${e}/${t}/${i}/light/forms`,x.ɵprov=M.kc({factory:function(){return new x(M.lc(I.a),M.lc(k.a),M.lc(a.a),M.lc(o.a),M.lc(h.a),M.lc(y.a),M.lc(E.a),M.lc(A.a),M.lc(P.a),M.lc(R.q),M.lc(F.a),M.lc(S.b),M.lc(S.b),M.lc(O.a),M.lc(T.b),M.lc(p.a),M.lc(u.a))},token:x,providedIn:"root"})},TIi1:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},TfV2:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.Security=0]="Security",e[e.Basic=1]="Basic",e[e.Enhanced=2]="Enhanced",e[e.Full=3]="Full"}(n||(n={}))},Tqea:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("6ib3");function r(e){switch(e){case n.a.Word:return"Word";case n.a.Excel:return"Excel";case n.a.PowerPoint:return"PowerPoint";case n.a.MeetingNotes:case n.a.OneNote:case n.a.OneNoteClassNoteBook:case n.a.OneNotePage:return"OneNote";case n.a.Pdf:return"PDF";case n.a.Visio:return"Visio";case n.a.Audio:return"Audio";case n.a.Video:return"Video";case n.a.Photos:return"Photos";case n.a.Outlook:return"Outlook";case n.a.Text:return"Text";case n.a.Sway:return"Sway";case n.a.Forms:case n.a.FormsQuiz:return"Forms";case n.a.Project:return"Project";case n.a.ProjectOperations:return"ProjectOperations";case n.a.Portfolio:return"Portfolio";case n.a.NewsArticle:return"NewsArticle";case n.a.Fluid:return"Loop components";case n.a.PowerBI:return"PowerBI";case n.a.StreamsVideo:return"Streams";case n.a.Stream:return"Stream";case n.a.ScreenRecording:return"ScreenRecording";case n.a.UpcomingMeeting:return"UpcomingMeeting";case n.a.List:return"List";case n.a.PlayLists:return"PlayLists";case n.a.PlayList:return"PlayList";case n.a.Spaces:return"Spaces";case n.a.MindMeister:return"MindMeister";case n.a.Monday:return"monday.com";case n.a.Trello:return"Trello";case n.a.Platform:return"Platform";case n.a.Whiteboard:return"Whiteboard";case n.a.MeetingObject:return"MeetingObject";case n.a.ThirdParty:return"Custom";case n.a.MyAnalytics:return"MyAnalytics";case n.a.Designer:return"Designer";default:return"Document"}}},U8M1:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("lrJm"),r=i("4/We"),a=i("cgnd"),o=i("fVt+"),s=i("1LNb"),l=i("Z0U4"),c=i("Mlb/");class u{constructor(e,t,i,n,r,o){this.capabilitiesService=e,this.clientStartupConfigService=t,this.feedbackService=i,this.officeRouteService=n,this.userConsentConfigService=r,this.globalErrorHandler=o,this.userConsentConfigPromise=null,this.capabilitiesService.capabilities.showFloodgate&&(this.capabilitiesService.capabilities.userConsentCallEnabled&&this.clientStartupConfigService.config.authType===a.a.MSA&&!this.userConsentConfigPromise&&(this.userConsentConfigPromise=this.userConsentConfigService.getConfig()),this.floodgateInitPromise=this.feedbackService.feedbackServiceInitializePromise.then((()=>new Promise(((e,t)=>{const i=t=>{const i=this.feedbackService.getOCVTelemetryData(t.toString());OfficeBrowserFeedback.initOptions.applicationGroup=i.applicationGroup,OfficeBrowserFeedback.initOptions.telemetryGroup=i.telemetryGroup,OfficeBrowserFeedback.initOptions.webGroup=i.webGroup,OfficeBrowserFeedback.initOptions.appId=this.feedbackService.getOcvAppId(),OfficeBrowserFeedback.floodgate.initOptions&&(this.capabilitiesService.capabilities.adminPolicyEnabled&&(OfficeBrowserFeedback.floodgate.initOptions.surveyEnabled=!!this.feedbackService.OCVAdminPolicy&&this.feedbackService.OCVAdminPolicy.SendSurvey.State,OfficeBrowserFeedback.floodgate.initOptions.showEmailAddress=!!this.feedbackService.OCVAdminPolicy&&this.feedbackService.OCVAdminPolicy.EmailCollection.State),OfficeBrowserFeedback.floodgate.initOptions.onSurveyActivatedCallback={onSurveyActivated:e=>this.activateSurvey(e)}),OfficeBrowserFeedback.floodgate.initialize().then(e)};this.userConsentConfigPromise?this.userConsentConfigPromise.then((e=>{0!==e.userConsent?t():this.feedbackService.addOCVScriptToPage(i)||t()})).catch((e=>{t(),this.globalErrorHandler.handleError(e)})):this.feedbackService.addOCVScriptToPage(i)||t()})))))}recordFloodgate(e){this.capabilitiesService.capabilities.showFloodgate&&this.floodgateInitPromise.then((()=>{OfficeBrowserFeedback.floodgate.start().then((()=>{const t=OfficeBrowserFeedback.floodgate.getEngine().getActivityListener();e.forEach((e=>t.logActivity(e))),OfficeBrowserFeedback.floodgate.stop()}))}))}activateSurvey(e){const t=this.officeRouteService.getRouteItemForCurrentLocation().route;!t||"OfficeHome"!==t&&"Search"!==t&&"AppGallery"!==t||e.launch()}}u.ɵprov=c.kc({factory:function(){return new u(c.lc(r.a),c.lc(a.b),c.lc(s.a),c.lc(l.a),c.lc(o.a),c.lc(n.b))},token:u,providedIn:"root"})},URPu:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("dFxn"),r=i("Mlb/");class a{constructor(e){this.config=e.parse("pwaConfig")||{bridgeTimeoutInSeconds:0,diagnosticsTimeoutInSeconds:30,enablePwaIdleCallback:!1,installedAppsToLookFor:null,officeUriProtocolEnabled:!1,oobToWeb:!1,pwaJumpListEnabled:!1,PwaStartPageEnabled:!1,resourceUrlMap:null,rfmToWeb:!1,shellAndConfigApiEndpoint:null},this.config.mock&&(window.appsLaunched=new Array,this.config.mock.appsLaunched=window.appsLaunched)}}a.ɵprov=r.kc({factory:function(){return new a(r.lc(n.a))},token:a,providedIn:"root"})},Uqr9:function(e,t,i){"use strict";i.d(t,"a",(function(){return S})),i.d(t,"b",(function(){return y}));var n=i("VV8N"),r=i("pM41"),a=i("CMIS"),o=i("70cc"),s=i("WKA6"),l=i("hhzZ"),c=i("BaAg"),u=i("cgnd"),d=i("MFXD"),h=i("AXqk"),p=i("7Gwk"),m=i("Z0U4"),f=i("re3B"),g=i("BMb5"),b=i("Mlb/"),v=i("qfyf");class S{static now(){const e=window.performance;return e&&e.now?e.now():(void 0===this.nowOffset&&(this.nowOffset=e&&e.timing&&e.timing.navigationStart?e.timing.navigationStart:Date.now()),Date.now()-this.nowOffset)}}class y{constructor(e,t,i,n,r,a,l,c){if(this.queuedMarks=e,this.dataSecurityService=t,this.instrumentationService=r,this.windowService=a,this.clientStartupConfigService=l,this.dumpedMeasures=new Set,this.dumpedBrowserMarkers=!1,this.recordedMarkers=new Map,this.recordedMeasures=new Map,this.paramsForAppMeasures=new Map,this.globalStateParamsForBrowserMeasures=null,this._marks=new d.a,this.loggingEnabled=y.performanceLoggingSupported(this.windowService.nativeWindow),!this.loggingEnabled)return;i.events.withScope(0).pipe(Object(o.a)((e=>"shellPlusLoaded"===e.name)),Object(s.a)(1)).toPromise().then((()=>{setTimeout((()=>this.log()),1e3)})),n.addUnloadEvent((()=>{this.mark("App_Unloaded",1),this.log()}));const u=e=>{this.currentRoute=e,this.mark("App_Navigation_Start",this.lastRecordedRouteNavigationStartMarker?0:this.windowService.nativeWindow.measureAppFrom||"responseStart")};c.subscribeToRouteChangeStart((e=>{e.currentRoute&&e.currentRoute.route&&u(e.currentRoute)})),c.subscribeToRouteChangeEnd((e=>{e.currentRoute&&e.currentRoute.route&&!this.currentRoute&&u(e.currentRoute),null===this.globalStateParamsForBrowserMeasures&&(this.globalStateParamsForBrowserMeasures={},this.instrumentationService.applyGlobalStateParams(this.globalStateParamsForBrowserMeasures,!0))})),this.drainQueuedMarks()}static performanceLoggingSupported(e){const t=e.performance;return!!(t&&t.now&&t.mark&&t.timing&&t.timing.navigationStart&&t.measure&&t.getEntriesByType)}static getBrowserTimingMeasures(e,t,i,n){const r=new Array;if(!y.performanceLoggingSupported(e))return r;for(const a in e.performance.timing){const o=y.globalAllowedMarkers.get(a);if(!o)continue;const s=e.performance.timing[a],l=e.performance.timing[o];if("number"!=typeof s||"number"!=typeof l){t(a,`Failed to calculate measure for <${a}> starting from <${o}> due to unexpected value type: <${a}> value type is ${typeof s}; <${o}> value type is ${typeof l}`);continue}if(0===s||0===l){"unloadEventStart"!==a&&"unloadEventEnd"!==a&&t(a,`Failed to calculate measure for <${a}> starting from <${o}> due to unexpected zero values: <${a}>=${s}; <${o}>=${l}`);continue}if(s<l){t(a,`Failed to calculate measure for <${a}> starting from <${o}> due to relative marker value being greater than marker value: <${a}>=${s}; diff from <${o}>=${s-l}`);continue}if(s<e.performance.timing.navigationStart){t(a,`Failed to calculate measure for <${a}> starting from <${o}> due to marker value being less than <navigationStart> marker value: <${a}>=${s}; diff from <navigationStart}>=${s-e.performance.timing.navigationStart}`);continue}if(l<e.performance.timing.navigationStart){t(a,`Failed to calculate measure for <${a}> starting from <${o}> due to relative marker value being less than <navigationStart> marker value: <${a}>=${s}; <${o}>=${l}; diff from <navigationStart}>=${l-e.performance.timing.navigationStart}`);continue}const c=Math.ceil(s-l);r.push({name:a,duration:c,params:i?Object.assign({},i):{}});const u=`${a}_ohp_measure`;n&&n(a,u);try{e.performance.measure(u,o,a)}catch(e){t(a,`Failed to record measure for <${a}> starting from <${o}>: exception is thrown`)}}return r}mark(e,t=2,i=0,r){if(!this.loggingEnabled)return;if(i>this.dataSecurityService.securityLevel)return;let a=e;if(this.currentRoute&&this.currentRoute.route){const t=`${this.currentRoute.route}${this.currentRoute.app?c.b[this.currentRoute.app]:""}`;Object(n.f)(t),a=`${e}_${t}`}let o=a;if(this.recordedMarkers.has(o)){const e=this.recordedMarkers.get(o)+1;this.recordedMarkers.set(o,e),o=`${a}.${e}`}else this.recordedMarkers.set(o,1);this.windowService.nativeWindow.performance.mark(o);const s=this.lastRecordedRouteNavigationStartMarker||"navigationStart";"App_Navigation_Start"===e&&(Object(n.g)(o),this.lastRecordedRouteNavigationStartMarker=o);let l="navigationStart";return 2===t?l=s:0===t?l="":"string"==typeof t&&(l=t),this.addMeasure(a,o,l,e,r),this.drainQueuedMarks(),o}getRecordedMarkerNameBySubstring(e){return e?Array.from(this.recordedMarkers.keys()).find((t=>t.indexOf(e)>=0)):null}getResourceTimingEntries(e){try{return this.windowService.nativeWindow.performance.getEntriesByType("resource").filter((t=>t.name.lastIndexOf(e)>=0))}catch(e){return[]}}get marks(){return this._marks.asScopableObservable()}get navigationStart(){return this.getPerformanceTimingMember("navigationStart")}get fetchStart(){return this.getPerformanceTimingMember("fetchStart")}getPerformanceTimingMember(e){const t=this.windowService.nativeWindow.performance;return t&&t.timing&&t.timing[e]?t.timing[e]:0}drainQueuedMarks(){this.queuedMarks&&this.queuedMarks.splice(0,this.queuedMarks.length).forEach((e=>this.addMeasure(e.markName,e.markName,e.measureFrom||"navigationStart",e.markName,e.eventParams)))}addMeasure(e,t,i,n,r){const a=this.windowService.nativeWindow,o=a.performance.getEntriesByType("mark").find((e=>e.name===t));if(o&&this._marks.next(o),i&&!this.recordedMeasures.has(e)){this.recordedMeasures.set(e,n||e);try{a.performance.measure(e,i,t)}catch(n){return void this.logError(e,`Failed to record <${e}> for <${t}> starting from <${i}>: exception is thrown`)}this.dumpedBrowserMarkers?(r&&this.paramsForAppMeasures.set(e,r),this.log(e)):(this.instrumentationService.applyGlobalStateParams(r=r||{},!1),this.paramsForAppMeasures.set(e,r))}}log(e){this.getPerformanceDump(e).forEach((e=>{this.instrumentationService.logPerformanceEvent(e.name,e.duration,e.params),Object(r.a)({eventName:e.name,latency:e.duration,instrumentationParams:e.params})}))}getPerformanceDump(e){const t=new Map;if(!e&&this.dumpedBrowserMarkers)return t;const i=this.windowService.nativeWindow;let n;if(e){const r=i.performance.getEntriesByName(e,"measure");if(!r)return t;n=r}else n=i.performance.getEntriesByType("measure").filter((e=>!this.dumpedMeasures.has(e.name)&&this.recordedMeasures.has(e.name)));return n.forEach((e=>{const i=Math.ceil(e.duration);let n={};this.paramsForAppMeasures.has(e.name)&&(n=this.paramsForAppMeasures.get(e.name));const r=this.recordedMeasures.get(e.name);t.set(e.name,{name:r,duration:i,params:n}),this.dumpedMeasures.add(e.name)})),e||this.dumpBrowserMarkers(t),t}dumpBrowserMarkers(e){if(this.dumpedBrowserMarkers)return;const t=this.windowService.nativeWindow;if(this.clientStartupConfigService.config.resourceLoggingEnabled&&this.clientStartupConfigService.config.cdnDomain){const i=new RegExp(`https://${this.clientStartupConfigService.config.cdnDomain}.*`,"i"),n=t.performance.getEntriesByType("resource").filter((e=>i.test(e.name)&&("script"===e.initiatorType||"link"===e.initiatorType))).filter((e=>e.hasOwnProperty("transferSize")?e.transferSize>0:e.responseEnd-e.responseStart>20));let r,a=0;for(const e of n){const t=e.responseEnd;"number"==typeof t&&t>0&&t>a&&(a=t,r=e)}if(r){const t=r.name.split("/").pop(),i="Last_CDN_Script_Downloaded",n=r.responseEnd,a=null===this.globalStateParamsForBrowserMeasures?{}:Object.assign({},this.globalStateParamsForBrowserMeasures);a.Filename=t,e.set(i,{name:i,duration:n,params:a}),this.dumpedMeasures.add(i)}}y.getBrowserTimingMeasures(t,((e,t)=>{this.logError(e,t)}),this.globalStateParamsForBrowserMeasures,((e,t)=>{this.dumpedMeasures.add(t),this.recordedMeasures.set(t,e)})).forEach((t=>{e.set(t.name,t)})),this.dumpedBrowserMarkers=!0}logError(e,t){this.instrumentationService.logGenericEvent("Performance_Mark_Failure",{Error:e,DebugInfo:t}),Object(a.a)({eventName:"Performance_Mark_Failure",errorType:"Other",message:e,debugInfo:t})}}y.globalAllowedMarkers=new Map([["fetchStart","navigationStart"],["unloadEventStart","navigationStart"],["unloadEventEnd","unloadEventStart"],["domainLookupEnd","domainLookupStart"],["connectEnd","connectStart"],["requestStart","navigationStart"],["responseStart","requestStart"],["responseEnd","responseStart"],["domLoading","responseStart"],["domInteractive","domLoading"],["domComplete","domLoading"]]),y.ɵprov=b.kc({factory:function(){return new y(b.lc(v.a,8),b.lc(h.a),b.lc(p.a),b.lc(f.a),b.lc(l.a),b.lc(g.b),b.lc(u.b),b.lc(m.a))},token:y,providedIn:"root"})},V9hE:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("8/lW"),r=i("a3FV"),a=i("4CZh");function o(e,t,i,o){void 0===t&&(t={}),void 0===i&&(i=[]),void 0===o&&(o=n.a.Security),Object(a.b)(e,r.a.GenericDebugCache,o,t,i,!0)}},VKX6:function(e,t,i){"use strict";var n;function r(){var e=window.performance;return e&&e.now?e.now():(void 0===n&&(n=e&&e.timing&&e.timing.navigationStart?e.timing.navigationStart:Date.now()),Date.now()-n)}i.d(t,"a",(function(){return r}))},VV8N:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"d",(function(){return o})),i.d(t,"e",(function(){return s})),i.d(t,"b",(function(){return l})),i.d(t,"f",(function(){return c})),i.d(t,"c",(function(){return u})),i.d(t,"g",(function(){return d}));var n=void 0,r=void 0,a=new Map,o=new Map,s=new Set;function l(){return n}function c(e){n=e}function u(){return r}function d(e){r=e}},VY7U:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("PZOQ"),r=i("1Bt+");class a{static forRoot(){return{ngModule:a,providers:[n.a,r.a]}}}},VrZ9:function(e,t,i){"use strict";i.d(t,"a",(function(){return h})),i.d(t,"b",(function(){return m}));var n=i("Mlb/"),r=i("vk2e"),a=i("pzhl"),o=i("PkQn"),s=i("4/We"),l=i("MRNN"),c=i("/I02"),u=i("PBJH"),d=i("Z0U4"),h=n.Fb({encapsulation:2,styles:[],data:{}});function p(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,5,null,null,null,null,null,null,null)),(e()(),n.Hb(1,0,null,null,4,"div",[],null,null,null,null,null)),n.Gb(2,278528,null,0,r.i,[n.x,n.y,n.o,n.K],{ngClass:[0,"ngClass"]},null),n.Zb(3,{"back-button":0,"back-button--fluent":1,"ms-u-hiddenMdDown":2}),(e()(),n.Hb(4,0,null,null,1,"ohp-icon-font",[["ariaVisible","true"],["dataArea","Hero"],["dataNav","1"],["iconButton","true"],["iconFontName","ArrowLeft"]],null,[[null,"iconClicked"]],(function(e,t,i){var n=!0;return"iconClicked"===t&&(n=!1!==e.component.navigateBack()&&n),n}),a.b,a.a)),n.Gb(5,638976,null,0,o.a,[s.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],id:[2,"id"],title:[3,"title"],ariaVisible:[4,"ariaVisible"],ariaLabel:[5,"ariaLabel"],dataArea:[6,"dataArea"],dataNav:[7,"dataNav"],iconButton:[8,"iconButton"],focusOnLoad:[9,"focusOnLoad"]},{iconClicked:"iconClicked"})],(function(e,t){var i=t.component,n=e(t,3,0,!i.fluentRefresh,i.fluentRefresh,i.responsive&&!i.fluentRefresh);e(t,2,0,n),e(t,5,0,"back-button__icon ms-fcl-tp"+(i.fluentRefresh?" back-button__icon--fluent":""),"ArrowLeft",i.elementId,i.backButtonAriaLabel||i.defaultAriaLabel,"true",i.backButtonAriaLabel||i.defaultAriaLabel,"Hero","1","true",i.focusOnLoad)}),null)}function m(e){return n.jc(0,[(e()(),n.qb(16777216,null,null,1,null,p)),n.Gb(1,16384,null,0,r.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,1,0,i.backRoute||i.defaultBackRoute)}),null)}n.Db("ohp-back-button",l.a,(function(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-back-button",[],null,null,null,m,h)),n.Gb(1,245760,null,0,l.a,[s.a,c.a,u.a,d.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{elementId:"elementId",backButtonAriaLabel:"backButtonAriaLabel",defaultBackRoute:"defaultBackRoute",responsive:"responsive",focusOnLoad:"focusOnLoad"},{},[])},Vwd8:function(e,t,i){"use strict";i.d(t,"b",(function(){return p})),i.d(t,"a",(function(){return f}));var n=i("QjXU"),r=i("Dn7E"),a=i("lrJm"),o=i("W3Zz"),s=i("uzn7"),l=i("re3B"),c=i("xoWf"),u=i("cgnd"),d=i("hhzZ"),h=i("Mlb/");class p{constructor(e,t,i,n,r,a,o){this.clientStartupConfigService=e,this.localStorageService=t,this.userDataStorageService=r,this.instrumentationService=a,this.globalErrorHandler=o,this.scheduledSavePromise=null,this.pendingFirstTimeMetrics={},this.firstTimeUser=this.userDataStorageService.isFirstUse(),this.firstVisitTimestamp=this.userDataStorageService.getFirstUseTimestamp(),this.bufferingTimeoutInSeconds=n.isMobileDevice()?p.BufferingTimespanInSecondsForMobile:p.BufferingTimespanInSecondsForDesktop,this.localStorageProfileDataKey=`.Full_Metrics.v${p.LocalStorageSchemaVersion}`,this.fullMetrics=this.localStorageService.get(this.localStorageProfileDataKey),this.fullMetrics&&this.fullMetrics.metrics?this.firstTimeUser&&(this.firstTimeUser=!1,this.firstVisitTimestamp=this.fullMetrics.created):this.fullMetrics=p.createEmptySnapshot(),this.onLoadMetrics=this.fullMetrics.metrics,this.localStorageUnsavedDataKey=`.Unsaved_Metrics.v${p.LocalStorageSchemaVersion}`,this.unsavedMetrics=this.localStorageService.get(this.localStorageUnsavedDataKey),this.unsavedMetrics&&this.unsavedMetrics.metrics?this.firstTimeUser&&(this.firstTimeUser=!1,this.firstVisitTimestamp=this.unsavedMetrics.created):this.unsavedMetrics=null,this.inMemoryProfile={metrics:this.fullMetrics.metrics},this.roamingStorageProfileDataKey=`User_Profile.Metrics.v${p.LocalStorageSchemaVersion}`,this.loadFromUserStorage(),this.forceImmediateSave=this.firstTimeUser||!!this.unsavedMetrics,i.addUnloadEvent((()=>this.flush()))}incrementMetric(e,t){const i=p.createTimestamp();p.applyIncrement(e,i,this.fullMetrics.metrics);const n=this.fullMetrics.metrics[e];n&&1===n.count&&(this.loadingMetricsFromRoamingStorage?this.pendingFirstTimeMetrics[e]=n.firstOccurrence:this.logMetricRecordedForFirstTime(e)),this.unsavedMetrics||(this.unsavedMetrics=p.createEmptySnapshot()),p.applyIncrement(e,i,this.unsavedMetrics.metrics),this.scheduleSave(t)}flush(){this.scheduledSavePromise&&this.forceSave()}get(){return this.pendingLoad}isFirstVisit(){return this.firstTimeUser}getInitialMetric(e){return this.onLoadMetrics[e]}doesMetricExist(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const i=(yield this.get()).metrics;for(const n in i)if(t?n===e:n.includes(e))return!0;return!1}))}fullDaysSinceFirstVisit(){if(this.firstTimeUser)return 0;if(void 0===this.firstVisitTimestamp||this.firstVisitTimestamp<0)return-1;const e=p.createTimestamp()-this.firstVisitTimestamp;return Math.floor(e/p.MillisecondsInDay)}static createTimestamp(){return Date.now()}static createEmptySnapshot(){return{metrics:{},created:p.createTimestamp(),saved:-1}}static applyIncrement(e,t,i){if(i.hasOwnProperty(e)){const n=i[e];n.count++,n.lastOccurrence=t}else i[e]={count:1,firstOccurrence:t,lastOccurrence:t}}static mergeMetrics(e,t){for(const i in t)p.applyMetric(e,i,t[i])}static applyMetric(e,t,i){if(e.hasOwnProperty(t)){const n=e[t];n.count+=i.count,n.firstOccurrence>i.firstOccurrence&&(n.firstOccurrence=i.firstOccurrence),n.lastOccurrence<i.lastOccurrence&&(n.lastOccurrence=i.lastOccurrence)}else e[t]=Object.assign({},i)}static sanitizeMetrics(e){if(!e.hasOwnProperty(p.MetricPresentInSetThatHasToBeSanitized))return e;const t={};for(const i in e){if(i.indexOf("_Request")>0)continue;if(i.indexOf("_Impression")>0)continue;let n=!1;if(i.startsWith("Referral."))n=!0;else if(i.indexOf("_PageView")>0)n=!0;else if(i.indexOf("_Click")>0||i.indexOf("_Toggle")>0){const e=i.split(".");3===e.length&&d.b.hasOwnProperty(e[1])&&(n=!0)}else"Upload_Completed"===i&&(n=!0);n&&(t[i]=e[i])}return t}resetScheduledSave(){this.scheduledSavePromise&&(clearTimeout(this.scheduledSaveTimeoutId),this.scheduledSaveTimeoutId=null,this.scheduledSavePromise=null,this.scheduledSaveEstimatedTime=null)}scheduleSave(e){if(this.forceImmediateSave)return this.forceImmediateSave=!1,void this.forceSave();if(this.scheduledSavePromise&&(!e||Date.now()+1e3*e>=this.scheduledSaveEstimatedTime))return;this.resetScheduledSave();const t=1e3*(e?Math.min(e,this.bufferingTimeoutInSeconds):this.bufferingTimeoutInSeconds);this.scheduledSaveEstimatedTime=Date.now()+t,this.scheduledSavePromise=new Promise((e=>{this.scheduledSaveTimeoutId=setTimeout((()=>{this.forceSave(),e()}),t)}))}forceSave(){if(this.resetScheduledSave(),this.clientStartupConfigService.config.sanitizeMetrics&&(this.unsavedMetrics&&(this.unsavedMetrics.metrics=p.sanitizeMetrics(this.unsavedMetrics.metrics)),this.fullMetrics.metrics=p.sanitizeMetrics(this.fullMetrics.metrics)),this.fullMetrics.saved=p.createTimestamp(),this.localStorageService.set(this.localStorageProfileDataKey,this.fullMetrics),this.unsavedMetrics&&this.localStorageService.set(this.localStorageUnsavedDataKey,this.unsavedMetrics),this.loadingMetricsFromRoamingStorage)this.scheduleSave();else{const e=this.unsavedMetrics;this.unsavedMetrics=null,this.userDataStorageService.set(this.roamingStorageProfileDataKey,this.fullMetrics).then((()=>{this.unsavedMetrics?this.localStorageService.set(this.localStorageUnsavedDataKey,this.unsavedMetrics):this.localStorageService.remove(this.localStorageUnsavedDataKey)})).catch((t=>{this.globalErrorHandler.handleError(t,"SxWjc"),this.unsavedMetrics&&e&&p.mergeMetrics(e.metrics,this.unsavedMetrics.metrics),this.unsavedMetrics=e,this.unsavedMetrics&&this.localStorageService.set(this.localStorageUnsavedDataKey,this.unsavedMetrics)}))}}loadFromUserStorage(){this.pendingLoad=new Promise((e=>{this.loadingMetricsFromRoamingStorage=!0,this.userDataStorageService.get(this.roamingStorageProfileDataKey,p.LoadFromUserStorageRemoteAttempts).then((e=>{e&&e.metrics&&(this.unsavedMetrics&&e.saved<this.unsavedMetrics.created&&p.mergeMetrics(e.metrics,this.unsavedMetrics.metrics),this.fullMetrics=e,this.inMemoryProfile.metrics=this.fullMetrics.metrics)})).catch((e=>{this.globalErrorHandler.handleError(e,"QN0a5")})).then((()=>{this.loadingMetricsFromRoamingStorage=!1;for(const e in this.pendingFirstTimeMetrics){const t=this.fullMetrics.metrics[e];t&&this.pendingFirstTimeMetrics[e]!==t.firstOccurrence||this.logMetricRecordedForFirstTime(e)}this.pendingFirstTimeMetrics={},e(this.inMemoryProfile)}))}))}logMetricRecordedForFirstTime(e){const t={};t.MetricName=e,this.instrumentationService.logGenericEvent("First_Time_Metric",t),Object(r.a)({featureName:"Other",eventName:"First_Time_Metric",params:t})}}p.BufferingTimespanInSecondsForDesktop=30,p.BufferingTimespanInSecondsForMobile=5,p.LoadFromUserStorageRemoteAttempts=2,p.LocalStorageSchemaVersion=1,p.MillisecondsInDay=864e5,p.MetricPresentInSetThatHasToBeSanitized="Site_Visit",p.ɵprov=h.kc({factory:function(){return new p(h.lc(u.b),h.lc(s.a),h.lc(l.a),h.lc(o.b),h.lc(c.a),h.lc(d.a),h.lc(a.b))},token:p,providedIn:"root"});class m{constructor(e,t,i,n){this.userProfileService=e,this.streamName=t,this.params=i,this.metrics=n}record(){if(this.metrics){const e="Generic_Click"===this.streamName&&this.params.Referral?1:void 0;this.metrics.forEach((t=>this.userProfileService.incrementMetric(t,e)))}}}class f{constructor(e){this.userProfileService=e}createEvent(e,t,i){return new m(this.userProfileService,e,t,i)}flush(){this.userProfileService.flush()}}f.ɵprov=h.kc({factory:function(){return new f(h.lc(p))},token:f,providedIn:"root"})},W0EU:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},W3Zz:function(e,t,i){"use strict";i.d(t,"d",(function(){return n})),i.d(t,"a",(function(){return r})),i.d(t,"c",(function(){return a})),i.d(t,"e",(function(){return l})),i.d(t,"b",(function(){return u}));var n,r,a,o=i("BMb5"),s=i("Mlb/");!function(e){e[e.PC=0]="PC",e[e.Mac=1]="Mac",e[e.WindowsPhone=2]="WindowsPhone",e[e.iPad=3]="iPad",e[e.iPhone=4]="iPhone",e[e.AndroidPhone=5]="AndroidPhone",e[e.AndroidTablet=6]="AndroidTablet",e[e.Linux=7]="Linux",e[e.Chromebook=8]="Chromebook",e[e.Other=9]="Other"}(n||(n={})),function(e){e[e.IE=0]="IE",e[e.Edge=1]="Edge",e[e.EdgeLegacy=2]="EdgeLegacy",e[e.Chrome=3]="Chrome",e[e.Firefox=4]="Firefox",e[e.Safari=5]="Safari",e[e.PhantomJS=6]="PhantomJS",e[e.Opera=7]="Opera",e[e.WebView=8]="WebView",e[e.Other=9]="Other"}(r||(r={})),function(e){e.Slow2g="Slow2g",e.Standard2g="Standard2g",e.Standard3g="Standard3g",e.Standard4g="Standard4g",e.Unknown="Unknown"}(a||(a={}));class l{constructor(e,t,i){this.major=this.normalize(e),this.minor=this.normalize(t),this.build=this.normalize(i)}compareTo(e){return this.major===e.major&&this.minor===e.minor&&this.build===e.build?0:this.major>e.major||this.major===e.major&&this.minor>e.minor||this.major===e.major&&this.minor===e.minor&&this.build>e.build?1:-1}toString(){return`${this.major}_${this.minor}_${this.build}`}normalize(e){if("number"==typeof e)return e;if("string"==typeof e){const t=parseInt(e);return isNaN(t)?0:t}return 0}}class c{constructor(e,t,i){this.major=this.normalize(e),this.minor=this.normalize(t),this.build=this.normalize(i)}compareTo(e){return this.major===e.major&&this.minor===e.minor&&this.build===e.build?0:this.major>e.major||this.major===e.major&&this.minor>e.minor||this.major===e.major&&this.minor===e.minor&&this.build>e.build?1:-1}toString(){return`${this.major}_${this.minor}_${this.build}`}normalize(e){if("number"==typeof e)return e;if("string"==typeof e){const t=parseInt(e);return isNaN(t)?0:t}return 0}}class u{constructor(e){this.windowService=e,this.platforms=[{keyword:"Windows NT",platformType:n.PC},{keyword:"Windows XP",platformType:n.PC},{keyword:"Macintosh",platformType:n.Mac},{keyword:"Windows Phone",platformType:n.WindowsPhone,pageName:"windows-phone"},{keyword:"iPad",platformType:n.iPad,pageName:"ipad"},{keyword:"iPhone",platformType:n.iPhone,pageName:"iphone"},{keyword:"Android",platformType:n.AndroidPhone,pageName:"android-phone"},{keyword:"Linux",platformType:n.Linux},{keyword:"CrOS",platformType:n.Chromebook}],this.browsers=[{keyword:"PhantomJS",browserType:r.PhantomJS},{keyword:"Edge",browserType:r.EdgeLegacy},{keyword:"EdgA",browserType:r.Edge},{keyword:"EdgiOS",browserType:r.Edge},{keyword:"Edg",browserType:r.Edge},{keyword:"wv",browserType:r.WebView},{keyword:"MSIE",browserType:r.IE},{keyword:"Trident",browserType:r.IE},{keyword:"OPR",browserType:r.Opera},{keyword:"Chrome",browserType:r.Chrome},{keyword:"CriOS",browserType:r.Chrome},{keyword:"Firefox",browserType:r.Firefox},{keyword:"Safari",browserType:r.Safari}],this.networkTypes=[{keyword:"slow-2g",networkType:a.Slow2g},{keyword:"2g",networkType:a.Standard2g},{keyword:"3g",networkType:a.Standard3g},{keyword:"4g",networkType:a.Standard4g}],this.userAgent=this.windowService.nativeWindow.navigator.userAgent}getDeviceInfo(){if(this.deviceInfo)return this.deviceInfo;const e=this.userAgent.toLowerCase();let t={keyword:"Other",platformType:n.Other};this.platforms.some((i=>-1!==e.indexOf(i.keyword.toLowerCase())&&(t=i,!0))),t.platformType===n.AndroidPhone&&-1===e.indexOf("mobile")&&(t={keyword:"Android",platformType:n.AndroidTablet,pageName:"android-tablet"});let i=new l(0,0,0);if(t.platformType===n.Mac){const e=/Mac OS X (\d+)(_|\.)(\d+)([_\.]?)(\d*)/i.exec(this.userAgent);e.length>=6&&(i=new l(e[1],e[3],e[5]))}else if(t.platformType===n.PC||t.platformType===n.WindowsPhone)if(-1!==e.indexOf("windows xp"))i=new l(5,1,0);else{const e=/Windows (NT|Phone) (OS )?(\d+)\.(\d+)/i.exec(this.userAgent);e.length>=5&&(i=new l(e[3],e[4],0))}else if(t.platformType===n.iPad||t.platformType===n.iPhone){const t=e.match(/os (\d+)_(\d+)(_(\d+))?/);i=new l(t[1]||0,t[2]||0,t[4]||0)}let a={keyword:"Other",browserType:r.Other},o=new c(0,0,0);return this.browsers.some((t=>{if(-1!==e.indexOf(t.keyword.toLowerCase())){a=t;const i=e.split(t.keyword.toLowerCase()+"/")[1].match(/\d+|\s/);return o=new c(i[0]||0,i[1]||0,i[2]||0),!0}return!1})),this.deviceInfo={platform:t,platformVersion:i,browser:a,browserVersion:o},this.deviceInfo}getNetworkInfo(){if(this.networkType)return this.networkType;const e=this.windowService.nativeWindow.navigator.connection,t=e&&e.effectiveType?e.effectiveType:"Unknown";let i={keyword:"Unknown",networkType:a.Unknown};return this.networkTypes.some((e=>-1!==t.toLowerCase().indexOf(e.keyword)&&(i=e,!0))),this.networkType=i.networkType,this.networkType}isDesktopDevice(){const e=this.getDeviceInfo().platform.platformType;return e===n.PC||e===n.Mac||e===n.Linux||e===n.Chromebook}isMobileDevice(){const e=this.getDeviceInfo().platform.platformType;return e===n.iPhone||e===n.AndroidPhone||e===n.WindowsPhone}isTabletDevice(e=null){const t=this.getDeviceInfo().platform.platformType;return null!==e?t===e:t===n.iPad||t===n.AndroidTablet}isUwp(){return this.userAgent.toLowerCase().indexOf("msapphost/")>-1&&"undefined"!=typeof Windows}isWebView2(){return this.isUwp()&&void 0!==window.Office}isIE11Browser(){return this.userAgent.toLowerCase().indexOf("trident/7.0")>-1}}u.ɵprov=s.kc({factory:function(){return new u(s.lc(o.b))},token:u,providedIn:"root"})},WDeU:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("QjXU");function r(e){for(var t=[],i=0;i<e.length;++i){var n=("00"+e[i].toString(16)).slice(-2);t.push(n)}return t.join("")}var a=i("HZp7"),o=i("YqCH");function s(e,t,i,s,l){return Object(n.__awaiter)(this,void 0,void 0,(function(){var c,u,d;return Object(n.__generator)(this,(function(h){switch(h.label){case 0:return c=[Object(o.a)(e,t,i)],l&&c.push(function(e,t,i,a){return Object(n.__awaiter)(this,void 0,void 0,(function(){var o,s;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,a(t+i)];case 1:return o=n.sent(),[4,e.digest({name:"SHA-256"},o)];case 2:return s=n.sent(),[2,r(new Uint8Array(s))]}}))}))}(crypto.subtle,s,e,(function(e){return Object(a.b)(e)}))),[4,Promise.all(c)];case 1:return u=h.sent(),d=s,u.length>1&&(d=u[1]),[2,[u[0],d]]}}))}))}},WFKr:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("CVeG");class r{constructor(e,t){this.Finished=e,this.Value=t}static Finished(e){return new r(!0,e)}static Unfinished(e){return new r(!1,e)}}class a{static get MetacharactersMatch(){return/[\\^$*+?.()|[\]{}]/g}static get MetacharactersReplacement(){return"\\$&"}static escape(e){return e.replace(a.MetacharactersMatch,a.MetacharactersReplacement)}}class o{static Format(e,t,i){return o.FormatWithSeparator(e,o.DefaultSeparator(t),i)}static FormatWithSeparator(e,t,i){const r=[],s=o.FormatterPipeline.Run({PathArray:e,Formatted:"",Separator:t,MaxLength:i||o.DefaultMaxLength}).Formatted;r.push(s);const l=n.a.escapeHtml(t),c=`${o.PathSegmentPostfix}${o.PathSegmentPrefix}${l}${o.PathSegmentPostfix}${o.PathSegmentPrefix}`,u=o.GetRegExp(a.escape(l),"g");return r.push(`${o.PathSegmentPrefix}${n.a.escapeHtml(s).replace(u,c)}${o.PathSegmentPostfix}`),r}static DefaultSeparator(e){return e?o.DefaultPathSepRtl:o.DefaultPathSepLtr}static ZeroElements(e){return e.PathArray&&0!==e.PathArray.length?r.Unfinished(e):(e.Formatted="",r.Finished(e))}static TopTooLong(e){const t=e.PathArray[0].trim();return t.length>e.MaxLength?(e.Formatted=t.substr(0,e.MaxLength-1).trim()+o.Ellipsis,r.Finished(e)):r.Unfinished(e)}static SingleElement(e){return 1===e.PathArray.length?(e.Formatted=e.PathArray[0].trim(),r.Finished(e)):r.Unfinished(e)}static TopTooLongForSingleFollower(e){const t=e.PathArray[0].trim();return t.length+e.Separator.length+o.Ellipsis.length>e.MaxLength?(e.Formatted=t,r.Finished(e)):r.Unfinished(e)}static TopTooLongForMultipleFollowers(e){const t=e.PathArray[0].trim();return e.PathArray.length>2&&t.length+2*(e.Separator.length+o.Ellipsis.length)>e.MaxLength?(e.Formatted=t,r.Finished(e)):r.Unfinished(e)}static TopAndBottomTooLongAndOnlyElements(e){if(2===e.PathArray.length){const t=e.PathArray[0].trim(),i=e.PathArray[1].trim(),n=t.length+i.length+e.Separator.length+1-e.MaxLength;if(n>1)return e.Formatted=o.Join(t,o.Ellipsis+i.substr(n).trim(),e.Separator),r.Finished(e)}return r.Unfinished(e)}static TopAndBottomTooLongAndOtherElements(e){if(e.PathArray.length>2){const t=e.PathArray[0].trim();let i=e.PathArray[e.PathArray.length-1].trim();const n=t.length+i.length+2*(e.Separator.length+1)-e.MaxLength;if(n>1)return i=i.substr(n).trim(),e.Formatted=o.Join(t,o.Ellipsis,e.Separator),i.length>0&&(e.Formatted=o.Join(e.Formatted,o.Ellipsis+i,e.Separator)),r.Finished(e)}return r.Unfinished(e)}static MultipleElements(e){return e.Formatted=e.PathArray.reduce(((t,i)=>o.Join(t,i,e.Separator))),e.Formatted.length<=e.MaxLength?r.Finished(e):r.Unfinished(e)}static CollapseFirst(e){const t=o.GetRegExp(e.Separator+".*?"+e.Separator);return e.Formatted=e.Formatted.replace(t,e.Separator+o.Ellipsis+e.Separator),e.Formatted.length<=e.MaxLength?r.Finished(e):r.Unfinished(e)}static CollapseRemaining(e){const t=o.GetRegExp(e.Separator+".*?"+e.Separator+".*?"+e.Separator);for(;e.Formatted.length>e.MaxLength;){const i=e.Formatted;if(e.Formatted=e.Formatted.replace(t,e.Separator+o.Ellipsis+e.Separator),i===e.Formatted)break}return r.Finished(e)}static Join(e,t,i){return 0===t.length?e:e.trim()+i+t.trim()}static GetRegExp(e,t=""){const i=`${e}/${t}`;if(o.RegExpCache.has(i))return o.RegExpCache.get(i);const n=new RegExp(e,t);return o.RegExpCache.set(i,n),n}}o.DefaultMaxLength=60,o.DefaultPathSepLtr=" » ",o.DefaultPathSepRtl=" « ",o.Ellipsis="…",o.PathSegmentPrefix='<span dir="auto">',o.PathSegmentPostfix="</span>",o.FormatterPipeline=new class{constructor(...e){this.Pipeline=e}Run(e){if(!this.Pipeline||0===this.Pipeline.length)return e;let t=null;for(let i=0;i<this.Pipeline.length;i++){if(t=this.Pipeline[i](e),t.Finished)return t.Value;e=t.Value}return t?t.Value:e}}(o.ZeroElements,o.TopTooLong,o.SingleElement,o.TopTooLongForSingleFollower,o.TopTooLongForMultipleFollowers,o.TopAndBottomTooLongAndOnlyElements,o.TopAndBottomTooLongAndOtherElements,o.MultipleElements,o.CollapseFirst,o.CollapseRemaining),o.RegExpCache=new Map},WJRI:function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return l}));var n=i("Mlb/"),r=i("vk2e"),a=i("kVgv"),o=n.Fb({encapsulation:2,styles:[],data:{}});function s(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"div",[["aria-live","assertive"],["class","title-announcement"],["role","alert"],["tabindex","-1"]],[[1,"aria-label",0]],null,null,null,null)),(e()(),n.gc(1,null,[" ","\n"]))],null,(function(e,t){var i=t.component;e(t,0,0,i.announcement),e(t,1,0,i.announcement)}))}function l(e){return n.jc(2,[(e()(),n.qb(16777216,null,null,1,null,s)),n.Gb(1,16384,null,0,r.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,1,0,t.component.announcement)}),null)}n.Db("ohp-title-announcer",a.a,(function(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-title-announcer",[],null,null,null,l,o)),n.Gb(1,49152,null,0,a.a,[],null,null)],null,null)}),{announcement:"announcement"},{},[])},WLAd:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("hZW2"),r=i("Mlb/");class a{constructor(e){this.documentService=e}addOnVisibilityChanged(e){const t=this.documentService.nativeDocument;t.addEventListener("visibilitychange",(()=>e(t.visibilityState)))}getVisibilityState(){return this.documentService.nativeDocument.visibilityState}isVisible(){return"visible"===this.getVisibilityState()}}a.ɵprov=r.kc({factory:function(){return new a(r.lc(n.a))},token:a,providedIn:"root"})},Xc4i:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("pM41"),r=i("EYJY"),a=i("HbWZ"),o=i("WKA6"),s=(i("hhzZ"),i("BaAg")),l=i("jCfB"),c=(i("4/We"),i("cgnd"),i("/I02"),i("idgT"),i("oAX+")),u=i("y9oG"),d=(i("hZW2"),i("Uqr9"),i("Brer")),h=i("EUVs");class p{constructor(e,t,i,n,r,a,o,s){this.capabilitiesService=e,this.clientStartupConfigService=t,this.contextService=i,this.documentService=n,this.instrumentationService=r,this.performanceService=a,this.templatesConfigService=o,this.vroomService=s,this.index=0,this.bootstrappersLoaded=new Map,this.bootstrapperDiagnostics=new Map,this.applicationUrls=new Map,this.performanceMarker=new Map}loadBootstrapper(e,t,i,n=!1){if(this.bootstrappersLoaded.has(e))return this.bootstrappersLoaded.get(e);const r=new Promise(((t,n)=>{this.bootstrapperDiagnostics.set(e,{startTime:Date.now()}),this.documentService.addScriptToPage(e,(()=>{this.bootstrapperDiagnostics.get(e).endTime=Date.now(),t()}),n,!1,`${s.b[i]}_bootstrapper`)}));return n&&this.templatesConfigService.prefetchStaticResources(i),this.bootstrappersLoaded.set(e,r),this.applicationUrls.set(i,{bootstrapperUrl:e,applicationUrl:t}),r}convertMruInflationPromise(e,t,i){return e.then((e=>{const n=h.a.getDocumentInfoForMruFileItem(e,t);return{fetchDiagnostics:{startTime:i,endTime:Date.now()},wopiHostData:e.wopiData,fetchedDocumentInfo:n.docId&&n.driveId?this.getDocumentInfoWithSharingLink(n):this.getWopiData(n,!1,!1,!0).then((e=>e.fetchedDocumentInfo))}}))}getWopiData(e,t=!1,i=!1,n=!1){const r=Date.now(),[a,o]=this.getDriveItemWithWacData(e,t,i);return a.then((t=>{var i,a,s,l;if(t){const o={startTime:r,endTime:Date.now()},c=d.a.getWopiHostDataFromItem(t),u=Object.assign(Object.assign({},e),{docUrl:null!==(i=t.webUrl)&&void 0!==i?i:e.docUrl,driveId:null!==(s=null===(a=null==t?void 0:t.parentReference)||void 0===a?void 0:a.driveId)&&void 0!==s?s:e.driveId,docId:null!==(l=null==t?void 0:t.id)&&void 0!==l?l:e.docId}),h=n?this.getDocumentInfoWithSharingLink(u):Promise.resolve(u);return Promise.resolve({wopiHostData:c,fetchDiagnostics:o,fetchedDocumentInfo:h})}return o.then((e=>Promise.reject(e))).catch((e=>Promise.reject(e)))})).catch((e=>Promise.reject(e)))}logPerformanceEventFromClick(e,t,i){var n;const{clickTimeMarker:r,instrumentationParams:a}=null!==(n=this.performanceMarker.get(e))&&void 0!==n?n:{clickTimeMarker:1,instrumentationParams:{WacHostEntry:this.contextService.getWdOrigin("DIRECT"),ResourceId:this.getCorrelationIdForBootId(e),FileFormat:s.a.fileTypeNameFromType(i)}};this.performanceService.mark(`${t}.${e}`,r,void 0,a)}generateCorrelationAndBootId(e){const t=null!=e?e:this.index++;return[this.getCorrelationIdForBootId(t),t]}logPerformanceBootStart(e,t,i,n){const r={WacHostEntry:i,ResourceId:t,FileFormat:s.a.fileTypeNameFromType[n]},a=this.performanceService.mark(`WacContentPerformanceMarker.DocumentLoadStart.${e}`,0,void 0,r);this.performanceMarker.set(e,{clickTimeMarker:a,instrumentationParams:r})}logBootPerformance(e,t,i,r){if(!i||!i.documentLoadedTime||!r)return;const a={DebugInfo:JSON.stringify(i)},o=Object(u.a)(e,t,a),s=i.documentLoadedTime-r;this.instrumentationService.logPerformanceEvent(l.b,s,o),Object(n.a)({eventName:l.b,latency:s,instrumentationParams:o})}getDocumentInfoWithSharingLink(e){return this.capabilitiesService.capabilities.wacSharingLinkEnabled?this.vroomService.createSharingLink(e.driveId,e.docId).then((t=>{let i;try{i=decodeURIComponent(t)}catch(t){return e}return Object.assign(Object.assign({},e),{docUrl:null!=i?i:e.docUrl})})).catch((()=>e)):Promise.resolve(e)}getCorrelationIdForBootId(e){return`${this.clientStartupConfigService.config.sharedClientStartupContext.correlationId}.${e}`}getDriveItemWithWacData(e,t,i){const{docId:n,driveId:s,docUrl:l,fileType:u}=e,d=t?"editnew":"open",h=s&&n?e=>this.vroomService.getItemWithWacData(l,s,n,e,d,i):e=>this.vroomService.getSharedItemWithoutThumbnail(l,u,null,e,!0,d,i),p=new r.a;return[(i?Object(a.a)(h("network-only")):c.a.createResultsWithCacheObservable(h("cache-only"),h("network-first"),void 0,(e=>p.error(e))).results).pipe(Object(o.a)(1)).toPromise(),p.toPromise()]}}},Xn3c:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("CMIS"),r=i("lrJm"),a=i("3GGT"),o=i("hhzZ"),s=i("R7NL"),l=i("/I02"),c=i("kpuN"),u=i("MMsA"),d=i("dFxn"),h=i("wwmn"),p=i("casz"),m=i("4d0o"),f=i("Mlb/");class g{constructor(e,t,i,n,r,a,o,s,l,c){this.accessTokenService=e,this.contextService=t,this.instrumentationService=i,this.instrumentedHttp=n,this.authStateService=r,this.officeHomeApiConfigService=a,this.userDataStorageConfigService=o,this.globalErrorHandler=l,this.scheduler=c,null!=t.sharedContext.officeHomeApiRoot&&o.config&&null!=o.config.userStorageEndpoint&&(this.serviceUrl=`${t.sharedContext.officeHomeApiRoot}/${o.config.userStorageEndpoint}`);const u=s.parse("userStorageCache")||{firstUse:!1,firstUseTimestamp:0,content:{}};this.firstUse=u.firstUse,this.firstUseTimestamp=u.firstUseTimestamp,this.masterCollection=u.content}get(e,t=1){return new Promise(((i,n)=>{if(this.masterCollection.hasOwnProperty(e)){const t=Object.assign({},this.masterCollection[e]);return void i(t)}if(this.firstUse||t<1)return void i(void 0);if("SignedIn"!==this.authStateService.getCurrentState())return void n(`User has to be signed in to access storage for <${e}> key.`);if(!this.serviceUrl)return void n("User storage does not support roaming");let r=0;const o=(s,l,c)=>{this.instrumentedHttp.get(s,l,`${this.serviceUrl}/${e}/`,c||{},"network-only").instrument(((t,i)=>{i.ElementId=e,i.Retry=r.toString()})).then((e=>i(e.data))).catch((u=>{this.globalErrorHandler.handleError(u,"Bn3rc"),u&&u.status===a.a.NotFound?i(void 0):u.status!==a.a.Forbidden&&r<t-1?(r++,o(s,l,c)):n(`Failed to get value from user data storage for <${e}> key. Status code: ${u.status}`)}))};this.request(o,"OfficeHomeStorage_Read_Request","OfficeHomeStorage_Read",n)}))}set(e,t){return new Promise(((i,r)=>{"SignedIn"===this.authStateService.getCurrentState()?(this.masterCollection[e]=Object.assign({},t),this.serviceUrl?this.request(((a,o,s)=>{if((s=s||{}).headers||(s.headers=new Map),!this.officeHomeApiConfigService.config.jwtAuthEnabled&&!this.contextService.sharedContext.inMockMode){if(!this.contextService.getCsrfToken())return this.instrumentationService.logErrorEvent("Csrf_Token_Error"),Object(n.a)({eventName:"Csrf_Token",errorType:"User_Storage_Error"}),void r("CSRF token missing");s.headers.set("AjaxSessionKey",this.contextService.getCsrfToken())}const l=()=>this.instrumentedHttp.put(a,o,`${this.serviceUrl}/${e}/`,t,s).instrument(((t,i)=>{i.ElementId=e})).then((()=>i(null))).catch((t=>{this.globalErrorHandler.handleError(t,"J7GBR"),r(`Failed to update or create value in roaming user data storage for <${e}> key. Status code: ${t.status}`)}));this.userDataStorageConfigService.config.deferWrite?this.scheduler.scheduleWork((()=>{l()}),4):l()}),"OfficeHomeStorage_Write_Request","OfficeHomeStorage_Write",r):r("User storage does not support roaming")):r(`User has to be signed in to access storage for <${e}> key.`)}))}request(e,t,i,n){this.officeHomeApiConfigService.config.jwtAuthEnabled?this.accessTokenService.getAccessToken("OfficeHome").then((r=>{if(!r.success)return this.instrumentationService.logRequestEvent(t,a.a.TokenUnavailable,-1,"string"==typeof r.error?r.error:""),void n("Token Unavailable");const o={headers:new Map([["Authorization",`Bearer ${r.token}`]])};e(t,i,o)})):e(t,i)}isFirstUse(){return this.firstUse}getFirstUseTimestamp(){return this.firstUseTimestamp}}g.ɵprov=f.kc({factory:function(){return new g(f.lc(c.a),f.lc(l.a),f.lc(o.a),f.lc(s.a),f.lc(u.a),f.lc(h.a),f.lc(m.a),f.lc(d.a),f.lc(r.b),f.lc(p.a))},token:g,providedIn:"root"})},Y22C:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n=function(){function e(){this.queuedEvents=[]}return e.prototype.queueEvent=function(e){this.queuedEvents.push(e)},e.prototype.drainQueue=function(){return this.queuedEvents.splice(0,this.queuedEvents.length)},e}()},YqCH:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("QjXU"),r=i("e3cR"),a=i("obr3"),o=i("H2Bi"),s=new Map;function l(e,t,i){return Object(n.__awaiter)(this,void 0,void 0,(function(){var c,u,d,h,p;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:if(u=s.get(c=e+"."+o.a+"."+t))return[2,u];n.label=1;case 1:return n.trys.push([1,3,,7]),[4,d=Object(r.b)(c,{upgrade:function(e){try{e.deleteObjectStore(o.b)}catch(e){}e.createObjectStore(o.b)},blocking:function(){d.then((function(e){e.close(),s.delete(c)}))},terminated:function(){s.delete(c)}},i)];case 2:return h=n.sent(),s.set(c,d),[2,h];case 3:return(p=n.sent())instanceof DOMException?[4,Object(a.a)(c)]:[3,5];case 4:return n.sent(),[2,l(e,t,i)];case 5:throw new Error("Failed to create database with exception: "+p.toString());case 6:return[3,7];case 7:return[2]}}))}))}},Yvbg:function(e,t,i){"use strict";function n(e){return/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(e)}i.d(t,"a",(function(){return n}))},Z0U4:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var n=i("qk26"),r=i("GMuP"),a=i("6UlS"),o=i("S5zL"),s=i("70cc"),l=i("hhzZ"),c=i("BaAg"),u=i("4/We"),d=i("ZBli"),h=i("uzn7"),p=i("5aVq"),m=i("BMb5"),f=i("Mlb/"),g=i("vk2e");class b{constructor(e,t,i,n,s,l,c,u,d){this.activatedRoute=e,this.capabilitiesService=t,this.instrumentationService=i,this.localStorageService=n,this.locationStrategy=s,this.platformLocation=l,this.router=c,this.windowService=u,this.shellShimService=d;const h=this.windowService.nativeWindow.history;if(this.historyEnabled=!!h&&!!h.go,this.historyEnabled)try{this.lastPoppedState=this.parseState(h.state),this.windowService.nativeWindow.addEventListener("popstate",(e=>{this.lastPoppedState=this.parseState(e.state)}))}catch(e){this.historyEnabled=!1}this.historyEnabled||(this.instrumentationService.logGenericEvent("History_Disabled"),Object(r.a)({eventName:"History_Disabled",params:{}})),this.initialRoute=this.currentRouteFromPath(this.platformLocation.pathname),this._routes=new a.a({currentRoute:this.initialRoute,type:0}),this.routes=this._routes.asObservable().pipe(Object(o.a)(((e,t)=>e.type===t.type&&b.areRoutesEqual(e.currentRoute,t.currentRoute)))),this.nativeSearchEnabled=this.capabilitiesService.capabilities.nativeSearchInHeaderEnabled}static areRoutesEqual(e,t){return!(!e||!t||e.route!==t.route)&&("M365Apps"===e.route&&"M365Apps"===t.route?e.appId===t.appId&&e.entityId===t.entityId&&e.subEntityId===t.subEntityId:e.app===t.app)}start(){this.router.events.pipe(Object(s.a)((e=>e instanceof n.e||e instanceof n.d))).subscribe((e=>{const t=e.url?e.url.split("?")[0]:null,i=this.currentRouteFromPath(t),a={currentRoute:i,type:e instanceof n.e?0:1},o=!this.ignoreNextNavigation&&(!this.currentRouteState||!b.areRoutesEqual(i,this.currentRouteState.routeItem)||this.rewriteInProgress);if(this.isRouteChangeEndEvent(a)){if("eager"===this.router.urlUpdateStrategy&&(this.router.urlUpdateStrategy="deferred"),this.ignoreNextNavigation)return void(this.ignoreNextNavigation=!1);let e={routeItem:i,index:this.historyEnabled?this.windowService.nativeWindow.history.length:-1,backRouteItem:null,backIndex:-1,version:b.officeRouteStateVersion};if(this.lastPoppedState&&b.areRoutesEqual(this.lastPoppedState.routeItem,i))e=this.lastPoppedState;else if(this.historyEnabled&&this.currentRouteState){if(e.index!==this.currentRouteState.index+1){const t={};t.Index=e.index.toString(),i&&(t.State=i.route,t.DocumentType=i.app?c.b[i.app]:""),t.Error=this.versionMismatch?"Version":"Index",t.DebugInfo=`new: ${JSON.stringify(e)}, current: ${JSON.stringify(this.currentRouteState)}, previous: ${JSON.stringify(this.previousRouteState)}`,this.instrumentationService.logGenericEvent("Unexpected_History_State",t),Object(r.a)({eventName:"Unexpected_History_State",params:t}),this.previousRouteState||this.currentRouteState.routeItem&&"OfficeHome"===this.currentRouteState.routeItem.route||(this.historyEnabled=!1,e.index=-1)}if(this.historyEnabled){e.index=this.currentRouteState.index+1;const t=b.areRoutesEqual(this.currentRouteState.routeItem,i);e.backRouteItem=t?this.currentRouteState.backRouteItem:this.currentRouteState.routeItem,e.backIndex=t?this.currentRouteState.backIndex:this.currentRouteState.index}}this.updateState(e),this.lastPoppedState=null,this.previousRouteState=this.currentRouteState,this.currentRouteState=e,this.rewriteInProgress=!1,a.previousRoute=this.previousRouteState?this.previousRouteState.routeItem:null,a.backRoute=e.backRouteItem}o&&this._routes.next(a)}))}hasNavigated(){return this.router.navigated}back(e=null){if(!this.currentRouteState)return void(e&&this.navigateTo(e));this.nativeSearchEnabled&&this.currentRouteState.routeItem&&"Search"===this.currentRouteState.routeItem.route&&this.shellShimService.getShellShim().then((e=>{e.Search.SetSearchText("")}));const t=this.currentRouteState.backIndex-this.currentRouteState.index;this.historyEnabled&&this.currentRouteState.backIndex>=0&&t<0?this.windowService.nativeWindow.history.go(t):e?this.navigateTo(e):this.platformLocation.back()}getNavigationUrl(e="/",...t){const i=[e].concat(t),n=Object.assign({},this.activatedRoute.snapshot.queryParams);return this.router.serializeUrl(this.router.createUrlTree(i,{queryParams:n}))}navigateTo(e,t=!1,i=null,n,r=!1){const a=this.getCommandsAndParamsForRoute(e,i);if(!a)return;const[o,s]=a;return this.navigateToInternal(o,t,s,n,r)}getUrlForRoute(e,t=null){const i=this.getCommandsAndParamsForRoute(e,t);if(!i)return;const[n,r]=i,a=n.reduce(((e,t)=>e+t.split("/").filter((e=>!!e)).join("/")+"/"),`${this.platformLocation.protocol}//${this.platformLocation.hostname}/`);return d.a.appendQueryParams(a,r)}updateQueryParams(e){this.ignoreNextNavigation=!0,this.router.navigate([],{relativeTo:this.activatedRoute,queryParams:e,queryParamsHandling:"merge",replaceUrl:!0}).then((()=>{this.ignoreNextNavigation=!1})).catch((()=>{this.ignoreNextNavigation=!1}))}navigateToAuxilaryRoute(e,t){const i={};i[e]=t?[t]:null,this.ignoreNextNavigation=!0,this.router.navigate([{outlets:i}],{queryParamsHandling:"preserve",skipLocationChange:!0})}redirectAndRewrite(e="/",...t){this.currentRouteState=this.previousRouteState,this.rewriteInProgress=!0;const i=[e].concat(t);if(this.capabilitiesService.capabilities.isEmbedMode){const e=i.shift().split("/").join("");i.unshift("/Embed/".toLowerCase(),e)}this.router.navigate(i,{queryParamsHandling:"preserve",replaceUrl:!0})}subscribeToRouteChangeStart(e){return this.routes.pipe(Object(s.a)(this.isRouteChangeStartEvent)).subscribe(e)}subscribeToRouteChangeEnd(e){return this.routes.pipe(Object(s.a)(this.isRouteChangeEndEvent)).subscribe(e)}getRouteChangeStartObservable(){return this.routes.pipe(Object(s.a)(this.isRouteChangeStartEvent))}getRouteChangeEndObservable(){return this.routes.pipe(Object(s.a)(this.isRouteChangeEndEvent))}isOnRoute(e){return this.currentRouteState.routeItem.route===e}getCurrentRoute(){return this.currentRouteState?this.currentRouteState.routeItem:null}getCurrentPageForLogging(){const e=this.getCurrentRoute();return e?`${e.app?c.b[e.app]:""}${e.route}`:"Unknown"}getInitialRoute(){return this.initialRoute}getInitialPageForLogging(){const e=this.initialRoute;return e?`${e.app?c.b[e.app]:""}${e.route}`:"Unknown"}getRouteItemForCurrentLocation(){return this.currentRouteFromPath(this.platformLocation.pathname)}isRouteChangeStartEvent(e){return 0===e.type}isRouteChangeEndEvent(e){return 1===e.type}getCommandsAndParamsForRoute(e,t=null){if(!e)return;let i=Object.assign({},this.activatedRoute.snapshot.queryParams);"Search"!==e.route&&this.currentRouteState&&this.currentRouteState.routeItem&&("Search"===this.currentRouteState.routeItem.route||"SearchPersonScoped"===this.currentRouteState.routeItem.route||"SearchTopicScoped"===this.currentRouteState.routeItem.route||"SearchMeetingScoped"===this.currentRouteState.routeItem.route)&&(delete i.q,delete i.p,delete i.e,delete i.s,delete i.pp,delete i.topicId,delete i.topicName,delete i.meetingId,delete i.meetingName,delete i.refiners,delete i.wm),this.currentRouteState&&this.currentRouteState.routeItem&&"Content"===this.currentRouteState.routeItem.route&&(delete i.item,delete i.drive,delete i.file,delete i.action,delete i.siteUrl,delete i.abpId,delete i.t),t&&(i=Object.assign(Object.assign({},i),t));const n=[];switch(e.route){case"AppGallery":n.push("apps");break;case"Search":case"SearchSiteScoped":n.push("search");break;case"SearchTopicScoped":n.push("search/topic");break;case"SearchMeetingScoped":n.push("search/meeting");break;case"SearchPersonScoped":n.push("search/content");break;case"Start":n.push(this.capabilitiesService.capabilities.startPageRootPath);break;case"ModernStart":n.push(this.capabilitiesService.capabilities.modernStartPageRootPath);break;case"Templates":n.push(this.capabilitiesService.capabilities.templatePageRootPath);break;case"Pwa":n.push("pwa");break;case"Create":n.push("create");break;case"Content":case"MyForms":case"GroupForms":n.push(this.capabilitiesService.capabilities.startPageRootPath);break;case"M365Apps":n.push(this.capabilitiesService.capabilities.m365AppsPageRootPath.toLowerCase()),e.appId&&(n.push(e.appId.toLocaleLowerCase()),e.entityId&&(n.push(e.entityId),e.subEntityId&&n.push(e.subEntityId)));break;case"ConsumerAllSearch":n.push("search/main");break;case"ConsumerFileSearch":n.push("search/docs");break;case"ConsumerTemplateSearch":n.push("search/templates");break;case"MyContent":n.push("mycontent");break;case"Feed":n.push("feed");break;default:n.push("home")}if(e.app&&n.push(c.b[e.app]),"MyForms"===e.route&&n.push("MyForms"),"GroupForms"===e.route&&n.push("GroupForms"),"Content"===e.route&&n.push(this.capabilitiesService.capabilities.wacHostPagePath.replace("/","")),this.capabilitiesService.capabilities.isEmbedMode){const e=n.shift().split("/").join("");n.unshift("/Embed/",e)}return"M365Apps"===e.route?[n,i]:[n.map((e=>e.toLowerCase())),i]}currentRouteFromPath(e){var t,i;if(!e)return null;let n=e.toLowerCase(),r=null,a=null;if(0===n.indexOf("/embed")&&(n=n.replace("/embed","")),"/"===n||0===n.indexOf("/home"))r=this.capabilitiesService.capabilities.pwaEnabled?"Pwa":"OfficeHome";else if(0===n.indexOf("/apps"))r="AppGallery";else if(0===n.indexOf("/search"))r=this.isSiteScopedSearchRoute(n)?"SearchSiteScoped":this.isTopicScopedSearchRoute(n)?"SearchTopicScoped":this.isMeetingScopedSearchRoute(n)?"SearchMeetingScoped":this.isPersonScopedSearchRoute(n)?"SearchPersonScoped":"Search";else if(0===n.indexOf("/pwa"))r="Pwa";else{if(0===n.indexOf("/m365apps")){r="M365Apps";const n=e.split("/").filter((e=>!!e));return{route:r,appId:n[1]?n[1].toLowerCase():void 0,entityId:null!==(t=n[2])&&void 0!==t?t:void 0,subEntityId:null!==(i=n[3])&&void 0!==i?i:void 0}}if(0===n.indexOf("/create"))r="Create";else if(0===n.indexOf("/mycontent"))r="MyContent";else if(0===n.indexOf("/feed"))r="Feed";else{const e=0===n.indexOf(this.capabilitiesService.capabilities.templatePageRootPath.toLowerCase()),t=0===n.indexOf(this.capabilitiesService.capabilities.startPageRootPath.toLowerCase()),i=0===n.indexOf(this.capabilitiesService.capabilities.modernStartPageRootPath.toLowerCase()),o=n.indexOf(this.capabilitiesService.capabilities.wacHostPagePath.toLowerCase())>=0&&(t||i),s=n.toLocaleLowerCase().indexOf("/myforms")>=0&&t,l=n.toLocaleLowerCase().indexOf("/groupforms")>=0&&t;if(e||t||i||o||s||l){const t=n.split("/");r=e?"Templates":o?"Content":s?"MyForms":l?"GroupForms":i?"ModernStart":"Start",a=c.a.fileTypeNameToFileType(t[o||s||l?t.length-2:t.length-1])}}}return r?{route:r,app:a}:null}navigateToInternal(e,t=!1,i={},n,r=!1){return t&&(this.currentRouteState=this.previousRouteState,this.rewriteInProgress=!0),n&&e.length&&this.localStorageService.set(n,e[0]),this.router.urlUpdateStrategy=r?"eager":"deferred",this.router.navigate(e,{queryParams:i,replaceUrl:t})}parseState(e){const t=e?e.ohpState:null;return t&&t.version!==b.officeRouteStateVersion&&(this.versionMismatch=!0),this.versionMismatch?null:t}updateState(e){if(this.historyEnabled){const t=this.windowService.nativeWindow.history.state?Object.assign({},this.windowService.nativeWindow.history.state):{};t.ohpState=e,this.locationStrategy.replaceState(t,"",this.platformLocation.pathname,this.platformLocation.search+this.platformLocation.hash)}}isSiteScopedSearchRoute(e){return e.startsWith("/search/siteall")||e.startsWith("/search/sitenews")||e.startsWith("/search/sitesites")||e.startsWith("/search/sitefiles")||e.startsWith("/search/siteimages")}isTopicScopedSearchRoute(e){return e.startsWith("/search/topic")}isMeetingScopedSearchRoute(e){return e.startsWith("/search/meeting")}isPersonScopedSearchRoute(e){return e.startsWith("/search/content")||e.startsWith("/search/contact")||e.startsWith("/search/organization")||e.startsWith("/search/calendar")||e.startsWith("/search/office")||e.startsWith("/search/personconversations")||e.startsWith("/search/overview")}}b.officeRouteStateVersion=1,b.ɵprov=f.kc({factory:function(){return new b(f.lc(n.a),f.lc(u.a),f.lc(l.a),f.lc(h.a),f.lc(g.h),f.lc(g.q),f.lc(n.n),f.lc(m.b),f.lc(p.a))},token:b,providedIn:"root"})},ZBSS:function(e,t,i){"use strict";i.d(t,"Z",(function(){return n})),i.d(t,"cb",(function(){return r})),i.d(t,"hb",(function(){return a})),i.d(t,"A",(function(){return o})),i.d(t,"l",(function(){return s})),i.d(t,"n",(function(){return l})),i.d(t,"db",(function(){return c})),i.d(t,"D",(function(){return u})),i.d(t,"s",(function(){return d})),i.d(t,"o",(function(){return h})),i.d(t,"h",(function(){return p})),i.d(t,"i",(function(){return m})),i.d(t,"T",(function(){return f})),i.d(t,"eb",(function(){return g})),i.d(t,"C",(function(){return b})),i.d(t,"r",(function(){return v})),i.d(t,"I",(function(){return S})),i.d(t,"m",(function(){return y})),i.d(t,"g",(function(){return C})),i.d(t,"y",(function(){return w})),i.d(t,"X",(function(){return I})),i.d(t,"a",(function(){return T})),i.d(t,"p",(function(){return k})),i.d(t,"B",(function(){return A})),i.d(t,"Y",(function(){return _})),i.d(t,"w",(function(){return P})),i.d(t,"bb",(function(){return E})),i.d(t,"H",(function(){return F})),i.d(t,"z",(function(){return O})),i.d(t,"k",(function(){return D})),i.d(t,"J",(function(){return M})),i.d(t,"K",(function(){return R})),i.d(t,"L",(function(){return x})),i.d(t,"M",(function(){return L})),i.d(t,"N",(function(){return U})),i.d(t,"O",(function(){return N})),i.d(t,"Q",(function(){return W})),i.d(t,"R",(function(){return j})),i.d(t,"G",(function(){return H})),i.d(t,"j",(function(){return B})),i.d(t,"fb",(function(){return G})),i.d(t,"E",(function(){return q})),i.d(t,"U",(function(){return V})),i.d(t,"V",(function(){return $})),i.d(t,"W",(function(){return z})),i.d(t,"P",(function(){return Z})),i.d(t,"c",(function(){return K})),i.d(t,"d",(function(){return J})),i.d(t,"b",(function(){return Q})),i.d(t,"e",(function(){return Y})),i.d(t,"F",(function(){return X})),i.d(t,"t",(function(){return ee})),i.d(t,"x",(function(){return te})),i.d(t,"u",(function(){return ie})),i.d(t,"v",(function(){return ne})),i.d(t,"S",(function(){return re})),i.d(t,"f",(function(){return ae})),i.d(t,"q",(function(){return oe})),i.d(t,"ab",(function(){return se})),i.d(t,"gb",(function(){return le}));var n="Release",r="RequestOrigin",a="UserSegment",o="EventSchemaVersion",s="BrowserSessionId",l="DeploymentEnvironment",c="Geo",u="Flights",d="EcsRing",h="DeviceType",p="AppWorkload",m="AppWorkloadType",f="NetworkType",g="ServiceWorkerState",b="FirstVisitAgeInDays",v="DomainOrigin",S="InitialPageName",y="DataBoundary",C="AppLanguage",w="EventCategory",I="PageView",T="Action",k="Diagnostic",A="Feature",_="Performance",P="Error",E="Request",F="Impression",O="EventName",D="AudienceGroup",M="IsAdmin",R="IsDynamics",x="IsEdu",L="IsEduFaculty",U="IsEduStudent",N="IsFirstVisit",W="IsIw",j="IsSmb",H="Id",B="Area",G="SubArea",q="FromCache",V="AppName",$="PageName",z="PageType",Z="IsIntentional",K="Target",J="TargetId",Q="Result",Y="Type",X="HttpCode",ee="Error",te="ErrorType",ie="ErrorCategory",ne="OccurrenceCount",re="Latency",ae="ActualSize",oe="Distribution",se="RenderSize",le="TotalSize"},ZBli:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("pjz5");class r{static appendQueryParam(e,t,i){if(!e||!t)return e;const n={};return n[t]=i,r.appendQueryParams(e,n)}static appendQueryParams(e,t,i){return e?r.appendQuery(e,r.buildQueryPath(t,i)):e}static appendQuery(e,t){if(!e||!t)return e;const{protocol:i,hostname:r,port:a,path:o,search:s,hash:l}=n.a.getLocation(e);return`${i}//${r}${a?":"+a:""}${o}${s?s+"&":"?"}${t}${l}`}static appendAndReplaceQueryParams(e,t,i,a){if(!e||!t)return e;const o={},{protocol:s,hostname:l,path:c,search:u,hash:d}=n.a.getLocation(e);"?"===u[0]&&u.substring(1).split("&").forEach((e=>{const t=e.split("=");i?o[decodeURIComponent(t[0])]=decodeURIComponent(t[1]):o[t[0]]=t[1]}));for(const e in t)o[e]=t[e];return r.appendQueryParams(s+"//"+l+c+d,o,a)}static appendLoginHint(e,t,i){return i?r.appendQueryParam(e,"login_hint",t):e}static removeQueryParams(e,t,i){if(!e||!t)return e;const a={},{protocol:o,hostname:s,path:l,search:c,hash:u}=n.a.getLocation(e);return"?"===c[0]&&c.substring(1).split("&").forEach((e=>{const n=e.split("="),r=i?decodeURIComponent(n[0]):n[0];t.some((e=>e.toLowerCase()===r.toLowerCase()))||(a[r]=i?decodeURIComponent(n[1]):n[1])})),r.appendQueryParams(o+"//"+s+l+u,a,!1)}static buildQueryPath(e,t){if(!e)return"";let i="";for(const n in e){const r=i?"&":"";let a;a=t?e[n]?`${e[n]}`:"":e[n]?`${encodeURIComponent(e[n])}`:"",i=`${i}${r}${n}=${a}`}return i}static replacePathAndAddParams(e,t,i){const a=i?r.appendAndReplaceQueryParams(e,i,!1):e,{protocol:o,hostname:s,port:l,search:c,hash:u}=n.a.getLocation(a);return`${o}//${s}${l?":"+l:""}${t}${c}${u}`}}},ZJrL:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{static parseJsonElementWithId(e){const t=document.getElementById(e),i=t&&t.textContent;return i?JSON.parse(i):null}static decodeJsonString(e){const t=e.split('"');return t.forEach(((e,t,i)=>{const n=decodeURIComponent(e);i[t]=n.replace(/"/g,'\\"')})),t.join('"')}}},ZcZ3:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("6ib3"),r=i("Tqea");function a(e){switch(e){case n.a.Word:return"WordOnline";case n.a.Excel:return"ExcelOnline";case n.a.PowerPoint:return"PowerPointOnline";case n.a.OneNote:return"OneNoteOnline";case n.a.Sway:return"Sway";case n.a.Visio:return"VisioOnline";case n.a.Project:case n.a.ProjectOperations:case n.a.Portfolio:return"Project";case n.a.PowerBI:return"PowerBIv2";default:return Object(r.a)(e)}}},Zmq1:function(e,t,i){"use strict";var n;function r(e){var t=parseInt(e);return isNaN(t)?0:t}function a(){if(n)return n;var e=window.navigator.userAgent.toLowerCase(),t={keyword:"Other",platformType:"Other"};[{keyword:"Windows NT",platformType:"PC"},{keyword:"Windows XP",platformType:"PC"},{keyword:"Macintosh",platformType:"Mac"},{keyword:"Windows Phone",platformType:"WindowsPhone",pageName:"windows-phone"},{keyword:"iPad",platformType:"iPad",pageName:"ipad"},{keyword:"iPhone",platformType:"iPhone",pageName:"iphone"},{keyword:"Android",platformType:"AndroidPhone",pageName:"android-phone"},{keyword:"Linux",platformType:"Linux"},{keyword:"CrOS",platformType:"Chromebook"}].some((function(i){return-1!==e.indexOf(i.keyword.toLowerCase())&&(t=i,!0)})),"AndroidPhone"===t.platformType&&-1===e.indexOf("mobile")&&(t={keyword:"Android",platformType:"AndroidTablet",pageName:"android-tablet"});var i={major:0,minor:0,build:0};if("Mac"===t.platformType)(a=/Mac OS X (\d+)(_|\.)(\d+)([_\.]?)(\d*)/i.exec(window.navigator.userAgent))&&a.length>=6&&(i={major:r(a[1]),minor:r(a[3]),build:r(a[5])});else if("PC"===t.platformType||"WindowsPhone"===t.platformType)-1!==e.indexOf("windows xp")?i={major:5,minor:1,build:0}:(a=/Windows (NT|Phone) (OS )?(\d+)\.(\d+)/i.exec(window.navigator.userAgent))&&a.length>=5&&(i={major:r(a[3]),minor:r(a[4]),build:0});else if("iPad"===t.platformType||"iPhone"===t.platformType){var a;i={major:r((a=e.match(/os (\d+)_(\d+)(_(\d+))?/))&&a[1]),minor:r(a&&a[2]),build:r(a&&a[4])}}var o={keyword:"Other",browserType:"Other"};return[{keyword:"PhantomJS",browserType:"Headless"},{keyword:"Edge",browserType:"EdgeLegacy"},{keyword:"MSIE",browserType:"IE"},{keyword:"Edg",browserType:"Edge"},{keyword:"Chrome",browserType:"Chrome"},{keyword:"CriOS",browserType:"Chrome"},{keyword:"Firefox",browserType:"Firefox"},{keyword:"Safari",browserType:"Safari"}].some((function(t){return-1!==e.indexOf(t.keyword.toLowerCase())&&(o=t,!0)})),n={platform:t,platformVersion:i,browser:o}}i.d(t,"a",(function(){return a}))},ZtId:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},Zy3K:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i("BaAg"),i("4/We"),i("PBJH");class n{constructor(e,t){this.capabilitiesService=e,this.locService=t}ngOnInit(){this.createLocation=this.locService.BrandOneDrive,this.createLocationPrompt=this.locService.appResource("CreateNewLocationPrompt",this.app),this.oneDriveColor="#0078D4",this.fluentRefresh=this.capabilitiesService.capabilities.fluentRefresh}}},a3FV:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.ActionsMenuItemClick="Actions_Menu_Item_Click",e.ActionsMenuReactToggle="Actions_Menu_React_Toggle",e.ActionsMenuToggle="Actions_Menu_Toggle",e.ActivityFeedRequest="Activity_Feed_Request",e.ActivitySessionFinished="Activity_Session_Finished",e.ActivitySessionStarted="Activity_Session_Started",e.ActivityStoreRequest="Activity_Store_Request",e.AddToHomeScreenPromptImpressionMobile="Add_To_Home_Screen_Prompt_Mobile",e.AddToHomeScreenPromptImpressionDesktop="Add_To_Home_Screen_Prompt_Impression_Desktop",e.AddToToDoRequest="Add_To_To_Do_Request",e.AddToToDoClick="Add_To_To_Do_Click",e.AdminPolicyServerRequest="Admin_Policy_Server_Request",e.AdminPolicyCacheRequest="Admin_Policy_Cache_Request",e.AllowFileSystemAccess="Allow_File_System_Access",e.AllTemplatesClick="All_Templates_Click",e.AppAddedToHomeScreen="App_Added_To_Home_Screen",e.AppAddedToHomeScreenMobile="App_Added_To_Home_Screen_Mobile",e.AppAddedToHomeScreenDesktop="App_Added_To_Home_Screen_Desktop",e.AppItemsImpression="App_Items_Impression",e.AnnouncementImpression="Announcement_Impression",e.AppError="App_Error",e.AppBarClick="AppBar_Click",e.AppBarImpression="AppBar_Impression",e.AppBarPinApp="AppBar_Pin_App",e.AppBarRenderError="AppBar_RenderError",e.AppBarUnpinApp="AppBar_Unpin_App",e.AppBarMovePinnedApp="AppBar_Move_Pinned_App",e.AppBarUserDataReadError="AppBar_UserData_Read_Error",e.AppBarUserDataWriteError="AppBar_UserData_Write_Error",e.AppBarFlyoutLinkClick="AppBar_FlyoutLinkClick",e.AppBarFlyoutOpened="AppBar_FlyoutOpened",e.AppGalleryLearnMoreClick="AppGallery_LearnMoreClick",e.AppGalleryPinClick="AppGallery_PinClick",e.AppGalleryUnpinClick="AppGallery_UnpinClick",e.AppGalleryAppsPerWorkspace="AppGallery_AppsPerWorkspace",e.AppGalleryLauncherClick="AppGallery_Launcher_Click",e.AppGalleryCardImpression="AppGallery_Card_Impression",e.AppGalleryClick="AppGallery_Click",e.AppGalleryNavClick="AppGallery_Nav_Click",e.AppGalleryPageView="AppGallery_PageView",e.AppGalleryShowAllClick="AppGallery_ShowAll_Click",e.AppGalleryUninstallClick="AppGallery_UninstallClick",e.AppGalleryAboutClick="AppGallery_AboutClick",e.AppInstalledStatus="App_Installed_Status",e.AppListImpression="AppList_Impression",e.AppServiceConnection="App_Service_Connection",e.AppTileRightClick="App_Tile_Right_Click",e.AppTilesImpression="App_Tiles_Impression",e.AppTilesReady="App_Tiles_Ready",e.AuthStateChanged="Auth_State_Changed",e.BulkLicensePreview="Bulk_License_Preview",e.BulkLicensePreviewReadError="Bulk_License_Preview_Read_Error",e.BulkLicensePreviewRequest="Bulk_License_Preview_Request",e.CalendarClick="Calendar_Click",e.CalendarDayImpression="Calendar_Day_Impression",e.CalendarRequest="Calendar_Request",e.CAPPopup="CAP_Popup",e.CheckLoginRequest="Check_Login_Request",e.ClearSWCache="Clear_SW_Cache",e.ConfigRequest="Config_Request",e.ConsumerSkuLoaded="ConsumerSkuLoaded",e.ConsumerUpsellImpression="ConsumerUpsell_InstallImpression",e.ContentActionError="Content_Action_Error",e.ContentActionsMenuToggle="Content_Actions_Menu_Toggle",e.ContentActionsCommandMenuToggle="Content_Actions_Command_Menu_Toggle",e.ContentActionsMenuItemClick="Content_Actions_Menu_Item_Click",e.ContentActionsMenuItemClickLaunchDocument="Content_Actions_Menu_Item_Click_Launch_Document",e.ContentActionInitialization="Content_Action_Initialization",e.ContentActionRegistered="Content_Action_Registered",e.ContentActionSuccess="Content_Action_Success",e.ContentActionCompleted="Content_Action_Completed",e.CreateCenterCreateTilesImpression="Create_Center_Create_Tiles_Impression",e.CreateCenterEnterpriseTemplatesImpression="Create_Center_Enterprise_Templates_Impression",e.CreateCenterTemplatesCollectionsImpression="Create_Center_Templates_Collections_Impression",e.CreateFromDocumentClick="Create_From_Document_Click",e.CreateFromDocumentClickResult="Create_From_Document_Click_Result",e.CreateLinkClick="Create_Link_Click",e.CreateLinkClickResult="Create_Link_Click_Result",e.CreateMenuImpression="Create_Menu_Impression",e.CreateMenuToggle="Create_Menu_Toggle",e.CreateModalImpression="Create_Modal_Impression",e.CreateNewDocumentError="CreateNew_Document_Error",e.CreateNewRedirectFail="Create_New_Redirect_Fail",e.CreateNewRedirectSuccess="Create_New_Redirect_Success",e.CreateOnHomeCreateTilesImpression="Create_On_Home_Create_Tiles_Impression",e.CreateOnHomeSeeMoreClick="Create_On_Home_See_More_Click",e.CreatePanelImpression="Create_Panel_Impression",e.CreateSharingLinkGraphAPI="CreateSharingLink_GraphAPI",e.CsrfTokenError="Csrf_Token_Error",e.CustomStartDeprecationModalImpression="CustomStart_Deprecation_Modal_Impression",e.DimeCompleted="Dime_Completed",e.DimeTransactionCompleted="DimeTransactionCompleted",e.DimeInitialize="Dime_Initialize",e.DimeLaunch="Dime_Launch",e.DimeLoadScript="Dime_LoadScript",e.DimePreload="Dime_Preload",e.DimeWarmup="Dime_Warmup",e.DocumentHover="Document_Hover",e.DocumentTitleRenameFile="Document_Title_Rename_File",e.DocumentTitleRenameFileError="Document_Title_Rename_File_Error",e.DTTShellContainerNotFound="Document_Title_Shell_Container_Not_Found",e.EdgeworthBulkCacheRead="EdgeworthBulkCacheRead",e.EdgeworthCacheDeleteError="Edgeworth_Cache_Delete_Error",e.EdgeworthCacheRead="EdgeworthCacheRead",e.EdgeworthCacheWrite="EdgeworthCacheWrite",e.EdgeworthCachedTimestampAccess="EdgeworthCachedTimestampAccess",e.EdgeworthCalloutImpression="Edgeworth_Callout_Impression",e.EdgeworthClick="Edgeworth_Click",e.EdgeworthDebugCount="EdgeworthDebugCount",e.EdgeworthDeleteSettingRequest="EdgeworthDeleteSettingRequest",e.EdgeworthDuplicateFilesDetected="EdgeworthDuplicateFilesDetected",e.EdgeworthFilterSelect="Edgeworth_Filter_Select",e.EdgeworthFullSyncRequest="EdgeworthFullSyncRequest",e.EdgeworthHideItemRequest="EdgeworthHideItemRequest",e.EdgeworthImpression="Edgeworth_Impression",e.EdgeworthInitExperience="Edgeworth_Init_Experience",e.EdgeworthParseError="Edgeworth_Parse_Error",e.EdgeworthPinItemRequest="EdgeworthPinItemRequest",e.EdgeworthPivotClick="Edgeworth_Pivot_Click",e.EdgeworthRebuildError="EdgeworthRebuildError",e.EdgeworthRebuildRequired="EdgeworthRebuildRequired",e.EdgeworthRebuildCompleted="EdgeworthRebuildCompleted",e.EdgeworthRequest="EdgeworthRequest",e.EdgeworthSubstrateRecentRequest="EdgeworthSubstrateRecentRequest",e.EdgeworthSubstrateDeltaSyncPageRequest="EdgeworthSubstrateDeltaSyncPageRequest",e.EdgeworthSyncDetails="EdgeworthSyncDetails",e.EdgeworthTextFilterUsed="EdgeworthTextFilterUsed",e.EdgeworthUnhideItemRequest="EdgeworthUnhideItemRequest",e.EdgeworthUnpinItemRequest="EdgeworthUnpinItemRequest",e.EdgeworthUpsertSettingRequest="EdgeworthUpsertSettingRequest",e.EduThemesCalloutImpression="EduThemesCallout_Impression",e.ElementInViewport="Element_In_Viewport",e.EmbedBootstrapEnd="Embed_Bootstrap_End",e.EmbedSwGetTokenError="Embed_Sw_Get_Token_Error",e.ErrorDialogImpression="Error_Dialog_Impression",e.ExpandableListToggle="Expandable_List_Toggle",e.ExpandedWorkspacesRequest="Expanded_Workspaces_Request",e.ExploreAllYourAppsImpression="ExploreAllYourApps_Impression",e.FastSearchPageView="FastSearch_PageView",e.FeaturedDocumentsClick="FeaturedDocuments_Click",e.FeaturedDocumentsErrorImpression="FeaturedDocuments_Error_Impression",e.FeaturedDocumentsImpression="FeaturedDocuments_Impression",e.FeaturedDocumentsRequest="FeaturedDocuments_Request",e.FeaturedDocumentsToggle="FeaturedDocuments_Toggle",e.FeatureGatesRequest="FeatureGates_Request",e.FeatureSettingsRequest="FeatureSettings_Request",e.FeedbackOCVClick="Feedback_OCV_Click",e.FeedbackOCVDismissed="Feedback_OCV_Dismissed",e.FeedbackOCVError="Feedback_OCV_Error",e.FeedbackOCVSubmitted="Feedback_OCV_Submitted",e.FileVersionListFetch="File_Version_List_Fetch",e.FirstRunCompleted="First_Run_Completed",e.FirstRunImpression="First_Run_Impression",e.FirstRunDetermineStateError="FirstRun_DetermineState_Error",e.FirstRunResolveConfigError="FirstRun_ResolveConfig_Error",e.FirstRunSlideStats="First_Run_Slide_Stats",e.FirstRunUpsellClick="First_Run_Upsell_Click",e.FirstSiteVisit="First_Site_Visit",e.FirstTimeMetric="First_Time_Metric",e.FluidContentCreateNew="FluidContent_CreateNew",e.FluidContentError="FluidContent_Error",e.FluidContentOpen="FluidContent_Open",e.FluidContentPageView="FluidContent_PageView",e.FluidContentTimeout="FluidContent_Timeout",e.FluidFileInfoError="Fluid_FileInfo_Error",e.FluidFileLoadError="FluidFileLoad_Error",e.FluidFileLocationInfoError="FluidFile_LocationInfo_Error",e.FluidInformationProtectionError="Fluid_InformationProtection_Error",e.FluidMobileUpsellImpression="Fluid_MobileUpsell_Impression",e.FluidMobileUpsellInstallClick="Fluid_MobileUpsell_Install_Click",e.FluidShareControlError="Fluid_ShareControl_Error",e.FluidShareControlStart="Fluid_ShareControl_Start",e.FluidTokenFetch="Fluid_TokenFetch",e.FluidVersionHistoryDTTClick="Fluid_VersionHistoryDTTClick",e.FocusContextError="Focus_Context_Error",e.FreNewCalloutsEvent="Fre_New_Callouts_Event",e.FreNewCalloutsImpression="Fre_New_Callouts_Impression",e.GalleryCardImpression="Gallery_Card_Impression",e.GalleryNavClick="Gallery_Nav_Click",e.GenericDebugCache="Generic_Debug_Cache_2",e.GenericClick="Generic_Click",e.GenericEvent="Generic_Event",e.GenericImpression="Generic_Impression",e.GenericRequest="Generic_Request",e.GetClassNotebooksRequest="Get_ClassNotebooks_Request",e.GetDownloadUrlError="Get_DownloadUrl_Error",e.GetForm="Get_Form",e.GetOneNotePageRequest="Get_OneNote_Page_Request",e.GetOneNoteSectionsRequest="Get_OneNote_Sections_Request",e.GetSiteTitleRequest="Get_Site_Title_Request",e.GetUserReputationTier="Get_User_Reputation_Tier",e.GetWindowsPkid="GetWindowsPkid",e.GroupSideMenuMoveClick="Group_SideMenu_Move_Click",e.EnterpriseTemplatesErrorImpression="Enterprise_Templates_Error_Impression",e.EnterpriseTemplatesImpression="Enterprise_Templates_Impression",e.InvalidMethod="Invalid_Method",e.FormCreateFormFromTemplate="Form_Create_Form_From_Template",e.FormsFeatureCallout="Forms_Feature_Callout",e.FormsMembersThumbnailFetch="Forms_Members_Thumbnail_Fetch",e.FormsGroupThumbnailFetch="Forms_Group_Thumbnail_Fetch",e.FormsSharedUnpinRequest="Forms_Shared_UnpinRequest",e.FormsCopyRequest="Forms_Copy_Request",e.FormsGroupsRequest="Forms_Groups_Request",e.FormsFromGroupRequest="Forms_From_Group_Request",e.FormsResponses="Forms_Responses",e.FormsThemeRequest="Forms_Theme_Request",e.FormsDeleteRequest="Forms_Delete_Request",e.GroupFormsCreateRequest="Group_Forms_Create_Request",e.FormsGroupMembersRequest="Forms_Group_Members_Request",e.ImpressionsSinceFirstVisit="Impressions_Since_First_Visit",e.InitializeWopiPendingFailed="Initialize_Wopi_Pending_Failed",e.SharedFormsRequest="Shared_Forms_Request",e.MyFormsRequest="My_Forms_Request",e.MyContentLinkClick="My_Content_Link_Click",e.RestoreFormRequest="Restore_Form_Request",e.RecycleFormRequest="Recycle_Form_Request",e.GraphBatchRequest="Graph_Batch_Request",e.GroupItemClick="Group_Item_Click",e.HelpSearchSuggestionRequest="Help_Search_Suggestion_Request",e.HistoryDisabled="History_Disabled",e.HomePageView="Home_PageView",e.IdentityRequest="Identity_Request",e.InputDialogButtonClick="Input_Dialog_Button_Click",e.InstallClick="Install_Click",e.InstallCustomError="Install_Custom_Error",e.InstallGenericError="Install_Generic_Error",e.InstallableAppsRequest="Installable_Apps_Request",e.InstalledAppsFetch="Installed_Apps_Fetch",e.InstalledAppsExFetch="Installed_Apps_Ex_Fetch",e.InstalledAppsExFetchDebug="Installed_Apps_Ex_Fetch_Debug",e.InstalledOfficeDetailsFetch="Installed_Office_Details_Fetch",e.InstallerRequest="Installer_Request",e.InstallScenario="Install_Scenario",e.JoinMeetingClick="Join_Meeting_Click",e.IrisRequest="IrisRequest",e.LaunchByProtocolFailed="Launch_By_Protocol_Failed",e.LaunchFileExplorerFailed="Launch_File_Explorer_Failed",e.LaunchLocalApp="Launch_Local_App",e.LearningShelfAutoCollapsed="LearningShelfAutoCollapsed",e.LearningShelfCardClick="LearningShelfCardClick",e.LearningShelfCardClickError="LearningShelfCardClickError",e.LearningShelfCardInvalid="LearningShelfCardInvalid",e.LearningShelfToggled="LearningShelfToggled",e.LeftNavCalloutImpression="Left_Nav_Callout_Impression",e.LeftNavImpression="Left_Nav_Impression",e.LeftNavReady="LeftNav_Ready",e.LocalMruFetch="Local_Mru_Fetch",e.LocalStorageUnavailable="Local_Storage_Unavailable",e.M365AppsDefinitionDeleteRequest="M365_Apps_Definition_Delete_Request",e.M365AppsDefinitionDeleteError="M365_Apps_Definition_Delete_Error",e.M365AppsDefinitionError="M365_Apps_Definition_Error",e.M365AppsDefinitionLookup="M365_Apps_Definition_Lookup",e.M365AppsDefinitionLookupError="M365_Apps_Definition_Retry_Lookup_Error",e.M365AppsDefinitionLookupRequest="M365_Apps_Definition_Not_Found_In_Config_Retrying_Lookup",e.M365AppsParseDomConfigError="M365_Apps_Parse_Dom_Config_Error",e.MarkAsDoneClick="Mark_As_Done_Click",e.MOSAppHostError="MOS_App_Host_Error",e.MOSHubSDK="MOS_HUB_SDK_Request",e.MeetingObjectsNoArtifactsFoundError="Meeting_Objects_No_Artifacts_Found_Error",e.MeetNowButtonImpression="Meet_Now_Button_Impression",e.MemoryUsage="Memory_Usage",e.MetaTransformCapacityRequest="MeTA_Transform_Capacity_Request",e.MobileAppBannerImpression="Mobile_App_Banner_Impression",e.MobileView="Mobile_View",e.MoveToFolderControlError="Move_To_Folder_Control_Error",e.MoveToFolderControlClick="Move_To_Folder_Control_Click",e.MoveToFolderControlAbandon="Move_To_Folder_Control_Abandon",e.MoveToFolderControlImpression="Move_To_Folder_Control_Impression",e.MoveToFolderControlAuthenticate="Move_To_Folder_Control_Authenticate",e.MoveToFolderControlNavigationStarted="Move_To_Folder_Control_Navigation_Started",e.MoveToFolderControlNavigationEnded="Move_To_Folder_Control_Navigation_Ended",e.MruClick="Mru_Click",e.MruDelete="Mru_Delete",e.MruFileItemError="Mru_File_Item_Error",e.MruPathClick="Mru_Path_Click",e.MruUpdatePin="Mru_Update_Pin",e.MruImpression="Mru_Impression",e.MruRequest="Mru_Request",e.MruS2SRequest="Mru_S2S_Request",e.MruWrite="Mru_Write",e.MruWriteError="Mru_Write_Error",e.MsaTokenFetch="Msa_Token_Fetch",e.MyContentChangeLayout="My_Content_Change_Layout",e.NavigateToTemplatesClick="Navigate_To_Templates_Click",e.NewConsumerNoContentImpression="New_Consumer_No_Content_Impression",e.NewPlaylistButtonClick="New_Playlist_Button_Click",e.NewUserShelfImpression="New_User_Shelf_Impression",e.NewScreenRecorderButtonClick="New_Screen_Recorder_Button_Click",e.NewVideoRecorderButtonClick="New_Video_Recorder_Button_Click",e.NewUserShelfClick="New_User_Shelf_Click",e.NotificationServiceError="Notification_Service_Error",e.OfficeConsumerLicenseFetch="Office_Consumer_License_Fetch",e.OfficeFeedAction="OfficeFeedAction",e.OfficeFeedInstrumentation="OfficeFeedInstrumentation",e.OfficeFeedDelete="OfficeFeedDelete",e.OfficeFeedRequest="OfficeFeedRequest",e.OfficeFeedStreamThumbnailRequest="OfficeFeed_Stream_Thumbnail_Request",e.OfficeHomeStorageReadRequest="OfficeHomeStorage_Read_Request",e.OfficeHomeStorageWriteRequest="OfficeHomeStorage_Write_Request",e.OfficeInsightsSearchSuggestionRequest="OfficeInsights_Search_Telemetry_Request",e.OfficeLicensesFetch="Office_Licenses_Fetch",e.OneDriveGraphCancelUploadSessionRequest="OneDrive_Graph_Cancel_Upload_Session_Request",e.OneDriveGraphCreateFileRequest="OneDrive_Graph_Create_File_Request",e.OneDriveGraphCreateUploadSessionRequest="OneDrive_Graph_Create_Upload_Session_Request",e.OneDriveGraphItemError="OneDrive_Graph_Item_Error",e.OneDriveGraphItemRequest="OneDrive_Graph_Item_Request",e.OneDriveGraphItemWithWacDataAndThumbRequest="OneDrive_Graph_Item_With_Wac_Data_And_Thumb_Request",e.OneDriveGraphItemWithWacDataRequest="OneDrive_Graph_Item_With_Wac_Data_Request",e.OneDriveGraphSharesRequest="OneDrive_Graph_Shares_Request",e.OneDriveGraphSharesWithWacDataRequest="OneDrive_Graph_Shares_With_Wac_Data_Request",e.OneDriveGraphStorageRequest="OneDrive_Graph_Storage_Request",e.OneDriveGraphBatchSharesRequest="OneDrive_Graph_Batch_Shares_Request",e.OneDriveGraphThumbnailRequest="OneDrive_Graph_Thumbnail_Request",e.OneDriveGraphThumbnailStringRequest="OneDrive_Graph_Thumbnail_String_Request",e.OneDriveGraphPeoplePictureRequest="OneDrive_Graph_People_Picture_Request",e.OneDriveGraphBatchPeoplePicturesRequest="OneDrive_Graph_Batch_People_Pictures_Request",e.OneDriveGraphUploadFileRequest="OneDrive_Graph_Upload_File_Request",e.OneDriveGraphUploadFragmentRequest="OneDrive_Graph_Upload_Fragment_Request",e.OneDriveGraphUploadStatusRequest="OneDrive_Graph_Upload_Status_Request",e.OneDrivePlacesBadUrl="OneDrive_Places_Bad_Url",e.OneDrivePlacesClick="OneDrive_Places_Click",e.OneDrivePlacesImpression="OneDrive_Places_Impression",e.OneDriveUserRootUrl="OneDrive_User_RootUrl",e.ODSPProvisioningStatus="ODSP_Provisioning_Status",e.ODSPProvisioningFinish="ODSP_Provisioning_Finish",e.ODSPProvisioningGiveUp="ODSP_Provisioning_GiveUp",e.ODSPInstaProvisionedRedirect="ODSP_Insta_Provisioned_Redirect",e.OneNoteGraphCreateNoteBookRequest="OneNote_Graph_Create_NoteBook_Request",e.OneNoteGraphGetNotebooksRequest="OneNote_Graph_Get_NoteBooks_Request",e.OneNoteNotebookCreateLinkClick="OneNote_Notebook_Create_Link_Click",e.OneNotePageCreateLinkClick="OneNote_Page_Create_Link_Click",e.OtelInitializationError="OTEL_Initialization_Error",e.OtelReady="OTEL_Ready",e.GroupsImpression="Groups_Impression",e.PerformanceDump="Performance_Dump",e.PerformanceMarkFailure="Performance_Mark_Failure",e.PeopleCardImpression="People_Card_Impression",e.PeopleCardInitialization="People_Card_Initialization",e.PinToTaskbar="Pin_To_Taskbar",e.PrefetchEdgeworthConfigInternalError="PrefetchEdgeworthConfigInternal_Error",e.PrefetchNorthStarError="PrefetchNorthStar_Error",e.PrefetchNorthStarMarkPerformanceError="PrefetchNorthStar_MarkPerformance_Error",e.PrideThemesCalloutImpression="PrideThemesCallout_Impression",e.PrimaryTokenFetchRequest="Primary_Token_Fetch_Request",e.PromotedAppTileImpression="Promoted_App_Tile_Impression",e.PwaBootstrapEnd="Pwa_Bootstrap_End",e.PwaOnActivated="Pwa_On_Activated",e.PwaNavigationFailed="Pwa_Navigation_Failed",e.PwaJumpListItemClick="Pwa_Jump_List_Item_Click",e.PwaJumpList="Pwa_Jump_List",e.PwaSwHandleRegistrationError="Pwa_Sw_Handle_Registration_Error",e.PwaSwGetTokenError="Pwa_Sw_Get_Token_Error",e.QuickAccessChangeLayout="QuickAccess_Change_Layout",e.QuickAccessCreateCustomPivot="QuickAccess_Create_CustomPivot",e.QuickAccessCustomPivotsImpression="QuickAccess_CustomPivots_Impression",e.QuickAccessRemoveCustomPivot="QuickAccess_Remove_CustomPivot",e.QuickAccessShowCustomPivotsMenu="QuickAccess_Show_CustomPivotMenu",e.RecommendedCalloutImpression="Recommended_Callout_Impression",e.RecommendedClick="Recommended_Click",e.RecommendedDelete="Recommended_Delete_Request",e.RecommendedFilesActions="Recommended_Files_Actions",e.RecommendedImpression="Recommended_Impression",e.RecommendedInflationComplete="Recommended_Inflation_Complete",e.RecommendedNavClick="Recommended_Nav_Click",e.RecommendedRequest="Recommended_Request",e.RefreshAccessTokenRequest="Refresh_Access_Token_Request",e.ResourceStringsFetch="Resource_Strings_Fetch",e.ReturningUserCalloutsImpression="Returning_User_Callouts_Impression",e.SearchAutoSuggestionResultsFetched="Search_Auto_Suggestion_Results_Fetched",e.SearchCapability="Search_Capability",e.SearchClick="Search_Click",e.SearchPageView="Search_PageView",e.SearchPerformance="Search_Performance",e.SearchQuery="Search_Query",e.SearchRenderedResults="Search_Rendered_Results",e.SearchResultsFetched="Search_Results_Fetched",e.SearchSessionStarted="Search_Session_Started",e.SessionStorageUnavailable="Session_Storage_Unavailable",e.SettingsRequest="Settings_Request",e.ShareControlAbandon="Share_Control_Abandon",e.ShareControlClick="Share_Control_Click",e.ShareControlError="Share_Control_Error",e.ShareControlImpression="Share_Control_Impression",e.ShareControlStarted="Share_Control_Started",e.SharedWithMeRequest="Shared_With_Me_Request",e.SharePointContextRequest="SharePoint_Context_Request",e.SharePointGetListError="SharePoint_Get_List_Error",e.SharePointIdsRequest="SharePoint_Ids_Request",e.SharePointListItemRequest="SharePoint_List_Item_Request",e.SharePointListsRequest="SharePoint_Lists_Request",e.SharePointMicroserviceUrlsRequest="SharePoint_Microservice_Urls_Request",e.SharePointSiteClick="SharePoint_Site_Click",e.SharePointSitesImpression="SharePoint_Sites_Impression",e.SharePointWebsocketRequest="SharePoint_Websocket_Request",e.SharePointSitesRequest="SharePoint_Sites_Request",e.ShellBootstrapperError="Shell_Bootstrapper_Load_Error",e.ShowMoreTilesImpression="ShowMoreTiles_Impression",e.SimplePersistenceReadError="Simple_Persistence_Read_Error",e.SimplePersistenceWriteError="Simple_Persistence_Write_Error",e.SpaceCreated="Space_Created",e.SpaceGalleryClick="SpaceGallery_Click",e.SpaceGalleryImpression="SpaceGallery_Impression",e.SpaceGalleryPageView="SpaceGallery_PageView",e.SpacePageClick="SpacePage_Click",e.SpacePagePageView="SpacePage_PageView",e.SpaceUpdated="Space_Updated",e.SplitButtonToggle="Split_Button_Toggle",e.SuggestedActionClick="Suggested_Action_Click",e.SupportCentralError="Support_Central_Error",e.SupportCentralImpression="Support_Central_Impresion",e.SupportCentralInit="Support_Central_Init",e.SupportCentralLoaded="Support_Central_Loaded",e.SupportCentralStart="Support_Central_Start",e.SwActivated="Sw_Activated",e.SwApiMissingTokenError="Sw_ApiMissingToken_Error",e.SwApiMissingUserIdError="Sw_ApiMissingUserId_Error",e.SwApiNetworkRequestError="Sw_ApiNetworkRequest_Error",e.SwApiRequestHandlingError="Sw_ApiRequestHandling_Error",e.SwApiTimeoutError="Sw_ApiTimeout_Error",e.SwAppWarmupTimeoutError="Sw_AppWarmupTimeout_Error",e.SwPrecacheAssetError="Sw_PrecacheAsset_Error",e.SwPrecacheCountMismatchError="Sw_PrecacheCountMismatch_Error",e.SwayCreateRequest="Sway_Create_Request",e.SwayCreateStoryAndPublishDocumentRequest="Sway_Create_Story_And_Publish_Document_Request",e.SwayGetAnalytics="Sway_Get_Analytics_Request",e.SwayGetThumbnailRequest="Sway_Get_Thumbnail_Request",e.TeamsAccessTokenRequest="Teams_Access_Token_Request",e.TellMeSearchSuggestionRequest="TellMe_Search_Suggestion_Request",e.TuiActionButtonClick="Tui_Action_Button_Click",e.TuiCompleted="Tui_Completed",e.TuiDismissed="Tui_Dismissed",e.TemplateClick="Template_Click",e.TemplateClickResult="Template_Click_Result",e.TemplateLibrariesRequest="Template_Libraries_Request",e.TemplatesCollectionClick="Templates_Collection_Click",e.TemplatesCollectionsRequest="Templates_Collections_Request",e.TemplateContentRequest="Template_Content_Request",e.TemplatesRecommendedRequest="Templates_Recommended_Request",e.TemplatesGraphGetRequest="Templates_Graph_Get_Request",e.TemplatesErrorImpression="Templates_Error_Impression",e.TemplatesImpression="Templates_Impression",e.TemplatesPageView="Templates_PageView",e.TemplatesRequest="Templates_Request",e.TemplatesToggle="Templates_Toggle",e.ThumbnailLoad="Thumbnail_Load",e.ThumbnailCachePipeLoad="Thumbnail_Cache_Pipe_Load",e.TileToggleOpen="Tile_Toggle_Open",e.TileToggleSelect="Tile_Toggle_Select",e.ToastClick="Toast_Click",e.TokensConfigMissing="Tokens_Config_Missing",e.TrendingAroundMeRequest="Trending_Around_Me_Request",e.UnexpectedHistoryState="Unexpected_History_State",e.UnhandledException="Unhandled_Exception",e.UnifiedDocumentBootEnd="UnifiedDocumentBootEnd",e.UnifiedDocumentBootError="UnifiedDocumentBootError",e.UnifiedDocumentBootErrorExpected="UnifiedDocumentBootErrorExpected",e.UnifiedStorageRequest="Unified_Storage_Request",e.UnknownTheme="Unknown_Theme",e.UpgradeDialogAppDefinitionNotFound=" Upgrade_Dialog_AppDefinition_Not_Found",e.UploadButtonImpression="Upload_Button_Impression",e.UploadButtonDragAndDropCalloutImpression="Upload_Button_DragAndDrop_Callout_Impression",e.UploadClick="Upload_Click",e.UploadCompleted="Upload_Completed",e.UploadDialogImpression="Upload_Dialog_Impression",e.UploadLocalError="Upload_Local_Error",e.UpsellButtonClick="Upsell_Button_Click",e.UpsellButtonImpression="Upsell_Button_Impression",e.UpsellDialogImpression="Upsell_Dialog_Impression",e.UpsellDialogClose="Upsell_Dialog_Close",e.UserEntitlementsRequest="UserEntitlements_Request",e.ViewInToDoClick="View_In_To_Do_Click",e.VisioLicenseStatus="Visio_License_Status",e.VisualBackgroundImageError="Visual_Background_Image_Error",e.VroomActivityRequest="Vroom_Activity_Request",e.VroomCreateFileRequest="Vroom_Create_File_Request",e.VroomCreateLinkRequest="Vroom_Create_Link_Request",e.VroomCreateUploadSessionRequest="Vroom_Create_Upload_Session_Request",e.VroomGetFluidEnabled="Vroom_Get_Fluid_Enabled_Request",e.VroomItemRequest="Vroom_Item_Request",e.VroomItemWithWacDataRequest="Vroom_Item_With_Wac_Data_Request",e.VroomOneDriveCheckAccessRequest="Vroom_OneDrive_Item_Check_Access_Request",e.VroomSharesRequest="Vroom_Shares_Request",e.VroomSharesWithWacDataRequest="Vroom_Shares_With_Wac_Data_Request",e.VroomThumbnailRequest="Vroom_Thumbnail_Request",e.VroomUploadFileRequest="Vroom_Upload_File_Request",e.WacContentError="WacContent_Error",e.WacContentPageView="WacContent_PageView",e.WacDocumentAbandon="WacDocument_Abandon",e.WacDocumentLoadStart="WacDocument_Load_Start",e.WacDocumentLoaded="WacDocument_Loaded",e.WacDocumentPreboot="WacDocument_Preboot",e.WacDocumentPreload="WacDocument_Preload",e.WacDocumentJsApiError="WacDocument_JsApi_Error",e.WacDocumentJsApiTimeout="WacDocument_JsApi_Timeout",e.WacDocumentVroomError="WacDocument_Vroom_Error",e.WacDocumentBootstrapperLoadError="WacHost_Bootstrapper_Load_Error",e.WacDocumentGenericBootError="WacDocument_Generic_Boot_Error",e.WacPageAction="WacPageAction",e.WacStartPageView="WacStart_PageView",e.WamTokenRequestInitiated="WAM_Token_Request_Initiated",e.WamTokenRequest="WAM_Token_Request",e.WamTokenExpired="WAM_Token_Expired",e.WebVitalsError="WebVitals_Error",e.WopiDataFetchFailed="Wopi_Data_Fetch_Failed"}(n||(n={}))},aQ3G:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("pOWU");class r{constructor(){this.cachedResponsePromises=new Map}set(e,t,i,n){const r=this.key(t,i,n);this.cachedResponsePromises.set(r,e)}has(e,t,i){const n=this.key(e,t,i);return this.cachedResponsePromises.has(n)}get(e,t,i){const n=this.key(e,t,i);return this.cachedResponsePromises.get(n)}delete(e,t,i){const n=this.key(e,t,i);return this.cachedResponsePromises.delete(n)}key(e,t,i){return`${t?"beta":"v1.0"}/${i}/${e}`}}class a extends n.a{constructor(e,t,i,n,a,o,s,l){super(e,t,i,"Graph",n,a,o,l),this.globalErrorHandler=s,this.cachedResponsePromises=new r;const{officeHomeApiRoot:c,graphApiRoot:u}=n.sharedContext;this.graphServiceHost=this.inMockMode?c:u,this.requestConfig={headers:new Map}}getGraph(e,t,i,r,a,o=!1,s,l,c,u=!1,d,h=null,p=!1){if(!p&&this.cachedResponsePromises.has(i,u,r))return this.cachedResponsePromises.get(i,u,r);const m=new Promise(((p,m)=>{const f=this.getGraphServiceEndpoint(i,u);f||m(new n.b(null,"Graph service endpoint url is not defined"));const g=this.getRequestConfig();g.responseType=void 0!==d?d:"json",super.get(e,t,f,(e=>{e.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e),a&&a(e,t)})).then((e=>p(e))).catch((e=>{this.globalErrorHandler.handleError(e,"XDHsY")}))}),(e=>{o&&this.cachedResponsePromises.delete(i,u,r),m(e)}),g,r,s,l,c,void 0,void 0,h)}));return o&&this.cachedResponsePromises.set(m,i,u,r),m}postGraph(e,t,i,n,r,a,o,s,l,c,u=!1,d=!1,h=null,p){const m=this.getGraphServiceEndpoint(i,u),f=this.getRequestConfig();return void 0!==p&&p.forEach(((e,t)=>{f.headers.set(t,e)})),super.post(e,t,m,n,r,a,f,o,s,l,c,void 0,null,null,null,d,h)}putGraph(e,t,i,n,r,a,o,s,l,c,u=!1){const d=this.getGraphServiceEndpoint(i,u);return super.put(e,t,d,n,r,a,this.getRequestConfig(),o,s,l,c)}patchGraph(e,t,i,n,r,a,o,s,l,c,u,d,h,p=!1){const m=this.getGraphServiceEndpoint(i,p),f=o||this.getRequestConfig();return super.patch(e,t,m,n,r,a,f,s,l,c,u,d,h)}handleQueryParam(e,t,i){"mockgraph"===e&&(null==i||i.headers.set(a.mockGraphHeader,t))}getRequestConfig(e={}){return Object.assign(Object.assign(Object.assign({},this.requestConfig),{headers:new Map(this.requestConfig.headers)}),e)}getGraphServiceEndpoint(e,t=!1){return this.graphServiceHost?`${this.graphServiceHost}/${t?a.graphBeta:a.graphV1}/${e}`:""}}a.graphV1="v1.0",a.graphBeta="beta",a.mockGraphHeader="ohp-mock-graph"},adME:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e){this.action=e,this.hoverDelay=100}onMouseEnter(){this.enabled()&&(this.hoverTimeout=setTimeout((()=>{this.action()}),this.hoverDelay))}onMouseLeave(){this.hoverTimeout&&(clearTimeout(this.hoverTimeout),this.hoverTimeout=null)}}},b7yv:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("70cc"),r=i("WKA6"),a=i("dFxn"),o=i("7Gwk"),s=i("4/We"),l=i("Mlb/");class c{constructor(e,t,i){this.configParserService=e,this.capabilitiesService=t,this.eventService=i}getConfig(){if(!this.configPromise){const e=()=>this.configParserService.parse("firstRunConfig");if(this.capabilitiesService.capabilities.pwaEnabled)this.configPromise=Promise.resolve(e());else{const t=this.eventService.events.withScope(0).pipe(Object(n.a)((e=>"primaryTokensLoaded"===e.name)),Object(r.a)(1)).toPromise();this.configPromise=t.then(e)}}return this.configPromise}}c.ɵprov=l.kc({factory:function(){return new c(l.lc(a.a),l.lc(s.a),l.lc(o.a))},token:c,providedIn:"root"})},bvSZ:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("NL/U"),r=i("Tqea"),a=i("ZcZ3");function o(e,t,i,o,s){var l,c,u,d,h,p={};p.ImpressionId=e.impressionId||"",p.ElementId=t,p.DocumentId=e.id,p.Referral=Object(a.a)(e.fileType),p.Index=i.toString(),p.DocumentType=Object(r.a)(e.fileType),p.Action=o;var m=e.lastAccessedTime?Object(n.a)(e.lastAccessedTime):void 0;return void 0!==m&&(p.InactivityDuration=m.toString()),p.Area=s,p.Pinned=(null===(l=e.isPinned)||void 0===l?void 0:l.toString())||"",p.ItemIsNew=(null===(c=e.isNew)||void 0===c?void 0:c.toString())||"",p.ItemIsShared=(null===(u=e.isShared)||void 0===u?void 0:u.toString())||"",p.IsEmailAttachment=(null===(d=e.isEmailAttachment)||void 0===d?void 0:d.toString())||"",p.IsOnPremOrVanity=(null===(h=e.isOnPremOrVanity)||void 0===h?void 0:h.toString())||"",p}},cAxl:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i("3bNC");class n{constructor(e){this.graphPictureService=e,this.fetchImage=!0,this.isUpcomingMeeting=!1,this.status="None",this.hasPadding=!1,this.personPictureCard=!1,this.iconSize=this.iconSize||30}ngOnChanges(){var e;if(this.fetchImage){const t=this.pictureId||(null===(e=this.person)||void 0===e?void 0:e.email);this.imageBase64Promise=t?this.graphPictureService.getPeoplePicture(t,this.iconSize<=48?"48x48":void 0):Promise.resolve(null)}else this.imageBase64Promise=Promise.resolve(this.imageBase64)}}},cZRF:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("QjXU");function r(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return(yield i.e(164).then(i.t.bind(null,"yfDh",7))).default}))}var a=i("BMb5"),o=i("Mlb/");class s{constructor(e){this.windowService=e}decode(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return function(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const i="TextDecoder"in t;return(yield function(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return e?new TextDecoder:new((yield r()).TextDecoderLite)}))}(i)).decode(e)}))}(e,this.windowService.nativeWindow)}))}encode(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return function(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const i="TextEncoder"in t;return(yield function(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return e?new TextEncoder:new((yield r()).TextEncoderLite)}))}(i)).encode(e)}))}(e,this.windowService.nativeWindow)}))}}s.ɵprov=o.kc({factory:function(){return new s(o.lc(a.b))},token:s,providedIn:"root"});var l=i("FHrx"),c=i("COYM");class u{constructor(e,t){this.webCryptoService=e,this.encryptionConfigService=t}get key(){return this._keyPromise||(this._keyPromise=this.importKey()),this._keyPromise}importKey(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return function(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return t.importKey("jwk",e,"AES-GCM",!1,["encrypt","decrypt"])}))}(this.encryptionConfigService.config.cryptoKey,this.webCryptoService.crypto.subtle)}))}}u.ɵprov=o.kc({factory:function(){return new u(o.lc(c.b),o.lc(l.a))},token:u,providedIn:"root"});class d{constructor(e,t,i){this.encodingService=e,this.encryptionKeyService=t,this.webCryptoService=i}encryptData(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.encryptionKeyService.key;return function(e,t,i,r){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const a=yield r(JSON.stringify(e)),o=yield function(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return e.getRandomValues(new Uint8Array(12))}))}(i),s=yield i.subtle.encrypt({name:"AES-GCM",iv:o,tagLength:128},t,a);return function(e,t){const i=new Uint8Array(e.byteLength+t.byteLength);return i.set(new Uint8Array(e),0),i.set(new Uint8Array(t),e.byteLength),i.buffer}(o.buffer,s)}))}(e,t,this.webCryptoService.crypto,(e=>this.encodingService.encode(e)))}))}decryptData(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.encryptionKeyService.key;return function(e,t,i,r,a){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const n=e.slice(0,12),o=e.slice(12,e.byteLength),s=yield i.subtle.decrypt({name:"AES-GCM",iv:n,tagLength:128},t,o),l=yield r(new Uint8Array(s));return JSON.parse(l,a)}))}(e,i,this.webCryptoService.crypto,(e=>this.encodingService.decode(e)),t)}))}}d.ɵprov=o.kc({factory:function(){return new d(o.lc(s),o.lc(u),o.lc(c.b))},token:d,providedIn:"root"})},casz:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("QjXU"),r=i("5f+/"),a=i("lrJm"),o=i("x+6c"),s=i("WLAd"),l=i("Uqr9"),c=i("BMb5"),u=i("Mlb/");class d{constructor(e,t,i,n,a){this.idleCallbackService=e,this.errorHandler=t,this.pageVisibilityService=i,this.windowService=n,this.performanceService=a,this.heap=new r.a([],((e,t)=>this.compare(e,t))),this.isProcessing=!1,this.shouldLogFirstIdle=this.pageVisibilityService.isVisible(),this.shouldLogFirstSchedule=!0,this.setOnVisibilityChange(),this.setOnGlobalWindow()}scheduleWork(e,t){if(0===t)return e(),this.createNoopHandle();this.shouldLogFirstSchedule&&(this.shouldLogFirstSchedule=!1,this.performanceService.mark("First_Schedule"));const i={work:e,priority:t,cancelled:!1,completed:!1},n=this.createHandle(i);return this.heap.push(i),this.dequeueWhenIdle(),n}hasTasks(){return!!this.heap.peek()}get FCI(){return void 0!==this.firstIdle?this.firstIdle:-1}createHandle(e){const t=()=>e.cancelled=!0;return{cancel:t,cancelAndRunNow:()=>{e.cancelled||(t(),e.completed||(e.work(),e.completed=!0))},adjustPriority:i=>(t(),e.completed?this.createNoopHandle():this.scheduleWork(e.work,i))}}createNoopHandle(){return{cancel:()=>null,cancelAndRunNow:()=>null,adjustPriority:()=>null}}dequeueWhenIdle(){this.pageVisibilityService.isVisible()?this.idleCallbackHandle||(this.idleCallbackHandle=this.idleCallbackService.runWhenIdle((e=>{this.shouldLogFirstIdle&&(this.shouldLogFirstIdle=!1,this.firstIdle=l.a.now(),this.performanceService.mark("First_Idle")),this.idleCallbackHandle=null,this.doWork(e)}))):this.doWork()}doWork(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){if(!this.isProcessing){for(this.isProcessing=!0;!this.pageVisibilityService.isVisible()||e&&e.timeRemaining()>0;){const t=this.heap.pop();if(!t)break;if(!t.cancelled)try{yield t.work(e),t.completed=!0}catch(e){this.errorHandler.handleError(e,"DXUlK")}}this.isProcessing=!1,this.heap.peek()&&this.dequeueWhenIdle()}}))}compare(e,t){return e.priority<t.priority?-1:e.priority>t.priority?1:0}setOnGlobalWindow(){this.windowService.nativeWindow.scheduler=this}setOnVisibilityChange(){this.pageVisibilityService.addOnVisibilityChanged((e=>{"hidden"===e&&(this.shouldLogFirstIdle=!1,this.idleCallbackHandle&&(this.idleCallbackService.cancelIdleCallback(this.idleCallbackHandle),this.idleCallbackHandle=null),this.doWork())}))}}d.ɵprov=u.kc({factory:function(){return new d(u.lc(o.a),u.lc(a.b),u.lc(s.a),u.lc(c.b),u.lc(l.b))},token:d,providedIn:"root"})},cenr:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("8/lW"),r=i("a3FV"),a=i("4CZh");function o(e,t,i,o){void 0===t&&(t={}),void 0===i&&(i=[]),void 0===o&&(o=n.a.Security),Object(a.b)(e,r.a.GenericEvent,o,t,i,!0)}},cgnd:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return u}));var n,r=i("lrJm"),a=i("dFxn"),o=i("ZJrL"),s=i("Mlb/");let l,c;!function(e){e[e.MSA=0]="MSA",e[e.OrgId=1]="OrgId",e[e.Unknown=-1]="Unknown"}(n||(n={}));class u{constructor(e){this.config=function(e){if(!l){l=!0;try{c=e?e.parse("clientStartupConfiguration"):o.a.parseJsonElementWithId("clientStartupConfiguration")}catch(e){throw new r.a("Failure to parse clientStartupConfiguration from response",e)}if(!c)throw new r.a("clientStartupConfiguration is not present in response");const t=c.authTypeString;"MSA"===t?(c.authType=n.MSA,window.pwaCurrentUserId&&0===window.pwaCurrentUserId.indexOf("consumers_")&&(c.puid=window.pwaCurrentUserId.substring("consumers_".length)),window.userPrincipalName&&(c.userPrincipalName=window.userPrincipalName,c.loginHint=window.userPrincipalName)):c.authType="OrgId"===t?n.OrgId:n.Unknown,c.isV2Auth="2.0"===c.authVersion}return function(e){let t;t=e.length?`https://${e}`:window.location.origin,t=`${t}/bundles/`,i.p=t}(c.cdnDomain),c}(e)}}u.ɵprov=s.kc({factory:function(){return new u(s.lc(a.a))},token:u,providedIn:"root"})},ci1G:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},cj6A:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("QjXU"),r=i("4/We"),a=i("hZW2"),o=i("casz"),s=i("Mlb/");class l{constructor(e,t,i,n){this.capabilitiesService=e,this.documentService=t,this.ngModuleLoader=i,this.scheduler=n,this.routeModuleMap=new Map([["Start","./start-page-wrapper/start-page-wrapper.module#StartPageWrapperModule"],["AppGallery","./app-gallery/app-gallery.module#AppGalleryModule"],["Templates","./templates/templates.module#TemplatesModule"]]),this.preloadedRoutes=new Set,this.prefetchedDns=new Set}preload(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){e&&(this.isOfficeRoute(e)&&this.routeModuleMap.has(e)?yield this.preloadRoute(e):e.startsWith("https")&&this.prefetchDns(e))}))}isOfficeRoute(e){return!e.startsWith("http")}preloadRoute(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){("Start"!==e||this.capabilitiesService.capabilities.wacStartPageEnabled)&&(this.preloadedRoutes.has(e)||(this.preloadedRoutes.add(e),yield new Promise((e=>this.scheduler.scheduleWork(e,3))),yield this.ngModuleLoader.load(this.routeModuleMap.get(e))))}))}prefetchDns(e){if(!this.prefetchedDns.has(e)){this.prefetchedDns.add(e);const t=new Map([["rel","dns-prefetch"],["href",e]]);this.documentService.addLinkTag(t)}}}l.ɵprov=s.kc({factory:function(){return new l(s.lc(r.a),s.lc(a.a),s.lc(s.C),s.lc(o.a))},token:l,providedIn:"root"})},clUe:function(e,t,i){"use strict";i.d(t,"a",(function(){return R}));var n=i("QjXU"),r=i("j7b/"),a=i("m32Q"),o=i("lkvL"),s=i("lwUs"),l=i("tyUq"),c=i("lrJm"),u=i("3GGT"),d=i("hhzZ"),h=i("R7NL"),p=i("Vwd8"),m=i("BaAg"),f=i("kpuN"),g=i("6nG3"),b=i("W3Zz"),v=i("Z0U4"),S=i("wwmn"),y=i("casz"),C=i("ZtId"),w=i("Brer"),I=i("pOWU"),T=i("4/We"),k=i("cgnd"),A=i("LQqy"),_=i("/I02"),P=i("PBJH"),E=i("JH4S"),F=i("oAX+"),O=i("idgT"),D=i("Mlb/"),M=i("vk2e");class R extends I.a{constructor(e,t,i,n,r,a,o,s,l,c,u,d,h,p,m,f,g,b,v,S){super(e,s,l,"OfficeHome",r,c,d,v),this.capabilitesService=t,this.clientStartupConfigService=i,this.consumerInstallConfigService=n,this.deviceDetector=a,this.globalErrorHandler=o,this.officeRouteService=u,this.startupConfigService=h,this.templatesConfig=p,this.updateContentService=m,this.userContextService=f,this.userProfileService=g,this.locService=b,this.vroomService=S,this.locale=r.sharedContext.officeMarket.toLowerCase(),this.numTemplates=this.templatesConfig.config.numTemplates,this.initializeTemplateCache(),this.requestConfig={headers:new Map},this.templatesStreamMap=new Map,this.enterpriseTemplatesStreamMap=new Map,this.templatesContentStreamMap=new Map,this.deviceInfo=this.deviceDetector.getDeviceInfo()}getTemplateContent(e,t,i){if(this.templatesContentStreamMap.has(e)&&this.templatesContentStreamMap.get(e).has(i))return this.templatesContentStreamMap.get(e).get(i);const n=`${this.getUrl(e,this.templatesConfig.config.templatesApiEndpoint+R.TEMPLATES_CONTENT_PATH)}&${R.templateIdArg}${t}&${R.templateBinaryUrlArg}${i}`,r=this.fetchTemplateContentData(e,n,t,"cache-only"),a=this.fetchTemplateContentData(e,n,t,"network-first"),o=F.a.createResultsWithCacheObservable(r,a,null,(t=>{this.templatesContentStreamMap.get(e)&&this.templatesContentStreamMap.get(e).delete(i)}));return this.templatesContentStreamMap.get(e)||this.templatesContentStreamMap.set(e,new Map),this.templatesContentStreamMap.get(e).set(i,o),o}getVisioLocalizationLabel(e){return this.locService[`${m.b[e]}TemplateLabel`]}getTemplatesCollections(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){if(!(e&&e.length>0))return[];{let t=[],i=[];const n={};try{t=yield Promise.all(e.map((e=>Object(a.a)({userId:this.clientStartupConfigService.config.puid,collectionName:R.templatesCollectionPersistenceKey,collectionVersion:R.templatesCollectionPersistenceVersion,key:this.getCacheKey(e),plugins:R.templatesPersistencePlugins}))));for(let r=0;r<e.length;++r)t[r]?n[e[r]]=t[r]:i.push(e[r]);if(0===i.length)return Object(l.a)({eventName:"Templates_Collections",httpCode:u.a.OK,fromCache:!0,latency:-1}),t}catch(t){i=e}try{const t=yield this.fetchTemplatesCollections(i.join(","));t.forEach((e=>{e&&e.Templates&&e.Templates.Template&&e.Templates.Template.length>0&&Object(o.a)({userId:this.clientStartupConfigService.config.puid,collectionName:R.templatesCollectionPersistenceKey,collectionVersion:R.templatesCollectionPersistenceVersion,key:this.getCacheKey(e.CollectionId),data:e,plugins:R.templatesPersistencePlugins})}));for(let e=0;e<i.length;++e)n[i[e]]=t[e];return e.map((e=>n[e])).filter((e=>!!e))}catch(e){return t.filter((e=>!!e))}}}))}getTemplatesRecommended(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){if(e&&e.length>0){try{const t=yield Object(a.a)({userId:this.clientStartupConfigService.config.puid,collectionName:R.templatesRecommendedPersistenceKey,collectionVersion:R.templatesRecommendedPersistenceVersion,key:this.getCacheKey(e),plugins:R.templatesPersistencePlugins});if(t)return t}catch(e){}const t=this.getTemplatesRecommendedUrl(e);try{const i=yield this.fetchTemplatesRecommended(e,t);return i&&i.Template&&i.Template.length&&Object(o.a)({userId:this.clientStartupConfigService.config.puid,collectionName:R.templatesRecommendedPersistenceKey,collectionVersion:R.templatesRecommendedPersistenceVersion,key:this.getCacheKey(e),data:i,plugins:R.templatesPersistencePlugins}),i}catch(e){}}return null}))}getTemplates(e){if(this.templatesStreamMap.has(e))return this.templatesStreamMap.get(e);const t=this.getUrl(e,this.templatesConfig.config.templatesApiEndpoint),i=this.fetchTemplateData(e,t,"cache-only"),n=this.fetchTemplateData(e,t,"network-first"),r=this.updateContentService.getOrAddUpdateStream(this.getUpdateStreamKey(t),(()=>this.fetchTemplateData(e,t,"network-first"))),a=F.a.createResultsWithCacheObservable(i,n,r,(t=>this.templatesStreamMap.delete(e)));return this.templatesStreamMap.set(e,a),a}updateTemplates(e){return this.templatesFromConfig.delete(e),this.templatesStreamMap.delete(e),this.updateContentService.pushUpdate(this.getUpdateStreamKey(this.getUrl(e,this.templatesConfig.config.templatesApiEndpoint)))}getCreateTemplates(){if(this.createTemplatesStream)return this.createTemplatesStream;const e=this.startupConfigService.config.authType===k.a.OrgId?2:1,t=this.startupConfigService.config.sharedClientStartupContext.flights.replace(/,\s*$/,""),i=`&${R.isIwArg}${this.userContextService.user.isIw}&${R.isAdminArg}${this.userContextService.user.isAdmin}&${R.isSmbArg}${this.userContextService.user.isSmb}&${R.isEduFacultyArg}${this.userContextService.user.isEduFaculty}&${R.isEduStudentArg}${this.userContextService.user.isEduStudent}&${R.flightsArg}${t}&${R.authIdArg}${e}&${R.pageArg}Other&${R.firstVisitAgeInWeeksArg}${Math.floor(this.userProfileService.fullDaysSinceFirstVisit()/7)}&${R.browserNameArg}${b.a[this.deviceInfo.browser.browserType]}&${R.osNameArg}${b.d[this.deviceInfo.platform.platformType]}&${R.osVersionArg}${this.deviceInfo.platformVersion}&${R.deploymentEnvironmentArg}${this.startupConfigService.config.sharedClientStartupContext.deploymentEnvironment}`,n=`${this.contextService.sharedContext.officeHomeApiRoot}/${this.templatesConfig.config.templatesApiEndpoint}?${R.appArg}Create&${R.cultureArg}${this.locale}&${R.limitArg}20&${R.isEduArg}${this.userContextService.user.isEdu}${i}`,r=this.fetchTemplateData(m.b.None,n,"cache-only"),a=this.fetchTemplateData(m.b.None,n,"network-first"),o=F.a.createResultsWithCacheObservable(r,a,null,(e=>this.createTemplatesStream=null));return this.createTemplatesStream=o,o}getEnterpriseTemplates(e,t="",i=!1){const n=e.concat(t);if(this.enterpriseTemplatesStreamMap.has(n))return this.enterpriseTemplatesStreamMap.get(n);const r=(e,t)=>{let n=[];return e&&(n=e.value.filter((e=>R.supportedEnterpriseFileTypes.has(m.a.getFileExtension(e.name))||e.folder)).map((e=>{const t=[];if(e.thumbnails.length>0){const n=e.thumbnails[0];t.push(i?{Size:"large",Height:n.large.height,Width:n.large.width,Url:n.large.url,ImageType:"MT"}:{Size:"medium",Height:n.medium.height,Width:n.medium.width,Url:n.medium.url,ImageType:"MT"})}return{AssetId:e.id,Title:e.name,TemplateBinaryUrl:this.capabilitesService.capabilities.pwaEnabled?e.webDavUrl:e.webUrl,Thumbnails:t}}))),{Template:n,fromCache:t}},a=this.vroomService.getDriveItemChildrenWithThumbnails(e,t,"cache-only").then((e=>r(e,!0))),o=this.vroomService.getDriveItemChildrenWithThumbnails(e,t,"network-first","BrowseOrgTemplates","AUO").then((e=>r(e,!1))),s=F.a.createResultsWithCacheObservable(a,o,null,(e=>this.enterpriseTemplatesStreamMap.delete(n)));return this.enterpriseTemplatesStreamMap.set(n,s),s}getRequestIdFromOmexResponse(e){return this.getHeaderValue(e.headers,"x-ms-request-id")}getEnterpriseTemplatesLibraries(){return this.enterpriseTemplateLibraries||(this.enterpriseTemplateLibraries=this.vroomService.getEnterpriseTemplatesLibraries().then((e=>{let t=[];return e&&(t=e.value.map((e=>({DriveId:e.id,ItemId:"",Title:e.name})))),t}))),this.enterpriseTemplateLibraries}isPaidConsumer(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){if(this.clientStartupConfigService.config.authType===k.a.MSA){const e=yield this.consumerInstallConfigService.getCurrentSku();return null!==e&&!(e===g.b.NonActive||e===g.b.NotSubscribed||e===g.b.NotDetected||e===g.b.Perpetual||e===g.b.Perpetual2019)}return!1}))}handleQueryParam(e,t){"mocktemplates"===e&&this.mockRequestHeader&&this.requestConfig.headers.set(this.mockRequestHeader,t)}fetchTemplateContentData(e,t,i,r){return new Promise(((a,o)=>Object(n.__awaiter)(this,void 0,void 0,(function*(){const n=m.a.fileTypeNameFromType(e);this.get("Template_Content_Request","Template_Content",t,(e=>{e.instrument(((e,t)=>{e.ok&&(e.data?(t.ItemCategory=n,t.ElementId=i):t.HttpCode=u.a.UnexpectedResponse.toString())})).then((e=>{e.data?a(e):o(new I.b(e,"Null template content response"))})).catch((e=>{this.globalErrorHandler.handleError(e)}))}),o,this.requestConfig,r)}))))}fetchTemplatesCollections(e){const t=this.getTemplatesCollectionUrl(e);return new Promise(((i,r)=>Object(n.__awaiter)(this,void 0,void 0,(function*(){this.get("Templates_Collections_Request","Templates_Collections",t,(t=>{t.instrument(((t,i)=>{var n;if(t.ok)if(t.data&&t.data.Collections&&t.data.Collections.length>0){const r=null===(n=t.data.Collections[0].Templates)||void 0===n?void 0:n.RequestId;i.ActualSize=t.data.Collections.length.toString(),i.ItemCategory=e,i.RequestId=r}else i.Error="Unexpected response",i.HttpCode=u.a.UnexpectedResponse.toString();else i.Error=t.statusText})).then((e=>{if(!e.data||!e.data.Collections||0===e.data.Collections.length)return void r(new I.b(e,"Null templates response"));const t=e.data.Collections.map((e=>e&&e.Templates&&e.Templates.Value&&e.Templates.Value.length>0?{CollectionId:e.Collection,Title:e.Collection,Templates:{Template:this.setupTemplates(e.Templates.Value,m.b.None),fromCache:!1}}:null));t&&0!==t.length||r(new I.b(e,"Null templates response")),i(t)})).catch((e=>{this.globalErrorHandler.handleError(e,"KAzhF")}))}),r,this.requestConfig,"network-only")}))))}fetchTemplatesRecommended(e,t){return new Promise(((i,r)=>Object(n.__awaiter)(this,void 0,void 0,(function*(){(yield this.isPaidConsumer())&&(t+=R.isPremiumString),this.get("Templates_Recommended_Request","Templates_Recommended",t,(t=>{t.instrument(((t,i)=>{if(t.ok)if(t.data&&t.data.Templates.Value&&t.data.Templates.Value.length>0){const n=t.data.Templates.RequestId;i.ActualSize=t.data.Templates.Value.length.toString(),i.ItemCategory=e,i.RequestId=n}else i.HttpCode=u.a.UnexpectedResponse.toString()})).then((e=>{if(!e.data||!e.data.Templates||0===e.data.Templates.Value.length)return void r(new I.b(e,"Null templates response"));const t={Template:this.setupTemplates(e.data.Templates.Value,m.b.None),fromCache:!1};t&&0!==t.Template.length||r(new I.b(e,"Null templates response")),i(t)})).catch((e=>{this.globalErrorHandler.handleError(e,"KlVan")}))}),r,this.requestConfig,"network-only")}))))}fetchTemplateData(e,t,i){return new Promise(((r,a)=>Object(n.__awaiter)(this,void 0,void 0,(function*(){if(this.templatesFromConfig.has(e))return void r({Template:this.templatesFromConfig.get(e),fromCache:"cache-only"===i});const n=m.a.fileTypeNameFromType(e);(yield this.isPaidConsumer())&&(t+=R.isPremiumString),this.get("Templates_Request","Templates",t,(t=>{t.instrument(((e,t)=>{e.ok?e.data&&e.data.Templates&&e.data.Templates.Value?(t.ActualSize=e.data.Templates.Value.length.toString(),t.ItemCategory=n,t.RequestId=e.data.Templates.RequestId):(t.HttpCode=u.a.UnexpectedResponse.toString(),t.Error="Null templates response"):t.Error=e.statusText})).then((t=>{if(!t.data||!t.data.Templates||!t.data.Templates.Value)return void a(new I.b(t,"Null templates response"));const i=this.setupTemplates(t.data.Templates.Value,e);r({Template:i,fromCache:t.fromCache})})).catch((e=>{this.globalErrorHandler.handleError(e,"TFeVI")}))}),a,this.requestConfig,i)}))))}initializeTemplateCache(){this.templatesFromConfig=new Map,this.templatesConfig.getTemplatesInfoPromise().then((e=>{if(!e)return;const t=m.a.fileTypeNameToFileType(e.Application);if(t!==m.b.Unknown){const i=this.setupTemplates(e.Templates.Value,t);this.templatesFromConfig.set(t,i)}}))}setupTemplates(e,t){if(t===m.b.Visio)for(const t of e)t.Categories.length&&(t.Title=t.Categories[0].LocalizedTitle);return e.reduce((function(e,t){return void 0!==t.AssetId&&(t.IsBlank=!1,e.push(t)),e}),[])}getUpdateStreamKey(e){return`templates-${e}`}getUrl(e,t){let i=this.numTemplates;[m.b.VisioBusinessWac,m.b.VisioFlowChartWac,m.b.VisioGeneralWac,m.b.VisioNetworkWac,m.b.VisioSoftwareWac].lastIndexOf(e)>=0&&(i=this.templatesConfig.config.numVisioTemplates);const n=this.officeRouteService.getRouteItemForCurrentLocation(),r=!n||"Start"!==n.route&&"Templates"!==n.route?"Other":`${n.route}Page`,a=this.startupConfigService.config.authType===k.a.OrgId?2:1,o=this.startupConfigService.config.sharedClientStartupContext.flights.replace(/,\s*$/,""),s=`&${R.isIwArg}${this.userContextService.user.isIw}&${R.isAdminArg}${this.userContextService.user.isAdmin}&${R.isSmbArg}${this.userContextService.user.isSmb}&${R.isEduFacultyArg}${this.userContextService.user.isEduFaculty}&${R.isEduStudentArg}${this.userContextService.user.isEduStudent}&${R.flightsArg}${o}&${R.authIdArg}${a}&${R.pageArg}${r}&${R.firstVisitAgeInWeeksArg}${Math.floor(this.userProfileService.fullDaysSinceFirstVisit()/7)}&${R.browserNameArg}${b.a[this.deviceInfo.browser.browserType]}&${R.osNameArg}${b.d[this.deviceInfo.platform.platformType]}&${R.osVersionArg}${this.deviceInfo.platformVersion}&${R.deploymentEnvironmentArg}${this.startupConfigService.config.sharedClientStartupContext.deploymentEnvironment}`;return`${this.contextService.sharedContext.officeHomeApiRoot}/${t}?${R.appArg}${m.b[e]}&${R.cultureArg}${this.locale}&${R.limitArg}${i-1}&${R.isEduArg}${this.userContextService.user.isEdu}${s}`}getTemplatesCollectionUrl(e){return`${this.contextService.sharedContext.officeHomeApiRoot}/${this.templatesConfig.config.templatesApiEndpoint+R.TEMPLATES_COLLECTION_PATH}?${R.collectionsArg}${e}&${R.cultureArg}${this.locale}`}getTemplatesRecommendedUrl(e){const t=this.startupConfigService.config.authType===k.a.OrgId?2:1,i=this.startupConfigService.config.sharedClientStartupContext.flights.replace(/,\s*$/,""),n=`&${R.browserNameArg}${b.a[this.deviceInfo.browser.browserType]}&${R.flightsArg}${i}&${R.isIwArg}${this.userContextService.user.isIw}&${R.isAdminArg}${this.userContextService.user.isAdmin}&${R.isSmbArg}${this.userContextService.user.isSmb}&${R.isEduFacultyArg}${this.userContextService.user.isEduFaculty}&${R.isEduStudentArg}${this.userContextService.user.isEduStudent}&${R.authIdArg}${t}&${R.firstVisitAgeInWeeksArg}${Math.floor(this.userProfileService.fullDaysSinceFirstVisit()/7)}&${R.pageArg}Create&${R.deploymentEnvironmentArg}${this.startupConfigService.config.sharedClientStartupContext.deploymentEnvironment}&${R.osNameArg}${b.d[this.deviceInfo.platform.platformType]}&${R.osVersionArg}${this.deviceInfo.platformVersion}`;return`${this.contextService.sharedContext.officeHomeApiRoot}/${this.templatesConfig.config.templatesApiEndpoint+R.TEMPLATES_RECOMMENDED_PATH}?${R.cultureArg}${this.locale}&${R.appsArg}${e}&${R.limitArg}200${n}`}getCacheKey(e){return e+"_"+this.locale}}R.TEMPLATES_COLLECTION_PATH="/collections",R.TEMPLATES_RECOMMENDED_PATH="/recommended",R.TEMPLATES_CONTENT_PATH="/content",R.collectionsArg="collections=",R.cultureArg="culture=",R.appArg="app=",R.appsArg="apps=",R.limitArg="show=",R.isEduArg="isEdu=",R.flightsArg="flights=",R.isIwArg="isIw=",R.isAdminArg="isAdmin=",R.isSmbArg="isSmb=",R.isEduFacultyArg="isEduFaculty=",R.isEduStudentArg="isEduStudent=",R.authIdArg="authId=",R.pageArg="page=",R.firstVisitAgeInWeeksArg="firstVisitAgeInWeeks=",R.browserNameArg="browserName=",R.osNameArg="osName=",R.osVersionArg="osVersion=",R.deploymentEnvironmentArg="deploymentEnvironment=",R.isPremiumString="&isPremium=1",R.templateIdArg="id=",R.templateBinaryUrlArg="templateBinaryUrl=",R.supportedEnterpriseFileTypes=new Set(["pptx","potx","dotx","xltx"]),R.templatesCollectionPersistenceKey="templates-collection-api",R.templatesCollectionPersistenceVersion=5,R.templatesPersistencePlugins=[Object(s.a)(7*r.a)],R.templatesRecommendedPersistenceKey="templates-recommended-api",R.templatesRecommendedPersistenceVersion=3,R.ɵprov=D.kc({factory:function(){return new R(D.lc(f.a),D.lc(T.a),D.lc(k.b),D.lc(A.a),D.lc(_.a),D.lc(b.b),D.lc(c.b),D.lc(d.a),D.lc(h.a),D.lc(S.a),D.lc(v.a),D.lc(M.q),D.lc(k.b),D.lc(O.a),D.lc(C.a),D.lc(E.a),D.lc(p.b),D.lc(P.a),D.lc(y.a),D.lc(w.a))},token:R,providedIn:"root"})},dFxn:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("lrJm"),r=i("ZJrL"),a=i("Mlb/");class o{constructor(e){this.globalErrorHandler=e}parse(e){try{return r.a.parseJsonElementWithId(e)}catch(t){const i=new n.a(`Failure to parse ${e} from response`,t);this.globalErrorHandler.handleError(i)}return null}}o.ɵprov=a.kc({factory:function(){return new o(a.lc(a.p))},token:o,providedIn:"root"})},dOgD:function(e,t,i){"use strict";i.d(t,"a",(function(){return F}));var n=i("lrJm"),r=i("hhzZ"),a=i("R7NL"),o=i("QOOv"),s=i("kpuN"),l=i("pd4Y"),c=i("Z0U4"),u=i("wwmn"),d=i("casz"),h=i("ZtId"),p=i("BMb5"),m=i("4/We"),f=i("cgnd"),g=i("/I02"),b=i("PBJH"),v=i("kaEK"),S=i("9260"),y=i("BaAg"),C=i("RR/o"),w=i("pOWU"),I=i("uUrA"),T=i("CVeG"),k=i("oAX+");class A extends w.a{constructor(e,t,i,n,r,a,o,s,l,c,u,d,h,p,m){super(e,n,r,"Substrate",i,o,l,h),this.capabilitiesService=t,this.locService=a,this.mruConfigService=s,this.globalErrorHandler=c,this.startupConfigService=u,this.updateContentService=d,this.dateService=p,this.windowService=m,this.fetchRequestIndex=0;const f=this.capabilitiesService.capabilities;this.scenario=f.suggestedActionsEnabled?"OfficeSuggestedActions":f.pwaEnabled?"OfficeComApp":"OfficeComHome",this.section=f.suggestedActionsEnabled?"OfficeSuggestedActions":"OfficeComHome",this.application=f.pwaEnabled?"OfficeComApp":"OfficeComHome",this.baseUrl=this.inMockMode?this.contextService.sharedContext.officeHomeApiRoot:`${this.mruConfigService.config.substrateApiEndpoint}`,this.officeFeedDataStreams=new Map,this.regExp=new RegExp("{([0-9]+)}"),this.feedFlight=this.mruConfigService.config.officeFeedFlightEnabled,this.startupConfig=this.startupConfigService.config,this.tamyDataStreamMap=new Map}getOfficeFeed(){let e="";const t=this.mruConfigService.config;e=t.useFeedS2SApi?`${this.contextService.sharedContext.officeHomeApiRoot}/api/officefeed?${A.locParam}${this.contextService.sharedContext.officeMarket}&feedFlight=${this.getFeedFlight()}`:`${this.baseUrl}/PeoplePredictionsB2/MicrosoftFeed?section=${this.section}&${A.locParam}${this.contextService.sharedContext.officeMarket}&${A.newSchema}${this.mruConfigService.config.officeFeedNewSchemaEnabled}`;const i=this.startupConfig.sharedClientStartupContext.flights.toLowerCase(),n=[],r=this.capabilitiesService.capabilities;if(t.officeFeedFlightControlName&&t.officeFeedFlightName&&(i.includes(t.officeFeedFlightControlName.toLowerCase())?n.push(t.officeFeedExperimentControlName):i.includes(t.officeFeedFlightName.toLowerCase())&&n.push(t.officeFeedExperimentName)),t.officeFeedFlight2ControlName&&t.officeFeedFlight2Name&&(i.includes(t.officeFeedFlight2ControlName.toLowerCase())?n.push(t.officeFeedExperiment2ControlName):i.includes(t.officeFeedFlight2Name.toLowerCase())&&n.push(t.officeFeedExperiment2Name)),t.officeFeedFlight3ControlName&&t.officeFeedFlight3Name&&(i.includes(t.officeFeedFlight3ControlName.toLowerCase())?n.push(t.officeFeedExperiment3ControlName):i.includes(t.officeFeedFlight3Name.toLowerCase())&&n.push(t.officeFeedExperiment3Name)),r.threeSRdlFeedExperiment&&n.push(r.threeSRdlFeedExperiment),n.length>0&&(e+=`&experiment=${n.join("&experiment=")}`),this.officeFeedDataStreams.has(e))return this.officeFeedDataStreams.get(e);const a=this.updateContentService.getOrAddUpdateStream(`officefeed-${e}`,(()=>this.fetchOfficeFeed("network-first",e,t.useFeedS2SApi))),o=this.capabilitiesService.capabilities.prefetchDataEnabled?this.prefetchOfficeFeed(e,t.useFeedS2SApi):this.fetchOfficeFeed("network-first",e,t.useFeedS2SApi),s=k.a.createResultsWithCacheObservable(this.fetchOfficeFeed("cache-only",e,t.useFeedS2SApi),o,a,(t=>this.officeFeedDataStreams.delete(e)));return this.officeFeedDataStreams.set(e,s),s}getTamyDocuments(e,t){const i=this.mruConfigService.config.supportedFileTypes,n=t&&t.size?i.filter((e=>t.has(y.a.fileTypeNameToFileType(e)))):i,r=n.reduce(((e,t,i)=>`${e}${i>0?" or ":""}resourceVisualization/Type eq '${t}'`),""),a=A.tamyPath,o=`$top=${e}&$filter=${encodeURIComponent(r)}`,s=`?${A.tamyQueryParams}&${o}`,l=this.inMockMode?`${this.contextService.sharedContext.officeHomeApiRoot}${a}/trending${s}`:`${this.mruConfigService.config.substrateApiEndpoint}${a}${s}`;if(this.tamyDataStreamMap.has(l))return this.tamyDataStreamMap.get(l);const c=this.fetchOfficeFeed("cache-only",l,!1,0,"Trending",!0,n),u=this.fetchOfficeFeed("network-first",l,!1,0,"Trending",!0,n),d=k.a.createResultsWithCacheObservable(c,u,null,(e=>this.tamyDataStreamMap.delete(l)));return this.tamyDataStreamMap.set(l,d),d}logInstrumentation(e,t,i,n){return new Promise(((r,a)=>{const o=`${this.inMockMode?this.contextService.sharedContext.officeHomeApiRoot:this.mruConfigService.config.substrateApiEndpoint}/peoplepredictionsb2/Feedback`,s=[];for(let r=0;r<e.length;r++)s.push({FeedbackId:e[r],Action:t[r],ItemSource:i[r],Target:n?n[r]:"",Timestamp:new Date(Date.now()).toISOString()});const l={Actions:s},c=this.createRequestConfig(this.startupConfig.sharedClientStartupContext.correlationId,"Feedback");this.post("OfficeFeedInstrumentation","OfficeFeedInstrumentation",o,l,(e=>{e.instrument(((e,t)=>{t.ItemCategory=s.map((e=>e.Action)).join(","),t.RequestId=this.getRequestIdFromResponse(e)})).then((()=>r(null)))}),a,c,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,this.mruConfigService.config.deferFeedWrite?4:0)}))}performAction(e,t,i){return new Promise(((n,r)=>{const a=`${this.inMockMode?this.contextService.sharedContext.officeHomeApiRoot:this.mruConfigService.config.substrateApiEndpoint}/peoplepredictionsb2/v2/myanalyticsaction`,o={FeedbackId:e,Action:t,ActionPayload:i},s=this.createRequestConfig(this.startupConfigService.config.sharedClientStartupContext.correlationId,"Feedback");this.post("OfficeFeedAction","OfficeFeedAction",a,o,(e=>{e.instrument(((e,t)=>{t.ItemCategory=o.Action})).then((()=>n(!0)))}),r,s,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,0)}))}getStreamsThumbnail(e){this.inMockMode&&(e=`${this.contextService.sharedContext.officeHomeApiRoot}/StreamsThumbnail`);const t=new FileReader;return new Promise(((i,n)=>{const r=this.createRequestConfig(this.startupConfig.sharedClientStartupContext.correlationId,"StreamsThumbnail","blob");this.get("OfficeFeed_Stream_Thumbnail_Request","OfficeFeed_Stream_Thumbnail",e,(e=>{e.then((e=>{e&&e.data?(t.onloadend=()=>{const e=t.result&&"string"==typeof t.result&&t.result||"";i(e.length>0?e:null)},t.onerror=()=>i(null),t.onabort=()=>i(null),t.readAsDataURL(e.data)):i(null)})).catch((e=>{this.globalErrorHandler.handleError(e,"AfEUN")}))}),n,r,"network-only")}))}handleQueryParam(e,t,i){"mockofficefeed"===e&&this.mockRequestHeader&&i.headers.set(this.mockRequestHeader,t)}prefetchOfficeFeed(e,t){return this.windowService.nativeWindow.prefetchRecommendedDataPromise?this.windowService.nativeWindow.prefetchRecommendedDataPromise.then((e=>e?{items:((this.mruConfigService.config.officeFeedNewSchemaEnabled?e.items:e)||[]).map((e=>this.convertItemToMruDataItem(e))).filter((e=>{var t;return e&&(null===(t=e.Activity)||void 0===t?void 0:t.formatString)})),impressionId:e.recommendedRequestId||"",fromCache:!1}:Promise.reject("Prefetch failed"))):this.fetchOfficeFeed("network-first",e,t)}fetchOfficeFeed(e,t,i,n,a,o,s){return new Promise(((l,c)=>{const u=I.a.createGuid(),d=this.createRequestConfig(u,a||"MicrosoftFeed"),h="MicrosoftFeedSPNF"===a;this.get(o?"Trending_Around_Me_Request":"OfficeFeedRequest",o?"Trending_Around_Me":"OfficeFeedRequest",t,(i=>{i.instrument(((i,n)=>{if(n.RequestId=this.getRequestIdFromResponse(i),n.Index=(this.fetchRequestIndex++).toString(),n.ImpressionId=!!i.headers&&i.headers.get(S.a.clientRequestIdHeader)||u,n.ApiLatency=(!!i.headers&&i.headers.get(A.e2eLatencyHeader)||-1).toString(),i.ok&&i.data&&!h){const e=this.mruConfigService.config.officeFeedNewSchemaEnabled?i.data.items:i.data;if(e){const t=e.length;n.ResourceIdDistribution=e.map((e=>e.sharePointIds&&e.sharePointIds.listItemUniqueId?e.sharePointIds.listItemUniqueId:"")).toString(),n.OfficeFeedCategoryDistribution=e.map((e=>e.category)).toString(),n.ActualSize=t.toString()}}else"cache-only"===e&&401===i.status&&(n.OfficeFeedUrl=r.a.filterPii(t),n.OfficeFeedAuthenticateHeader=i.headers.get("WWW-Authenticate"))})).then((t=>{if(h)l(null);else{let i=t&&t.data&&(this.mruConfigService.config.officeFeedNewSchemaEnabled?t.data.items:t.data)||[];s&&s.length>0&&(i=i.filter((e=>s.includes(e.subCategory))));const n=i.map((e=>this.convertItemToMruDataItem(e,o))),r=o?n:n.filter((e=>{var t;return e&&(null===(t=e.Activity)||void 0===t?void 0:t.formatString)}));l({items:r,impressionId:!!t.headers&&t.headers.get(S.a.clientRequestIdHeader)||u,fromCache:"cache-only"===e})}})).catch((e=>{this.globalErrorHandler.handleError(e,"AfEUN")}))}),c,d,e,null,null,null,i?"OfficeHome":"Substrate",null,n)}))}createRequestConfig(e,t,i){const n={headers:new Map([["ScenarioTag",`${this.scenario}${t}`],["Content-Type","application/json"],["X-OfficeFeedFlight",this.getFeedFlight()],["X-AnchorMailbox",`Oid:${this.startupConfig.objectId}@${this.startupConfig.tenantId}`],["X-Application",this.application],["X-ApplicationScenario",this.scenario],["X-RoutingParameter-SessionKey",this.startupConfig.objectId],[S.a.clientRequestIdHeader,e]])};return i&&(n.responseType=i),n}getFeedFlight(){return this.feedFlight?"experiment":"evaluation"}convertItemToMruDataItem(e,t=!1){return"file"===e.category.toLowerCase()||"video"===e.category.toLowerCase()?this.convertFileToMruDataItem(e,t):"newsarticle"===e.category.toLowerCase()?this.convertNewsItemToMruDataItem(e):"upcomingmeeting"===e.category.toLowerCase()&&this.mruConfigService.config.upcomingMeetingEnabled?this.convertUpcomingMeetingToMruDataItem(e):"myanalyticsinsight"===e.category.toLowerCase()&&this.mruConfigService.config.myAnalyticsEnabled?this.convertMyAnalyticsToMruDataItem(e):null}convertMyAnalyticsToMruDataItem(e){var t,i,n;const r=(null===(t=(e.inclusionReasons&&e.inclusionReasons[0]).actors[0])||void 0===t?void 0:t.User)||{},a=r.DisplayName,o={formatString:a,plainText:a,people:[{upn:r.email,tag:"c0",name:r.DisplayName}],reasonType:v.a.MyAnalytics,timestamp:e.createdDateTime?new Date(e.createdDateTime):null},s='"'+(null===(i=e.previewInfo)||void 0===i?void 0:i.text)+'"',l=e.lastModifiedDateTime?new Date(e.lastModifiedDateTime):null;return{Application:null,Category:e.category,DocId:null,DriveId:null,FileName:e.name,Title:e.name,Url:e.webUrl,WebUrl:e.webUrl,LastAccessedTime:l,FileType:"MyAnalytics",PathArray:null,Provenance:y.e[y.e.Substrate],ResourceId:"",UrlAlreadyEncoded:!0,Activity:o,ThumbnailUrl:null,FeedbackId:e.feedbackId,TaskInsight:e.taskInsight,PotentialAction:e.potentialActions,Actor:r,InsightName:e.insightName,InsightDescription:s,InsightDescriptionPrefix:this.getInsightDescriptionPrefix(null===(n=e.taskInsight)||void 0===n?void 0:n.actionType)}}getInsightDescriptionPrefix(e){let t=this.locService.YouSaid;return"FollowUp"===e||"FollowUpActionRequest"===e||"FollowUpReplyRequest"===e?t=this.locService.YouAsked:"Commitment"===e?t=this.locService.YouSaid:"Request"===e&&(t=this.locService.TheyAsked),t}convertUpcomingMeetingToMruDataItem(e){var t,i,n,r,a,o,s;const l=e.upcomingMeetingInfo,c=null!==(t=new Date(l.start))&&void 0!==t?t:null,u=this.dateService.timespanInSeconds(c),d="TeamsForBusiness"===(null===(i=l.onlineMeeting)||void 0===i?void 0:i.onlineMeetingProvider),h=null!==(n=new Date(e.expiresAt))&&void 0!==n?n:null,p=new Date,m=e.itemGroups&&e.itemGroups.length>0&&-1!==e.itemGroups.indexOf("MeetingOnlineAttending");if(!this.inMockMode&&h&&p>h)return null;const f=u>0;let g=f?this.locService.OfficeFeedYourUpcomingMeetingStarted:this.locService.OfficeFeedYourUpcomingMeeting;!f&&u>-60&&(g=this.locService.OfficeFeedYourUpcomingMeetingHappeningNow);const b=d?this.locService.JoinTeamsMeeting:this.locService.SuggestedActionJoinMeeting,S={formatString:g,plainText:g,people:null,reasonType:v.a.Meeting,timestamp:null!==(r=new Date(l.start))&&void 0!==r?r:null};return{Application:null,Category:e.category,DocId:null,DriveId:null,FileName:null,Title:null===(a=e.previewInfo)||void 0===a?void 0:a.text,Url:e.webUrl,WebUrl:e.webUrl,LastAccessedTime:c,FileType:"UpcomingMeeting",PathArray:null,Provenance:y.e[y.e.Substrate],UrlAlreadyEncoded:!0,Activity:S,FeedbackId:e.feedbackId,Attendees:l.attendees,Subject:l.subject,JoinUrl:null===(o=l.onlineMeeting)||void 0===o?void 0:o.joinUrl,MeetingStart:this.locService.formatTimeFromDate(new Date(l.start)),MeetingEnd:this.locService.formatTimeFromDate(new Date(l.end)),Location:null===(s=l.location)||void 0===s?void 0:s.displayName,Organizer:l.organizer,JoinMeetingText:b,IsUpcomingMeetingAccepted:m,IsTeamsMeeting:d}}convertNewsItemToMruDataItem(e){var t;const i=this.locService.format(this.locService.OfficeFeedPostedBy,e.newsArticleInfo&&e.newsArticleInfo.byLine||""),n=this.locService.format(this.locService.OfficeFeedPostedBy,`<c0>${e.newsArticleInfo&&e.newsArticleInfo.byLine||""}</c0>`),r=e.createdBy&&e.createdBy.User||{},a={formatString:n,plainText:i,people:[{upn:r.Id,tag:"c0",name:r.DisplayName}],reasonType:v.a.News,timestamp:e.newsArticleInfo.firstPublishedDateTime?new Date(e.newsArticleInfo.firstPublishedDateTime):null},o=e.lastModifiedDateTime?new Date(e.lastModifiedDateTime):null;return{Application:null,Category:e.category,DocId:e.oneDriveItemInfo&&e.oneDriveItemInfo.itemId,DriveId:e.oneDriveItemInfo&&e.oneDriveItemInfo.driveId,FileName:e.name,Title:e.name,Url:e.uri,WebUrl:e.webUrl,LastAccessedTime:o,FileType:"NewsArticle",PathArray:e.containerInfo?[e.containerInfo.displayName]:null,Provenance:y.e[y.e.Substrate],ResourceId:e.sharePointIds?e.sharePointIds.listItemUniqueId:"",UrlAlreadyEncoded:!0,Activity:a,ThumbnailUrl:null===(t=e.previewInfo)||void 0===t?void 0:t.image,FeedbackId:e.feedbackId}}convertOfficeFeedActivityToActivityDescription(e){let t=e.reason||"",i=null;for(;null!==(i=this.regExp.exec(t));){const n=i[1];t=t.replace(i[0],(()=>`<c${n}>${e.actors[n].User.DisplayName}</c${n}>`))}return{formatString:t,plainText:T.a.stripTags(t),people:(e.actors||[]).map((function(e,t){return{upn:e&&e.User.email,tag:`c${t}`,name:e.User.DisplayName}})),reasonType:"popularVideoInclusionReason"===e.kind?v.a.Trending:"meetingRecordingInclusionReason"===e.kind?v.a.Video:this.convertReasonTypeToActivityReason(e.inclusionKind),timestamp:e.dateTime?new Date(e.dateTime):null}}convertReasonTypeToActivityReason(e){return C.b.convertMruReasonTypeToActivityReason(C.a[e])}convertFileToMruDataItem(e,t=!1){var i,n,r,a,o,s;const l=e.lastModifiedDateTime?new Date(e.lastModifiedDateTime):null,c=e.sharePointIds,u=c&&{list_id:c.listId,list_item_unique_id:c.listItemUniqueId,site_id:c.siteId,site_url:null,web_id:c.webId},d=e.inclusionReasons&&e.inclusionReasons[0];let h,p,m,f=!1,g=null;d&&!t&&(m=this.convertOfficeFeedActivityToActivityDescription(d),f="EmailAttachment"===d.inclusionKind,this.capabilitiesService.capabilities.recommendedTeamsLinkEnabled&&(h=d.sharingWebUrl),this.capabilitiesService.capabilities.recommendedDeepLinkEnabled&&(p=d.navigationId),f&&(g={AttachmentType:1,ConversationId:"",Subject:d.conversationSubject||""}));let b=f;const v=this.fileType(e);v!==y.b.MeetingNotes&&v!==y.b.Whiteboard||(b=!0);const S="video"===e.category.toLowerCase()?"StreamsVideo":"Document",C="StreamsVideo"===S?null===(i=e.video)||void 0===i?void 0:i.mediaDuration:void 0,w="StreamsVideo"===S||"Custom"===e.subCategory?e.previewInfo.image:void 0,I=b?e.webUrl:e.uri;return{Application:y.b[v],Category:S,DocId:e.oneDriveItemInfo&&e.oneDriveItemInfo.itemId,DriveId:e.oneDriveItemInfo&&e.oneDriveItemInfo.driveId,Extension:(null===(n=null==e?void 0:e.file)||void 0===n?void 0:n.extension)||y.a.getFileExtensionFromUrl(I),FileName:e.name,Title:e.name,Url:I,WebUrl:e.webUrl,LastAccessedTime:l,FileType:y.b[v],PathArray:null!==(o=this.getPathArray(null===(r=e.containerInfo)||void 0===r?void 0:r.kind,null===(a=e.containerInfo)||void 0===a?void 0:a.displayName))&&void 0!==o?o:null,Provenance:y.e[y.e.Substrate],ResourceId:e.sharePointIds?e.sharePointIds.listItemUniqueId:"",UrlAlreadyEncoded:!0,Activity:m,SharepointInfo:u,IsEmailAttachment:f,EmailReference:g,IsCollab:e.is_collab,FeedbackId:e.feedbackId,NavigationId:p,TeamsDeepLink:h,ThumbnailUrl:w,MediaDuration:C,IconUrl:null===(s=e.appInfo)||void 0===s?void 0:s.iconUrl}}fileType(e){var t;let i=y.a.fileTypeNameToFileType(e.subCategory);return i&&i!==y.b.None?i===y.b.OneNote&&"note"===(null===(t=e.file)||void 0===t?void 0:t.extension)&&(i=y.b.MeetingNotes):i=y.b.Unknown,i}getPathArray(e,t){return t?this.isOneDrive(e)&&t?[this.locService.format(this.locService.EdgeworthFilePathTitle,t)]:[t]:null}isOneDrive(e){const t=null==e?void 0:e.toLocaleLowerCase();return"onedrive"===t||"onedrivebusiness"===t}}A.locParam="rs=",A.newSchema="forceNewSchema=",A.e2eLatencyHeader="x-end2endlatencyms",A.tamyPath="/PeoplePredictionsB2/MicrosoftFeed",A.tamyQueryParams="section=OfficeHomeTrending&scenario=OfficeHomeTrending";var _=i("Mlb/"),P=i("vk2e");class E{constructor(e,t,i,n,r,a,o,s,l,c,u,d,h,p,m,f){this.officefeedService=new A(e,h,n,i,t,p,r,a,o,s,l,u,d,m,f),c.subscribeToRouteChangeStart((e=>{e.currentRoute&&(a.config.officeFeedControlEnabled||a.config.officeFeedFlightEnabled)&&this.warmDocumentCache(e.currentRoute)}))}getOfficeFeedService(){return this.officefeedService}warmDocumentCache(e){switch(e.route){case"OfficeHome":case"Pwa":this.officefeedService.getOfficeFeed()}}}E.ɵprov=_.kc({factory:function(){return new E(_.lc(s.a),_.lc(a.a),_.lc(r.a),_.lc(g.a),_.lc(u.a),_.lc(o.a),_.lc(P.q),_.lc(n.b),_.lc(f.b),_.lc(c.a),_.lc(h.a),_.lc(d.a),_.lc(m.a),_.lc(b.a),_.lc(l.a),_.lc(p.b))},token:E,providedIn:"root"});class F{}F.ɵprov=_.kc({factory:function(){return(e=>e.getOfficeFeedService())(_.lc(E))},token:F,providedIn:"root"})},dQLD:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("dFxn"),r=i("Mlb/");class a{constructor(e){this.config=e.parse("odspConfig")||{odspProvisioningCheckIntervals:null,odspProvisioningPendingImage:null,odspProvisioningStatusApiPath:null}}}a.ɵprov=r.kc({factory:function(){return new a(r.lc(n.a))},token:a,providedIn:"root"})},dRqz:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},dSKW:function(e,t,i){"use strict";function n(e){return e?"MyContent"===e?"Default":e.endsWith("Start")?"Start":e.endsWith("Templates")?"Templates":e.endsWith("Content")?"Content":"SearchPersonScoped"===e?"Person":"SearchSiteScoped"===e?"Site":"FormsGroupForms"===e?"GroupForms":"FormsMyForms"===e?"MyForms":"Default":"Other"}function r(e){return e?"MyContent"===e?e:e.endsWith("Start")||e.endsWith("Templates")||e.endsWith("Content")?e.replace("Start","").replace("Templates","").replace("Content",""):e.startsWith("Search")?"Search":e.startsWith("Forms")?"Forms":"OfficeHome"===e?"Home":e:""}function a(e){var t="Pwa"===(null==e?void 0:e.route)?"OfficeHome":null==e?void 0:e.route,i=void 0!==t?""+((null==e?void 0:e.app)?e.app:"")+t:void 0;return void 0!==i?i:"Unknown"}i.d(t,"c",(function(){return n})),i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return a}))},dvrM:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return c}));var n=i("Mlb/"),r=i("pzhl"),a=i("PkQn"),o=i("4/We"),s=i("W0EU"),l=n.Fb({encapsulation:2,styles:[],data:{}});function c(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,"span",[["class","alert-message"]],null,null,null,null,null)),(e()(),n.Hb(1,0,null,null,1,"ohp-icon-font",[["cssClass","alert-message__icon"],["iconFontName","Alert"]],null,null,null,r.b,r.a)),n.Gb(2,638976,null,0,a.a,[o.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"]},null),(e()(),n.Hb(3,0,null,null,1,"span",[["class","alert-message__text"]],null,null,null,null,null)),(e()(),n.gc(4,null,["",""]))],(function(e,t){e(t,2,0,"alert-message__icon","Alert")}),(function(e,t){e(t,4,0,t.component.message)}))}n.Db("ohp-alert-message",s.a,(function(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-alert-message",[],null,null,null,c,l)),n.Gb(1,49152,null,0,s.a,[],null,null)],null,null)}),{message:"message"},{},[])},dx17:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("kaEK"),r=i("L/Tc"),a=i("QOOv"),o=i("pd4Y"),s=i("uH9+"),l=i("cgnd"),c=i("PBJH"),u=i("CVeG"),d=i("Mlb/");class h{constructor(e,t,i,n,r){this.timestampFormatService=t,this.locService=i,this.mruConfigService=n,this.dateService=r,this.userEmail=e.config.userPrincipalName}activityDescription(e,t,i,n=!1){if(!e||0===e.length)return null;e=this.filterActivities(e,t);const a=new Map;for(let t=0;t<e.length;t++){const i=e[t],n=i.action.type;a.has(n)?a.get(n).push(i):a.set(n,[i])}return a.has(r.a.Mention)?this.createMentionDescription(a.get(r.a.Mention),i,n):a.has(r.a.Comment)?this.createCommentDescription(a.get(r.a.Comment),i,n):a.has(r.a.Edit)?this.createEditDescription(a.get(r.a.Edit),i,n):null}displayedActivityType(e,t,i){if(!e||0===e.length)return r.a.None;i&&(e=this.filterActivities(e,t));let n=0,a=0,o=0;for(let t=0;t<e.length;t++){const i=e[t].action.type;i===r.a.Mention?n++:i===r.a.Comment?a++:i===r.a.Edit&&o++}return n>0?r.a.Mention:a>0?r.a.Comment:o>0?r.a.Edit:r.a.None}filterActivities(e,t){return e?e.filter((e=>{if(e&&e.action&&e.timestamp&&e.actor&&e.actor.user&&e.actor.user.email&&e.actor.user.displayName){const i=e.action;if(t&&e.timestamp<t)return!1;if(this.isCurrentUser(e.actor.user))return!1;if(i.type===r.a.Mention&&i.data){const e=i.data.mentionees;return e&&e.filter((e=>e&&e.user&&this.isCurrentUser(e.user))).length>0}return i.type!==r.a.Unknown}return!1})):[]}isCurrentUser(e){return e&&(!!e.self||e.userPrincipalName===this.userEmail)}createMentionDescription(e,t,i){if(!e||!e.length)return null;const r=e[0],a=this.numDistinctActors(e),o=r.actor.user,s=r.timestamp,l=this.formatStringWithTime(s,"Mentioned",t,i,[o.displayName],a-1);return{formatString:l,plainText:u.a.stripTags(l),people:[{upn:o.email,tag:"c0",name:o.displayName},{upn:this.userEmail,tag:"c1",name:this.userEmail}],reasonType:n.a.Mention,timestamp:s}}createCommentDescription(e,t,i){if(0===e.length)return null;const r=e[0],a=r.action.data,o=r.actor.user,s=r.timestamp;let l="",c=null;if(e.length>1){const n=this.numDistinctActors(e);l=this.formatStringWithTime(s,"Commented",t,i,[o.displayName],n-1),c=[{upn:o.email,tag:"c0",name:o.displayName}]}else if(a&&a.isReply&&a.parentAuthor&&a.parentAuthor.user.displayName&&a.parentAuthor.user.email){const e=a.parentAuthor.user;this.isCurrentUser(e)?(l=this.formatStringWithTime(s,"RepliedYourComment",t,i,[o.displayName],0),c=[{upn:o.email,tag:"c0",name:o.displayName},{upn:this.userEmail,tag:"c1",name:this.userEmail}]):(l=this.formatStringWithTime(s,"RepliedOtherComment",t,i,[o.displayName,e.displayName],0),c=[{upn:o.email,tag:"c0",name:o.displayName},{upn:e.email,tag:"c1",name:e.displayName}])}else l=this.formatStringWithTime(s,"Commented",t,i,[o.displayName],0),c=[{upn:o.email,tag:"c0",name:o.displayName}];return{formatString:l,plainText:u.a.stripTags(l),people:c,reasonType:n.a.Comment,timestamp:s}}createEditDescription(e,t,i){if(0===e.length)return null;const r=e[0],a=this.numDistinctActors(e),o=r.actor.user,s=r.timestamp,l=this.formatStringWithTime(s,"Edited",t,i,[o.displayName],a-1);return{formatString:l,plainText:u.a.stripTags(l),people:[{upn:o.email,tag:"c0",name:o.displayName}],reasonType:n.a.Edit,timestamp:s}}formatStringWithTime(e,t,i,n,r,a){const o=a<=0?"":1===a?"OneOther":"Others";let s=t+o;const l=n?"NoDate":this.getActivityTimestampType(e,i);s+="FullDateThisYear"===l?"FullDate":l;const c=this.getTimestampPlaceholders(e,l),u=this.mruConfigService.config.activityStrings[s];return"OneOther"===o||""===o||r.push(this.locService.localizedNumberString(a)),r=r.concat(c),this.locService.format(u,...r)}getActivityTimestampType(e,t){switch(this.timestampFormatService.getTimestampType(e)){case 0:return"NoDate";case 1:return"JustNow";case 2:return"MinAgo";case 3:return"HoursAgo";case 4:return t?"Yesterday":"YesterdayAt";case 5:return t?"DayOfWeek":"DayAndTimeOfWeek";case 6:return"FullDateThisYear";case 7:return"FullDate"}}getTimestampPlaceholders(e,t){const i=this.dateService.timespanInSeconds(e);switch(t){case"NoDate":case"JustNow":case"Yesterday":return null;case"MinAgo":return[this.locService.localizedNumberString(Math.round(i/60))];case"HoursAgo":return[this.locService.localizedNumberString(Math.round(i/3600))];case"YesterdayAt":return[this.locService.formatTimeFromDate(e)];case"DayOfWeek":return[this.locService.localizedWeekday(e)];case"DayAndTimeOfWeek":return[this.locService.localizedWeekday(e),this.locService.formatTimeFromDate(e)];case"FullDateThisYear":return[this.locService.localizedMonthDate(e)];case"FullDate":return[this.locService.localizedDateStringMedium(e)]}}numDistinctActors(e){return new Set(e.map((e=>e.actor.user.email))).size}}h.ɵprov=d.kc({factory:function(){return new h(d.lc(l.b),d.lc(s.a),d.lc(c.a),d.lc(a.a),d.lc(o.a))},token:h,providedIn:"root"})},dy1P:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.AADMyApps="AADMyApps",e.AboutMe="AboutMe",e.Access="Access",e.AdminPortal="AdminPortal",e.AppGallery="AppGallery",e.Audio="Audio",e.BecomeTheAdmin="BecomeTheAdmin",e.Bing="Bing",e.Bookings="Bookings",e.BusinessCentral="BusinessCentral",e.Calendar="Calendar",e.ClassNotebook="ClassNotebook",e.Clipchamp="Clipchamp",e.CloudPC="CloudPC",e.ComplianceCenter="ComplianceCenter",e.Create="Create",e.CustomerVoice="CustomerVoice",e.CRM="CRM",e.Designer="Designer",e.DocsCom="DocsCom",e.Documents="Documents",e.Dynamics365="Dynamics365",e.Dynamics365CI="Dynamics365CI",e.Dynamics365CSI="Dynamics365CSI",e.Dynamics365FraudProtection="Dynamics365FraudProtection",e.Dynamics365Invoicing="Dynamics365Invoicing",e.Dynamics365ProductInsights="Dynamics365ProductInsights",e.Dynamics365SalesInsights="Dynamics365SalesInsights",e.DynamicsApp="DynamicsApp",e.DynamicsNAV="DynamicsNAV",e.ERP="ERP",e.ExcelOnline="ExcelOnline",e.ExchangeAdmin="ExchangeAdmin",e.FamilySafety="FamilySafety",e.Fluid="Fluid",e.Forefront="Forefront",e.ForefrontAdmin="ForefrontAdmin",e.GraphApp="GraphApp",e.HighLander="HighLander",e.Invoicing="Invoicing",e.ISVStudio="ISVStudio",e.Kaizala="Kaizala",e.LineOfBusinessApp="LineOfBusinessApp",e.Lists="Lists",e.LoopComponent="Loop component",e.LogicFlows="LogicFlows",e.Mail="Mail",e.Marketing="Marketing",e.MeetingObject="Meeting Object",e.MeetingNotes="MeetingNotes",e.MetaOSApp="MetaOSApp",e.MicrosoftStream="MicrosoftStream",e.MOSStore="MOSStore",e.MSN="MSN",e.MyAnalytics="MyAnalytics",e.MyApps="MyApps",e.MyContent="MyContent",e.Feed="Feed",e.Netbreeze="Netbreeze",e.NewsArticle="NewsArticle",e.Newsfeed="Newsfeed",e.NonProfitPortal="NonProfitPortal",e.O365Settings="O365Settings",e.ODBAdmin="ODBAdmin",e.OfficeDotCom="OfficeDotCom",e.OfficeForms="OfficeForms",e.OfficeGraph="OfficeGraph",e.OfficeStore="OfficeStore",e.OneNoteOnline="OneNoteOnline",e.OWASettings="OWASettings",e.Park="Park",e.Parature="Parature",e.Partner="Partner",e.Paw="Paw",e.PDF="PDF",e.People="People",e.Photos="Photos",e.PlayLists="PlayLists",e.PowerApps="PowerApps",e.PowerAppsApp="PowerAppsApp",e.PowerBI="PowerBI",e.PowerPointOnline="PowerPointOnline",e.Privacy="Privacy",e.Project="Project",e.Publisher="Publisher",e.SecureScore="SecureScore",e.Rewards="Rewards",e.Security="Security",e.SendASmile="SendASmile",e.SharePoint="SharePoint",e.SharePointAdmin="SharePointAdmin",e.SharePointApp="SharePointApp",e.SISSyncAdmin="SISSyncAdmin",e.Skype="Skype",e.SkypeAdmin="SkypeAdmin",e.SkypeForBusiness="SkypeForBusiness",e.SkypeMeetings="SkypeMeetings",e.SkypeTeams="SkypeTeams",e.SpaceGallery="SpaceGallery",e.StaffHub="StaffHub",e.StaffNotebook="StaffNotebook",e.Sway="Sway",e.Tasks="Tasks",e.Text="Text",e.ThirdPartyApp="ThirdPartyApp",e.ToDo="ToDo",e.UnknownApp="UnknownApp",e.Video="Video",e.VisioOnline="VisioOnline",e.WAC="WAC",e.Whiteboard="Whiteboard",e.WindowsStore="WindowsStore",e.WordOnline="WordOnline",e.Yammer="Yammer"}(n||(n={}))},e3cR:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"e",(function(){return o})),i.d(t,"c",(function(){return s})),i.d(t,"d",(function(){return l})),i.d(t,"a",(function(){return c}));var n=i("QjXU"),r=i("obr3");function a(e,t,i){return void 0===i&&(i=1),Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(n){return[2,Object(r.b)(e,i,t)]}))}))}function o(e,t,i,r,a){return Object(n.__awaiter)(this,void 0,void 0,(function(){var o,s;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return"replace"!==r?[3,2]:[4,e.clear(i)];case 1:n.sent(),n.label=2;case 2:return o=e.transaction(i,"readwrite"),s=t.map((function(e,t){return o.store.put(e,a[t])})),[4,Promise.all(s)];case 3:return n.sent(),[4,o.done];case 4:return n.sent(),[2]}}))}))}function s(e,t,i){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(n){return[2,e.get(t,i)]}))}))}function l(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(i){return[2,e.getAll(t)]}))}))}function c(e,t,i){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(n){return[2,e.delete(t,i)]}))}))}},ej7j:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},fGsv:function(e,t,i){"use strict";i.d(t,"a",(function(){return S}));var n=i("QjXU"),r=i("tyUq"),a=i("lrJm"),o=i("hhzZ"),s=i("R7NL"),l=i("4/We"),c=i("/I02"),u=i("kpuN"),d=i("dFxn"),h=i("Mlb/");class p{constructor(e){this.config=e.parse("adminPolicyConfig")}}p.ɵprov=h.kc({factory:function(){return new p(h.lc(d.a))},token:p,providedIn:"root"});var m=i("wwmn"),f=i("casz"),g=i("xoWf"),b=i("pOWU"),v=i("vk2e");class S extends b.a{constructor(e,t,i,n,r,a,o,s,l,c,u){super(r,s,o,"OfficeHome",a,l,u,c),this.globalErrorHandler=e,this.userDataStorageService=t,this.adminPolicyConfigService=i,this.capabilitiesService=n,this.fetchPolicyPromise=null,this.fetchCachedPolicyPromise=null}getAdminPolicy(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return(yield this.fetchCachedPolicy())||(this.fetchPolicyPromise||(this.fetchPolicyPromise=new Promise(((e,t)=>{const i=`${this.contextService.sharedContext.officeHomeApiRoot}/${this.adminPolicyConfigService.config.adminPolicyApiPath}`,n={responseType:"json",headers:new Map};this.get("Admin_Policy_Server_Request","Admin_Policy_Server",i,(i=>{i.instrument(((e,t)=>{e.ok||(this.fetchPolicyPromise=null)})).then((i=>{i.data&&i.data.Value||t("Null admin policies response."),e(i.data.Value)})).catch((e=>{this.fetchPolicyPromise=null,this.globalErrorHandler.handleError(e)}))}),t,n,"network-only")}))),this.fetchPolicyPromise)}))}fetchCachedPolicy(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const e={Action:"FetchCachedAdminPolicyFromUserStorage"};return this.fetchCachedPolicyPromise||(this.fetchCachedPolicyPromise=new Promise((t=>{let i,n;this.userDataStorageService.get(this.adminPolicyConfigService.config.cacheKey,this.capabilitiesService.capabilities.pwaEnabled?1:0).then((a=>{if(a&&a.Value){const r=new Date(a.LastUpdated).getTime()+60*a.CheckInInterval*1e3;r<Date.now()?(e.State="CacheExpired",e.DebugInfo=`Cache Expired, ExpireTime:${r}`,i=709,n="CacheExpired",t(null)):(e.State="CacheFound",i=200,n="CacheFound",t(a.Value))}else e.State="NotFound",e.DebugInfo="No cached policies found.",n="NotFound",i=709,t(null);this.instrumentationService.logDebugCacheEvent("Admin_Policy_Cache_Request",e),Object(r.a)({eventName:"Admin_Policy_Cache",httpCode:i,error:n,fromCache:200===i,latency:-1})})).catch((e=>{this.fetchCachedPolicyPromise=null,this.globalErrorHandler.handleError(e)}))}))),this.fetchCachedPolicyPromise}))}}S.ɵprov=h.kc({factory:function(){return new S(h.lc(a.b),h.lc(g.a),h.lc(p),h.lc(l.a),h.lc(u.a),h.lc(c.a),h.lc(s.a),h.lc(o.a),h.lc(m.a),h.lc(f.a),h.lc(v.q))},token:S,providedIn:"root"})},fKR7:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return h}));var n,r=i("aZf6"),a=i("hhzZ"),o=i("BaAg"),s=i("p6Zr"),l=i("cgnd"),c=i("lwM0"),u=i("pjz5"),d=i("L/Tc");!function(e){e[e.Recent=0]="Recent",e[e.Shared=1]="Shared",e[e.Trending=2]="Trending",e[e.Recommended=3]="Recommended",e[e.ClassNoteBook=4]="ClassNoteBook",e[e.News=5]="News",e[e.NoteBook=6]="NoteBook",e[e.Form=7]="Form",e[e.OfficeFeedDocument=8]="OfficeFeedDocument",e[e.EdgeworthDocument=9]="EdgeworthDocument",e[e.SharedForm=10]="SharedForm",e[e.StreamsVideo=11]="StreamsVideo",e[e.UpcomingMeeting=12]="UpcomingMeeting",e[e.MyAnalytics=13]="MyAnalytics"}(n||(n={}));class h extends o.a{constructor(e,t,i,a,h,p,m,f,g,b,v,S,y,C,w,I,T,k,A,_,P,E,F,O=!1,D=!1,M=null,R=null,x=null,L=null,U=null,N=null,W=!1,j=!1,H=null,B=null,G,q,V,$,z,Z,K,J,Q,Y,X,ee,te,ie,ne,re,ae,oe,se,le,ce,ue,de=!1,he,pe,me,fe,ge,be,ve,Se,ye,Ce,we,Ie,Te,ke,Ae,_e,Pe,Ee,Fe){if(super(t,i,a,h,p,m,f,g,b,v,S,y,C,I,T,k,O,M,R,W,V?V.AttachmentType:void 0,j,de),this.format=e,this.sharingType=w,this.fromCache=_,this.application=P,this.resourceId=E,this.storageHost=F,this.isPinned=D,this.mruV2Category=x,this.mruV2Type=L,this.mruV2Id=U,this.activity=N,this.isEmailAttachment=W,this.createdDate=H,this.sharepointIds=B,this.sharing=G,this.isNew=q,this.emailReference=V,this.sharedByUsername=$,this.sharedByEmail=z,this.sharedById=Z,this.thumbnailInfo=K,this.spoId=Q,this.isCollab=Y,this.navigationId=ee,this.thumbnails=te,this.feedbackId=ie,this.serverDocId=ne,this.createdBy=re,this.teamsDeepLink=ae,this.ownerType=oe,this.ownerId=se,this.ownerTenantId=le,this.isDeleted=ce,this.isHidden=ue,this.isSafeLink=de,this.streamsThumbnailUrl=he,this.startTime=pe,this.endTime=me,this.location=fe,this.locations=ge,this.attendees=be,this.joinUrl=ve,this.organizer=Se,this.joinMeetingText=ye,this.mediaDuration=Ce,this.subType=we,this.subTypeCategory=Ie,this.taskInsight=Te,this.potentialAction=ke,this.activityUser=Ae,this.insightName=_e,this.insightDescription=Pe,this.insightDescriptionPrefix=Ee,this.meetingArtifacts=Fe,this.mediaDurationRegex=new RegExp(/PT(\d+H)?(\d+M)?(\d*).*S?/),B||(this.sharepointIds={listId:null,listItemId:null,listItemUniqueId:null,siteId:null,siteUrl:null,webId:null}),this.documentUrl=f,e===n.Trending){const e=this.url.match(/file=([\S]+?)(&|$)/i);if(e&&e.length>=2){const t=e[1];this.canonicalUrl=`${c.a.encodeUrl(R)}/${t}`}else this.canonicalUrl=this.url;this.sharing={shared:!0}}else this.canonicalUrl=this.url||e===n.EdgeworthDocument&&this.webUrl,e===n.Shared&&(this.sharing={shared:!0});if(this.format===n.StreamsVideo&&this.mediaDuration){const e=this.mediaDurationRegex.exec(this.mediaDuration);if(e){let t=e[1],i=e[2],n=e[3];t&&t.length<3&&(t=`0${t}`),i&&i.length<3&&(i=`0${i}`),n&&n.length<2&&(n=`0${n}`),this.mediaDuration=`${t?t.substring(0,t.length-1)+":":""}${i?i.substring(0,i.length-1)+":":""}${n||""}`}}if(f){if(!this.sharepointIds.siteUrl){const e=f.match(/https?:\/\/.*?\.sharepoint(-df)?\.com\/.*?\/.*?\//);e&&e.length&&(this.sharepointIds.siteUrl=e[0])}this.isMsftDogfood=f.lastIndexOf("microsoft-my.sharepoint-df.com")>-1||f.lastIndexOf("microsoft.sharepoint-df.com")>-1}if(o.a.referralFromFileLocation(this.url)===s.a.SharePoint&&(this.sharing={shared:!0}),this.lastModifiedBy&&this.lastModifiedBy.fullName&&this.lastModifiedBy.email&&this.lastModifiedTime&&(this.lastModifiedActivity=[{action:{type:d.a.Edit,data:{}},actor:{user:{displayName:this.lastModifiedBy.fullName,email:this.lastModifiedBy.email,userPrincipalName:this.lastModifiedBy.email},id:null},timestamp:this.lastModifiedTime}]),this._initialInflationCompleted=new r.a,this.initialInflationCompleted=this._initialInflationCompleted.asObservable(),"string"==typeof J&&(this.attribution=J),A===l.a.MSA)this.isOnPremOrVanity=!1;else if(X&&X.lastIndexOf("ONPREM")>=0)this.isOnPremOrVanity=!0;else if(X&&X.lastIndexOf("O365")>=0||this.fileType===o.b.Sway||this.fileType===o.b.Forms)this.isOnPremOrVanity=!1;else{const e=u.a.getHostName(this.url);this.isOnPremOrVanity=!(!e||-1!==e.lastIndexOf("sharepoint.com")||this.isMsftDogfood)}}getFormEnumType(){if(this.subType)if("form"===this.subType.toLowerCase()&&this.subTypeCategory)switch(this.subTypeCategory.toLowerCase()){case"poll":case"teams poll":case"pptpoll":case"wordpoll":return"poll";case"assignments":return"assignments"}else if("poll"===this.subType.toLowerCase())return"poll";return"form"}getClickData(e,t,i){const r=super.getClickData(e,t,i,this.format===n.EdgeworthDocument);return r&&r.params&&(r.params.Area="Suggested_Action_Click"===e?a.b.SuggestedActions:"Recommended_Click"===e?a.b.Recommended:a.b.Documents,"boolean"==typeof this.isPinned&&(r.params.Pinned=this.isPinned.toString()),"boolean"==typeof this.isNew&&(r.params.ItemIsNew=this.isNew.toString()),this.sharing&&"boolean"==typeof this.sharing.shared&&(r.params.ItemIsShared=this.sharing.shared.toString())),r}getClickDataForPath(e,t,i){const n=super.getClickDataForPath(e,t,i);return n&&n.params&&(n.params.Area=a.b.Documents),n}copyInflationData(e,t=!1){e.activities&&!t&&(this.activities=e.activities.slice()),e.driveId&&(this.driveId=e.driveId),void 0===e.isNew||t||(this.isNew=e.isNew),e.sharepointIds.siteUrl&&(this.sharepointIds.siteUrl=e.sharepointIds.siteUrl),e.sharing&&!t&&(this.sharing=Object.assign({},e.sharing)),e.thumbnails&&(this.thumbnails=Object.assign({},e.thumbnails)),e.wopiData&&(this.wopiData=Object.assign({},e.wopiData))}inflationCompleted(){this._initialInflationCompleted.next(!0),this._initialInflationCompleted.complete()}shouldAddLoginHint(){return!this.isLocal&&!this.isOnPremOrVanity&&("OneDriveForBusiness"===this.source||"SharePoint"===this.source||"EmailAttachment"===this.source||this.fileType!==o.b.Sway&&this.fileType!==o.b.Forms&&this.fileType!==o.b.PowerBI)}}},"fVt+":function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("70cc"),r=i("WKA6"),a=i("dFxn"),o=i("7Gwk"),s=i("uWZl"),l=i("4/We"),c=i("cgnd"),u=i("Mlb/");class d{constructor(e,t,i,n){this.capabilitiesService=e,this.configParserService=t,this.startupConfigService=i,this.eventService=n}getConfig(){if(!this.configPromise){if(this.startupConfigService.config.authType!==c.a.MSA)return Promise.reject();if(this.capabilitiesService.capabilities.isPwaInUwp)this.configPromise=Promise.resolve(this.configParserService.parse("consumerUserConsent"));else{const e=this.eventService.events.withScope(0).pipe(Object(n.a)((e=>"primaryTokensLoaded"===e.name)),Object(r.a)(1)).toPromise(),t=s.a.fullPageReady();this.configPromise=Promise.race([e,t]).then((()=>this.configParserService.parse("consumerUserConsent")))}}return this.configPromise}}d.ɵprov=u.kc({factory:function(){return new d(u.lc(l.a),u.lc(a.a),u.lc(c.b),u.lc(o.a))},token:d,providedIn:"root"})},fpaX:function(e,t,i){"use strict";i.d(t,"b",(function(){return S})),i.d(t,"a",(function(){return C}));var n=i("31lE"),r=i("Uqr9"),a=i("re3B"),o=i("4/We"),s=i("cgnd"),l=i("JH4S"),c=i("Dn7E"),u=i("lrJm"),d=i("/I02"),h=i("uUrA"),p=i("Mlb/"),m=i("C0xW");class f{constructor(e,t,i){this.contextService=e,this.unloadEventService=t,this.eventManager=i,this.currentSessionIndex=0,this.currentSessionId=null,this.currentSessionStartTime=0,this.currentSessionClickCount=0,this.inactivityStartTime=0,this.inactivityTrackerStartTime=0,this.cumulativeDurationOfActivitySessions=0,this.cumulativeDurationBetweenActivitySessions=0,this.cumulativeClickCount=0}initialize(e){if(!this.contextService.sharedContext.activityTrackingEnabled)return;this.instrumentationService=e;const t=()=>{this.startSession(),this.trackInactivity()};t(),this.mousedownListener=this.eventManager.addGlobalEventListener("document","mousedown",t),this.mousemoveListener=this.eventManager.addGlobalEventListener("document","mousemove",t),this.keypressListener=this.eventManager.addGlobalEventListener("document","keypress",t),this.unloadEventService.addUnloadEvent((()=>{this.mousedownListener&&this.mousedownListener(),this.mousemoveListener&&this.mousemoveListener(),this.keypressListener&&this.keypressListener(),clearTimeout(this.inactivityTrackerTimeout),this.endSession(this.inactivityTrackerStartTime?r.a.now()-this.inactivityTrackerStartTime:0)}))}startSession(){if(!this.contextService.sharedContext.activityTrackingEnabled)return null;if(this.currentSessionId)return this.currentSessionId;this.currentSessionStartTime=r.a.now(),this.currentSessionId=h.a.createGuid(),this.currentSessionIndex++,this.currentSessionClickCount=0;const e={};if(e.ActivitySessionId=this.currentSessionId,e.Index=this.currentSessionIndex.toString(),this.currentSessionIndex>1){if(this.inactivityStartTime<=0)throw new u.a("Logical error in ActivitySessionService: inactivityStartTime must be set to valid value when startSession() is called");const t=this.currentSessionStartTime-this.inactivityStartTime;this.cumulativeDurationBetweenActivitySessions+=t,e.Latency=Math.ceil(t).toString()}return this.instrumentationService.logGenericEvent("Activity_Session_Started",e),Object(c.a)({featureName:"ActivitySession",eventName:"Activity_Session_Started",params:e}),this.currentSessionId}endSession(e=0){if(!this.contextService.sharedContext.activityTrackingEnabled)return null;if(!this.currentSessionId)return this.getCurrentStats();this.inactivityStartTime=r.a.now()-e;const t={};t.ActivitySessionId=this.currentSessionId,t.Index=this.currentSessionIndex.toString(),t.ClickCount=this.currentSessionClickCount.toString();const i=this.inactivityStartTime-this.currentSessionStartTime;return this.cumulativeDurationOfActivitySessions+=i,t.Latency=Math.ceil(i).toString(),this.instrumentationService.logGenericEvent("Activity_Session_Finished",t),Object(c.a)({featureName:"ActivitySession",eventName:"Activity_Session_Finished",params:t}),this.currentSessionId=null,this.getCurrentStats()}incrementClick(){this.startSession(),this.currentSessionClickCount++,this.cumulativeClickCount++}getCurrentStats(){return{activitySessionsCount:this.currentSessionIndex,cumulativeClickCount:this.cumulativeClickCount,cumulativeDurationOfActivitySessions:this.cumulativeDurationOfActivitySessions,cumulativeDurationBetweenActivitySessions:this.cumulativeDurationBetweenActivitySessions,inactivityStartTime:this.inactivityStartTime}}trackInactivity(){clearTimeout(this.inactivityTrackerTimeout),this.inactivityTrackerStartTime=r.a.now(),this.inactivityTrackerTimeout=setTimeout((()=>this.endSession(r.a.now()-this.inactivityTrackerStartTime)),1e3*this.contextService.sharedContext.inactivityTimeoutInSeconds)}}f.ɵprov=p.kc({factory:function(){return new f(p.lc(d.a),p.lc(a.a),p.lc(m.d))},token:f,providedIn:"root"});var g=i("hhzZ"),b=i("Vwd8"),v=i("OtXi");class S{constructor(e,t,i,n,r,a,o){this.clientStartupConfigService=t,this.activitySessionService=n,this.sessionActive=!1,this.ariaLogger=S.createAriaLogger(t.config,i,r,o,e),this.ariaLogger&&(this.sessionActive=!0,a.addUnloadEvent((()=>{this.endAppSession(!e.capabilities.pwaEnabled)}),!0))}static createAriaLogger(e,t,i,r,a){if(!e.sharedClientStartupContext.ariaTenant||!e.sharedClientStartupContext.ariaCollectorUrl)return null;const o=S.initializeAriaLogManager(e.sharedClientStartupContext.ariaTenant,e.sharedClientStartupContext.ariaCollectorUrl);let l=e.puid,c=n.AWTUserIdType.Unknown;if(l?e.authType===s.a.OrgId?c=n.AWTUserIdType.OrgIdPUID:e.authType===s.a.MSA&&(c=n.AWTUserIdType.MSAPUID):l=S.unknownUserId,o.getSemanticContext().setUserId(l,n.AWTPiiKind.NotSet,c),o.setContext("UserInfo.OMSTenantId",e.tenantId),o.setContext("AuthType",e.authTypeString),o.setContext("AuthVer",e.authVersion),o.setContext("CorpNet",e.sharedClientStartupContext.corpNet),o.setContext("CorrelationId",e.sharedClientStartupContext.correlationId),o.setContext("DevEnvironment",e.sharedClientStartupContext.devEnvironment),o.setContext("DeploymentEnvironment",e.sharedClientStartupContext.deploymentEnvironment),o.setContext("Geo",e.sharedClientStartupContext.geoName),o.setContext("RequestOrigin",e.sharedClientStartupContext.requestOrigin),o.setContext("SessionId",e.sharedClientStartupContext.sessionId),o.setContext("TestTraffic",e.sharedClientStartupContext.testTraffic),o.setContext("Workload",a.getWorkload()),o.setContext("ServerBuildDate",e.sharedClientStartupContext.buildDateUtc),o.setContext("ServerBuildId",e.sharedClientStartupContext.buildId),o.setContext("BundleBuildDate","2023-01-30 10:03:43.956"),o.setContext("BundleBuildId","0ded6a5a-54e3-1d68-dd1e-8c8254010961"),o.setContext("EcsRing",e.sharedClientStartupContext.ecsRing),o.setContext("DomainOrigin",e.sharedClientStartupContext.domainOrigin),o.setContext("Flights",e.sharedClientStartupContext.flights+(e.sharedClientStartupContext.flights&&e.features?",":"")+e.features),t&&(o.setContext("Admin",t.user.isAdmin),o.setContext("IsSmb",t.user.isSmb),o.setContext("IsIw",t.user.isIw),o.setContext("IsEdu",t.user.isEdu),o.setContext("IsEduStudent",t.user.isEduStudent),o.setContext("IsEduFaculty",t.user.isEduFaculty),o.setContext("IsDynamics",t.user.isDynamics),o.setContext("ThemeId",t.user.themeId),o.setContext("IsFirstRelease",t.user.isFirstRelease)),i&&(o.setContext("FirstVisit",i.isFirstVisit()),o.setContext("FirstVisitAgeInDays",i.fullDaysSinceFirstVisit())),r){let e;if(o.setContext("WrapperVersion",`${r.major}.${r.minor}.${r.build}.${r.revision}`),a.capabilities.isPwaInWebView2)e="WebView2";else if(a.capabilities.isPwaInUwp){const t=new RegExp("1[0-9]{2}10");e=(null==r?void 0:r.build)&&t.test(r.build.toString())?"UWP_fallback":"UWP"}e&&o.setContext("AppWorkloadType",e)}return S.startSession(o),o}static endSession(e,t,i){window.disableLogs||(i=i||new n.AWTEventProperties,S.populateSessionProperties(i),e.logSession(n.AWTSessionState.Ended,i)),t?n.AWTLogManager.flushAndTeardown():n.AWTLogManager.flush(null)}trackEvent(e,t){if(!this.ariaLogger)return;this.sessionActive||(S.startSession(this.ariaLogger),this.sessionActive=!0);const i=this.clientStartupConfigService.config,r=new n.AWTEventProperties;r.setName(e);for(const e in t)if(t.hasOwnProperty(e)){const n=t[e];n instanceof g.d?i.logPiiAllowed&&(i.logPiiInClearText?r.setProperty(e,n.value):r.setPropertyWithPii(e,n.value,n.kind)):r.setProperty(e,n)}this.ariaLogger.logEvent(r)}endAppSession(e){if(!this.ariaLogger||!this.sessionActive)return;const t=new n.AWTEventProperties,i=this.activitySessionService.endSession();if(i){const e=r.a.now()-i.inactivityStartTime;t.setProperty("ActivityDuration",Math.ceil(i.cumulativeDurationOfActivitySessions/1e3).toString()),t.setProperty("InactivityDuration",Math.ceil((i.cumulativeDurationBetweenActivitySessions+e)/1e3).toString()),t.setProperty("ItemCount",i.activitySessionsCount.toString()),t.setProperty("ClickCount",i.cumulativeClickCount.toString())}S.endSession(this.ariaLogger,e,t),this.sessionActive=!1}static startSession(e){if(window.disableLogs)return;const t=new n.AWTEventProperties;S.populateSessionProperties(t),e.logSession(n.AWTSessionState.Started,t)}static populateSessionProperties(e){e.setProperty("LoggerId","Angular"),window.prelaunchMode&&e.setProperty("PrelaunchMode","true")}static initializeAriaLogManager(e,t){const i={collectorUri:t,enableAutoUserSession:!1,propertyStorageOverride:{setProperty:(e,t)=>S.setProperty(e,t),getProperty:e=>S.getProperty(e)},disableCookiesUsage:!0};return document&&document.cookie&&S.legacyAriaCookies.forEach((e=>{document.cookie=e+S.removeCookieString})),n.AWTLogManager.initialize(e,i)}static setProperty(e,t){S.propertyMap.set(e,t)}static getProperty(e){return S.propertyMap.has(e)?this.propertyMap.get(e):""}}S.unknownUserId="Unknown",S.legacyAriaCookies=["MicrosoftApplicationsTelemetryDeviceId","MicrosoftApplicationsTelemetryFirstLaunchTime"],S.removeCookieString="=;expires=Thu, 01 Jan 1970 00:00:01 GMT;",S.propertyMap=new Map,S.ɵprov=p.kc({factory:function(){return new S(p.lc(o.a),p.lc(s.b),p.lc(l.a),p.lc(f),p.lc(b.b),p.lc(a.a),p.lc(v.a,8))},token:S,providedIn:"root"});class y{constructor(e,t,i,n){this.ariaService=e,this.streamName=t,this.params=i,this.metrics=n}record(){const e={};for(const t in this.params)e[t]=this.params[t];this.ariaService.trackEvent(this.streamName,e)}}class C{constructor(e){this.ariaService=e}createEvent(e,t,i){return new y(this.ariaService,e,t,i)}flush(){this.ariaService.endAppSession(!0)}}C.ɵprov=p.kc({factory:function(){return new C(p.lc(S))},token:C,providedIn:"root"})},"g/dT":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("kxm0"),r=i("W3Zz");i("hhzZ");class a{constructor(e,t){this.deviceDetector=e,this.instrumentationService=t}ngOnInit(){const e={};e.DevicePlatform=r.d[this.deviceDetector.getDeviceInfo().platform.platformType],this.instrumentationService.logGenericEvent(this.pageName,e,[this.pageName]);let t=!0;window.prelaunchMode&&(t=!1),Object(n.d)({isIntentional:t,eventName:this.pageName})}}},g0MB:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i("w1PR");class n{constructor(e,t,i){this.elementReference=e,this.renderer=t,this.themingService=i,this.toolTipSpan=null}ngAfterViewInit(){this.elementReference.nativeElement.onfocus=()=>{this.elementReference.nativeElement.title&&this.onEvent()},this.elementReference.nativeElement.onblur=()=>{this.toolTipSpan&&this.renderer.removeChild(this.elementReference.nativeElement,this.toolTipSpan),this.toolTipDelayTimeout&&(clearTimeout(this.toolTipDelayTimeout),this.toolTipDelayTimeout=null)}}onEvent(){this.toolTipDelay().then((()=>{this.toolTipSpan=document.createElement("span"),this.toolTipSpan.classList.add("ohp-keyboardfocus-tooltip"),this.toolTipSpan.classList.add("ohpAppTheme"),this.toolTipSpan.classList.add("ms-fcl-nd"),this.toolTipSpan.classList.add("ms-bgc-w"),this.toolTipSpan.innerText=this.elementReference.nativeElement.title,this.renderer.appendChild(this.elementReference.nativeElement,this.toolTipSpan)}))}toolTipDelay(){return new Promise((e=>{this.toolTipDelayTimeout=setTimeout((()=>{e()}),1e3)}))}}},gB6C:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var n,r=i("8wW2"),a=i("AGMK"),o=i("z0B0"),s=i("iPRk"),l=new(i("oX8g").a)([],(function(e,t){return function(e,t){return e.priority<t.priority?-1:e.priority>t.priority?1:0}(e,t)})),c=i("Zmq1"),u=i("VKX6"),d="Safari"===Object(c.a)().browser.browserType,h=d?function(e,t){return setTimeout((function(){var t=Object(u.a)();e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Object(u.a)()-t))}})}))}:requestIdleCallback,p=d?function(e){clearTimeout(e)}:cancelIdleCallback,m=i("pdjy"),f=!1,g=Object(a.a)(),b=!0;function v(e){for(;f||e&&e.timeRemaining()>0;){var t=l.pop();if(!t)break;if(!t.cancelled)try{t.work(e),t.completed=!0}catch(e){Object(r.a)().handleError(e,"DXUlK")}}l.peek()&&S()}function S(){f&&v(),n||(n=h((function(e){g&&(g=!1,Object(s.a)("First_Idle_React")),n=null,v(e)})))}function y(e,t){if(t===m.e)return e(),{cancel:function(){return null},cancelAndRunNow:function(){return null},adjustPriority:function(){return null}};b&&(b=!1,Object(s.a)("First_Schedule_React"));var i={work:e,priority:t,cancelled:!1,completed:!1},n=function(e){var t=function(){return e.cancelled=!0};return{cancel:t,cancelAndRunNow:function(){e.cancelled||(t(),e.completed||(e.work(),e.completed=!0))},adjustPriority:function(i){return t(),e.completed?{cancel:function(){return null},cancelAndRunNow:function(){return null},adjustPriority:function(){return null}}:y(e.work,i)}}}(i);return l.push(i),S(),n}Object(o.a)((function(e){(f="visible"!==e)&&(g=!1,n&&(p(n),n=null),v())}))},"gO/A":function(e,t,i){"use strict";i.d(t,"a",(function(){return S}));var n=i("CMIS"),r=i("qpkC"),a=i("hUdb"),o=i("GAcG"),s=i("HbWZ"),l=i("59BC"),c=i("O6Zd"),u=i("4/We"),d=i("cgnd"),h=i("dFxn"),p=i("uzn7"),m=i("Xn3c"),f=i("Z0U4"),g=i("w1PR"),b=i("Mlb/");const v="HarmonyTheme";class S{constructor(e,t,a,u,h,p,m){if(this.capabilitiesService=e,this.clientStartupService=t,this.configParserService=a,this.localStorageService=u,this.routeService=h,this.themingService=p,this.userDataStorageService=m,e.capabilities.visualEnabled){try{this.visualModuleObservable=Object(s.a)(Promise.all([i.e(0),i.e(5),i.e(36),i.e(220),i.e(262)]).then(i.bind(null,"VfNa")))}catch(e){Object(n.a)({eventName:"VisualServiceOfficeStartChunkLoadError"})}this.visualConfigSubscription=Object(l.b)(this.visualModuleObservable,this.themingService.themeShades,this.themingService.darkModeSubscription,this.routeService.getRouteChangeEndObservable()).pipe(Object(c.a)((([e,t,i,n])=>{var a;const o=((null===(a=t.theme.themeId)||void 0===a?void 0:a.toLowerCase())===g.b.baseThemeId||t.theme.themeId===g.b.staticDarkTheme)&&t.theme.reactShellTheme.PreferOfficeTheme||t.theme.themeId===g.b.baseWithOfficeThemePreferredThemeId?g.b.officeThemeId:t.theme.themeId,s=null==e?void 0:e.isVisualBackgroundEnabled(this.clientStartupService.config.authType===d.a.MSA,window.matchMedia("(-ms-high-contrast: active)").matches||window.matchMedia("(forced-colors: active)").matches,null==e?void 0:e.getRouteFlight(n.currentRoute.route),o,i?r.a.dark:r.a.default,this.getVisualGates());return!this.harmonyThemeSubscription&&e&&this.capabilitiesService.capabilities.visualSettingEnabled&&(this.harmonyThemeSubscription=e.harmonyThemeObservable.subscribe((e=>{this.updateTheme(e)}))),{visualBackgroundEnabled:s,visualInitialized:void 0!==e,visualOfficeWrapperStyle:this.getVisualOfficeWrapperStyle(n.currentRoute.route)}}))),this.initializeHarmonyTheme()}else this.visualConfigSubscription=o.a.create()}ngOnDestroy(){var e;null===(e=this.harmonyThemeSubscription)||void 0===e||e.unsubscribe()}getVisualGates(){return{visualAppsModuleEnabled:this.capabilitiesService.capabilities.visualAppsModuleEnabled,visualBackgroundEnabled:this.capabilitiesService.capabilities.visualBackgroundEnabled,visualCreateCenterModuleEnabled:this.capabilitiesService.capabilities.visualCreateCenterModuleEnabled,visualEnabled:this.capabilitiesService.capabilities.visualEnabled,visualFeedModuleEnabled:this.capabilitiesService.capabilities.visualFeedModuleEnabled,visualMyContentModuleEnabled:this.capabilitiesService.capabilities.visualMyContentModuleEnabled,visualSettingEnabled:this.capabilitiesService.capabilities.visualSettingEnabled}}getVisualOfficeWrapperStyle(e){return"OfficeHome"===e||"Pwa"===e||"Create"===e?{position:"relative"}:{}}initializeHarmonyTheme(){this.capabilitiesService.capabilities.visualSettingEnabled&&(this.capabilitiesService.capabilities.pwaEnabled||(this.capabilitiesService.capabilities.pwaEnabled&&this.capabilitiesService.capabilities.isConsumerUser?this.initializeHarmonyThemeLocalStorage():this.initializeHarmonyThemeUserStorage()))}initializeHarmonyThemeUserStorage(){this.userDataStorageService.get(v,1).then((e=>{this.updateTheme(e)})).catch((e=>{}))}initializeHarmonyThemeLocalStorage(){const e=this.localStorageService.get(v);this.updateTheme(e)}updateTheme(e){(null==e?void 0:e.preferHarmonyTheme)&&(this.initializeUserPersonalizationSetting(),this.themingService.updateVisualsTheme(e.id,e.mode===a.b.Dark,this.userPersonalizationAllowed))}initializeUserPersonalizationSetting(){if(void 0===this.userPersonalizationAllowed)if(this.clientStartupService.config.authType!==d.a.MSA){try{const e=this.configParserService.parse(this.capabilitiesService.capabilities.pwaEnabled?"navBarData":"navbarData");if(null==e?void 0:e.ClientData){const{UserPersonalizationAllowed:t}=JSON.parse(e.ClientData);return void(this.userPersonalizationAllowed=null!=t&&t)}}catch(e){}this.userPersonalizationAllowed=!1}else this.userPersonalizationAllowed=!0}}S.ɵprov=b.kc({factory:function(){return new S(b.lc(u.a),b.lc(d.b),b.lc(h.a),b.lc(p.a),b.lc(f.a),b.lc(g.b),b.lc(m.a))},token:S,providedIn:"root"})},gktR:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var n=i("Dn7E"),r=i("laSs"),a=i("lrJm"),o=i("R7NL"),s=i("3GGT"),l=i("hhzZ"),c=i("kpuN"),u=i("uzn7"),d=i("wwmn"),h=i("casz"),p=i("xoWf"),m=i("pOWU"),f=i("/I02"),g=i("Mlb/"),b=i("vk2e");class v extends m.a{constructor(e,t,i,n,r,a,o,s,l,c){super(e,i,t,"OfficeHome",n,r,a,o),this.localStorageService=s,this.userDataStorageService=l,this.globalErrorHandler=c,this.requestConfig={headers:new Map([["Accept","application/json"]])},this.alreadyCompleted=!1}fetchFirstRunData(e,t=!1,i){return new Promise((n=>{const r=`_${i}`,a=this.localStorageService.get(r)||this.createInitialFirstRunData(e);if(t)return void n(a);let o=!1;a.CompletedFirstRun&&(o=!0,n(a)),this.userDataStorageService.get(i,v.LoadFromUserStorageRemoteAttempts).then((e=>{e&&e.CompletedFirstRun?a.CompletedFirstRun||(o=!0,n(e),this.localStorageService.set(r,e)):a.CompletedFirstRun&&this.storeFirstRunDataInUserStorage(a,i)})).catch((e=>{this.globalErrorHandler.handleError(e,"oZtOo"),a.CompletedFirstRun&&this.storeFirstRunDataInUserStorage(a,i)})).then((()=>{o||(o=!0,n(a))}))}))}updateFirstRunData(e,t,i,n=!0){this.fetchFirstRunData(e.Version,!1,t).then((r=>{const a=`_${t}`,o=e.CompletedFirstRun;(r.CompletedFirstRun||e.StepsCompleted>=e.TotalSteps)&&(e.CompletedFirstRun=!0),e.FurthestCompleted=r.FurthestCompleted,(void 0===r.FurthestCompleted||e.StepsCompleted>r.FurthestCompleted)&&(e.FurthestCompleted=e.StepsCompleted),this.localStorageService.set(a,e),this.storeFirstRunDataInUserStorage(e,t),n&&this.instrumentFirstRunData(e,i,o)}))}forceRefreshAndGetLicenseStatus(){return new Promise(((e,t)=>{this.get("Office_Consumer_License_Fetch","Office_Consumer_License_Fetch",this.contextService.sharedContext.officeHomeApiRoot+v.ConsumerLicenseStatusEndpoint+"?"+v.ConsumerLicenseStatusForceRefreshQuery,(t=>{t.instrument(((e,t)=>{t.HttpCode=e.ok?s.a.OK.toString():s.a.UnexpectedResponse.toString()})).then((t=>{e(t.data)}))}),(e=>{this.globalErrorHandler.handleError(e,"wCBHa"),t(e)}),this.requestConfig,"network-only")}))}isRetriableError(e){return e===s.a.Throttled}createInitialFirstRunData(e){return{CompletedFirstRun:!1,StepsCompleted:0,Version:e}}storeFirstRunDataInUserStorage(e,t){this.userDataStorageService.set(t,e)}instrumentFirstRunData(e,t,i){const a={};a.FirstRunStepsCompleted=e.StepsCompleted.toString(),a.FirstRunTotalSteps=e.TotalSteps?e.TotalSteps.toString():"0",a.FirstRunVersion=e.Version.toString(),a.FirstRunFurthestCompleted=e.FurthestCompleted.toString(),a.FirstRunUserDismissedCallout=i.toString(),e.CompletedFirstRun&&!this.alreadyCompleted&&(this.instrumentationService.logGenericEvent("First_Run_Completed",a),Object(n.a)({featureName:"FirstRun",eventName:"First_Run_Completed",params:a}),this.alreadyCompleted=!0),e.CompletedFirstRun&&void 0===t||(a.ItemCategory=t,this.instrumentationService.logImpressionEvent("First_Run_Impression",a),Object(r.a)({eventName:"First_Run_Impression",area:t}))}}v.firstRunDataKey="FirstRunData",v.LoadFromUserStorageRemoteAttempts=2,v.ConsumerLicenseStatusEndpoint="/api/license/consumer",v.ConsumerLicenseStatusForceRefreshQuery="forceRefresh=true",v.ɵprov=g.kc({factory:function(){return new v(g.lc(c.a),g.lc(o.a),g.lc(l.a),g.lc(f.a),g.lc(d.a),g.lc(b.q),g.lc(h.a),g.lc(u.a),g.lc(p.a),g.lc(a.b))},token:v,providedIn:"root"})},hUdb:function(e,t,i){"use strict";var n,r;i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r})),function(e){e.Contrast="contrast",e.Dark="dark",e.Light="light",e.System="system"}(n||(n={})),function(e){e.Office="Office"}(r||(r={}))},hZW2:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("Mlb/"),r=i("dFxn");class a{constructor(e){this.configParserService=e}getConfig(){return this.config||(this.config=this.configParserService.parse("documentConfig")),this.config||{mockUploadFile:null}}}a.ɵprov=n.kc({factory:function(){return new a(n.lc(r.a))},token:a,providedIn:"root"});class o{constructor(e){this.documentConfigService=e}addScriptToPage(e,t,i,n=!1,r,a=!1){const o=this.getDocument();if(!o)return;if(this.findScript(r))return void(t&&t());const s=o.createElement("script");if(s.src=e,s.id=r,t&&(s.onload=t),i&&(s.onerror=i),n){const e=o.getElementsByTagName("script")[0];if(e&&e.parentNode)return void e.parentNode.insertBefore(s,e)}a&&(s.crossOrigin="anonymous"),o.body.appendChild(s)}addIframeToPage(e,t){if(!e&&!t)return;const i=this.getDocument();if(!i||t&&i.getElementById(t)||i.querySelector(`iframe[src="${e}"]`))return;const n=i.createElement("iframe");e&&n.setAttribute("src",e),t&&(n.id=t),n.style.display="none",i.body.appendChild(n)}selectFile(e){this.selectFilePromiseRejector&&this.selectFilePromiseRejector();const t=this.getDocument();this.fileInputElement&&t.body.removeChild(this.fileInputElement);const i=this.documentConfigService.getConfig().mockUploadFile;if(i){const e=this.createMockFileList(i.name,i.size);return Promise.resolve(e)}return this.fileInputElement=t.createElement("input"),this.fileInputElement.type="file",this.fileInputElement.id=o.fileInputId,this.fileInputElement.accept=e.join(","),t.body.appendChild(this.fileInputElement),new Promise(((e,i)=>{this.selectFilePromiseRejector=i;const n=r=>{const a=r.target.files;a&&a.length?e(a):i(),this.selectFilePromiseRejector=null,this.fileInputElement&&(this.fileInputElement.removeEventListener("change",n),t.body.removeChild(this.fileInputElement),this.fileInputElement=null)};this.fileInputElement.addEventListener("change",n),this.fileInputElement.click()}))}updateFavicon(e){this.addOrUpdateLink(e,"shortcut icon","image/x-icon",'link[rel="shortcut icon"]')}addOrUpdateStylesheet(e,t){this.addOrUpdateLink(e,"stylesheet","text/css",`#${t}`,t)}addCssClassToElement(e,t){e&&e.classList.add(t)}removeCssClassFromElement(e,t){e&&e.classList.remove(t)}addOrUpdateStyleTag(e,t){const i=this.getDocument();if(!i)return;let n=i.getElementById(e);n&&n.parentNode&&n.parentNode.removeChild(n),n=i.createElement("style"),n.id=e,n.type="text/css",n.styleSheet?n.styleSheet.cssText=t:n.appendChild(i.createTextNode(t)),i.head.appendChild(n)}addLinkTag(e){const t=this.getDocument();if(!t)return;const i=t.createElement("link");e.forEach(((e,t)=>i.setAttribute(t,e))),t.head.appendChild(i)}appendHTMLToElement(e,t){e&&t&&e.insertAdjacentHTML("beforeend",t)}getOffset(e){const t=(e instanceof n.o?e.nativeElement:e).getBoundingClientRect();return{top:t.top+this.nativeDocument.body.scrollTop,left:t.left+this.nativeDocument.body.scrollLeft}}disableTouchMove(){this.getDocument().addEventListener("touchmove",this.preventDefault,{passive:!1})}enableTouchMove(){this.getDocument().removeEventListener("touchmove",this.preventDefault)}updateThemeColor(e){const t=this.getDocument();if(!t)return;const i=t.querySelector('meta[name="theme-color"]');if(i)return void(i.content!==e&&(i.content=e));const n=t.createElement("meta");n.name="theme-color",n.content=e,t.head.appendChild(n)}preventDefault(e){e.preventDefault()}get nativeDocument(){return this.getDocument()}getDocument(){return document}findScript(e){if(!e)return!1;const t=this.getDocument();return!!t&&!!t.getElementById(e)}addOrUpdateLink(e,t,i,n,r){if(!e)return;const a=this.getDocument();if(!a)return;let o=a.querySelector(n);o?o.href!==e&&(o.href=e):(o=a.createElement("link"),o.rel=t,o.type=i,o.href=e,r&&(o.id=r),a.head.appendChild(o))}createMockFileList(e,t){const i=new Blob([new Uint8Array(t)],{type:""});return i.name=e,[i]}}o.fileInputId="select-file",o.ɵprov=n.kc({factory:function(){return new o(n.lc(a))},token:o,providedIn:"root"})},hhzZ:function(e,t,i){"use strict";i.d(t,"c",(function(){return r})),i.d(t,"b",(function(){return a})),i.d(t,"d",(function(){return o})),i.d(t,"a",(function(){return s}));var n=i("31lE");class r{}r.FirsttimeReferral="First time",r.ResurrectedReferral="Resurrected",r.RepeatReferral="Repeat",r.NotDetected="NotDetected";class a{}a.AllMyDocuments="AllMyDocuments",a.AppCategory="AppCategory",a.AppGalleryHero="AppGalleryHero",a.AppList="AppList",a.AppTiles="AppTiles",a.BackstageMru="BackstageMru",a.Banner="Banner",a.Calendar="Calendar",a.CreateCenter="CreateCenter",a.CreateFlyOut="CreateFlyOut",a.CreateGallery="CreateGallery",a.CreateModal="CreateModal",a.CreateOnHome="CreateOnHome",a.Documents="Documents",a.DocumentTitleComponent="DocumentTitleComponent",a.Edgeworth="Edgeworth",a.EnterpriseTemplates="EnterpriseTemplates",a.ErrorDialog="ErrorDialog",a.FeaturedDocs="FeaturedDocs",a.Feedback="Feedback",a.FirstRun="FirstRun",a.FluidContent="FluidContent",a.Folders="Folders",a.FormsGroups="FormsGroups",a.Hero="Hero",a.InputDialog="InputDialog",a.InstallWizard="InstallWizard",a.LeftNav="LeftNav",a.LeftNavCallout="LeftNavCallout",a.MobileAppBanner="MobileAppBanner",a.NewConsumerExperience="NewConsumerExperience",a.PeopleCard="PeopleCard",a.PwaDialog="PwaDialog",a.Recommended="Recommended",a.SearchResults="SearchResults",a.SearchSuggestions="SearchSuggestions",a.Shell="Shell",a.SideMenu="SideMenu",a.Sites="Sites",a.SuggestedActions="SuggestedActions",a.Templates="Templates",a.UploadDialog="UploadDialog",a.Upsell="Upsell";class o{constructor(e,t=n.AWTPiiKind.GenericData){this.value=e,this.kind=t}}class s{static filterPii(e){return e?(e.replace(/\n/g,"").replace(/\r/g,"").replace(/\t/g,"").replace(/\b/g,""),e.replace(this.emailRegex,"email_removed").replace(this.localFileRegex,"file_removed").replace(this.searchQueryRegex,"$1query_removed")):e}}s.emailRegex=new RegExp("[a-zA-Z0-9_\\-\\.]+(@|%40|%2540)[a-zA-Z0-9_\\-\\.]+\\.[a-zA-Z]{2,63}","gm"),s.localFileRegex=new RegExp("file(:|%3A|%253A).*","gim"),s.searchQueryRegex=new RegExp("([&?]q=)(.+?)(?=[&].*| |, |$)","gmi")},hoyd:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},iPRk:function(e,t,i){"use strict";i.d(t,"a",(function(){return g})),i.d(t,"b",(function(){return b}));var n,r=i("8/lW"),a=i("AGMK"),o=i("z0B0"),s=i("Ihso"),l=i("cenr"),c=i("a3FV"),u=i("CMIS"),d=i("1rn/"),h=i("pM41"),p=i("VV8N"),m=new Set,f=!1;function g(e,t,i,n){if(void 0===t&&(t=2),void 0===i&&(i=r.a.Security),function(){var e=window.performance;return!!(e&&e.now&&e.mark&&e.timing&&e.timing.navigationStart&&e.measure&&e.getEntriesByType)}()){var a=e,o=Object(p.b)();o&&(a=e+"_"+o);var s=a,m=p.d.get(s);if(m){var f=m+1;p.d.set(s,f),s=a+"."+f}else p.d.set(s,1);window.performance.mark(s);var g=Object(p.c)()||"navigationStart";"App_Navigation_Start"===e&&Object(p.g)(s);var b="navigationStart";return 2===t?b=g:0===t?b="":"string"==typeof t&&(b=t),function(e,t,i,n,a,o){if(i&&!p.e.has(e)){p.e.add(e);try{window.performance.measure(e,i,t)}catch(n){return void function(e,t){var i,n=((i={}).Error=e,i.DebugInfo=t,i);Object(l.a)(c.a.PerformanceMarkFailure,n),Object(u.a)({eventName:"Performance_Mark_Failure",errorType:"Other",message:e,debugInfo:t})}(e,"Failed to record <"+e+"> for <"+t+"> starting from <"+i+">: exception is thrown")}!function(e,t,i,n){var a=window.performance.getEntriesByName(e,"measure");a&&0!==a.length&&function(e,t,i,n){void 0===n&&(n=r.a.Security),Object(d.a)(e,t,i,n),Object(h.a)({eventName:e,latency:t,instrumentationParams:i},n)}(t,Math.ceil(a[0].duration),n,i)}(e,a||e,n,o)}}(a,s,b,i,e,n),s}}function b(e){f||(Object(o.a)((function(e){"hidden"===e&&(n&&Object(s.a)(n),v())})),f=!0),m.add(e),n||(n=Object(s.b)((function(){Object(a.a)()&&m.forEach((function(e){g(e)})),v()})))}function v(){m.clear(),n=null}},"iX+N":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("dFxn"),r=i("Mlb/");class a{constructor(e){this.config=e.parse("wacStartPageConfig")||{featuredDocumentsEnabled:!1,maxInitialDocuments:0,maxTotalDocuments:0,startPageNumTemplatesToShow:0,visioMoreTemplatesUrl:null,moreTemplatesRedirectionEnabled:!1,streamCrossLinkUrl:null,streamDocumentationUrl:null,resources:null,streamPreviewString:"StreamCrossLinkText",visioLibraryTileEnabled:!1}}}a.ɵprov=r.kc({factory:function(){return new a(r.lc(n.a))},token:a,providedIn:"root"})},idgT:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("70cc"),r=i("WKA6"),a=i("BaAg"),o=i("dFxn"),s=i("hZW2"),l=i("7Gwk"),c=i("/I02"),u=i("uWZl"),d=i("ZBli"),h=i("Mlb/");class p{constructor(e,t,i,n){this.configParserService=e,this.contextService=t,this.documentService=i,this.eventService=n;const r=this.configParserService.parse(p.configElementId);this.config=r||{createLcidEnabled:!1,enterpriseTemplatesEnabled:!1,exploreTemplatesUrlFormat:null,exploreTemplatesUrlLocale:null,msCreateSupportedLocale:"",numTemplates:0,numVisioTemplates:0,premiumTemplatesDiamondCorner:null,premiumTemplatesUpsellEnabled:!1,sharePointAuthFrameUrl:null,templatesApiEndpoint:null,excelOrgTemplatesEnabled:!1,templatesFormsEnabled:!1,createTemplatesEnabled:!1,wordOrgTemplatesEnabled:!1,templatesRecommendedApps:[],templatesCollectionsCommercial:[],templatesCollectionsConsumer:[],templatesCollectionsEdu:[],templatesRecommendedApiEnabled:!1,visioUnsupportedTemplatesLocales:[]},this.commonResources=r&&r.appResources?r.appResources.common:{},this.resourceVariants=new Map,r&&r.appResources&&r.appResources.variants&&r.appResources.variants.forEach((e=>{const t=a.a.fileTypeNameToFileType(e.app);t&&this.resourceVariants.set(t,e.resources)})),this.resourceMap=new Map}resources(e=a.b.Word){const t=a.a.fileTypeToApp(e);if(this.resourceMap.has(t))return this.resourceMap.get(t);if(!this.resourceVariants.has(t))return this.commonResources;const i=this.resourceVariants.get(t),n=Object.assign(Object.assign({},this.commonResources),i);return this.resourceMap.set(t,n),n}getTemplatesInfoPromise(){if(!this.templatesInfoPromise){const e=this.eventService.events.withScope(0).pipe(Object(n.a)((e=>"primaryTokensLoaded"===e.name)),Object(r.a)(1)).toPromise(),t=u.a.fullPageReady();this.templatesInfoPromise=Promise.race([e,t]).then((()=>this.configParserService.parse("templatesInfo")))}return this.templatesInfoPromise}prefetchStaticResources(e){const t=this.resources(e);(null==t?void 0:t.PrefetchUrl)&&this.documentService.addIframeToPage(d.a.appendQueryParam(t.PrefetchUrl,"ui",this.contextService.sharedContext.officeMarket))}}p.configElementId="templatesPageConfig",p.ɵprov=h.kc({factory:function(){return new p(h.lc(o.a),h.lc(c.a),h.lc(s.a),h.lc(l.a))},token:p,providedIn:"root"})},izKO:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},"j7b/":function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r})),i.d(t,"d",(function(){return a})),i.d(t,"c",(function(){return o}));var n=36e5,r=24*n,a=7*r,o=30*r},jCfB:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r})),function(e){e.ItemId="item",e.DriveId="drive",e.DocUrl="file",e.ContentUri="contenturi",e.NewFile="newfile",e.BootId="bootid",e.Nav="nav"}(n||(n={}));const r="WacContent_Document_Boot_Diagnostics"},jrGV:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("EYJY"),r=i("70cc"),a=i("O6Zd"),o=i("Mlb/");class s{constructor(){this.actionContextMenu=new n.a}closeMenu(e){this.updateNext(e,0)}openMenu(e){this.updateNext(e,1)}subscribeToCloseEvents(e){return this.actionContextMenu.asObservable().pipe(Object(r.a)((e=>e&&0===e.type)),Object(a.a)((e=>({id:e.id,itemIndex:e.itemIndex,actions:e.actions,groupInfo:e.groupInfo,mouseEvent:e.mouseEvent,targetElement:e.targetElement})))).subscribe(e)}subscribeToOpenEvents(e){return this.actionContextMenu.asObservable().pipe(Object(r.a)((e=>e&&1===e.type)),Object(a.a)((e=>({id:e.id,itemIndex:e.itemIndex,actions:e.actions,groupInfo:e.groupInfo,mouseEvent:e.mouseEvent,targetElement:e.targetElement})))).subscribe(e)}updateNext(e,t){e&&this.actionContextMenu.next({type:t,id:e.id,itemIndex:e.itemIndex,actions:e.actions,groupInfo:e.groupInfo,mouseEvent:e.mouseEvent,targetElement:e.targetElement})}}s.ɵprov=o.kc({factory:function(){return new s},token:s,providedIn:"root"})},"k+kJ":function(e,t,i){"use strict";i.d(t,"b",(function(){return c})),i.d(t,"c",(function(){return n})),i.d(t,"a",(function(){return r})),i.d(t,"d",(function(){return a}));var n,r,a,o=i("6UlS"),s=i("Uqr9"),l=i("IAGz");class c extends class{constructor(e,t,i,r=null,a=0,c=n.Started,u=null,d=null,h=null){this.sessionId=e,this.file=t,this.uploadSource=i,this.cancellationToken=r,this.bytesUploaded=a,this.state=c,this.error=u,this.sessionUrl=d,this.markCompletedAndOpenedInOfficeHome=h,this.startTime=s.a.now(),this.fileSize=t.size,this.lastLoaded=a,this.progress=new o.a(this.progressState()),this.cancellationToken=r||new l.a}finished(){return this.state===n.Completed||this.state===n.Cancelled||this.state===n.Failed||this.state===n.CompletedAndOpened}updateProgress(e){void 0!==e&&(this.lastLoaded=Math.min(Math.max(this.lastLoaded,e),this.fileSize),this.progress.next(this.progressState()))}getProgress(){return this.progress.asObservable()}get duration(){return s.a.now()-this.startTime}progressState(){return{percentage:Math.floor(100*this.lastLoaded/this.fileSize),loaded:this.lastLoaded,total:this.fileSize}}}{}!function(e){e[e.Unknown=0]="Unknown",e[e.Started=1]="Started",e[e.Completed=2]="Completed",e[e.CompletedAndOpened=3]="CompletedAndOpened",e[e.Cancelled=4]="Cancelled",e[e.Failed=5]="Failed"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.FileTooLarge=1]="FileTooLarge",e[e.OutOfSpace=2]="OutOfSpace",e[e.InvalidFileType=3]="InvalidFileType",e[e.BadConnection=4]="BadConnection",e[e.Timeout=5]="Timeout",e[e.Auth=6]="Auth",e[e.MultipleFiles=7]="MultipleFiles"}(r||(r={})),function(e){e[e.Button=0]="Button",e[e.DragAndDrop=1]="DragAndDrop",e[e.CreateMenu=2]="CreateMenu"}(a||(a={}))},kH2X:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("dFxn"),r=i("Mlb/");class a{constructor(e){this.config=e.parse("feedbackConfig")}}a.ɵprov=r.kc({factory:function(){return new a(r.lc(n.a))},token:a,providedIn:"root"})},kJkW:function(e,t,i){var n={"../app-gallery-wrapper/app-gallery-wrapper.module.ngfactory":["xPmN",77],"../create-center/create-center-wrapper/create-center-wrapper.module.ngfactory":["8EFO",85],"../feed/feed.module.ngfactory":["BVus",7,5,6,8,104],"../fluid-unsupported-page/fluid-unsupported-page.module.ngfactory":["OZAL",7,109],"../home/home.module.ngfactory":["tGFC",113],"../install/install-wizard/install-wizard.module.ngfactory":["MPfF",119],"../m365-apps/m365-apps.module.ngfactory":["S91J",7,5,6,8,127],"../modern-start/modern-start.module.ngfactory":["JOfQ",0,4,5,6,8,45,54,134],"../my-content/my-content.module.ngfactory":["+ilh",0,4,5,6,8,9,1,10,11,12,15,14,2,13,17,16,18,19,20,129],"../odsp-start/onedrive-start/onedrive-start.module.ngfactory":["1TjK",7,138],"../odsp-start/sharepoint-start/sharepoint-start.module.ngfactory":["MxpO",7,139],"../search-results/search-results.module.ngfactory":["+OTV",4,35,46,33,154],"../start-page-wrapper/start-page-wrapper.module.ngfactory":["08GV",160],"../templates/templates.module.ngfactory":["+eAU",55,163],"../wac-content/wac-content.module.ngfactory":["005W",7,61],"./app-gallery-wrapper/app-gallery-wrapper.module.ngfactory":["xPmN",77],"./create-center/create-center-wrapper/create-center-wrapper.module.ngfactory":["8EFO",85],"./feed/feed.module.ngfactory":["BVus",7,5,6,8,104],"./fluid-unsupported-page/fluid-unsupported-page.module.ngfactory":["OZAL",7,109],"./install/install-wizard/install-wizard.module.ngfactory":["MPfF",119],"./m365-apps/m365-apps.module.ngfactory":["S91J",7,5,6,8,127],"./modern-start/modern-start.module.ngfactory":["JOfQ",0,4,5,6,8,45,54,134],"./my-content/my-content.module.ngfactory":["+ilh",0,4,5,6,8,9,1,10,11,12,15,14,2,13,17,16,18,19,20,129],"./odsp-start/onedrive-start/onedrive-start.module.ngfactory":["1TjK",7,138],"./odsp-start/sharepoint-start/sharepoint-start.module.ngfactory":["MxpO",7,139],"./officeforms/group-forms.module.ngfactory":["/o7E",31,141],"./officeforms/my-forms.module.ngfactory":["lJPE",7,31,142],"./search-results/search-results.module.ngfactory":["+OTV",4,35,46,33,154],"./start-page-wrapper/start-page-wrapper.module.ngfactory":["08GV",160],"./templates/templates.module.ngfactory":["+eAU",55,163],"./wac-content/wac-content.module.ngfactory":["005W",7,61],"action-context-menu-react.ngfactory":["JJsp",5,6,8,9,10,11,12,15,14,17,16,18,19,22,24,28,34,37,42,72],"allow-filesystem-access.ngfactory":["eYKY",7,73],"announcement.ngfactory":["OyNO",0,4,5,6,8,9,13,36,171,74],"app-gallery-angular.ngfactory":["6nNX",75],"app-gallery-react.ngfactory":["Z6FN",0,4,5,6,8,9,1,10,11,12,15,14,17,16,18,19,22,25,24,76],"appbar.ngfactory":["fdWd",0,5,6,8,9,1,10,11,14,17,16,18,25,24,28,34,42,56,57,79],"auto-suggest.ngfactory":["tDVW",4,35,33,80],"banner.ngfactory":["QOI9",7,81],"bread-crumb.ngfactory":["PaRP",7,4,35,33,82],"confirmation-dialog-react.ngfactory":["uaMB",0,4,5,6,8,13,20,26,30,176,88],"context-menu.ngfactory":["aBzG",89],"create-center-react.ngfactory":["PA+F",0,4,5,6,8,9,1,10,11,12,15,14,2,13,17,16,18,19,20,84],"create-center.ngfactory":["htPP",4,5,6,8,9,10,11,12,15,14,13,17,16,18,19,20,25,24,26,83],"create-menu.ngfactory":["EA+W",7,92],"create-on-home.ngfactory":["6+a9",4,5,6,8,9,10,11,51,174,87],"create-onenote-page-dialog-react.ngfactory":["uENI",0,4,6,11,12,17,16,18,19,25,24,28,34,42,70,56,178,90],"edgeworth.ngfactory":["MZ9O",7,44,180,95],"error-dialog.ngfactory":["oDVq",7,98],"ew-react.ngfactory":["cjNM",0,4,5,6,8,9,1,10,11,12,15,14,2,13,17,16,18,19,20,100],"feature-callout.ngfactory":["6lH3",102],"feature-tooltip-container.ngfactory":["Vbec",103],"first-run-react.ngfactory":["nDWB",0,4,5,6,8,9,10,12,15,13,20,58,182,107],"first-run-wrapper.ngfactory":["SpUw",108],"first-run.ngfactory":["AzcM",106],"fluent-theme-provider.ngfactory":["wMw5",5,6,8,111],"forms-group.ngfactory":["oA+b",31,112],"input-dialog.ngfactory":["4csf",7,44,116],"install-react.ngfactory":["dqLy",7,0,5,6,8,1,68,184,118],"install-wrapper.ngfactory":["hLvm",120],"install.ngfactory":["T4V2",7,117],"learning-shelf-react.ngfactory":["AIbW",0,5,6,8,9,1,10,12,15,14,36,51,186,124],"left-nav-react.ngfactory":["46Tl",4,5,187,126],"move-to-folder-control.ngfactory":["PsH8",132],"mru.ngfactory":["GHXR",7,31,133],"new-consumer-experience.ngfactory":["VHqc",7,135],"new-user-shelf.ngfactory":["hPLh",7,136],"places.ngfactory":["wK/J",7,31,144],"quick-access.ngfactory":["leWi",0,4,5,6,8,9,1,10,11,12,15,14,2,13,17,16,18,19,20,147],"recommended-react.ngfactory":["+luH",7,0,4,5,6,8,9,1,10,11,12,15,14,2,13,17,16,18,19,149],"search-preload.ngfactory":["01Cu",7,4,35,194,33,153],"share-control.ngfactory":["Uv8L",156],"side-popup-menu.ngfactory":["8KAq",7,157],"start-page-react.ngfactory":["VbK9",0,4,5,6,8,45,54,159],"task-module-dialog-react.ngfactory":["C0gm",0,4,5,6,8,1,23,27,29,49,197,161],"teaching-ui-react.ngfactory":["BSh6",0,4,5,6,8,9,13,20,26,30,45,59,198,162],"toast-container-react.ngfactory":["G/jE",0,4,5,6,8,9,10,12,34,200,165],"upload-button.ngfactory":["WbHY",7,166],"upload-dialog.ngfactory":["ynE4",7,167],"upload-local-file.ngfactory":["pYXo",7,168],"upload-react.ngfactory":["9kEu",0,4,5,6,8,9,1,10,11,12,14,2,17,16,18,19,25,24,28,169],"visual-background-react.ngfactory":["gB77",0,5,6,8,9,201,204],"wac-content.ngfactory":["005W",7,61],"wac-start.ngfactory":["DLYR",44,55,205],"web-vitals.ngfactory":["/Fzb",207],"welcome-badge-react.ngfactory":["tO7o",7,0,4,5,6,8,9,1,10,12,13,17,16,19,22,25,24,43,203,206],"workspace-nav.ngfactory":["r3HZ",7,208]};function r(e){if(!i.o(n,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],r=t[0];return Promise.all(t.slice(1).map(i.e)).then((function(){return i(r)}))}r.keys=function(){return Object.keys(n)},r.id="kJkW",e.exports=r},kVgv:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},kaEK:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.None=0]="None",e[e.Default=1]="Default",e[e.Open=2]="Open",e[e.Edit=3]="Edit",e[e.Comment=4]="Comment",e[e.Mention=5]="Mention",e[e.Share=6]="Share",e[e.Attachment=7]="Attachment",e[e.SnoozeExpiry=8]="SnoozeExpiry",e[e.Trending=9]="Trending",e[e.News=10]="News",e[e.Meeting=11]="Meeting",e[e.Video=12]="Video",e[e.MyAnalytics=13]="MyAnalytics",e[e.Task=14]="Task"}(n||(n={}))},kfAr:function(e,t,i){"use strict";i.d(t,"a",(function(){return S}));var n=i("lrJm"),r=i("Ry9Z"),a=i("BaAg"),o=i("QOOv"),s=i("fKR7"),l=i("pd4Y"),c=i("TDzr"),u=i("n826"),d=i("Dpxn"),h=i("m+UP"),p=i("BJbw"),m=i("Brer"),f=i("4/We"),g=i("/I02"),b=i("cgnd"),v=i("Mlb/");class S{constructor(e,t,i,n,r,a,o,s,l,c,u,d,h){this.capabilitiesService=e,this.dateService=i,this.formsService=n,this.oneDriveGraphService=a,this.oneDriveService=o,this.vroomService=s,this.swayService=l,this.analyticsService=c,this.urlAuthenticatorService=u,this.globalErrorHandler=d,this.clientStartupConfigService=h,this.config=r.config,this.lifecycleEventsEnabled=this.config.isNewLifecycleEventEnabled,this.inflationsInProgress=new Array,this.inMockMode=t.sharedContext.inMockMode,this.thumbnailApiEnabled=this.capabilitiesService.capabilities.thumbnailEndpointEnabled}inflateItem(e,t,i,n){if(e.isLocal||S.disableInflation.has(e.fileType))return Promise.resolve(e);const r=this.fetchItemInflationData(e,e.fromCache?"cache-only":"network-first",t,i,n);return this.inflationsInProgress.push(r.then((e=>e),(()=>null))),this.waitOnInflations().then((()=>this.inflationsInProgress.splice(0))),r}inflateThumbnails(e){if(!S.thumbnailFileTypes.has(e.fileType)||e.thumbnails)return Promise.resolve(e);const t=e.fromCache?"cache-only":"network-first";return new Promise((i=>{if(e.fileType!==a.b.Sway)return e.fileType===a.b.Forms?(e.thumbnails={},void this.formsService.fetchFormThumbnail(e).then((()=>i(e)))):void(e.driveId&&e.docId?this.thumbnailApiEnabled&&e.format!==s.a.News&&e.format!==s.a.StreamsVideo?(this.populateThumbnailWithUrl(e,this.getThumbnailUrlForItem(e.driveId,e.docId)),i(e)):this.oneDriveGraphService.getThumbnailsForItem(e.driveId,e.docId,t,2).then((t=>{t&&t.value&&t.value.length&&this.populateThumbnails(e,t.value[0])})).catch((e=>{this.globalErrorHandler.handleError(e,"ZYaIo")})).then((()=>i(e))):this.chooseSharesCall(e,t,!0).then((t=>{t&&t.thumbnails&&t.thumbnails.length&&this.populateThumbnails(e,t.thumbnails[0])})).catch((e=>{this.globalErrorHandler.handleError(e,"hKd6C")})).then((()=>i(e))));this.fetchSwayThumbnail(e,t).then((()=>{i(e)}))}))}waitOnInflations(){const e=this.inflationsInProgress.length;return Promise.all(this.inflationsInProgress).then((()=>{if(!(this.inflationsInProgress.length<=e))return this.waitOnInflations()}))}fetchItemInflationData(e,t,i,n,r){return e.format===s.a.Recommended||e.format===s.a.OfficeFeedDocument||e.format===s.a.News?this.fetchRecommendedItemInflationData(e,t):new Promise((o=>{const l=[],c=this.config.shareControlEnabled&&e.fileType!==a.b.Sway,u=this.capabilitiesService.wacHostEnabledForFileType(e.fileType)&&!this.capabilitiesService.capabilities.isEmbedMode;if(e.format===s.a.Trending&&e.driveId&&e.docId)this.tileViewEnabledForItem(e)&&i&&l.push(u?this.oneDriveService.getItemWithWacDataAndThumbnails(e,t,!1,2).then((t=>{this.populateMruItemFromDriveItem(e,t),this.thumbnailApiEnabled&&e.format!==s.a.News&&e.format!==s.a.StreamsVideo&&this.populateThumbnailWithUrl(e,this.getThumbnailUrlForItem(e.driveId,e.docId))})).catch((e=>{this.globalErrorHandler.handleError(e,"WF9ix")})):this.oneDriveGraphService.getThumbnailsForItem(e.driveId,e.docId,t,2).then((t=>{t&&t.value&&t.value.length&&this.populateThumbnails(e,t.value[0])})).catch((e=>{this.globalErrorHandler.handleError(e,"iZlQF")}))),e.fileType!==a.b.OneNote&&l.push(this.setupActivity(e,t)),(c||this.lifecycleEventsEnabled)&&l.push(this.oneDriveGraphService.getItemWithIds(e.driveId,e.docId,"sharepointIds,createdDateTime",t).then((t=>{this.setupShareControl(e,t),this.setupLifecycleEvents(e,t)})).catch((e=>{this.globalErrorHandler.handleError(e,"wUAkv")})));else if((this.tileViewEnabledForItem(e)||this.config.activityEnabled||this.config.permissionsEnabled||c||u)&&m.a.sharesFileTypes.has(e.fileType)&&(1===e.sharingType||4===e.sharingType||0===e.sharingType)){const n=this.checkAllDataIsPresentForInflation(e);if(n){this.setupLifecycleEvents(e,null);const n=(e.fileType!==a.b.OneNote?this.setupActivity(e,t):Promise.resolve()).then((()=>Promise.resolve()));l.push(n),i&&e.driveId&&e.docId&&l.push(this.oneDriveGraphService.getThumbnailsForItem(e.driveId,e.docId,t,2).then((t=>{t&&t.value&&t.value.length&&this.populateThumbnails(e,t.value[0])})).catch((e=>{this.globalErrorHandler.handleError(e,"iZlQF")})))}n||l.push(this.chooseSharesCall(e,t,i).then((i=>i?(this.populateMruItemFromDriveItem(e,i),this.thumbnailApiEnabled&&e.format!==s.a.News&&e.format!==s.a.StreamsVideo&&this.populateThumbnailWithUrl(e,this.getThumbnailUrlForItem(e.driveId,e.docId)),this.setupShareControl(e,i),this.setupLifecycleEvents(e,i),e.docId=i.id,i.parentReference&&(e.driveId=i.parentReference.driveId),e.fileType!==a.b.OneNote?this.setupActivity(e,t):Promise.resolve()):Promise.resolve())).catch((e=>{this.globalErrorHandler.handleError(e,"EgyA3")})))}if(this.config.analyticsEnabled&&n){const i=this.analyticsService.getAnalytics(e,t).then((t=>{e.analytics=t})).catch((e=>{this.globalErrorHandler.handleError(e,"gBfeR")}));l.push(i)}l.push(...this.setupSwayData(e,t,i)),l.push(...this.setupFormData(e,i,r)),Promise.all(l).then((()=>{e.inflationCompleted(),o(e)}),(()=>{e.inflationCompleted(),o(e)}))}))}fetchRecommendedItemInflationData(e,t){return new Promise((i=>{e.driveId&&e.docId?this.fetchAndPopulateWacDataAndThumbnails(e,t).catch((e=>{this.globalErrorHandler.handleError(e,"rm3f5")})).then((()=>i(e))):i(e)}))}getThumbnailUrlForItem(e,t){if(!e||!t)return;const i=`drives/${encodeURIComponent(e)}/items/${encodeURIComponent(t)}/thumbnails/0/c400x99999/content?prefer=noredirect,closestavailablesize,extendCacheMaxAge`;return this.inMockMode?`thumbnails?itemUrl=${encodeURIComponent(i)}`:i}fetchAndPopulateWacDataAndThumbnails(e,t){return this.capabilitiesService.wacHostEnabledForFileType(e.fileType)&&!this.inMockMode?this.oneDriveService.getItemWithWacDataAndThumbnails(e,t).then((t=>{this.populateMruItemFromDriveItem(e,t),this.thumbnailApiEnabled&&e.format!==s.a.News&&e.format!==s.a.StreamsVideo&&this.populateThumbnailWithUrl(e,this.getThumbnailUrlForItem(e.driveId,e.docId))})):this.thumbnailApiEnabled&&e.format!==s.a.News&&e.format!==s.a.StreamsVideo?(this.populateThumbnailWithUrl(e,this.getThumbnailUrlForItem(e.driveId,e.docId)),Promise.resolve()):(e.driveId&&e.docId?this.oneDriveGraphService.getThumbnailsForItem(e.driveId,e.docId,t).then((e=>null==e?void 0:e.value)):this.chooseSharesCall(e,t,!0).then((e=>null==e?void 0:e.thumbnails))).then((t=>{(null==t?void 0:t.length)&&this.populateThumbnails(e,t[0])}))}populateMruItemFromDriveItem(e,t){!this.thumbnailApiEnabled&&t&&t.thumbnails&&t.thumbnails.length&&this.populateThumbnails(e,t.thumbnails[0]),t&&t.openWith&&t.openWith.wac&&this.populateWopiHostData(e,t)}populateThumbnails(e,t){e.thumbnails={small:t.small?t.small.url:null,medium:t.medium?t.medium.url:null,large:t.large?t.large.url:null,recommendedThumbnail:e.format!==s.a.Recommended&&e.format!==s.a.News&&e.format!==s.a.OfficeFeedDocument||!t.large?null:this.getRecommendedThumbnail(t.large.url)}}populateThumbnailWithUrl(e,t){t&&(e.thumbnails={large:t,recommendedThumbnail:t})}populateWopiHostData(e,t){e.wopiData=m.a.getWopiHostDataFromItem(t)}getRecommendedThumbnail(e){return e.replace(/&width=\d+/,"&width=350").replace(/&height=\d+/,"&height=400")}setupActivity(e,t){return!this.config.activityEnabled||e.format===s.a.Recent&&this.config.mruActivityEnabled&&this.config.onlyMruActivityEnabled?Promise.resolve():this.vroomService.getDocumentActivity(e,t,2).then((t=>e.activities=t)).catch((e=>{this.globalErrorHandler.handleError(e,"SluwI")}))}chooseSharesCall(e,t,i){const n=e.canonicalUrl;if(!n.match(a.d)&&!n.match(a.c))return Promise.resolve(void 0);const r=this.capabilitiesService.wacHostEnabledForFileType(e.fileType);return i?this.oneDriveService.getSharedItemWithThumbnail(n,e.fileType,s.a[e.format],t,r,!1,2):this.oneDriveService.getSharedItemWithoutThumbnail(n,e.fileType,s.a[e.format],t,r,void 0,!1,2)}setupShareControl(e,t){t&&t.sharepointIds&&t.sharepointIds.siteUrl&&(e.sharepointIds.siteUrl=t.sharepointIds.siteUrl)}setupLifecycleEvents(e,t){if(this.lifecycleEventsEnabled&&!this.config.mruActivityEnabled){let i=e.createdDate;!i&&t&&t.createdDateTime&&(i=new Date(t.createdDateTime)),i&&(e.isNew=this.dateService.addHours(this.dateService.getCurrentDate(),-1*this.config.isNewTimeWindowInHours).getTime()<=i.getTime())}}setupFormData(e,t,i){const n=[];return e.fileType!==a.b.Forms||(i===a.b.Forms&&n.push(new Promise(((t,i)=>{const n=(t=0)=>{e.metaData||(e.metaData={}),e.metaData.formsResponseCount=t};e.ownerId===this.clientStartupConfigService.config.objectId||this.clientStartupConfigService.config.authType===b.a.MSA?this.formsService.getMyFormsResponses().then((i=>{const r=i.find((t=>t.id===e.serverDocId));n(null==r?void 0:r.responseCount),t()})).catch(i):this.formsService.getForm(e.serverDocId,e.ownerType,e.ownerId).then((e=>{n(e?e.rowCount:null),t()})).catch(i)}))),this.tileViewEnabledForItem(e)&&t&&n.push(this.inflateThumbnails(e).then((()=>{})))),n}setupSwayData(e,t,i){const n=[];return e.fileType!==a.b.Sway||(this.tileViewEnabledForItem(e)&&this.swayService.swayConfig.thumbnailsEnabled&&i&&n.push(this.fetchSwayThumbnail(e,t)),e.url=this.urlAuthenticatorService.appendPvrAndUpnAuthParams(e.url)),n}fetchSwayThumbnail(e,t){return this.swayService.getThumbnail(e.url,e.thumbnailInfo?e.thumbnailInfo.thumbnailId:null,t).then((t=>{t&&(e.thumbnails={small:t,medium:t,large:t,recommendedThumbnail:t})})).catch((e=>{this.globalErrorHandler.handleError(e,"cm5b1")}))}checkAllDataIsPresentForInflation(e){return!!(e.sharepointIds&&e.createdDate&&e.driveId&&e.docId)}tileViewEnabledForItem(e){return this.config.tileViewEnabled||e.fileType===a.b.Forms}}S.thumbnailFileTypes=new Set([a.b.PowerPoint,a.b.Visio,a.b.Word,a.b.Sway,a.b.Pdf,a.b.Forms,a.b.Stream]),S.disableInflation=new Set([a.b.Project,a.b.ProjectOperations,a.b.Portfolio]),S.ɵprov=v.kc({factory:function(){return new S(v.lc(f.a),v.lc(g.a),v.lc(l.a),v.lc(c.a),v.lc(o.a),v.lc(u.a),v.lc(d.a),v.lc(m.a),v.lc(h.a),v.lc(r.a),v.lc(p.a),v.lc(n.b),v.lc(b.b))},token:S,providedIn:"root"})},kpuN:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n,r=i("QjXU"),a=i("EYJY");!function(e){e[e.NotInitialized=0]="NotInitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(n||(n={})),Error;class o{init(e,t,i){this.errorHandler=e,this.defaultTokenFormat=t,this.defaultTokenSource=i,this._reauth=new a.a,this.reauthComplete=this._reauth.asObservable()}getDefaultExpiry(){return(new Date).getTime()+36e5}getAccessToken(e,t,i,n,a,o,s,l,c){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return e?this.getAccessTokenResponse(e,t,i,n,a,o,s,l,c).then((e=>e&&e.token?e:{success:!1,token:"",format:this.defaultTokenFormat,source:this.defaultTokenSource,error:new Error("Empty token returned")})).catch((e=>(this.errorHandler.handleError(e,"SuNwZ"),{success:!1,token:"",format:this.defaultTokenFormat,source:this.defaultTokenSource,error:e}))):Promise.resolve({success:!1,token:"",format:this.defaultTokenFormat,source:this.defaultTokenSource,error:new Error("invalid tokenConsumer")})}))}}},kq70:function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i("EUVs"),i("4/We");var n=i("adME");class r extends n.a{constructor(e,t){super((()=>this.wacContentService.prebootDocument(this.itemInfo.item,this.itemInfo.wdOriginType))),this.capabilitiesService=e,this.wacContentService=t}enabled(){return this.capabilitiesService.wacHostEnabledForFileType(this.itemInfo.item.fileType)&&this.capabilitiesService.wacHostHoverPrebootEnabledForFileType(this.itemInfo.item.fileType)}}},ksTh:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r})),i.d(t,"d",(function(){return a})),i.d(t,"c",(function(){return o}));const n="client-request-id",r="x-correlationid",a=`_Edgeworth${window.ewWorkload}LastSyncTimestamp`,o="rs="},kxm0:function(e,t,i){"use strict";i.d(t,"d",(function(){return c})),i.d(t,"c",(function(){return u})),i.d(t,"e",(function(){return d})),i.d(t,"a",(function(){return h})),i.d(t,"b",(function(){return p}));var n=i("TfV2"),r=i("ZBSS"),a=i("zGJG"),o=i("uqr+"),s=i("dSKW"),l=i("uV9m");function c(e,t){var i;void 0===t&&(t=n.a.Security);var a,s={};s[r.y]="PageView",s[r.z]=null!==(i=e.eventName)&&void 0!==i?i:"",(Object(l.c)()||e.pageName)&&(a=h(p(s=d(s,e.pageName)))),s[Object(o.a)([r.X,r.P])]=e.isIntentional,Object(l.e)(a,s,t)}function u(e){return"PageView"===e[r.y]}function d(e,t){if(e[Object(o.a)([r.X,r.V])])return e;var i=t||Object(s.a)(Object(l.a)());return e[Object(o.a)([r.X,r.V])]=i,e[Object(o.a)([r.X,r.W])]=Object(s.c)(i),e[Object(o.a)([r.X,r.U])]=Object(s.b)(i),e}function h(e){return["PageView",e].join(a.a)}function p(e){return e[Object(o.a)([r.X,r.V])]}},lQwO:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},lUkk:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("TfV2"),r=i("ZBSS"),a=i("zGJG"),o=i("uqr+"),s=i("dSKW"),l=i("uV9m");function c(e,t){void 0===t&&(t=n.a.Security);var i=function(e){return["Action",e.result,e.target].join(a.a)}(e);Object(l.e)(i,function(e){var t,i,n,a,c={};if(c[r.y]="Action",c[Object(o.a)([r.a,r.e])]=null!==(t=e.type)&&void 0!==t?t:"Click",c[Object(o.a)([r.a,r.G])]=e.id,c[Object(o.a)([r.a,r.j])]=e.area,c[Object(o.a)([r.a,r.fb])]=null!==(i=e.subArea)&&void 0!==i?i:"Other",c[Object(o.a)([r.a,r.b])]=e.result,c[Object(o.a)([r.a,r.c])]=e.target,c[Object(o.a)([r.a,r.d])]=null!==(n=e.targetId)&&void 0!==n?n:"",c[r.z]=null!==(a=e.eventName)&&void 0!==a?a:"",Object(l.c)()){var u=Object(s.a)(Object(l.a)());c[Object(o.a)([r.a,r.V])]=u,c[Object(o.a)([r.a,r.W])]=Object(s.c)(u),c[Object(o.a)([r.a,r.U])]=Object(s.b)(u)}return c}(e),t)}},laSs:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("TfV2"),r=i("ZBSS"),a=i("uqr+"),o=i("dSKW"),s=i("uV9m");function l(e,t){void 0===t&&(t=n.a.Security),Object(s.e)("Impression",function(e){var t,i,n,l,c={};if(c[r.y]="Impression",c[r.z]=e.eventName,c[Object(a.a)([r.H,r.j])]=e.area,c[Object(a.a)([r.H,r.fb])]=null!==(t=e.subArea)&&void 0!==t?t:"Other",c[Object(a.a)([r.H,r.E])]=null!==(i=e.fromCache)&&void 0!==i&&i,c[Object(a.a)([r.H,r.ab])]=e.renderSize?e.renderSize.toString():"",c[Object(a.a)([r.H,r.gb])]=e.totalSize?e.totalSize.toString():"",c[Object(a.a)([r.H,r.f])]=e.actualSize?e.actualSize.toString():"",c[Object(a.a)([r.H,r.q])]=null!==(n=e.distribution)&&void 0!==n?n:"",c[Object(a.a)([r.H,r.G])]=null!==(l=e.id)&&void 0!==l?l:"",Object(s.c)()){var u=Object(o.a)(Object(s.a)());c[Object(a.a)([r.H,r.V])]=u,c[Object(a.a)([r.H,r.W])]=Object(o.c)(u),c[Object(a.a)([r.H,r.U])]=Object(o.b)(u)}return c}(e),t)}},lkvL:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("QjXU"),r=i("e3cR"),a=i("muUJ"),o=i("a3FV"),s=i("CMIS"),l=i("H2Bi"),c=i("WDeU");function u(e){var t,i,u=e.userId,d=e.collectionName,h=e.collectionVersion,p=e.key,m=e.data,f=e.hashKey,g=e.plugins,b=void 0===g?[]:g,v=e.writeBehavior,S=void 0===v?"replace":v;return Object(n.__awaiter)(this,void 0,void 0,(function(){var e,g,v,y,C,w,I,T,k,A,_;return Object(n.__generator)(this,(function(P){switch(P.label){case 0:return P.trys.push([0,10,,11]),[4,Object(c.a)(u,d,h,p,f)];case 1:e=n.__read.apply(void 0,[P.sent(),2]),g=e[0],v=e[1],P.label=2;case 2:P.trys.push([2,7,8,9]),y=Object(n.__values)(b),C=y.next(),P.label=3;case 3:return C.done?[3,6]:(w=C.value).onBeforeWriteValue?[4,w.onBeforeWriteValue(m,v,{userId:u,collectionName:d,collectionVersion:h})]:[3,5];case 4:m=P.sent(),P.label=5;case 5:return C=y.next(),[3,3];case 6:return[3,9];case 7:return I=P.sent(),k={error:I},[3,9];case 8:try{C&&!C.done&&(A=y.return)&&A.call(y)}finally{if(k)throw k.error}return[7];case 9:return m?[2,Object(r.e)(g,[m],l.b,S,[v])]:[2];case 10:throw T=P.sent(),Object(a.a)(o.a.SimplePersistenceWriteError,((_={}).Error="Error writing to "+d+": "+(null===(t=null==T?void 0:T.toString)||void 0===t?void 0:t.call(T)),_)),Object(s.a)({eventName:"Simple_Persistence_Write_Error",errorType:"SimplePersistence_Error",message:"Error writing to "+d+": "+(null===(i=null==T?void 0:T.toString)||void 0===i?void 0:i.call(T))}),T;case 11:return[2]}}))}))}},lrJm:function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return l}));var n=i("Mlb/"),r=i("CMIS"),a=i("hhzZ"),o=i("BMb5");class s extends Error{constructor(e,t){super(e),this.message=e,this.originalError=t,this.name="ApplicationError",Object.setPrototypeOf&&Object.setPrototypeOf(this,s.prototype)}}class l extends n.p{constructor(e,t){super(),this.instrumentationService=e,this.windowService=t,this.loggedErrors=new Map,this.unknownError="UnknownError",this.ignoredErrorSubstrings=["__gCrWeb"],this.mutateGlobalWindowErrorHandler()}handleError(e,t){this.shouldSwallow(e)||(this.setErrorId(e,t),this.logError(e,"Angular2"))}handleCacheObservableError(e,t,i){e&&(e.networkError&&this.handleError(e.networkError,i),e.cacheError&&this.handleError(e.cacheError,t))}setErrorId(e,t){e&&"object"==typeof e&&t&&(e.id=t)}mutateGlobalWindowErrorHandler(){const e=this.windowService.nativeWindow,t=e.onerror,i=this;e.onerror=function(n,r,a,o,s){let l=null;if("object"==typeof n&&n.type&&"error"===n.type.toLowerCase()?l=n:s?(l=s,l.message=s.message||n,Object.assign&&Object.assign(l,{filename:r,lineno:a,colno:o})):"string"==typeof n?(l=new Error(n||i.unknownError),Object.assign&&Object.assign(l,{filename:r,lineno:a,colno:o})):(l=new Error(i.unknownError),Object.assign&&Object.assign(l,{filename:r,lineno:a,colno:o})),i.logError(l,"Global"),t)try{t.apply(e,arguments)}catch(e){i.handleError(e)}}}logError(e,t){let i="",n="";e=e||new Error(this.unknownError);try{let r=e.filename;r?(r=r.replace(/^.*[\\\/]/,""),i=`Error location: ${r}, line: ${e.lineno}, col: ${e.colno}`):i=e.id?`Error id: ${e.id}`:"Error location: unknown";let a=e.error||e;a.originalError?(i+=`\nHandled error is a wrapper with message: ${a.message}`,n=`Wrapper call stack: ${a.stack||"Call stack trace is not available"}`,a=a.originalError,n+=`\nOriginal call stack: ${a.stack||"Call stack trace is not available"}`):n=`Call stack: ${a.stack||"Call stack trace is not available"}`,a.message&&(i+=`\nError message: ${a.message}`,i.indexOf("Invalid calling object")>0&&(i+=`\nShellver: ${window.O365ShellVerStr}`))}catch(e){i=`Error caught inside error logger: ${e&&e.message||this.unknownError}`,n=`Call stack: ${e&&e.stack||"Call stack trace is not available"}`,t="Angular2",super.handleError(e)}finally{this.safeLogErrorData(i,n,t),super.handleError(e)}}safeLogErrorData(e,t,i){try{const n=this.determineOccurrence(e);if(this.loggedErrors.set(e,n),this.shouldLogBasedOnOccurrence(n)){const a={ItemCategory:i,ItemCount:n.toString()};this.instrumentationService.logGenericEvent("Unhandled_Exception",a),a.Error=e,a.DebugInfo=t,this.instrumentationService.logDebugCacheEvent("Unhandled_Exception",a),Object(r.a)({eventName:"Unhandled_Exception",errorType:"Unhandled_Exception",message:e,debugInfo:t})}}catch(e){super.handleError(e)}}shouldSwallow(e){var t;if(null==e?void 0:e.shouldSwallow)return!0;const i=null===(t=(null==e?void 0:e.error)||e)||void 0===t?void 0:t.message;if(i)for(const e in this.ignoredErrorSubstrings)if(i.indexOf(e)>=0)return!0;if(e&&e.stack&&!e.promise)return!1;if(e&&e.promise&&e.rejection){const t=e.rejection;if(t.stack&&"Error"!==t.name)return!1}return!0}determineOccurrence(e){let t=1;return this.loggedErrors.has(e)&&(t=this.loggedErrors.get(e)+1),t}shouldLogBasedOnOccurrence(e){const t=e.toString().length,i=Math.pow(10,t-1);return i<2||e%i==0}}l.ɵprov=n.kc({factory:function(){return new l(n.lc(a.a),n.lc(o.b))},token:l,providedIn:"root"})},lwM0:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("pjz5");class r{static encodeUrl(e,t){if(!e)return"";if(t){const t=n.a.getLocation(e),i=e=>{if(!e)return"";const t=e.substring(1).split("&");let i=0;const n=t.reduce(((e,t)=>{const n=t.split("="),r=i>0?"&":"";return i++,e+r+(n[0]&&n[1]?n[0]+"="+encodeURIComponent(n[1]):n[0]+(""===n[1]?"=":""))}),"");return e[0]+n};return encodeURI(t.protocol+"//"+t.host)+encodeURI(t.path)+i(t.search)+i(t.hash)}return encodeURI(e).replace(/#/g,"%23")}static decodeUrl(e){if(!e)return"";try{return decodeURIComponent(e)}catch(e){return""}}}},lwUs:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("QjXU"),r=i("e3cR"),a=i("H2Bi"),o=i("YqCH");function s(e){var t=this;return{onBeforeWriteValue:function(e){return Object(n.__awaiter)(t,void 0,void 0,(function(){return Object(n.__generator)(this,(function(t){return e?[2,{item:e,persistedAtTimeMs:(new Date).getTime()}]:[2,e]}))}))},onAfterReadValue:function(i,s,l){return Object(n.__awaiter)(t,void 0,void 0,(function(){return Object(n.__generator)(this,(function(t){return i?e+i.persistedAtTimeMs<i.persistedAtTimeMs?(function(e,t,i,s){Object(n.__awaiter)(this,void 0,void 0,(function(){var l;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(o.a)(e,t,i)];case 1:return l=n.sent(),[4,Object(r.a)(l,a.b,s)];case 2:return n.sent(),[2]}}))}))}(l.userId,l.collectionName,l.collectionVersion,s),[2,null]):[2,i.item]:[2,i]}))}))}}}},"m+UP":function(e,t,i){"use strict";i.d(t,"a",(function(){return A}));var n=i("6UlS"),r=i("lrJm"),a=i("k+kJ"),o=i("JScD"),s=i("3GGT"),l=i("PZOQ"),c=i("hhzZ"),u=i("R7NL"),d=i("BaAg"),h=i("H90i"),p=i("cgnd"),m=i("/I02"),f=i("PBJH"),g=i("pjz5"),b=i("kpuN"),v=i("wwmn"),S=i("casz"),y=i("6GOa"),C=i("BJbw"),w=i("pOWU"),I=i("Mlb/"),T=i("vk2e");class k{constructor(){this.cachedResponsePromises=new Map}set(e,t,i){const n=this.key(t,i);this.cachedResponsePromises.set(n,e)}has(e,t){const i=this.key(e,t);return this.cachedResponsePromises.has(i)}get(e,t){const i=this.key(e,t);return this.cachedResponsePromises.get(i)}delete(e,t){const i=this.key(e,t);return this.cachedResponsePromises.delete(i)}key(e,t){return`/${t}/${e}`}}class A extends w.a{constructor(e,t,i,n,r,a,o,s,l,c,u,d,h,p){super(t,i,n,"Sway",r,a,o,p),this.globalErrorHandler=s,this.urlAuthenticatorService=l,this.uploadConfigService=u,this.locService=d,this.localDataSizePipe=h,this.cachedResponsePromises=new k,this.swayConfig=e.config;const m=c.config;this.requestConfig={headers:new Map([["X-UserSessionId",m.sharedClientStartupContext.correlationId],["X-OHP-CorrelationId",m.sharedClientStartupContext.correlationId]])}}createNew(){const e=`${this.swayConfig.apiUrl}/json/createStory`;return new Promise(((t,i)=>{this.post("Sway_Create_Request","Sway_Create",e,void 0,(e=>{e.instrument(((e,t)=>{!e.ok||e.data&&e.data.url||(t.HttpCode=s.a.UnexpectedResponse.toString()),this.instrumentResponse(e.headers,t)})).then((e=>{e&&e.data?t(this.urlAuthenticatorService.appendPvrAndUpnAuthParams(e.data.url)):i(new w.b(e,"Could not parse Sway creation response"))})).catch((e=>{this.globalErrorHandler.handleError(e,"WlqQb")}))}),i,this.requestConfig)}))}upload(e,t){const i=new a.b(t,e,a.d.Button),r=new n.a(i),o=e=>{i.state=e,r.next(i)};return i.cancellationToken.onCancel((()=>o(a.c.Cancelled))),this.verifyFileForUpload(e).then((()=>o(a.c.Started))).then((()=>A.readBase64(e))).then((e=>this.uploadFile({docBase64:e,documentName:i.file.name,world:"VerticalWorld",enhancementId:"",otsClient:h.a},i))).then((e=>{i.result=e,o(a.c.Completed)})).catch((e=>{i.error=this.createUploadError(e),o(a.c.Failed)})),r.asObservable()}getThumbnail(e,t,i){if(!this.swayConfig.thumbnailsEnabled||!t)return Promise.resolve("");const n=`${this.swayConfig.apiUrl}/sway/v1.0/${A.extractLookupId(e)}/croppedThumbnailImage?imageId=${t}&width=198&height=111`;return new Promise(((e,t)=>{this.swayGet("Sway_Get_Thumbnail_Request","Sway_Get_Thumbnail",n,i,"blob",!0).then((i=>{i&&i.data?A.readAsDataUrl(i.data).then(e,t):e(null)}),t)}))}getAnalytics(e,t){const i=A.extractLookupId(e);return this.fetchAnalyticsForBatch([i],t).then((e=>A.findAnalytics(e.data,i)))}prefetchAnalytics(e,t){if(!e||0===e.length)return;const i=e.map(A.extractLookupId).sort(),n=A.splitToBatches(i,this.swayConfig.analyticsBatchSize);for(let e=0;e<n.length;e++){const i=n[e],r=this.fetchAnalyticsForBatch(i,t);for(let e=0;e<i.length;e++){const n=this.buildUrlForAnalytics([i[e]]);this.cachedResponsePromises.set(r,n,t),r.catch((()=>this.cachedResponsePromises.delete(n,t)))}}}handleQueryParam(e,t){super.handleQueryParam(e,t),"mocksway"===e&&this.mockRequestHeader&&this.requestConfig.headers.set(this.mockRequestHeader,t)}static findAnalytics(e,t){if(e)for(let i=0;i<e.length;i++)if(e[i]&&e[i].id===t)return e[i].analytics}static extractLookupId(e){return g.a.getLocation(e).path.split("/").filter((e=>e))[0]}static splitToBatches(e,t){const i=[],n=e.slice();for(;n&&n.length&&t;)i.push(n.splice(0,t));return i}static readAsDataUrl(e){return new Promise(((t,i)=>{const n=new FileReader;n.addEventListener("loadend",(()=>{t(n.result)})),n.addEventListener("abort",(()=>{i()})),n.addEventListener("error",(()=>{i()})),n.readAsDataURL(e)}))}static readBase64(e){return new Promise(((t,i)=>{A.readAsDataUrl(e).then((e=>{const n=e.indexOf(",");n>=0?t(e.substring(n+1)):i(a.a.Unknown)})).catch((()=>i(a.a.Unknown)))}))}createUploadError(e){const t=this.uploadConfigService.config.swayResources;switch(e){case a.a.FileTooLarge:return{title:t.errorTitle,type:e,message:this.locService.format(t.largeFile,this.localDataSizePipe.transform(this.swayConfig.uploadMaxFileSize))};case a.a.InvalidFileType:return{title:t.errorTitle,type:e,message:t.unsupportedFile};default:return{title:t.errorTitle,type:e,message:""}}}verifyFileForUpload(e){const t=d.a.getFileExtension(e.name.toLowerCase());return-1===this.swayConfig.uploadSupportedExtensions.indexOf(t)?Promise.reject(a.a.InvalidFileType):e.size>this.swayConfig.uploadMaxFileSize?Promise.reject(a.a.FileTooLarge):Promise.resolve()}uploadFile(e,t){const i=`${this.swayConfig.apiUrl}/publishtosway/createstoryandpublishdocument`;return new Promise(((n,r)=>{this.post("Sway_Create_Story_And_Publish_Document_Request","Sway_Create_Story_And_Publish_Document",i,e,(e=>{e.instrument(((e,t)=>{!e.ok||e.data&&e.data.pollingUrl||(t.HttpCode=s.a.UnexpectedResponse.toString()),this.instrumentResponse(e.headers,t)})).then((e=>{e&&e.data?n(e.data):r(a.a.Unknown)}))}),r,this.requestConfig,(e=>t.updateProgress(e.loaded)),null,t.cancellationToken)}))}fetchAnalyticsForBatch(e,t){return this.swayGet("Sway_Get_Analytics_Request","Sway_Get_Analytics",this.buildUrlForAnalytics(e),t,"json",!0)}swayGet(e,t,i,n,r,a=!1){if(a&&this.cachedResponsePromises.has(i,n))return this.cachedResponsePromises.get(i,n);const o=new Promise(((o,s)=>{const l=Object.assign({},this.requestConfig);l.responseType=r,super.get(e,t,i,(e=>{e.instrument(((e,t)=>{this.instrumentResponse(e.headers,t)})).then(o).catch((e=>{this.globalErrorHandler.handleError(e,"cwHpN")}))}),(e=>{a&&this.cachedResponsePromises.delete(i,n),s(e)}),l,n)}));return a&&this.cachedResponsePromises.set(o,i,n),o}buildUrlForAnalytics(e){const t=encodeURIComponent(e.join(","));return`${this.swayConfig.apiUrl}/api/v1.0/batchanalytics?ids=${t}`}instrumentResponse(e,t){e&&(t.RequestId=e.get("X-CorrelationId"),t.PartnerGeo=e.get("X-OfficeCluster"))}}A.ɵprov=I.kc({factory:function(){return new A(I.lc(y.a),I.lc(b.a),I.lc(c.a),I.lc(u.a),I.lc(m.a),I.lc(v.a),I.lc(T.q),I.lc(r.b),I.lc(C.a),I.lc(p.b),I.lc(o.a),I.lc(f.a),I.lc(l.a),I.lc(S.a))},token:A,providedIn:"root"})},m32Q:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("QjXU"),r=i("e3cR"),a=i("muUJ"),o=i("a3FV"),s=i("CMIS"),l=i("H2Bi"),c=i("WDeU");function u(e){var t,i,u=e.userId,d=e.collectionName,h=e.collectionVersion,p=e.key,m=e.hashKey,f=e.plugins,g=void 0===f?[]:f;return Object(n.__awaiter)(this,void 0,void 0,(function(){var e,f,b,v,S,y,C,w,I,T,k,A;return Object(n.__generator)(this,(function(_){switch(_.label){case 0:return _.trys.push([0,11,,12]),[4,Object(c.a)(u,d,h,p,m)];case 1:return f=n.__read.apply(void 0,[_.sent(),2]),b=f[0],v=f[1],[4,Object(r.c)(b,l.b,v)];case 2:if(!(e=_.sent()))return[2,null];_.label=3;case 3:_.trys.push([3,8,9,10]),S=Object(n.__values)(g),y=S.next(),_.label=4;case 4:return y.done?[3,7]:(C=y.value).onAfterReadValue?[4,C.onAfterReadValue(e,v,{userId:u,collectionName:d,collectionVersion:h})]:[3,6];case 5:e=_.sent(),_.label=6;case 6:return y=S.next(),[3,4];case 7:return[3,10];case 8:return w=_.sent(),T={error:w},[3,10];case 9:try{y&&!y.done&&(k=S.return)&&k.call(S)}finally{if(T)throw T.error}return[7];case 10:return[3,12];case 11:throw I=_.sent(),Object(a.a)(o.a.SimplePersistenceReadError,((A={}).Error="Error reading from "+d+": "+(null===(t=null==I?void 0:I.toString)||void 0===t?void 0:t.call(I)),A)),Object(s.a)({eventName:"Simple_Persistence_Read_Error",errorType:"SimplePersistence_Error",message:"Error reading from "+d+": "+(null===(i=null==I?void 0:I.toString)||void 0===i?void 0:i.call(I))}),I;case 12:return[2,e]}}))}))}},mNaV:function(e,t,i){"use strict";i.d(t,"a",(function(){return N}));var n=i("QjXU"),r=i("Dn7E"),a=i("CMIS"),o=i("6UlS"),s=i("EYJY"),l=i("PxQI"),c=i("WKA6"),u=i("cZRF"),d=i("hhzZ"),h=i("1Hgo"),p=i("7Gwk"),m=i("uzn7"),f=i("casz"),g=i("BMb5"),b=i("4/We"),v=i("cgnd"),S=i("3iMk"),y=i("IA5y"),C=i("dRqz"),w=i("3XMr"),I=i("lrJm"),T=i("R7NL"),k=i("BaAg"),A=i("7ma0"),_=i("kpuN"),P=i("wwmn"),E=i("pOWU"),F=i("/I02"),O=i("uUrA"),D=i("ksTh"),M=i("Mlb/"),R=i("vk2e");class x extends E.a{constructor(e,t,i,n,r,a,o,s,l,c,u){super(e,i,n,"Substrate",t,r,a,l),this.globalErrorHandler=o,this.aadAppId=c,this.edgeworthConfigService=u,this.fetchRequestIndex=0,this.startupConfig=s.config;const d=this.edgeworthConfigService.config;if(d){const e=`top=${d.recentItemsCount}&${D.c}${this.contextService.sharedContext.officeMarket}`;this.endpoint=d.edgeworthS2SRecentEnabled?`${t.sharedContext.officeHomeApiRoot}/api/ew/recent?${e}`:`${d.substrateApiEndpoint}${d.edgeworthApiRootPath}${d.recentApiPath}?${e}`,d.userActionSortOrderEnabled&&(this.endpoint+="&order=UserActions")}}fetchEdgeworthSubstrateRecent(e){return this.cachedResponse||(this.cachedResponse=new Promise(((t,i)=>{const n=O.a.createGuid(),r=this.edgeworthConfigService.config.edgeworthS2SRecentEnabled?Object(y.b)(n):Object(y.a)(`${this.startupConfig.objectId}@${this.startupConfig.tenantId}`,this.contextService.sharedContext.recommendedIceApplicationId.toString(),this.startupConfig.objectId,this.aadAppId,n,this.contextService.getCurrentPageForLogging()),a=e?Array.from(e.values()):[],o=new Set;a.forEach((e=>{const t=this.getRecentAppParam(e);e&&o.add(t)}));const s=o.size?Array.from(o.values()).join(","):"";this.get("EdgeworthSubstrateRecentRequest","EdgeworthSubstrateRecent",s?`${this.endpoint}&apps=${s}`:this.endpoint,(e=>{e.instrument(((e,t)=>{var i;t.ActualSize=((null===(i=null==e?void 0:e.data)||void 0===i?void 0:i.files)?e.data.files.length:-1).toString(),t.RequestId=this.getRequestIdFromResponse(e),t.DebugInfo=Object(y.f)(e),t.Index=(this.fetchRequestIndex++).toString(),t.ImpressionId=!!e.headers&&e.headers.get(D.a)||n})).then((e=>{t({data:this.parse(e.data),impressionId:!!e.headers&&e.headers.get(D.a)||n})})).catch((e=>{this.globalErrorHandler.handleError(e)}))}),i,r,"network-only",null,null,null,this.edgeworthConfigService.config.edgeworthS2SRecentEnabled?"OfficeHome":"Substrate")}))),this.cachedResponse}handleQueryParam(e,t,i){"mockmru"===e&&this.mockRequestHeader&&i.headers.set(this.mockRequestHeader,t)}parse(e){const t=e.files?e.files.map((e=>{const t=e.user_relationship,i=e.activity_badge?Object.assign(Object.assign({},e.activity_badge),{timestamp:Object(y.j)(e.activity_badge.timestamp)}):void 0;return Object.assign(Object.assign({},e),{last_recommended_modified_datetime:e.last_recommended_modified_datetime,last_store_modified_datetime:e.last_store_modified_datetime,user_relationship:Object(y.i)(t),created_datetime:Object(y.j)(e.created_datetime),creation_info:e.creation_info?Object.assign(Object.assign({},e.creation_info),{timestamp:Object(y.j)(e.creation_info.timestamp)}):null,activity_badge:i,indexed:!1,server_last_recommended_modified_datetime:e.last_recommended_modified_datetime,server_last_store_modified_datetime:e.last_recommended_modified_datetime})})):[];return{diagnostics_data:e.diagnostics_data,files:t,is_complete:e.is_complete}}getRecentAppParam(e){switch(e){case k.b.Word:return"Word";case k.b.PowerPoint:return"PowerPoint";case k.b.Excel:return"Excel";case k.b.Video:case k.b.Stream:case k.b.StreamsVideo:return"Video";case k.b.Visio:case k.b.VisioSoftwareWac:case k.b.VisioBusinessWac:case k.b.VisioFlowChartWac:case k.b.VisioGeneralWac:case k.b.VisioNetworkWac:case k.b.VisioStartWac:return"Visio";default:return null}}}x.ɵprov=M.kc({factory:function(){return new x(M.lc(_.a),M.lc(F.a),M.lc(d.a),M.lc(T.a),M.lc(P.a),M.lc(R.q),M.lc(I.b),M.lc(v.b),M.lc(f.a),M.lc(A.a),M.lc(h.a))},token:x,providedIn:"root"});var L=i("S8t+");const U=.001;class N{constructor(e,t,i,n,r,a,u,d,h,p,m,f,g,b){this.capabilitiesService=e,this.clientStartupConfigService=t,this.edgeworthDeltaSyncService=i,this.edgeworthRecentService=n,this.instrumentationService=r,this.windowService=a,this.localStorageService=u,this.edgeworthConfigService=d,this.scheduler=h,this.edgeworthUiTimestampService=p,this.eventService=m,this.ngZone=f,this.encryptionService=g,this.edgeworthLocalFilesService=b,this._allFilesMap=new Map,this._dataSource=new o.a(void 0),this._dataSourceObservable=this._dataSource.asObservable().pipe(Object(l.a)(1)),this._hasFailures=new s.a,this._hasFailuresObservable=this._hasFailures.asObservable().pipe(Object(c.a)(1)),this._isInitialStable=new s.a,this._isInitialStableObservable=this._isInitialStable.asObservable(),this.uiFeatureEnabled=this.capabilitiesService.capabilities.edgeworthEnabled,this.writeInProgress=null,this.writeScheduled=null,this.hasDoneBulkRead=!1,this.isTopCacheReadStable=!1,this.isBulkCacheReadStable=!1,this.isRecentFetchStable=!1,this.isSyncStable=!1,this.isInitialized=!1,this.dateProperties=new Set(["t","useractions_datetime","last_access_datetime","last_modified_datetime","last_shared_datetime","save_for_later_datetime","created_datetime","timestamp","last_action_datetime"]),this.secondaryFilesBuffer=[]}get dataSource(){return this._dataSourceObservable}get hasFailures(){return this._hasFailuresObservable}get isInitialStable(){return this._isInitialStableObservable}doBulkRead(){var e;return Object(n.__awaiter)(this,void 0,void 0,(function*(){if(this.hasDoneBulkRead)return;this.loadLocalDocuments(),this.hasDoneBulkRead=!0;const t={};let i=!1;try{const e=this.windowService.nativeWindow.performance.now(),n=yield this.windowService.nativeWindow.ewIdb.readCache(),r=Math.ceil(this.windowService.nativeWindow.performance.now()-e),a=yield this.convertCacheEntriesToFiles(n);this.updateAllFiles(a,"Cached"),i=a.length>0,i&&(t.State="Succeeded",t.ActualSize=a.length.toString(),t.Latency=r.toString()),this.isBulkCacheReadStable=!0,this.updateIsStable()}catch(n){t.State="Failed",t.Error=(null===(e=null==n?void 0:n.toString)||void 0===e?void 0:e.call(n))||"",i=!0,this.hasDoneBulkRead=!1,this.isBulkCacheReadStable=!0,this.updateIsStable()}i&&Math.random()<U&&(this.instrumentationService.logGenericEvent("EdgeworthBulkCacheRead",t),Object(r.a)({featureName:"Edgeworth",eventName:"EdgeworthBulkCacheRead",params:t}))}))}startPeriodicSync(){this.syncIntervalHandle&&this.clearPeriodicSync(),this.syncIntervalHandle=setInterval((()=>this.syncDocuments()),6e4*this.edgeworthConfigService.config.periodicSyncIntervalInMin)}clearPeriodicSync(){this.syncIntervalHandle&&(clearInterval(this.syncIntervalHandle),this.syncIntervalHandle=void 0)}syncDocuments(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){let e=!1;return this.isSyncStable=!1,this.shouldRebuildClientCache&&this.edgeworthDeltaSyncService.resetTimestamp(),new Promise(((t,i)=>{this.edgeworthDeltaSyncService.syncDocuments().subscribe((t=>{this.updateAllFiles(t.items,"Network"),e=e||t.hasPluginFailures,this.shouldRebuildClientCache&&this.secondaryFilesBuffer.push(...t.items)}),(t=>{e=!0,this._hasFailures.next(!0),this.isSyncStable=!0,this.updateIsStable(),i()}),(()=>Object(n.__awaiter)(this,void 0,void 0,(function*(){this._hasFailures.next(e),this.isSyncStable=!0,this.updateIsStable(),this.shouldRebuildClientCache&&(yield this.rebuildCache());const i=yield this.writeIntoCache();!e&&i&&this.edgeworthDeltaSyncService.markSyncCompleted(),this.scheduler.scheduleWork((()=>{this.detectDuplicateFiles()}),4),t()}))))}))}))}init(e){var t;if(this.isInitialized)return;if(this.shouldRebuildClientCache=!this.isVisitWithinValidTimeWindow(),this.uiFeatureEnabled){const e={};let i=!1;this.localStorageService.getGlobal(this.windowService.nativeWindow.ewPreloadUserIdStorageKey)===this.clientStartupConfigService.config.puid?this.windowService.nativeWindow.ewUserActionsPreloadData.then((e=>this.convertCacheEntriesToFiles(e))).then((t=>{var n;if((null==t?void 0:t.length)>0){this.updateAllFiles(t,"Cached");const r=this.windowService.nativeWindow.ewUserActionsPreloadDuration;e.State="Succeeded",e.ActualSize=t.length.toString(),e.Latency=(null===(n=null==r?void 0:r.toString)||void 0===n?void 0:n.call(r))||"",i=!0}this.isTopCacheReadStable=!0,this.updateIsStable()})).catch((t=>{var n;e.State="Failed",e.Error=(null===(n=null==t?void 0:t.toString)||void 0===n?void 0:n.call(t))||"",i=!0,this.isTopCacheReadStable=!0,this.updateIsStable()})).then((()=>{i&&Math.random()<U&&this.scheduler.scheduleWork((()=>{this.instrumentationService.logGenericEvent("EdgeworthCacheRead",e),Object(r.a)({featureName:"Edgeworth",eventName:"EdgeworthCacheRead",params:e})}),4)})):null===(t=this.windowService.nativeWindow.ewIdb)||void 0===t||t.initDb(this.clientStartupConfigService.config.puid)}const i=this.edgeworthRecentService.fetchEdgeworthSubstrateRecent(e).then((e=>{this.updateAllFiles(e.data.files,"Network"),this.writeIntoCache(!0),this.isRecentFetchStable=!0,this.updateIsStable()}),(e=>{this._hasFailures.next(!0),this.isRecentFetchStable=!0,this.updateIsStable()}));e?i.then((()=>this.syncDocuments())):this.syncDocuments(),this.isInitialized=!0}updateIsStable(){this.isTopCacheReadStable&&this.isBulkCacheReadStable&&this.isRecentFetchStable&&this.isSyncStable&&(this._isInitialStable.next(),this._isInitialStable.complete())}updateAllFiles(e,t){var i,n,r,a,o;for(const t of e){if(t.is_deleted){this._allFilesMap.has(t.id)&&this._allFilesMap.delete(t.id);continue}if(this.shouldIgnore(t))continue;const e=this._allFilesMap.get(t.id),s=Object(y.g)(t),l=null==s?void 0:s.getTime(),c=l?-l:0;if(e){const l=t.activities&&!e.activities||t.subject&&!e.subject||(null===(i=t.user_relationship)||void 0===i?void 0:i.last_shared_by_history)&&!(null===(n=e.user_relationship)||void 0===n?void 0:n.last_shared_by_history),u=t.last_recommended_modified_datetime>e.last_recommended_modified_datetime;let d=t.last_store_modified_datetime>e.last_store_modified_datetime||u||(t.last_recommended_modified_datetime===e.last_recommended_modified_datetime||t.last_store_modified_datetime===e.last_store_modified_datetime)&&l,h=e;const p=null===(r=t.data_source)||void 0===r?void 0:r.includes("Mru"),m=e.meeting_artifacts;if("MeetingObject"===e.type&&(null===(a=t.meeting_artifacts)||void 0===a||a.forEach((e=>{m.find((t=>e.id===t.id))||(m.push(e),d=!0)}))),d){h=Object.assign(Object.assign(Object.assign({},e),t),{useractions_datetime:s,indexed:!1,useractions_datetime_inverse_time_in_ms:c,meeting_artifacts:m}),h.user_relationship.save_for_later_datetime=t.user_relationship.save_for_later_datetime,p||(h.is_pinned=t.is_pinned),this._allFilesMap.set(e.id,h);const i=null===(o=e.meetings)||void 0===o?void 0:o.filter((e=>{var i;return!(null===(i=t.meetings)||void 0===i?void 0:i.includes(e))}));i&&i.forEach((e=>{this._allFilesMap.delete(e)}))}p&&(h.mru_id=h.mru_id||t.mru_id,h.mru_type=h.mru_type||t.mru_type,h.mru_url=h.mru_url||t.mru_url,void 0!==t.is_pinned&&(h.is_pinned=t.is_pinned))}else"Mail"!==t.reference_type&&this._allFilesMap.set(t.id,Object.assign(Object.assign({},t),{indexed:!1,useractions_datetime:s,useractions_datetime_inverse_time_in_ms:c}))}this._dataSource.next({files:Array.from(this._allFilesMap.values()),source:t}),this.eventService.broadcastEvent({name:"edgeworthFilesUpdated",args:[this._allFilesMap.values()]})}writeIntoCache(e=!1){return Object(n.__awaiter)(this,void 0,void 0,(function*(){if(this.uiFeatureEnabled)return this.writeInProgress?(this.writeScheduled||(this.writeScheduled=this.writeInProgress.then((()=>this.writeIntoCache(e)))),this.writeScheduled):(this.writeScheduled=null,this.writeInProgress=new Promise((t=>{this.scheduler.scheduleWork((()=>{(()=>{Object(n.__awaiter)(this,void 0,void 0,(function*(){var i;const n={},a=Array.from(this._allFilesMap.values()).filter((e=>"LocalBridgeFile"!==e.source));let o=!1;try{if(this.encryptionService){const e=yield Promise.all(a.map((e=>new Promise(((t,i)=>{this.scheduler.scheduleWork((()=>{const n=Object.assign(Object.assign({},e),{indexed:!1});this.ngZone.runOutsideAngular((()=>{this.encryptionService.encryptData(n).then((e=>t({id:n.id,useractions_datetime:n.useractions_datetime,useractions_datetime_inverse_time_in_ms:n.useractions_datetime_inverse_time_in_ms,item:e}))).catch(i)}))}),4)})))));yield this.doWriteScheduled(e)}else yield this.doWriteScheduled(a.map((e=>({id:e.id,item:Object.assign(Object.assign({},e),{indexed:!1}),useractions_datetime:e.useractions_datetime,useractions_datetime_inverse_time_in_ms:e.useractions_datetime_inverse_time_in_ms}))));this.localStorageService.setGlobal(this.windowService.nativeWindow.ewPreloadUserIdStorageKey,this.clientStartupConfigService.config.puid),n.State="Succeeded"}catch(t){n.State="Failed",n.Error=(null===(i=null==t?void 0:t.toString)||void 0===i?void 0:i.call(t))||"",n.DebugInfo=`fromDeltaSync:${e}, itemCount:${a.length}`,o=!0}Math.random()<U&&(this.instrumentationService.logGenericEvent("EdgeworthCacheWrite",n),Object(r.a)({featureName:"Edgeworth",eventName:"EdgeworthCacheWrite",params:n})),this.writeInProgress=null,t(!o)}))})()}),4)})),this.writeInProgress)}))}shouldIgnore(e){var t;return!!("Image"===e.type&&Object(y.h)(e)||"ics"===e.extension||"spsite"===e.type||"WebLink"===e.type||"Whiteboard"===e.type||"LocalFile"===e.source&&(!Object(y.e)(Object(y.d)(e))||this.capabilitiesService.capabilities.isPwaInUwp)||"Video"===e.type&&0===(null===(t=e.id)||void 0===t?void 0:t.indexOf("STREAMS")))}doWriteScheduled(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const t=[];Object(S.a)(e,10,(e=>{t.push(new Promise(((t,i)=>{this.scheduler.scheduleWork((()=>{this.ngZone.runOutsideAngular((()=>{this.windowService.nativeWindow.ewIdb?this.windowService.nativeWindow.ewIdb.writeIntoCache(e).then(t).catch(i):i(`Missing ewIdb, db version: ${this.windowService.nativeWindow.ewDbVersion}`)}))}),4)})))})),yield Promise.all(t)}))}convertCacheEntriesToFiles(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return this.ngZone.runOutsideAngular((()=>Promise.all(e.map((e=>this.convertCachedEntry(e))))))}))}convertCachedEntry(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){if(e.item instanceof ArrayBuffer){const t=(e,t)=>this.dateProperties.has(e)?Object(y.j)(t):t;return yield this.encryptionService.decryptData(new Uint8Array(e.item),t)}return e.item}))}isVisitWithinValidTimeWindow(){const e=this.edgeworthUiTimestampService.getLastUiSyncTimestamp();if(!e)return!0;const t=((new Date).getTime()-e.getTime())/864e5<=this.edgeworthConfigService.config.reindexThresholdInDays;return t||(this.instrumentationService.logGenericEvent("EdgeworthRebuildRequired"),Object(r.a)({featureName:"Edgeworth",eventName:"EdgeworthRebuildRequired",params:{},area:"Edgeworth"})),t}rebuildCache(){var e;return Object(n.__awaiter)(this,void 0,void 0,(function*(){yield new Promise((e=>{this.eventService.broadcastEvent({name:"edgeworthRebuildNeeded",args:[e]})}));try{yield null===(e=window.ewIdb)||void 0===e?void 0:e.eraseStore(),this._allFilesMap.clear(),this.updateAllFiles(this.secondaryFilesBuffer,"Network"),this.secondaryFilesBuffer.length=0,this.shouldRebuildClientCache=!1,this.instrumentationService.logGenericEvent("EdgeworthRebuildCompleted"),Object(r.a)({featureName:"Edgeworth",eventName:"EdgeworthRebuildCompleted",params:{},area:"Edgeworth"})}catch(e){this.instrumentationService.logErrorEvent("EdgeworthRebuildError"),Object(a.a)({eventName:"EdgeworthRebuildError",errorType:"Other"})}}))}detectDuplicateFiles(){const e=Array.from(this._allFilesMap.values());let t=0;const i=new Set;if(e.forEach((e=>{const n=e.mru_id;n&&(i.has(n)?t++:i.add(n))})),t>0){const e={ItemCount:t.toString()};this.instrumentationService.logGenericEvent("EdgeworthDuplicateFilesDetected",e),Object(r.a)({featureName:"Edgeworth",eventName:"EdgeworthDuplicateFilesDetected",params:e,area:"Edgeworth"})}}loadLocalDocuments(){this.edgeworthLocalFilesService&&this.edgeworthLocalFilesService.getLocalMru().subscribe((e=>{this.updateAllFiles(e,"HwaLocalBridge")}))}}N.ɵprov=M.kc({factory:function(){return new N(M.lc(b.a),M.lc(v.b),M.lc(w.a),M.lc(x),M.lc(d.a),M.lc(g.b),M.lc(m.a),M.lc(h.a),M.lc(f.a),M.lc(L.a),M.lc(p.a),M.lc(M.F),M.lc(u.a,8),M.lc(C.a,8))},token:N,providedIn:"root"})},mu6k:function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"a",(function(){return s}));var n=i("Mlb/"),r=i("lrJm"),a=(i("W3Zz"),i("hZW2"),i("BMb5"),i("PBJH"),i("24t9"));class o{constructor(e){this.templateRef=e}}class s{constructor(e,t,i,r,a,o,s){this.deviceDetector=e,this.documentService=t,this.changeDetectorRef=i,this.locService=r,this.renderer=a,this.elementRef=o,this.windowService=s,this.leftAlignedCard=!1,this.multiSelect=!1,this.contextAriaLabel="",this.ariaRole="listitem",this.selectItem=new n.q,this.closeMenu=new n.q}ngOnInit(){this.focusActive=!1,this.closeByKey=!1,this.activeIndex=-1,this.menuItemClickHandler=e=>{this.elementRef.nativeElement.contains(e.target)||(this.mobileMenu&&e.preventDefault(),this.close())},this.animationState=this.mobileMenu?"openMobile":"open",this.open=!0,this.destroyed=!1,this.menuAriaLabel=this.locService.format(this.locService.MenuAriaLabel,this.contextAriaLabel),this.selectedIndex>=0&&(this.menuModel.items[this.selectedIndex].ariaChecked=!0),this.mobileMenu&&this.documentService.disableTouchMove()}ngAfterViewInit(){if(1!==this.menuItems.length)throw new r.a("Must have exactly 1 *ohpMenuItemContent in a Menu as a child");this.menuItemTemplate=this.menuItems.first.templateRef,this.changeDetectorRef.detectChanges(),setTimeout((()=>{if(this.deviceDetector.isDesktopDevice()){this.setActiveIndex(0,!0);const e=this.documentService.nativeDocument.activeElement;setTimeout((()=>{const t=e.getBoundingClientRect();t.top+t.height>this.windowService.nativeWindow.innerHeight&&e.scrollIntoView()}),100)}this.destroyed||(this.menuItemClickListener=this.renderer.listen(this.documentService.nativeDocument,"click",this.menuItemClickHandler),this.menuItemTouchListener=this.renderer.listen(this.documentService.nativeDocument,"touchend",this.menuItemClickHandler),this.menuItemContextListener=this.renderer.listen(this.documentService.nativeDocument,"contextmenu",this.menuItemClickHandler),this.menuItemKeyListener=this.renderer.listen(this.documentService.nativeDocument,"keydown",(e=>{3===a.a.getKey(e)&&this.close(!0)})))}),0)}ngOnDestroy(){this.destroyed=!0,this.menuItemClickListener&&this.menuItemClickListener(),this.menuItemTouchListener&&this.menuItemTouchListener(),this.menuItemContextListener&&this.menuItemContextListener(),this.menuItemKeyListener&&this.menuItemKeyListener(),this.documentService.enableTouchMove()}onAnimationCompleted(e){"closing"===e.toState&&this.completeClose()}onSelectItem(e,t,i){if(this.menuModel.announceItemIsSelected)if("radio"===this.ariaRole||"menuitemcheckbox"===this.ariaRole)if(this.multiSelect){const t=this.menuModel.items.find((t=>e.getId()===t.getId()));t.ariaChecked=!t.ariaChecked}else this.menuModel.items.forEach((t=>t.ariaChecked=e.getId()===t.getId()));else this.menuModel.items.forEach((t=>t.ariaSelected=e.getId()===t.getId()));this.selectItem.emit({item:e,index:t,nativeDomEvent:i}),i.preventDefault(),this.multiSelect||this.close()}close(e=!1){if(!this.closed){if(this.closed=!0,this.closeByKey=e,this.animateClose)return void(this.animationState="closing");this.completeClose()}}handleKey(e){const t=a.a.getKey(e);if(-1===s.expectedKeys.indexOf(t))return;if(e.preventDefault(),2===t&&this.activeIndex>=0)return void this.onSelectItem(this.menuModel.items[this.activeIndex],this.activeIndex,e);const i=this.menuModel.items.length-1;switch(t){case 1:case 3:this.close(!0);break;case 4:this.focusActive=!0,this.setActiveIndex(this.activeIndex>0?this.activeIndex-1:i);break;case 5:this.focusActive=!0,this.setActiveIndex((this.activeIndex+1)%(i+1))}}setActiveIndex(e,t){if(t&&(this.focusActive=!0),this.activeIndex=e,this.focusActive){const t=this.dropdownItems.find((t=>t.nativeElement.id===this.getIdForItem(this.menuModel.items[e])));t&&t.nativeElement.focus()}}getIdForItem(e){return`${this.menuModel.id}-item--${e.getId()}`}trackById(e,t){return t.getId()}completeClose(){this.open=!1,this.documentService.enableTouchMove(),this.closeMenu.emit(this.closeByKey),this.closeByKey=!1}}s.expectedKeys=[1,2,3,4,5]},muUJ:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("8/lW"),r=i("a3FV"),a=i("4CZh");function o(e,t,i,o){void 0===t&&(t={}),void 0===i&&(i=[]),void 0===o&&(o=n.a.Security),Object(a.b)(e,r.a.AppError,o,t,i,!0)}},n826:function(e,t,i){"use strict";i.d(t,"a",(function(){return k}));var n=i("WKA6"),r=i("lrJm"),a=i("3GGT"),o=i("hhzZ"),s=i("R7NL"),l=i("BaAg"),c=i("4/We"),u=i("/I02"),d=i("ZBli"),h=i("pjz5"),p=i("kpuN"),m=i("oAX+"),f=i("uzn7"),g=i("Mlb/");class b{constructor(e,t){this.storageService=e,this.capabilitiesService=t}makeRequest(e,t,i,n,r,a){if(this.capabilitiesService.capabilities.limitNetworkRequests&&t){const o=this.getKey(e),s=this.storageService.get(o);let l=!0;s&&s+1e3*t>=Date.now()&&(l=!1);const c=()=>{this.storageService.set(o,Date.now())};if(l){const e=n().then((e=>(e&&c(),e)));return m.a.createResultsWithCacheObservable(i(),e,r,a)}return m.a.createResultsCacheFirstObservable(i,n,c,r,a)}return m.a.createResultsWithCacheObservable(i(),n(),r,a)}getKey(e){return`network_ts_${e}`}}b.ɵprov=g.kc({factory:function(){return new b(g.lc(f.a),g.lc(c.a))},token:b,providedIn:"root"});var v=i("pd4Y"),S=i("aQ3G"),y=i("wwmn"),C=(i("Dpxn"),i("casz")),w=i("Brer"),I=i("pOWU"),T=i("vk2e");class k extends S.a{constructor(e,t,i,n,r,a,o,s,l,c,u,d){super(t,i,n,r,a,o,s,u),this.capabilitiesService=e,this.dateService=l,this.vroomService=c,this.cachedRequestService=d,t.reauthComplete.subscribe((()=>{this.myDriveRootAuthErrorCached&&(this.myDriveRootUrlStream=null,this.myDriveRootUrlPromise=null)}))}getItemWithIds(e,t,i,n,r,a=!1,o=!1){const s=this.getItemLocation(e,t),l=i?`?$select=${i}`:"",c=this.inMockMode?`${s}?currentDate=${this.dateService.getCurrentDateMinuteGranularity().toISOString()}`:`${s}${l}`;return this.getOneDriveItem("OneDrive_Graph_Item_Request","OneDrive_Graph_Item",c,n,r,a,null,o)}getMyDriveRootUrl(e=0){if(!this.capabilitiesService.capabilities.oneDriveApisEnabled)return Promise.resolve(null);if(!this.myDriveRootUrlPromise){const t=new Promise(((t,i)=>{const r=this.getMyDriveRootUrlStream(e);r.results.pipe(Object(n.a)(1)).toPromise().then((e=>{e&&e.userRoot?t(e):i("No/Incomplete data returned.")})),r.initialCompletion.then((e=>{e&&(this.globalErrorHandler.handleCacheObservableError(e,"Evsnp","SiCWx"),e.cacheError&&e.networkError&&i(e))}))}));this.myDriveRootAuthErrorCached=!1,this.myDriveRootUrlPromise=t}return this.myDriveRootUrlPromise}getMyDriveRootUrlStream(e=0){if(this.myDriveRootUrlStream)return this.myDriveRootUrlStream;const t=this.cachedRequestService.makeRequest("my-drive-root",this.contextService.sharedContext.graphApiRootRefreshIntervalInSeconds,(()=>this.getMyDriveRootUrlInternal("cache-only",e)),(()=>this.getMyDriveRootUrlInternal("network-first",e)),null,(e=>{e&&e.httpResponse&&(401===e.httpResponse.status||e.httpResponse.status===a.a.TokenUnavailable&&"CAP_Error"===e.httpResponse.data)?this.myDriveRootAuthErrorCached=!0:(this.myDriveRootUrlStream=null,this.myDriveRootUrlPromise=null)}));return this.myDriveRootAuthErrorCached=!1,this.myDriveRootUrlStream=t,this.myDriveRootUrlStream}getSiteTitle(e){const t=`${k.sitesEndpoint}${e}`;return this.getGraph("Get_Site_Title_Request","Get_Site_Title",t,"cache-only",null,!0,null,null,null,!1,"json",0).then((e=>{var t;return null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.displayName})).catch((()=>this.getGraph("Get_Site_Title_Request","Get_Site_Title",t,"network-first",null,!0,null,null,null,!1,"json",0).then((e=>{var t;return null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.displayName}))))}getFileListingVersions(e){return this.getGraph("File_Version_List_Fetch","File_Version_List_Fetch",e,"network-only").then((e=>e.data.value))}getSharedItemWithThumbnail(e,t,i,n,r,a=!1,o=0){return this.getSharedItemWithParams(e,t,i,w.a.getItemParams(["id","sharepointIds","parentReference","createdDateTime"],r,!0),n,a,o)}getSharedItemWithoutThumbnail(e,t,i,n,r,a="open",o=!1,s=0){return this.getSharedItemWithParams(e,t,i,w.a.getItemParams(["id","sharepointIds","parentReference","createdDateTime"],r,!1,"",a),n,o,s)}getSharedItemWithThumbnailAndIds(e,t,i,n,r,a=!1,o=0){return this.getSharedItemWithParams(e,t,i,w.a.getItemParams(["sharepointIds"],r,!0),n,a,o)}getItemWithWacDataAndThumbnails(e,t,i=!1,n=0){const r=this.getItemLocation(e.driveId,e.docId),a=w.a.getItemParams([],!0,!0);return this.getOneDriveItem("OneDrive_Graph_Item_With_Wac_Data_And_Thumb_Request","OneDrive_Graph_Item_With_Wac_Data_And_Thumb",`${r}?${a}`,t,null,null,n,i)}getItemWithWacData(e,t,i,n,r="open",a=!1,o=0){const s=this.getItemLocation(t,i),l=w.a.getItemParams([],!0,!1,"",r);return this.getOneDriveItem("OneDrive_Graph_Item_With_Wac_Data_Request","OneDrive_Graph_Item_With_Wac_Data",`${s}?${l}`,n,null,null,o,a)}getThumbnailsForItem(e,t,i,n=0){const r=`${this.getItemLocation(e,t)}/thumbnails`;return"network-first"===i?this.getThumbnails("OneDrive_Graph_Thumbnail_Request","OneDrive_Graph_Thumbnail",r,"cache-only",n).catch((()=>this.getThumbnails("OneDrive_Graph_Thumbnail_Request","OneDrive_Graph_Thumbnail",r,"network-first",n))):this.getThumbnails("OneDrive_Graph_Thumbnail_Request","OneDrive_Graph_Thumbnail",r,i,n)}getThumbnailString(e){const t=new FileReader;return new Promise(((i,n)=>{this.getGraph("OneDrive_Graph_Thumbnail_String_Request","OneDrive_Graph_Thumbnail_String",e,"network-only",((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)}),!0,null,null,null,!1,"blob",0).then((e=>{if(e&&e.status&&406===e.status){const t={};t.RequestId=this.getRequestIdFromResponse(e),t.HttpCode=e.status.toString(),t.DebugInfo=null==e.statusText?"":e.statusText,this.instrumentationService.logDebugCacheEvent("OneDrive_Graph_Thumbnail_String_Request",t)}e&&e.data?(t.onloadend=()=>{const e=t.result&&"string"==typeof t.result&&t.result||"";e.length>0?i(e):n()},t.onerror=n,t.onabort=n,t.readAsDataURL(e.data)):n()})).catch((e=>{this.globalErrorHandler.handleError(e,"AfEUN"),n()}))}))}createNewFile(e,t,i=!1){const n=`${k.myDriveEndpoint}root/children?select=webDavUrl,${i?"openwith,":""}*`,r={name:e,file:{},"@microsoft.graph.conflictBehavior":"rename"},o=new Map([["accept","application/json"],["Prefer","allow-zerobyte"],["application","officehome"]]);return new Promise(((e,i)=>{this.postGraph("OneDrive_Graph_Create_File_Request","OneDrive_Graph_Create_File",n,r,(t=>{t.instrument(((e,t)=>{if(t.RequestId=this.getRequestIdFromResponse(e),e.ok){const i=e.data;i&&i.id&&i.webUrl||(t.HttpCode=a.a.UnexpectedResponse.toString())}})).then((t=>{const n=t.data;n&&n.id&&n.webUrl?e(n):i(new I.b(t,"Could not parse drive item from Graph response"))})).catch((e=>{this.globalErrorHandler.handleError(e,"MCFQq")}))}),(e=>{e&&e.httpResponse?i(e.httpResponse.data?{error:{code:`${e.httpResponse.status}`,data:`${e.httpResponse.data}`}}:{error:{code:`${e.httpResponse.status}`}}):i()}),null,null,null,null,!1,!0,{category:"CreateFile",fileType:t},o)}))}renameFile(e,t,i){let n;n=i?this.getItemLocation(i,t):`${k.myDriveEndpoint}items/${t}`;const r={name:e},o=this.getRequestConfig();return o.headers.set("Content-Type","application/json"),new Promise(((e,t)=>{this.patchGraph("Document_Title_Rename_File","Document_Title_Rename_File",n,JSON.stringify(r),(i=>{i.instrument(((e,t)=>{if(t.RequestId=this.getRequestIdFromResponse(e),e.ok){const i=e.data;i&&i.id&&i.webUrl||(t.HttpCode=a.a.UnexpectedResponse.toString())}})).then((i=>{const n=i.data;n&&n.id&&n.webUrl?e(n):t(new I.b(i,"Could not parse drive item from Graph response"))}))}),(e=>{e&&e.httpResponse?t(e.httpResponse.data?{error:{code:`${e.httpResponse.status}`,data:`${e.httpResponse.data}`}}:{error:{code:`${e.httpResponse.status}`}}):t()}),o,null,null,null,null,void 0,null)}))}getDownloadUrl(e){return e&&e.itemId&&e.driveId?this.getItemWithIds(e.driveId,e.itemId,"id,content.downloadUrl","network-only").then((e=>e["@microsoft.graph.downloadUrl"]?d.a.removeQueryParams(e["@microsoft.graph.downloadUrl"],["tempAuth","ApiVersion"],!1):Promise.reject("Missing downloadUrl"))):Promise.reject("Invalid params")}uploadFile(e,t,i,n,r,a,o){return new Promise(((s,l)=>{e&&e.name||l(new I.b(null,"Invalid file"));const c=`${this.vroomService.getUploadLocation(k.myDriveEndpoint,e,i,n)}content?@microsoft.graph.conflictBehavior=rename&select=webDavUrl,*`;this.putGraph("OneDrive_Graph_Upload_File_Request","OneDrive_Graph_Upload_File",c,e,(i=>{i.instrument(((i,n)=>this.vroomService.instrumentUploadResponse(i,n,e,t))).then((e=>{const t=e.data;t&&t.id?s(t):l(new I.b(e,"Could not parse drive item from Graph response"))})).catch((e=>{this.globalErrorHandler.handleError(e,"NWgrO")}))}),l,r,null,a,o)}))}createUploadSession(e,t,i,n,r){return new Promise(((a,o)=>{e&&e.name||o(new I.b(null,"Invalid file"));const s=`${this.vroomService.getUploadLocation(k.myDriveEndpoint,e,i,n)}createUploadSession`;this.postGraph("OneDrive_Graph_Create_Upload_Session_Request","OneDrive_Graph_Create_Upload_Session",s,{item:{"@microsoft.graph.conflictBehavior":"rename"}},(i=>{i.instrument(((i,n)=>{if(this.vroomService.instrumentUploadResponse(i,n,e,t),i.ok){const e=i.data;n.Length=e&&e.uploadUrl?e.uploadUrl.length.toString():"0"}})).then((e=>{const t=e.data;t&&t.uploadUrl?a(t):o(new I.b(e,"Could not parse upload session from Graph response"))})).catch((e=>{this.globalErrorHandler.handleError(e,"Nt3wB")}))}),o,null,null,r)}))}cancelUploadSession(e,t,i){return this.vroomService.cancelUploadSessionInternal(e,t,i,"Graph")}uploadFragment(e,t,i,n,r,a,o,s,l){return this.vroomService.uploadFragment(e,t,i,n,r,a,o,s,l)}getUploadSessionStatus(e,t,i){return this.vroomService.getUploadSessionStatusInternal(e,t,i,"Graph")}getMyDriveRoot(e,t=0){return this.getMyDriveItem("root",e,t)}isRetriableError(e){return e===a.a.Throttled}handleQueryParam(e,t,i){super.handleQueryParam(e,t,i),"mockonedrive"===e&&this.mockRequestHeader&&(null==i||i.headers.set(this.mockRequestHeader,t))}getSharedItemWithParams(e,t,i,n,r,a=!1,s=0){return new Promise(((c,u)=>{const d=this.vroomService.getSharesUrl(e);if(!d)return void u(new I.b(null,"Unable to parse share id"));const p=this.inMockMode?`shares?itemUrl=${encodeURIComponent(d)}&currentDate=${this.dateService.getCurrentDateMinuteGranularity().toISOString()}`:`${d}${n?"?"+n:""}`,m=n.includes("openwith");this.getOneDriveItem(m?"OneDrive_Graph_Shares_With_Wac_Data_Request":"OneDrive_Graph_Shares_Request",m?"OneDrive_Graph_Shares_With_Wac_Data":"OneDrive_Graph_Shares",p,r,((n,r)=>{if(n.ok){const e=n.data,t=e?e.thumbnails:null;r.ItemCount=(t?t.length:0).toString()}const a=h.a.getLocation(e);if(a&&a.protocol&&a.host){const e=`${a.protocol}//${a.host}`;r.ResourceUrl=new o.d(e),r.ItemIsShared=(!(e===this.contextService.sharedContext.sharePointResourceId||e===this.contextService.sharedContext.oneDriveResourceId)).toString()}r.ItemCategory=l.a.referralFromFileLocation(e),r.DocumentType=l.b[t],i&&(r.FileFormat=i)}),!1,s,a).then(c,u)}))}getItemLocation(e,t){return`${k.drivesEndpoint}${encodeURIComponent(e)}/items/${encodeURIComponent(t)}`}getMyDriveItem(e,t,i){return this.getOneDriveItem("OneDrive_Graph_Item_Request","OneDrive_Graph_Item",`${k.myDriveEndpoint}${e}`,t,null,!1,i)}getOneDriveItem(e,t,i,n,r,a=!1,o=0,s=!1){return this.getGraph(e,t,i,n,((e,t)=>{r&&r(e,t)}),!0,null,null,null,a,"json",o,s).then((e=>e.data))}getThumbnails(e,t,i,n,r=0){const a=this.inMockMode?`thumbnails?itemUrl=${encodeURIComponent(i)}`:i;return this.getGraph(e,t,a,n,((e,t)=>{if(e.ok){const i=e.data,n=(i&&i.value?i.value.length:0).toString();t.ItemCount=n}}),!0,null,null,null,!1,"json",r).then((e=>e.data))}getMyDriveRootUrlInternal(e,t){return this.getMyDriveRoot(e,t).then((t=>this.vroomService.getRootUrlsFromRootItem(t,e)))}}k.myDriveEndpoint="me/drive/",k.drivesEndpoint="drives/",k.sitesEndpoint="sites/",k.itemsEndpoint="items/",k.ɵprov=g.kc({factory:function(){return new k(g.lc(c.a),g.lc(p.a),g.lc(o.a),g.lc(s.a),g.lc(u.a),g.lc(y.a),g.lc(T.q),g.lc(r.b),g.lc(v.a),g.lc(w.a),g.lc(C.a),g.lc(b))},token:k,providedIn:"root"})},o2Lt:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r})),i.d(t,"c",(function(){return a}));const n="/Pages/MobileDesignPage.aspx",r="/Pages/DesignPage.aspx",a="/Pages/DesignPageV2.aspx"},"oAX+":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("GAcG"),r=i("L0Zr"),a=i("PxQI");class o{static createResultsWithCacheObservable(e,t,i,o,s){let l;const c=new Promise((i=>{l=n.a.create((n=>{let r=null,a=!1,l=null,c=!1,u=!1;const d=()=>{s&&l&&r&&n.next(s),i(l||r?{cacheError:l,networkError:r}:null),n.complete()};e&&e.then((e=>{u=!0,e&&e instanceof Object&&void 0===e.fromCache&&(e.fromCache=!0),n.next(e),a&&d()})).catch((e=>{l=e,c=!0,a&&d()})),t&&t.then((e=>{e&&e instanceof Object&&void 0===e.fromCache&&(e.fromCache=!1),n.next(e),d()})).catch((e=>{r=e,a=!0,o&&o(e),(u||c)&&d()}))}))}));return i&&(l=l.pipe(Object(r.a)(i))),l=l.pipe(Object(a.a)(1)),{results:l,initialCompletion:c}}static createResultsCacheFirstObservable(e,t,i,o,s){let l;const c=new Promise((r=>{l=n.a.create((n=>{let a=null,o=null;const l=()=>{r(o||a?{cacheError:o,networkError:a}:null),n.complete()};e&&e().then((e=>{e&&e instanceof Object&&void 0===e.fromCache&&(e.fromCache=!0),n.next(e),l()})).catch((e=>{o=e,t().then((e=>{e&&e instanceof Object&&void 0===e.fromCache&&(e.fromCache=!1),i(),n.next(e),l()})).catch((e=>{a=e,s&&s(e),l()}))}))}))}));return o&&(l=l.pipe(Object(r.a)(o))),l=l.pipe(Object(a.a)(1)),{results:l,initialCompletion:c}}}},oKW8:function(e,t,i){"use strict";function n(){return new Date}i.d(t,"a",(function(){return n}))},p6Zr:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}n.Calendar="Calendar",n.Excel="ExcelOnline",n.Forms="OfficeForms",n.Mail="Mail",n.OneDrive="Documents",n.OneNote="OneNoteOnline",n.PowerPoint="PowerPointOnline",n.Project="Project",n.SharePoint="Sites",n.Skype="Skype",n.Sway="Sway",n.Visio="VisioOnline",n.Word="WordOnline",n.PowerBI="PowerBIv2"},p6gk:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var n=i("GAcG"),r=i("lrJm"),a=i("hhzZ"),o=i("R7NL"),s=i("BaAg"),l=i("/I02"),c=i("oAX+"),u=i("kpuN"),d=i("aQ3G"),h=i("wwmn"),p=i("casz"),m=i("pOWU"),f=i("Mlb/"),g=i("vk2e");class b extends d.a{constructor(e,t,i,n,r,a,o,s){super(e,t,i,n,r,a,o,s)}createNewNotebook(e){const t=`${b.myOneNoteEndpoint}notebooks`,i={displayName:e};return new Promise(((e,n)=>{this.postGraph("OneNote_Graph_Create_NoteBook_Request","OneNote_Graph_Create_NoteBook",t,i,(t=>{t.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((t=>{const i=t.data;i&&i.links&&i.links.oneNoteWebUrl?e(i):n(new m.b(t,"Could not parse notebook item from Graph response"))})).catch((e=>{this.globalErrorHandler.handleError(e,"vFlcr")}))}),(e=>{e&&e.httpResponse?n(e.httpResponse.data?{error:{code:`${e.httpResponse.status}`,data:`${e.httpResponse.data}`}}:{error:{code:`${e.httpResponse.status}`}}):n()}),null,null,null,null,null,!0,{category:"CreateFile",fileType:s.b.OneNote})}))}getNoteBooks(e){if("stale-while-revalidate"===e){const e=this.fetchNoteBooks("cache-only"),t=this.fetchNoteBooks("network-first");return c.a.createResultsWithCacheObservable(e,t)}return"cache-first-network-onmiss"===e?{results:n.a.create((e=>{this.fetchNoteBooks("cache-only").then((t=>{e.next(t),e.complete()})).catch((()=>{this.fetchNoteBooks("network-first").then((t=>{e.next(t),e.complete()}))}))})),initialCompletion:null}:{results:n.a.create((t=>{this.fetchNoteBooks(e).then((e=>{t.next(e),t.complete()}))})),initialCompletion:null}}fetchNoteBooks(e){return this.getGraph("OneNote_Graph_Get_NoteBooks_Request","OneNote_Graph_Get_NoteBooks",`${b.myOneNoteEndpoint}notebooks?orderby=lastModifiedTime%20desc`,e,((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((e=>Object.assign(e.data,{fromCache:e.fromCache})))}handleQueryParam(e,t){"mockgetnotebooks"===e&&this.mockRequestHeader&&this.requestConfig.headers.set(this.mockRequestHeader,t)}}b.myOneNoteEndpoint="me/onenote/",b.ɵprov=f.kc({factory:function(){return new b(f.lc(u.a),f.lc(a.a),f.lc(o.a),f.lc(l.a),f.lc(h.a),f.lc(g.q),f.lc(r.b),f.lc(p.a))},token:b,providedIn:"root"})},p6wn:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("rTyw"),r=i("lrJm"),a=i("BaAg"),o=(i("AXqk"),i("W3Zz")),s=i("Uqr9"),l=i("hhzZ");class c{constructor(e,t,i,n,r){this.instrumentationService=e,this.streamName=t,this.params=i,this.metrics=n,this.securityThreshold=r}record(){this.instrumentationService.recordEvent(this)}}class u{constructor(e,t,i){this.queuedEvents=e,this.dataSecurityService=t,this.deviceDetector=i,this.registeredEventFactories=[],this.initialPage="Unknown",this.serviceWorkerStateService=null,this.lastPageNav={time:0,from:void 0,to:void 0}}registerServiceWorkerStateService(e,t){if(this.serviceWorkerStateService)throw new r.a("DispatcherInstrumentationService.registerServiceWorkerStateService is not allowed to be called more than once");if(!e)throw new r.a("Must specify valid ServiceWorkerStateService when calling DispatcherInstrumentationService.registerServiceWorkerStateService");this.serviceWorkerStateService=e,t&&this.queuedEvents.forEach((e=>e.eventParams.ServiceWorkerState=this.serviceWorkerStateService.currentState))}registerOfficeRouteService(e){if(this.routeSubscriptionInitialized)throw new r.a("DispatcherInstrumentationService.registerOfficeRouteService is not allowed to be called more than once");if(!e)throw new r.a("Must specify valid OfficeRouteService when calling DispatcherInstrumentationService.registerOfficeRouteService");this.routeSubscriptionInitialized=!0,e.subscribeToRouteChangeStart((e=>{const t=!!e.currentRoute&&!!e.currentRoute.route,i=t?`${e.currentRoute.app?a.b[e.currentRoute.app]:""}${e.currentRoute.route}`:"Unknown";this.lastPageNav={time:s.a.now(),from:this.lastPageNav.to,to:i},"Unknown"===this.initialPage&&"Unknown"!==i&&(this.initialPage=i),!this.queuedEventsPopulatedWithRoute&&t&&(this.queuedEvents.forEach((e=>e.eventParams.Page=i)),this.queuedEvents.forEach((e=>e.eventParams.InitialPage=this.initialPage)),this.queuedEventsPopulatedWithRoute=!0)}))}registerEventFactories(e){if(this.registeredEventFactories.length>0)throw new r.a("DispatcherInstrumentationService.registerEventFactories is not allowed to be called more than once");if(!e||0===e.length)throw new r.a("Must specify at least one event factory when calling DispatcherInstrumentationService.registerEventFactories");this.registeredEventFactories=e.slice(),this.drainQueuedEvents()}logGenericEvent(e,t={},i=[],n=0){this.generateEvent(e,"Generic_Event",n,t,i,!0)}logImpressionEvent(e,t={},i=[],n=0){this.generateEvent(e,"Generic_Impression",n,t,i,!0)}logRequestEvent(e,t,i,n,r=!1,a={},o=[],s=0){this.generateRequestEvent(e,t,i,n,r,a,o,s).record()}logClickEvent(e,t,i,r,a,o={},l=[],c=0,d=!1){if(l=l||[],i&&t&&"Unknown"!==t&&l.push(`${e}.${i}.${t}`),o.ElementId=t,r){const e=Object(n.a)(r);o.Referral=e,l.push(`Referral.${e}`),o.ReferralPlatform=a&&this.dataSecurityService.securityLevel>=2?a:"Web"}i&&(o.Area=i),d&&this.lastPageNav&&this.lastPageNav.from&&s.a.now()-this.lastPageNav.time<u.lastPageNavTimeout&&(o.Page=this.lastPageNav.from),this.generateEvent(e,"Generic_Click",c,o,l,!0)}logErrorEvent(e,t={},i=[],n=0){this.generateEvent(e,"App_Error",n,t,i,!0)}logPerformanceEvent(e,t,i={},n=0){return i.Latency=t.toString(),this.generateEvent(e,"Performance_Dump",n,i,[],!0)}logDebugCacheEvent(e,t={},i=[],n=0){return this.generateEvent(e,"Generic_Debug_Cache_2",n,t,i,!0)}applyGlobalStateParams(e,t){window.prelaunchMode&&(e.PrelaunchMode="true"),!t&&e.hasOwnProperty("Page")||(e.Page=this.lastPageNav.to||"Unknown"),!t&&e.hasOwnProperty("InitialPage")||(e.InitialPage=this.initialPage),!t&&e.hasOwnProperty("ServiceWorkerState")||(e.ServiceWorkerState=this.serviceWorkerStateService?this.serviceWorkerStateService.currentState:"Unknown"),!t&&e.hasOwnProperty("AppSecurityLevel")||(e.AppSecurityLevel=this.dataSecurityService.securityLevel.toString()),!t&&e.hasOwnProperty("NetworkType")||(e.NetworkType=o.c[this.deviceDetector.getNetworkInfo()]),window.hostSessionId&&(e.HostSessionId=window.hostSessionId),window.ringId&&(e.Ring=window.ringId)}flush(){this.drainQueuedEvents(),this.registeredEventFactories.forEach((e=>e.flush()))}recordEvent(e){const t=e&&e.params&&(e.params.EventName&&e.params.EventName.indexOf("Error")>-1||e.params.Error&&"OK"!==e.params.Error);this.dataSecurityService.securityLevel<e.securityThreshold||window.disableLogs&&!t||(this.registeredEventFactories.length>0?this.registeredEventFactories.forEach((t=>t.createEvent(e.streamName,e.params,e.metrics).record())):this.queuedEvents.push({streamName:e.streamName,eventName:e.params.EventName,eventParams:e.params,metrics:e.metrics,securityThreshold:e.securityThreshold}))}generateEvent(e,t,i,n,r=[],a=!1){n.EventName=e,this.applyGlobalStateParams(n,!1);const o=n&&n.Error;o&&"string"==typeof o&&(n.Error=l.a.filterPii(o));const s=n&&n.DebugInfo;s&&"string"==typeof s&&(n.DebugInfo=l.a.filterPii(s)),"Performance_Dump"===t&&void 0!==window.startedFromServiceWorker&&(n.CachedPage=window.startedFromServiceWorker.toString()),"Generic_Click"===t&&(n.ReportingEnabled=window.isMetricsReportingEnabled?window.isMetricsReportingEnabled.toString():"false");const u=new c(this,t,n,r,i);return a&&u.record(),u}generateRequestEvent(e,t,i,n,r=!1,a={},o=[],s=0){return a.HttpCode=t.toString(),a.Latency=i.toString(),a.FromServiceWorkerCache=r.toString(),n&&(a.Error=n),this.generateEvent(e,"Generic_Request",s,a,o)}drainQueuedEvents(){this.queuedEvents&&this.queuedEvents.splice(0,this.queuedEvents.length).forEach((e=>{this.generateEvent(e.eventName,e.streamName,e.securityThreshold,e.eventParams||{},e.metrics,!0)}))}}u.lastPageNavTimeout=1e3},pM41:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("TfV2"),r=i("ZBSS"),a=i("GMuP"),o=i("Cin9");function s(e,t){void 0===t&&(t=n.a.Security),Object(o.a)({eventName:e.eventName,latency:e.latency},t),e.instrumentationParams&&Object.keys(e.instrumentationParams).length>0&&(e.instrumentationParams[r.S]=e.latency,Object(a.a)({eventName:e.eventName,params:e.instrumentationParams,area:e.area,subArea:e.subArea},t))}},pOWU:function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"a",(function(){return s}));var n=i("tyUq"),r=i("3GGT"),a=i("pjz5");class o{constructor(e,t){this.httpResponse=e,this.clientError=t}}class s{constructor(e,t,i,n,r,o,s,l,c=""){this.accessTokenService=e,this.instrumentationService=t,this.instrumentedHttp=i,this.tokenConsumer=n,this.contextService=r,this.officeHomeApiConfigService=o,this.scheduler=l,this.rpsCompactAuthHeaderPrefix=c,this.retryIntervalsInMs=[0,11,22,33],this.inMockMode=r.sharedContext.inMockMode,this.mockRequestHeader=o.config.mockRequestHeader,this.queryParams=a.a.getQueryParams(s.search)}static getErrorTypeFromServiceError(e){switch(e&&e.httpResponse&&e.httpResponse.status){case r.a.OK:case r.a.Created:case r.a.NoContent:return"None";case r.a.Unauthorized:case r.a.Forbidden:case r.a.TokenRefreshFailed:case r.a.TokenUnavailable:return"Unauthorized";case r.a.NotFound:return"NotFound";case r.a.RequestTimeout:case r.a.GatewayTimeout:case r.a.Timeout:return"Timeout";case r.a.Offline:return"Offline"}return"Generic"}handleQueryParam(e,t,i){}get(e,t,i,n,r,a,o,s,l,c,u,d,h=0){"cache-only"===o&&(u="None"),this.scheduler.scheduleWork((()=>this.request((n=>this.instrumentedHttp.get(e,t,i,n,o,s,l,c)),e,t,n,r,a,u,d,null,"cache-only"===o)),h)}getFromCache(e,t,i,n,r,a={}){this.get(e,t,i,n,r,a,"cache-only",null,null,null,"None")}post(e,t,i,n,r,a,o={},s,l,c,u,d,h,p,m,f=!1,g=null,b=0){"cache-only"===m&&(d="None"),this.scheduler.scheduleWork((()=>this.request((r=>this.instrumentedHttp.post(e,t,i,n,r,s,l,c,u,m)),e,t,r,a,o,d,h,p,!1,f,g)),b)}put(e,t,i,n,r,a,o={},s,l,c,u,d,h){this.request((r=>this.instrumentedHttp.put(e,t,i,n,r,s,l,c,u)),e,t,r,a,o,d,h)}delete(e,t,i,n,r,a,o={},s,l,c,u){this.request((r=>this.instrumentedHttp.delete(e,t,i,n,r,s,l)),e,t,r,a,o,c,u)}patch(e,t,i,n,r,a,o={},s,l,c,u,d,h){this.request((r=>this.instrumentedHttp.patch(e,t,i,n,r,s,l,c,u)),e,t,r,a,o,d,h)}isAuthError(e,t){return 401===e||403===e&&"OfficeHome"===t&&this.officeHomeApiConfigService.config.jwtAuthEnabled}isRetriableError(e){return!1}getRetryInterval(){const e=Math.floor(1e3*Math.random())%this.retryIntervalsInMs.length;return this.retryIntervalsInMs[e]}getRequestIdFromResponse(e,t="request-id"){return this.getHeaderValue(e.headers,t)}getHeaderValue(e,t){return e&&t&&e.get(t)}updateRequestConfig(e,t,i){t&&t.success&&e&&(this.setAuthHeader(e.headers,t),i&&i(e,t))}setAuthHeader(e,t){t&&e.set("Authorization",`${"RPSCompact"===t.format?this.rpsCompactAuthHeaderPrefix:"Bearer "}${t.token}`.trim())}request(e,t,i,n,a,s={},l,c,u,d=!1,h=!1,p=null){const m=void 0===l?this.tokenConsumer:l,f="OfficeHome"===m,g=this.officeHomeApiConfigService.config,b="None"===m||f&&!g.jwtAuthEnabled,v=e=>{const n=e.status;let s=Number.NaN;!b&&this.isAuthError(n,m)?s=r.a.TokenRefreshFailed:this.isRetriableError(n)&&(s=r.a.RetryFailed),s!==Number.NaN&&this.logCustomError(t,i,s,d),a(new o(e))},S=(t,i=0)=>{setTimeout((()=>{const i=e(t);n(i),i.catch(v)}),i||this.getRetryInterval())};for(const e in this.queryParams)if(e&&this.queryParams.hasOwnProperty(e)){const t=this.queryParams[e];this.handleQueryParam(e.toLowerCase(),t,s)}s.headers||(s.headers=new Map),(b?Promise.resolve(null):this.accessTokenService.getAccessToken(m,!1,c,h,p)).then((l=>{var y,C,w;if(!b){if(!(l&&l.success||f&&g.jwtAuthEnabled&&g.jwtAuthOnOfficeHome)){const e=null!==(C=null===(y=null==l?void 0:l.error)||void 0===y?void 0:y.message)&&void 0!==C?C:"";return this.logCustomError(t,i,r.a.TokenUnavailable,d,e),void a(new o({data:"CAP_Error"===e?e:null,status:r.a.TokenUnavailable,subStatus:null===(w=null==l?void 0:l.error)||void 0===w?void 0:w.statusCode,headers:null,config:null,ok:!1,statusText:"Failed to fetch access token",fromCache:!1}))}this.updateRequestConfig(s,l,u)}const I=e(s);n(I),I.catch((r=>{if(!b&&this.isAuthError(r.status,m)){const a=this.getClaimsChallenge(r.headers,t,i);this.accessTokenService.getAccessToken(m,!0,c,h,p,void 0,void 0,void 0,a).then((t=>{if(!t.success)return void v(r);this.updateRequestConfig(s,t,u);const i=e(s);n(i),i.catch(v)}))}else if(this.isRetriableError(r.status)){const e=this.getHeaderValue(r.headers,"Retry-After"),t=parseFloat(e||"0");S(s,Math.ceil(1e3*t))}else a(new o(r))}))}))}getClaimsChallenge(e,t,i){try{const n=e.getAll("WWW-Authenticate")[0];if(n.includes("insufficient_claims")){const e=n.match(/[\s|,]*claims=\"(\S+?)\"/);if(e&&2===e.length)return this.logCustomError(t,i,200,!1,"Found insufficient_claims"),e[1]}}catch(e){this.logCustomError(t,i,0,!1,e)}return""}logCustomError(e,t,i,r,a=""){this.instrumentationService.logRequestEvent(e,i,-1,a,r),Object(n.a)({eventName:t,fromCache:r,httpCode:i,latency:-1,error:a})}}},pd4Y:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("/I02"),r=i("Mlb/");class a{constructor(e){this.contextService=e,this.startDate=new Date;const t=this.contextService.sharedContext.dateOverride;t&&(this.mockDate=new Date(t))}getCurrentDate(){if(this.mockDate){const e=(new Date).getTime()-this.startDate.getTime();return new Date(this.mockDate.getTime()+e)}return new Date}getCurrentDateMinuteGranularity(){const e=this.getCurrentDate();return e.setSeconds(0,0),e}getLocalMidnight(){const e=this.getCurrentDate();return e.setHours(0,0,0,0),e}timespanInSeconds(e){return(this.getCurrentDate().getTime()-e.getTime())/1e3}getStartOfYear(){const e=this.getCurrentDate();return new Date(e.getFullYear(),0,0,0,0,0,0)}addDays(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}addHours(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours()+t,e.getMinutes(),e.getSeconds(),e.getMilliseconds())}addSeconds(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()+t,e.getMilliseconds())}}a.DAY=864e5,a.ɵprov=r.kc({factory:function(){return new a(r.lc(n.a))},token:a,providedIn:"root"})},pdjy:function(e,t,i){"use strict";i.d(t,"e",(function(){return n})),i.d(t,"a",(function(){return r})),i.d(t,"c",(function(){return a})),i.d(t,"b",(function(){return o})),i.d(t,"d",(function(){return s}));var n=0,r=1,a=2,o=3,s=4},pjz5:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{static getHostName(e){const t=n.getLocation(e);return t&&t.hostname||""}static getLocation(e){if(e&&e.length){const t=e.match(n.UrlParserRegex);return t&&{href:e,protocol:t[1],host:t[2],hostname:t[3],port:t[4],path:t[5],search:t[6],hash:t[7]}}return null}static getQueryParams(e){const t={};if(e){const i=e.split("&");for(const e of i){const[i,n]=e.split("=");t[i]=n}}return t}static getOrigin(e){const t=n.getLocation(e);return t&&t.protocol&&t.hostname?t.protocol+"//"+t.hostname:""}static removeFileNameFromDocUrl(e){if(e)return e.substring(0,e.lastIndexOf("/"))}static addMissingProtocol(e){return!(e=e.toLowerCase())||e.startsWith("http:")||e.startsWith("https:")||e.startsWith("mailto:")||e.startsWith("sip:")||e.startsWith("tel:")||e.startsWith("im:")?e:"https://"+e}}n.UrlParserRegex=new RegExp(["^(https?:)//","(([^:/?#]*)(?::([0-9]+))?)","(/{0,1}[^?#]*)","(\\?[^#]*|)","(#.*|)$"].join(""))},pzhl:function(e,t,i){"use strict";i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return p}));var n=i("Mlb/"),r=i("vk2e"),a=i("xSeq"),o=i("g0MB"),s=i("w1PR"),l=i("PkQn"),c=i("4/We"),u=n.Fb({encapsulation:2,styles:[],data:{}});function d(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,2,"span",[],[[8,"id",0],[1,"title",0],[1,"aria-hidden",0]],null,null,null,null)),n.Gb(1,278528,null,0,r.i,[n.x,n.y,n.o,n.K],{ngClass:[0,"ngClass"]},null),n.Gb(2,278528,null,0,r.n,[n.o,n.y,n.K],{ngStyle:[0,"ngStyle"]},null)],(function(e,t){var i=t.component;e(t,1,0,i.classAttrValue),e(t,2,0,i.styleAttrValue)}),(function(e,t){var i=t.component;e(t,0,0,i.id||"",i.title,!i.ariaVisible)}))}function h(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,"button",[["keyboardFocusTooltip",""]],[[8,"id",0],[8,"title",0],[1,"aria-label",0],[1,"aria-hidden",0],[1,"data-area",0],[1,"data-nav",0]],[[null,"click"]],(function(e,t,i){var n=!0;return"click"===t&&(n=!1!==e.component.handleClick()&&n),n}),null,null)),n.Gb(1,278528,null,0,r.i,[n.x,n.y,n.o,n.K],{ngClass:[0,"ngClass"]},null),n.Gb(2,278528,null,0,r.n,[n.o,n.y,n.K],{ngStyle:[0,"ngStyle"]},null),n.Gb(3,4210688,null,0,a.a,[n.o,n.h],{focusOnLoad:[0,"focusOnLoad"]},null),n.Gb(4,4210688,null,0,o.a,[n.o,n.K,s.b],null,null)],(function(e,t){var i=t.component;e(t,1,0,i.classAttrValue),e(t,2,0,i.styleAttrValue),e(t,3,0,i.focusOnLoad)}),(function(e,t){var i=t.component;e(t,0,0,i.id||"",i.title,i.ariaLabel,!i.ariaVisible,i.dataArea,i.dataNav)}))}function p(e){return n.jc(2,[(e()(),n.qb(16777216,null,null,1,null,d)),n.Gb(1,16384,null,0,r.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,h)),n.Gb(3,16384,null,0,r.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,1,0,!i.iconButton),e(t,3,0,i.iconButton)}),null)}n.Db("ohp-icon-font",l.a,(function(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-icon-font",[],null,null,null,p,u)),n.Gb(1,638976,null,0,l.a,[c.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{color:"color",cssClass:"cssClass",iconFontCssClass:"iconFontCssClass",iconFontName:"iconFontName",iconFontType:"iconFontType",id:"id",size:"size",style:"style",title:"title",ariaVisible:"ariaVisible",ariaLabel:"ariaLabel",dataArea:"dataArea",dataNav:"dataNav",iconButton:"iconButton",isThirdParty:"isThirdParty",focusOnLoad:"focusOnLoad"},{iconClicked:"iconClicked"},[])},qCYW:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("9WrL"),r=i("casz"),a=i("Mlb/");class o{constructor(e,t){this.officeStartBootstrapperService=e,this.schedulerService=t,this.runUnregisteredAction=(e,t,i,n,r,a)=>{this.maybeGetContentActionsHelper().then((o=>{null==o||o.runUnregisteredAction(e,t,i,n,r,a)}))}}createToDoErrorNotification(e){this.maybeGetContentActionsHelper().then((t=>{null==t||t.createToDoErrorNotification(e)}))}createToDoSuccessNotification(e,t){this.maybeGetContentActionsHelper().then((i=>{null==i||i.createToDoSuccessNotification(e,t)}))}createDocumentActions(e,t,i,n){return this.maybeGetContentActionsHelper().then((r=>r?r.createDocumentActions(e,t,i,n):[])).catch((e=>[]))}destroy(){this.contentActionsHelper&&this.contentActionsHelper.destroy()}getContentActionsGroupInfo(){return this.maybeGetContentActionsHelper().then((e=>null==e?void 0:e.getContentActionsGroupInfo()))}ngOnDestroy(){this.destroy()}maybeGetContentActionsHelper(){return new Promise((e=>{this.contentActionsHelper&&e(this.contentActionsHelper),this.contentActionsHelperPromise||(this.contentActionsHelperPromise=new Promise((e=>{this.schedulerService.scheduleWork((()=>{Promise.all([i.e(0),i.e(5),i.e(1),i.e(43),i.e(173),i.e(86)]).then(i.bind(null,"H4X2")).then((t=>{t.getContentActionsHelper(this.officeStartBootstrapperService).then((t=>{this.contentActionsHelper=t,e(this.contentActionsHelper)}))})).catch((t=>{this.contentActionsHelper=void 0,e(this.contentActionsHelper)}))}),4)}))),this.contentActionsHelperPromise.then((t=>{this.contentActionsHelper=t,this.contentActionsHelper||(this.contentActionsHelperPromise=void 0),e(this.contentActionsHelper)}))}))}}o.ɵprov=a.kc({factory:function(){return new o(a.lc(n.a),a.lc(r.a))},token:o,providedIn:"root"})},qfyf:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n=new(i("Mlb/").u)("PERFORMANCE_QUEUE")},qiPL:function(e,t,i){"use strict";i.r(t);var n=i("QjXU"),r=i("Mlb/"),a=i("Dn7E"),o=i("lrJm"),s=i("hZW2"),l=i("wwmn"),c=i("casz"),u=i("BMb5"),d=i("cgnd");const h=new r.u("SERVICE_WORKER_REGISTRATION_HANDLERS");var p=i("+2OL"),m=i("6cfW"),f=i("JWB6");const g=new r.u("SERVICE_WORKER_ENABLED");var b=i("511z"),v=i("5MEU");const S=new r.u("SERVICE_WORKER_GET_REGISTRATION_BY_SCOPE");class y{constructor(e,t,i,n,r,a,o,s,l,c,u,d){this.serviceWorkerConfigService=e,this.serviceWorkerEnabled=t,this.hasServiceWorkerApi=i,this.windowService=n,this.startupConfigService=r,this.globalErrorHandler=a,this.workloadQueryParameterValue=o,this.officeHomeApiConfig=s,this.serviceWorkerStateService=l,this.documentService=c,this.registrationHandlers=u,this.getRegistrationByScope=d}initialize(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){if(this.hasServiceWorkerApi){this.serviceWorkerContainer=this.windowService.nativeWindow.navigator.serviceWorker;try{let e;if("Controlled"===this.serviceWorkerStateService.currentState){const t=this.getRegistrationByScope?this.serviceWorkerConfigService.config.scope:void 0;e=yield this.serviceWorkerContainer.getRegistration(t)}if(this.serviceWorkerEnabled){const{scriptUrl:t,scope:i}=this.serviceWorkerConfigService.config,n=new URLSearchParams;n.append("cdnDomain",this.startupConfigService.config.cdnDomain),n.append(this.officeHomeApiConfig.config.workloadQueryParameter,this.workloadQueryParameterValue);const r=new URLSearchParams(this.windowService.nativeWindow.location.search),a=this.getFlightsForRegistrationUrl();for(const e of a)n.append("serviceWorkerFlight",e);if(this.startupConfigService.config.automatedTestRunning){const e=r.get("envType");n.append("envType",e)}const o=`${t}?${n.toString()}`;if(e){const t=this.windowService.nativeWindow.location.origin,n=e.active.scriptURL.toLowerCase()!==(t+o).toLowerCase(),r=e.scope.toLowerCase()!==(t+i).toLowerCase();(n||r)&&(e=yield this.registerServiceWorker(o,i))}else e=yield this.registerServiceWorker(o,i)}e&&this.registrationHandlers&&(yield Promise.all(this.registrationHandlers.map((t=>t.handleRegistration(e)))))}catch(e){if(Object(m.a)(e))return;this.globalErrorHandler.handleError(e,"qKgQM")}}}))}registerServiceWorker(e,t){return new Promise((i=>{const n=()=>{i(this.serviceWorkerContainer.register(e,{scope:t})),this.windowService.nativeWindow.removeEventListener("load",n)};"complete"===this.documentService.nativeDocument.readyState?n():this.windowService.nativeWindow.addEventListener("load",n)}))}getFlightsForRegistrationUrl(){const e=this.startupConfigService.config.sharedClientStartupContext.flights,{serviceWorkerAllowedFlights:t,pilotFlights:i}=this.serviceWorkerConfigService.config,n=new Set([...e.split(","),...i]);return t.filter((e=>n.has(e)))}}y.ɵprov=r.kc({factory:function(){return new y(r.lc(p.a),r.lc(g),r.lc(b.a),r.lc(u.b),r.lc(d.b),r.lc(o.b),r.lc(v.a),r.lc(l.a),r.lc(f.a),r.lc(s.a),r.lc(h,8),r.lc(S,8))},token:y,providedIn:"root"});class C extends y{constructor(e,t,i,n,r,a,o,s,l,c,u,d,h){super(e,t,i,n,r,a,o,s,l,c,d,h),this.schedulerService=u}registerServiceWorker(e,t){return new Promise((i=>{const n=()=>{this.schedulerService.scheduleWork((()=>{i(this.serviceWorkerContainer.register(e,{scope:t}))}),4),this.windowService.nativeWindow.removeEventListener("load",n)};"complete"===this.documentService.nativeDocument.readyState?n():this.windowService.nativeWindow.addEventListener("load",n)}))}}C.ɵprov=r.kc({factory:function(){return new C(r.lc(p.a),r.lc(g),r.lc(b.a),r.lc(u.b),r.lc(d.b),r.lc(o.b),r.lc(v.a),r.lc(l.a),r.lc(f.a),r.lc(s.a),r.lc(c.a),r.lc(h,8),r.lc(S,8))},token:C,providedIn:"root"});var w=i("31lE"),I=i("fpaX"),T=i("hhzZ"),k=i("Uqr9"),A=i("HQCr"),_=i("rTyw");class P{static setup(e){if(document.body&&document.body.addEventListener){const t=-1!==navigator.appVersion.toUpperCase().indexOf("MSIE")?"click":"mousedown";document.body.addEventListener(t,(function(t){P.processClick(t,e)}))}}static processClick(e,t){let i=e.srcElement||e.target;for(;i&&(!i.tagName||!P.supportedClickTargets.hasOwnProperty(i.tagName.toUpperCase()));)i=i.parentElement||i.parentNode;if(!i)return;const n=i.getAttribute("data-clicklog");if(n&&"CUSTOM"===n.toUpperCase())return;let r=i.getAttribute("data-referral");null!=r&&0!==r.length||(r=P.referralFromElement(i));const a=i.getAttribute("data-referral-platform");let o=i.getAttribute("data-area");null!=o&&0!==o.length||(o=P.areaFromElement(i));const s=!!i.getAttribute("data-nav"),l=r?Object(_.a)(r):i.id;P.logGenericClick(l,o,r,a,s,t),Object(A.a)(l,null!=o?o:"Other",r)}static logGenericClick(e,t,i,n,r,a){a.logClickEvent("Generic_Click",e,t,i,n,void 0,void 0,void 0,r)}static areaFromElement(e){const t=e.id||null;if(t&&t.length){const e="O365_";if(0===t.lastIndexOf(e,e.length))return T.b.Shell;const i="obf-";if(0===t.lastIndexOf(i,i.length))return T.b.Feedback}const i=e.classList||null;if(i&&i.length){const e="o365cs-";for(let t=0;t<i.length;t++)if(0===i.item(t).lastIndexOf(e,e.length))return T.b.Shell}return null}static referralFromElement(e){const t=e.id||null;if(t&&t.length){if(0===t.lastIndexOf(P.shellAppTileElementIdPrefix,P.shellAppTileElementIdPrefix.length)){let e=t.substring(P.shellAppTileElementIdPrefix.length);const i="Shell";return 0===e.lastIndexOf(i,i.length)&&(e=e.substring(i.length)),e}const i=e.classList||null;if(i&&i.length&&i.contains("o365cs-nav-appTile"))return t}return null}}P.shellAppTileElementIdPrefix="O365_AppTile_",P.supportedClickTargets={A:!0,IMG:!0,AREA:!0,INPUT:!0,BUTTON:!0};var E=i("p6wn"),F=i("Vwd8"),O=i("9WrL"),D=i("7Gwk"),M=i("Z0U4"),R=i("4/We"),x=i("82rx"),L=i("W3Zz"),U=i("EYcb");class N{runWhenIdle(e){return requestIdleCallback(e)}cancelIdleCallback(e){cancelIdleCallback(e)}}class W{runWhenIdle(e){const t=k.a.now();return setTimeout((()=>{e({didTimeout:!1,timeRemaining:()=>Math.max(0,50-(k.a.now()-t))})}),1)}cancelIdleCallback(e){clearTimeout(e)}}var j=i("x+6c"),H=i("TIi1"),B=i("/I02");class G{constructor(e,t,i){this.capabilitiesService=e,this.contextService=t,this.windowService=i}openUrl(e,t,r,a,o){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return this.capabilitiesService.capabilities.contentLauncherEnabled?(Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((i=>{i.launchUrl(e,{action:t,linkTarget:r})})),Promise.resolve()):(this.windowService.nativeWindow.open(e,r||this.contextService.sharedContext.defaultLinkTarget,"number"==typeof a&&"number"==typeof o?`width=${a},height=${o}`:""),Promise.resolve())}))}supportsProtocol(e){return Promise.reject("Method not implemented.")}}G.ɵprov=r.kc({factory:function(){return new G(r.lc(R.a),r.lc(B.a),r.lc(u.b))},token:G,providedIn:"root"});class q{}var V=i("URPu");class ${constructor(e){this.mockConfig=e.config.mock||{}}sendCommands(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return(yield this.getMockAppService()).execute(e)}))}getMockAppService(){return this.appService?Promise.resolve(this.appService):i.e(131).then(i.bind(null,"LK+F")).then((e=>(this.appService=new e.MockOfficeAppService(this.mockConfig),this.appService)))}}var z=i("CMIS"),Z=i("TfV2"),K=i("Y8if"),J=i("PxQI"),Q=i("BaAg"),Y=i("6nG3"),X=i("ZtId"),ee=i("LQqy"),te=i("PBJH"),ie=i("OtXi");class ne{constructor(e,t,i,n,r,a,o,s,l,c){this.appServiceConnection=e,this.capabilitiesService=t,this.clientStartupConfigService=i,this.consumerInstallConfigService=n,this.instrumentationService=r,this.locService=a,this.urlLauncherService=o,this.pwaConfigService=s,this.wrapperVersion=l,this.updateContentService=c,this.installedlocalAppsPromise=null,this.installedLocalAppsExPromise=null,this.installedOfficeDetailsPromise=null,this.officeLicensePromise=null,this.consumerSubscriptionStatusPromise=null,this.localDocsRequestIndex=0,this.recentFilesObservables=new Map,this.capabilitiesService.capabilities.pwaEnabled&&(this.isMsa=this.clientStartupConfigService.config.authType===d.a.MSA,this.getInstalledAppsEx(!0),this.getConsumerSubscriptionStatus())}getLocalMru(e){const t=e?Array.from(e).map((e=>Q.b[e])).join(","):"",i=`localMru-${t}`;if(!this.recentFilesObservables.has(t)){const e={observable:this.updateContentService.getOrAddUpdateStream(i,(()=>this.getLocalMruPromise(t)),void 0,void 0,void 0,!0).pipe(Object(K.a)({items:[],impressionId:"LocalMruImpression",fromCache:!1}),Object(J.a)(1))};this.recentFilesObservables.set(t,e)}const n=this.recentFilesObservables.get(t);return n.hadSuccess||this.updateContentService.pushUpdate(i),n.observable}filterUninstalledApps(e){return new Promise((t=>{if(e&&e.length>0){const i=e.map((t=>{const i=()=>e=e.filter((e=>e.Id!==t.Id));return this.getInstalledApp(t.Title).then((e=>{e||i()}),i)}));Promise.all(i).then((()=>{t(e)}))}else t(e)}))}launchOfficeApp(e,t,i){return new Promise((n=>{this.getInstalledApp(e).then((r=>{if(!r)return this.handleError("Launch_Local_App","Launch_Local_App","NotInstalled",`${e} not installed`),void n(!1);const a={appId:r.identifier,name:r.name,discovered:{}};for(const e of["command","uri","aumid"])r.launchInstall?r.launchInstall.hasOwnProperty(e)&&(a.discovered[e]=r.launchInstall[e]):r.hasOwnProperty(e)&&(a.discovered[e]=r[e]);this.launchFromBridge([{method:"id",data:3},{method:"LocalProviders.LaunchOfficeAppForResult",data:{details:a,filename:t}}],i).then((()=>{n(!0)}),(()=>{n(!1)}))})).catch((e=>{this.handleError("Launch_Local_App","Launch_Local_App","Failed",e),n(!1)}))}))}getInstalledApp(e){const t=e.toLowerCase();return new Promise(((i,n)=>{this.getInstalledAppsEx().then((n=>{if(!n)throw new Error("getInstalledAppsEx returned null");const r=n.apps.find((e=>e.name.toLowerCase()===t));return r&&r.isInstalled?this.isCoreApp(e)&&this.isMsa?void(r.perpetualInstalled?(r.launchInstall=r.perpetualInstalled,i(r)):r.o365Installed?this.getCurrentOfficeLicenses().then((t=>{if(this.hasLicensedInstall(t))return r.launchInstall=r.o365Installed,void i(r);this.updateAppInfoBySubscriptionStatus(e,r).then(i)})).catch((()=>{this.updateAppInfoBySubscriptionStatus(e,r).then(i)})):(this.handleError("App_Installed_Status","App_Installed_Status","NotInstalled",e),i(null))):(r.launchInstall=r.o365Installed||r.perpetualInstalled,void(r.launchInstall?i(r):(this.handleError("App_Installed_Status","App_Installed_Status","NotModern",e),i(null)))):(this.handleError("App_Installed_Status","App_Installed_Status","NotInstalled",e),void i(null))})).catch((r=>{this.handleError("App_Installed_Status","App_Installed_Status","FailedEx",r),-1!==r.toString().indexOf("ApiNotExist")?this.getInstalledApps().then((n=>{if(!n)throw new Error("Installed apps returned null");const r=n.apps.find((e=>e.name.toLowerCase()===t));if(!r||!r.isInstalled)return this.handleError("App_Installed_Status","App_Installed_Status","NotInstalled",e),void i(null);this.isCoreApp(r.name)&&this.isMsa?this.getOfficeInstallationDetails().then((t=>{t.IsO365?this.updateAppInfoBySubscriptionStatus(e,r).then(i):i(r)})).catch((e=>{this.handleError("App_Installed_Status","App_Installed_Status","DetailsFailed",e),i(r)})):i(r)})).catch((e=>{this.handleError("App_Installed_Status","App_Installed_Status","Failed",e),n("getInstalledApps failed: "+e)})):i(null)}))}))}static isValidDocument(e){return e.name&&e.location&&e.lastAccessedDate&&e.applicationName}getOfficeInstallationDetails(){return this.installedOfficeDetailsPromise||(this.installedOfficeDetailsPromise=new Promise(((e,t)=>{if(this.wrapperVersion&&18===this.wrapperVersion.major&&this.wrapperVersion.minor<1902)return this.handleError("Installed_Office_Details_Fetch","Installed_Office_Details_Fetch","ApiNotExist","",0),void t("getOfficeInstallationDetails failed: ApiNotExist");const i=k.a.now();let n;this.appServiceConnection.sendCommands([{method:"id",data:4},{method:"LocalProviders.GetOfficeInstallationDetails",data:null}]).then((t=>{if(n=this.calculateLatency(i),0!==t.status)throw new Error("AppService sendMessageAsync returned status: "+t.status);let r;try{r=JSON.parse(t.message["LocalProviders.GetOfficeInstallationDetails"])}catch(e){throw new Error(`InstalledOfficeDetailsResponse JSON parsing failed. r.msg: ${!t.message}, InstalledOfficeDetailsResponse: ${!(t.message&&!t.message["LocalProviders.GetOfficeInstallationDetails"])}`)}e(r);const o={State:"Success"};o.Latency=n.toString(),this.instrumentationService.logGenericEvent("Installed_Office_Details_Fetch",o,[],2),Object(a.a)({featureName:"Hwa",eventName:"Installed_Office_Details_Fetch",params:o},Z.a.Enhanced)})).catch((e=>{n=n||this.calculateLatency(i),this.installedOfficeDetailsPromise=null,this.handleError("Installed_Office_Details_Fetch","Installed_Office_Details_Fetch","Failed",e,n),t("getOfficeInstallationDetails failed: "+e)}))}))),this.installedOfficeDetailsPromise}getCurrentOfficeLicenses(){return this.officeLicensePromise||(this.officeLicensePromise=new Promise(((e,t)=>{const i=k.a.now();let n;this.appServiceConnection.sendCommands([{method:"id",data:6},{method:"LocalProviders.GetCurrentOfficeLicenses",data:null}]).then((t=>{if(n=this.calculateLatency(i),0!==t.status)throw new Error("AppService sendMessageAsync returned status: "+t.status);let r;try{r=JSON.parse(t.message["LocalProviders.GetCurrentOfficeLicenses"])}catch(e){throw new Error(`OfficeLicensesResponse JSON parsing failed. r.msg: ${!t.message}, OfficeLicensesResponse: ${!(t.message&&!t.message["LocalProviders.GetCurrentOfficeLicenses"])}`)}r&&r.forEach((e=>e.LicenseStatus=e.LicenseStatus.toLowerCase())),e(r);const o={State:"Success"};o.Latency=n.toString(),this.instrumentationService.logGenericEvent("Office_Licenses_Fetch",o,[],2),Object(a.a)({featureName:"Hwa",eventName:"Office_Licenses_Fetch",params:o},Z.a.Enhanced)})).catch((e=>{n=n||this.calculateLatency(i),this.officeLicensePromise=null,this.handleError("Office_Licenses_Fetch","Office_Licenses_Fetch","Failed",e,n),t("getCurrentOfficeLicenses failed: "+e)}))}))),this.officeLicensePromise}getInstalledAppsEx(e){return this.installedLocalAppsExPromise||(this.installedLocalAppsExPromise=new Promise(((t,i)=>{if(this.wrapperVersion&&18===this.wrapperVersion.major&&this.wrapperVersion.minor<1903)return this.handleError("Installed_Apps_Ex_Fetch","Installed_Apps_Ex_Fetch","ApiNotExist","",0),void i("getInstalledAppsEx failed: ApiNotExist");const n=[{method:"id",data:5},{method:"LocalProviders.GetInstalledOfficeAppsEx",data:{version:1,apps:{apps:this.pwaConfigService.config.installedAppsToLookFor.split(",")}}}],r=k.a.now();let o;this.appServiceConnection.sendCommands(n).then((e=>{if(o=this.calculateLatency(r),0!==e.status)throw new Error("AppService sendMessageAsync returned status: "+e.status);let i;try{i=JSON.parse(e.message["LocalProviders.GetInstalledOfficeAppsEx"])}catch(t){if(e.message&&e.message["LocalProviders.GetInstalledOfficeAppsEx"]){if(-1!==e.message["LocalProviders.GetInstalledOfficeAppsEx"].toString().indexOf("forbidden"))throw new Error("ApiNotExist");this.logToDebugCache("Installed_Apps_Ex_Fetch_Debug","FailedEx",e.message["LocalProviders.GetInstalledOfficeAppsEx"].toString())}throw new Error(`Apps JSON parsing failed. r.msg: ${!e.message}, appsFromResponse: ${!(e.message&&!e.message["LocalProviders.GetInstalledOfficeAppsEx"])}`)}t({apps:i.map((e=>{const t={name:e.name,identifier:e.appId,isInstalled:e.hasOwnProperty("discovered")&&e.discovered.length>0};return e.discovered&&e.discovered.length>0&&e.discovered.forEach((e=>{e.isO365?(!t.hasOwnProperty("o365Installed")||this.getMajorVersion(t.o365Installed.version)<this.getMajorVersion(e.version))&&(t.o365Installed=e):(!t.hasOwnProperty("perpetualInstalled")||this.getMajorVersion(t.perpetualInstalled.version)<this.getMajorVersion(e.version))&&(t.perpetualInstalled=e)})),t}))});const n={State:"Success"};n.Latency=o.toString(),this.instrumentationService.logGenericEvent("Installed_Apps_Ex_Fetch",n,[],2),Object(a.a)({featureName:"Hwa",eventName:"Installed_Apps_Ex_Fetch",params:n},Z.a.Enhanced)})).catch((t=>{o=o||this.calculateLatency(r),"ApiNotExist"===t.message?this.handleError("Installed_Apps_Ex_Fetch","Installed_Apps_Ex_Fetch","ApiNotExist","",o):this.handleError("Installed_Apps_Ex_Fetch","Installed_Apps_Ex_Fetch",e?"FailedInitial":"Failed",t,o),this.installedLocalAppsExPromise=null,i("getInstalledAppsEx failed: "+t)}))}))),this.installedLocalAppsExPromise}getInstalledApps(e){return this.installedlocalAppsPromise||(this.installedlocalAppsPromise=new Promise(((t,i)=>{const n=[{method:"id",data:2},{method:"LocalProviders.GetInstalledOfficeApps",data:{apps:this.pwaConfigService.config.installedAppsToLookFor.split(",")}}],r=k.a.now();let o;this.appServiceConnection.sendCommands(n).then((e=>{if(o=this.calculateLatency(r),0!==e.status)throw new Error("AppService sendMessageAsync returned status: "+e.status);let i;try{i=JSON.parse(e.message["LocalProviders.GetInstalledOfficeApps"])}catch(t){throw new Error(`Apps JSON parsing failed. r.msg: ${!e.message}, appsFromResponse: ${!(e.message&&!e.message["LocalProviders.GetInstalledOfficeApps"])}`)}t({apps:i.map((e=>{const t={name:e.name,identifier:e.appId,isInstalled:e.hasOwnProperty("discovered")};if(t.isInstalled&&e.discovered)for(const i of["command","uri","aumid","version"])e.discovered.hasOwnProperty(i)&&(t[i]=e.discovered[i]);return t}))});const n={State:"Success"};n.Latency=o.toString(),this.instrumentationService.logGenericEvent("Installed_Apps_Fetch",n,[],2),Object(a.a)({featureName:"Hwa",eventName:"Installed_Apps_Fetch",params:n},Z.a.Enhanced)})).catch((t=>{o=o||this.calculateLatency(r),this.handleError("Installed_Apps_Fetch","Installed_Apps_Fetch",e?"FailedInitial":"Failed",t,o),this.installedlocalAppsPromise=null,i("getInstalledApps failed: "+t)}))}))),this.installedlocalAppsPromise}logToDebugCache(e,t,i){const n={};n.State=t,n.Error=(i||"").toString(),this.instrumentationService.logDebugCacheEvent(e,n,[],2)}handleError(e,t,i,n,r){const o={};o.State=i,o.Error=(n||"").toString(),"number"==typeof r&&(o.Latency=r.toString()),this.instrumentationService.logGenericEvent(e,o,[],2),Object(z.a)({eventName:t,message:(n||"").toString()},Z.a.Enhanced),Object(a.a)({featureName:"Hwa",eventName:t,params:o},Z.a.Enhanced)}launchFromBridge(e,t){const i=k.a.now(),n=Math.ceil(Date.now()-(i-t)).toString();return this.launchViaProtocol(e,n).then((n=>{if(this.capabilitiesService.capabilities.contentLauncherEnabled){const r=n;if(r&&!r.success||!n)return this.handleLaunchViaProtocolError(e,i,t,"false")}const r={State:"Success",Action:"Protocol"};r.Latency=this.calculateLatency(i).toString(),r.DebugInfo=`StartLatency:${this.calculateLatency(t)}`,this.instrumentationService.logGenericEvent("Launch_Local_App",r,[],2),Object(a.a)({featureName:"Hwa",eventName:"Launch_Local_App",params:r},Z.a.Enhanced)}),(n=>this.handleLaunchViaProtocolError(e,i,t,n)))}handleLaunchViaProtocolError(e,t,i,n){const r={};r.Error=n,r.Latency=this.calculateLatency(t).toString(),this.instrumentationService.logGenericEvent("Launch_By_Protocol_Failed",r,[],2),Object(a.a)({featureName:"Hwa",eventName:"Launch_By_Protocol_Failed",params:r},Z.a.Enhanced);const o=k.a.now();let s;return this.appServiceConnection.sendCommands(e).then((e=>{if(s=this.calculateLatency(o),0!==e.status)return Promise.reject("AppService sendMessageAsync returned status - "+e.status);if(!e.message)return Promise.reject("AppService response message missing");const t=e.message["LocalProviders.LaunchOfficeAppForResult"];if(!t)return Promise.reject("AppService message result missing");if("number"==typeof t&&t<=32)return Promise.reject("AppService message returned error result - "+t);const n={State:"Success",Action:"Bridge"};n.Latency=s.toString(),n.DebugInfo=`StartLatency:${this.calculateLatency(i)}`,this.instrumentationService.logGenericEvent("Launch_Local_App",n,[],2),Object(a.a)({featureName:"Hwa",eventName:"Launch_Local_App",params:n},Z.a.Enhanced)})).catch((e=>(s=s||this.calculateLatency(o),this.handleError("Launch_Local_App","Launch_Local_App","Failed",e,s),Promise.reject())))}getOneDriveLaunchUri(){let e="odopen://launch";return e+=this.clientStartupConfigService.config.authType===d.a.OrgId?`?accounttype=business&userEmail=${this.clientStartupConfigService.config.userPrincipalName}`:"?accounttype=personal",e}launchViaProtocol(e,t){return this.urlLauncherService.supportsProtocol(ne.launchProtocol).then((n=>{if(!n)return Promise.reject("Launcher unavailable");let r="";const a=e[1].data.details;if(a&&"OneDrive"===a.name&&a.discovered&&a.discovered.uri&&"odopen"===a.discovered.uri.toLowerCase())r=this.getOneDriveLaunchUri();else{const i={};e.forEach((e=>{i[e.method]=e.data}));const n=this.clientStartupConfigService.config.sharedClientStartupContext,a=n.correlationId,o=n.sessionId;r=ne.launchProtocol+JSON.stringify(JSON.stringify(i))+" cid:"+a+" sid:"+o+" requestStart:"+t}return this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((e=>e.launchUrl(r,{action:"LaunchProtocol"}))):this.urlLauncherService.openUrl(r,"LaunchProtocol")}))}getLocalMruPromise(e){return new Promise(((t,i)=>{const n=[{method:"id",data:1},{method:"LocalProviders.GetMruLocalDocuments",data:{apps:e}}],r=k.a.now();let o;this.appServiceConnection.sendCommands(n).then((i=>{if(o=this.calculateLatency(r),0!==i.status)throw new Error("Error in response: "+i.status);let n=JSON.parse(i.message["LocalProviders.GetMruLocalDocuments"]).mru.filter(ne.isValidDocument);const s=()=>{t({fromCache:!1,impressionId:"LocalMruImpression",items:n.map((e=>{const t=e.location.split("\\"),i=t.length>1?t[t.length-2]:"",n=new Date(e.lastAccessedDate),r=e.applicationName.charAt(0).toUpperCase()+e.applicationName.substring(1),a=e.name.replace(/\0/gi,"");return{DocId:"",DriveId:"",FileName:a.trim(),Title:-1===a.lastIndexOf(".")?a:a.substring(0,a.lastIndexOf(".")),Url:e.location,WebUrl:"",LastAccessedTime:n,DisplayLastAccessedTime:this.locService.localizedDateString(n),FileType:e.applicationName,Provenance:"OfficeMru",PathArray:[i],IsPinned:!1,Application:r,IsLocal:!0}}))}),this.recentFilesObservables.has(e)&&(this.recentFilesObservables.get(e).hadSuccess=!0);const i={State:"Success"};i.Index=(this.localDocsRequestIndex++).toString(),i.Latency=o.toString(),this.instrumentationService.logGenericEvent("Local_Mru_Fetch",i,[],2),Object(a.a)({featureName:"Hwa",eventName:"Local_Mru_Fetch",params:i},Z.a.Enhanced)},l=()=>n=n.filter((e=>e.applicationName.toLowerCase()!==Q.b[Q.b.OneNote].toLowerCase()));return this.getInstalledApp(Q.b[Q.b.OneNote]).then((e=>{e||l(),s()}),(()=>{l(),s()}))})).catch((e=>{o=o||this.calculateLatency(r);const t={State:"Failed"};t.Error="getLocalMru failed: "+e,t.Index=(this.localDocsRequestIndex++).toString(),t.Latency=o.toString(),this.instrumentationService.logGenericEvent("Local_Mru_Fetch",t,[],2),Object(a.a)({featureName:"Hwa",eventName:"Local_Mru_Fetch",params:t},Z.a.Enhanced),i("Local MRU failed")}))}))}updateAppInfoBySubscriptionStatus(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return this.getConsumerSubscriptionStatus().then((i=>this.consumerHasSubscriptionOrPerpetual(i)?(t.launchInstall=t.o365Installed,t):(this.handleError("App_Installed_Status","App_Installed_Status","NoSubscription",e),null)))}))}getConsumerSubscriptionStatus(){return this.consumerSubscriptionStatusPromise||(this.consumerSubscriptionStatusPromise=new Promise((e=>{this.isMsa?this.consumerInstallConfigService.getConfig().then((t=>{e(t&&t.currentSkuInfo?t.currentSkuInfo.skuType:Y.b.NotDetected)})).catch((t=>{this.handleError("App_Installed_Status","App_Installed_Status","SubscriptionFetchFailed",t),e(Y.b.NotDetected)})):e(null)}))),this.consumerSubscriptionStatusPromise}hasLicensedInstall(e){if(this.pwaConfigService.config.rfmToWeb){const t=this.pwaConfigService.config.oobToWeb?["licensed","ootgrace","extendedgrace"]:["licensed","ootgrace","extendedgrace","oobgrace"];return!!e&&e.some((e=>-1!==t.indexOf(e.LicenseStatus.toLowerCase())))}return!!e&&e.some((e=>"unlicensed"!==e.LicenseStatus.toLowerCase()&&"unknown"!==e.LicenseStatus.toLowerCase()))}getMajorVersion(e){return parseInt(e.substring(0,2))||0}isCoreApp(e){return-1!==["outlook","word","excel","powerpoint"].indexOf(e.toLowerCase())}consumerHasSubscriptionOrPerpetual(e){return e!==Y.b.NotSubscribed&&e!==Y.b.NonActive}calculateLatency(e){return Math.ceil(k.a.now()-e)}}ne.launchProtocol="ms-officecmd:",ne.ɵprov=r.kc({factory:function(){return new ne(r.lc(q),r.lc(R.a),r.lc(d.b),r.lc(ee.a),r.lc(T.a),r.lc(te.a),r.lc(H.a),r.lc(V.a),r.lc(ie.a),r.lc(X.a))},token:ne,providedIn:"root"});class re{constructor(e,t,i){this.capabilitiesService=e,this.errorDialogService=t,this.instrumentationService=i}openUrl(e,t,r,a,o){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((i=>{i.launchUrl(e,{action:t}).catch((i=>(this.instrumentFailedLaunch(t,i),this.errorDialogService.showErrorDialog({category:"OpenFailed",error:re.errorDialogMap.has(t)?re.errorDialogMap.get(t):"Generic",inputText:e}),Promise.reject(i))))})):this.launchUrl(e).catch((i=>(this.instrumentFailedLaunch(t,i),this.errorDialogService.showErrorDialog({category:"OpenFailed",error:re.errorDialogMap.has(t)?re.errorDialogMap.get(t):"Generic",inputText:e}),Promise.reject(i))))}))}instrumentFailedLaunch(e,t=""){const i={};i.Action=e,i.Error=t,this.instrumentationService.logGenericEvent("Pwa_Navigation_Failed",i,[],2),Object(z.a)({eventName:"Pwa_Navigation_Failed",message:t,debugInfo:e})}}re.errorDialogMap=new Map([["GoToBlankDoc","None"],["CreateNewFallback","None"],["Upload","None"],["CreateFromDocument","None"],["LaunchProtocol","None"],["CreateFileWithTemplate","None"]]);class ae extends re{constructor(e,t,i,n,r){super(e,t,i),this.windowUrlLauncherService=r,this.config=n.config.mock||{}}supportsProtocol(e){return Promise.resolve(!this.config.protocolUnsupported)}launchUrl(e,t,i,n){if(this.config.urlLaunchError)return Promise.reject("Mock launch error");if(e.startsWith(ne.launchProtocol)){const t=e.lastIndexOf("cid:"),i=e.substring(ne.launchProtocol.length,-1===t?e.length:t),n=JSON.parse(JSON.parse(i))["LocalProviders.LaunchOfficeAppForResult"];this.config.appsLaunched.push({applicationName:n.details.name,filePath:n.filename,launchMethod:"Protocol"})}return this.windowUrlLauncherService.openUrl(e,void 0,t,i,n),Promise.resolve()}}class oe{constructor(e,t){this.ngZone=e,this.windowService=t}runWhenIdle(e){return this.ngZone.run((()=>{const t=k.a.now();return this.windowService.nativeWindow.MSApp.execAsyncAtPriority((()=>e({didTimeout:!1,timeRemaining:()=>Math.max(0,50-(k.a.now()-t))})),this.windowService.nativeWindow.MSApp.IDLE)}))}cancelIdleCallback(e){}}class se{constructor(e,t,i){this.clientStartupConfigService=e,this.instrumentationService=t,this.responseStatusMap={},this.bridgeTimeout=1e3*i.config.bridgeTimeoutInSeconds,this.responseStatusMap[Windows.ApplicationModel.AppService.AppServiceResponseStatus.success]=0,this.responseStatusMap[Windows.ApplicationModel.AppService.AppServiceResponseStatus.failure]=1,this.responseStatusMap[Windows.ApplicationModel.AppService.AppServiceResponseStatus.resourceLimitsExceeded]=2}sendCommands(e){return this.validateConnection().then((t=>this.sendConnectionMessage(t,e)))}validateConnection(){const e=Windows.ApplicationModel.AppService;return this.connectionPromise||(this.connectionPromise=new Promise(((t,i)=>{const n=k.a.now(),r=new e.AppServiceConnection;r.appServiceName="com.microsoft.myoffice.client.bridge",r.packageFamilyName=Windows.ApplicationModel.Package.current.id.familyName,r.openAsync().then((o=>{if(o===e.AppServiceConnectionStatus.success)r.onserviceclosed=()=>{this.connectionPromise=null},this.sendTelemetryContext(r,n).then((()=>{t(r)}));else{const e={},t=Math.ceil(k.a.now()-n);e.Latency=t.toString();const r="Connection status: "+o;e.State="Failed",e.Error=r,this.instrumentationService.logGenericEvent("App_Service_Connection",e,[],2),Object(a.a)({featureName:"Hwa",eventName:"App_Service_Connection",params:e},Z.a.Enhanced),this.connectionPromise=null,i(r)}}))}))),this.connectionPromise}sendTelemetryContext(e,t){const i=this.clientStartupConfigService.config.sharedClientStartupContext;return new Promise((n=>{this.sendConnectionMessage(e,[{method:"cid",data:i.correlationId},{method:"sid",data:i.sessionId}]).then((e=>{if(0!==e.status)throw new Error("Response failed: "+e.status);return null})).catch((e=>e||"Error")).then((e=>{const i={},r=Math.ceil(k.a.now()-t);i.Latency=r.toString(),i.State=e?"FailedContext":"Success",e&&(i.Error="SendTelemetryContext failed: "+e),this.instrumentationService.logGenericEvent("App_Service_Connection",i,[],2),n()}))}))}sendConnectionMessage(e,t){return new Promise(((i,n)=>{const r=new Windows.Foundation.Collections.ValueSet,a={};t.forEach((e=>{a[e.method]=e.data})),r.insert("message",JSON.stringify(a));const o=e.sendMessageAsync(r).then((e=>{let t;try{t=JSON.parse(e.message.message)}catch(t){return void n(`JSON parsing failed. Has message: ${!e.message}, error: ${e.error||""}`)}i({message:t,status:this.responseStatusMap.hasOwnProperty(e.status)?this.responseStatusMap[e.status]:3})}),n);if(this.bridgeTimeout){const e=setTimeout((()=>{n("Connection timeout"),o.cancel()}),this.bridgeTimeout);o.then((()=>clearTimeout(e)))}}))}}class le extends re{constructor(e,t,i){super(e,t,i)}supportsProtocol(e){return new Promise(((t,i)=>{const n=this.getUri(e);n?Windows.System.Launcher.queryUriSupportAsync(n,Windows.System.LaunchQuerySupportType.uri,Windows.ApplicationModel.Package.current.id.familyName).then((e=>{t(e===Windows.System.LaunchQuerySupportStatus.available)}),(e=>{i(`QueryUriSupportError: ${e}`)})):i("Invalid protocol")}))}launchUrl(e,t,i,r){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return new Promise(((t,i)=>{const n=this.getUri(e);n?Windows.System.Launcher.launchUriAsync(n).then((e=>{e?t():i("Launch Uri Failed")}),(()=>{i("Launch Uri Error")})):i("Invalid Url")}))}))}getUri(e){try{return new Windows.Foundation.Uri(e)}catch(e){return null}}}function ce(e,t,i,n,r){return n.config.mock?new ae(e,t,i,n,r):new le(e,t,i)}function ue(e,t,i){return i.config.mock?new $(i):new se(e,t,i)}function de(e,t,i,n,r){return n.config.enablePwaIdleCallback&&r.nativeWindow.MSApp?new oe(i,r):function(e,t){return e.config.automatedTestRunning||t.deviceInfo.browser.browserType===L.a.Safari?new W:new N}(e,t)}const he=function(e){return e.config.automatedTestRunning?new x.e:new x.f},pe=function(e){return()=>e.getShellAndConfigPromise()},me=function(){return window.queuedEvents||[]},fe=function(){return window.queuedMarks||[]},ge=function(e){return e.config.mock?e.config.mock.wrapperVersion:Windows.ApplicationModel.Package.current.id.version},be=function(e){return()=>Promise.resolve(e.nativeWindow.pwaCurrentUserId)};class ve{}var Se=i("WLAd");class ye{constructor(e,t,i,n,r){this.instrumentationService=e,this.pageVisibilityService=i,this.pwaConfigService=n,this.updateContentService=r,this.logIndex=0,this.pageIndex=0,t.subscribeToRouteChangeEnd((()=>{this.pageIndex++})),this.getDiagnostics(-1)}startTrackingDiagnostics(){this.queueLog(),setTimeout((()=>{this.logIndex<=1&&this.queueLog()}),1e4),this.updateContentService.getOrAddUpdateStream("diagnostics",(()=>(this.queueLog(),Promise.resolve()))),this.pageVisibilityService.addOnVisibilityChanged((e=>{"hidden"===e&&this.diagnosticTimer&&(clearTimeout(this.diagnosticTimer),this.diagnosticTimer=null)}))}queueLog(){this.diagnosticTimer||(this.diagnosticTimer=setTimeout((()=>this.logDiagnostics()),1e3*this.pwaConfigService.config.diagnosticsTimeoutInSeconds))}logDiagnostics(){if(this.diagnosticTimer=null,!this.pageVisibilityService.isVisible)return;const e=this.getDiagnostics(this.logIndex++);this.instrumentationService.logGenericEvent("Memory_Usage",e,[],2)}getDiagnostics(e){const t=k.a.now(),i={};if(i.Index=e.toString(),i.ItemCount=this.pageIndex.toString(),this.pwaConfigService.config.mock)return i;const n=Windows.System.MemoryManager.getAppMemoryReport();i.PeakPrivateCommit=this.getValueAsStringInMb(n.peakPrivateCommitUsage),i.PrivateCommit=this.getValueAsStringInMb(n.privateCommitUsage),i.TotalCommit=this.getValueAsStringInMb(n.totalCommitUsage);const r=Windows.System.MemoryManager.getProcessMemoryReport();i.PrivateWorkingSet=this.getValueAsStringInMb(r.privateWorkingSetUsage),i.TotalWorkingSet=this.getValueAsStringInMb(r.totalWorkingSetUsage);try{const e=Windows.System.Diagnostics.ProcessDiagnosticInfo.getForCurrentProcess(),t=e.memoryUsage.getReport(),n=e.diskUsage.getReport();i.PeakTotalWorkingSet=this.getValueAsStringInMb(t.peakWorkingSetSizeInBytes),i.DiskWrite=this.getValueAsStringInMb(n.bytesWrittenCount);const r=Windows.System.Diagnostics.SystemDiagnosticInfo.getForCurrentSystem(),a=r.memoryUsage.getReport(),o=a.totalPhysicalSizeInBytes,s=a.availableSizeInBytes;i.SystemMemoryTotal=this.getValueAsStringInMb(o),i.SystemMemoryUsage=Math.ceil(100*(1-s/o)).toString();const l=e.cpuUsage.getReport(),c=r.cpuUsage.getReport(),u=k.a.now(),d=c.userTime,h=c.idleTime,p=l.userTime+l.kernelTime;if(this.lastCpuMeasureTime&&this.lastProcessCpu&&this.lastUserCpu&&this.lastIdleCpu){const e=u-this.lastCpuMeasureTime,t=d-this.lastUserCpu,n=p-this.lastProcessCpu,r=t+(h-this.lastIdleCpu);i.SystemCpu=Math.ceil(100*t/r).toString(),i.ProcessCpu=Math.ceil(100*n/r).toString(),i.ProcessorCount=Math.ceil(r/e).toString()}this.lastProcessCpu=p,this.lastUserCpu=d,this.lastIdleCpu=h,this.lastCpuMeasureTime=u}catch(e){}return i.Latency=Math.ceil(k.a.now()-t).toString(),i}getValueAsStringInMb(e){return Math.ceil(e/ye.bytesPerMB).toString()}}ye.bytesPerMB=1048576,ye.ɵprov=r.kc({factory:function(){return new ye(r.lc(T.a),r.lc(M.a),r.lc(Se.a),r.lc(V.a),r.lc(X.a))},token:ye,providedIn:"root"});var Ce=i("bvSZ"),we=i("ZcZ3"),Ie=i("lUkk"),Te=i("70cc"),ke=i("WKA6"),Ae=i("dP4y"),_e=i("O6Zd"),Pe=i("5ZNw"),Ee=i("BYbh"),Fe=i("SPVw"),Oe=i("sH0/"),De=i("vcPZ"),Me=i("5aVq"),Re=i("w1PR"),xe=i("fVt+"),Le=i("JH4S"),Ue=i("b7yv"),Ne=i("gktR");class We{constructor(e,t,i,n,r,a,o,s,l,c,u,h,p,m,f,g,b,v,S,y){this.capabilitiesService=e,this.consumerInstallConfigService=t,this.contextService=i,this.documentService=n,this.eventService=r,this.featureCalloutService=a,this.firstRunConfigService=o,this.firstRunDataService=s,this.globalErrorHandler=l,this.instrumentationService=c,this.locService=u,this.performanceService=h,this.shellShimService=p,this.startupConfigService=m,this.themingService=f,this.userConsentService=g,this.userContextService=b,this.userProfileService=v,this.initialized=!1,this.disabled=!S.isDesktopDevice()||!y.config||y.config.hideInTestMode,this.disabled||(this.config=y.config,this.isCommercialUser=this.startupConfigService.config.authType===d.a.OrgId,this.theme="light",this.installButtonResponsePromise=this.eventService.events.withScope(0).pipe(Object(Te.a)((e=>"installButtonResponse"===e.name)),Object(ke.a)(1)).toPromise().then((e=>{if(e.args&&e.args.length)return Promise.resolve(e.args[0])})),this.consumerSubscriptionStatusPromise=this.consumerInstallConfigService.getConfig().then((e=>e&&e.currentSkuInfo&&e.currentSkuInfo.skuType)),this.userConsentPromise=this.isCommercialUser?Promise.resolve(null):this.userConsentService.getConfig(),this.modalFreClosedPromise=this.firstRunConfigService.getConfig().then((e=>(this.showModalFre=!!e&&!!e.model&&!!e.model.slides,this.showModalFre?r.events.withScope(0).pipe(Object(Te.a)((e=>"firstRunModalClosed"===e.name)),Object(ke.a)(1)).toPromise().then((()=>Promise.resolve())):Promise.resolve()))),this.appBarShowingPromise=this.capabilitiesService.capabilities.appBarEnabled?this.eventService.events.withScope(0).pipe(Object(Te.a)((e=>"appBarReady"===e.name)),Object(ke.a)(1)).toPromise().then((()=>Promise.resolve())):Promise.resolve())}ngOnDestroy(){var e;null===(e=this.themeShadesSubscription)||void 0===e||e.unsubscribe()}initializeFirstRun(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){if(this.disabled||this.initialized)return;this.initialized=!0,this.capabilitiesService.capabilities.darkModeEnabled&&(this.themeShadesSubscription=this.themingService.darkModeSubscription.subscribe((e=>{this.theme=e?"dark":"light"}))),this.firstRunVersion=this.config.version;const e=yield this.fetchFirstRun(),t=this.getCallouts(e.CompletedFirstRun),i=yield t;i.length&&(this.initCalloutActions(i),this.setupFirstCallout(e,i),this.featureCalloutService.addCallouts(i)),this.performanceService.mark("FRE_Ready")}))}fetchFirstRun(){return this.firstRunDataService.fetchFirstRunData(this.firstRunVersion,!1,Ne.a.firstRunDataKey)}shouldShowCallouts(){if(this.disabled)return Promise.resolve(!1);const e=this.fetchFirstRun(),t=this.fetchHasSeenNewCallouts(),{tuiFlowInTestMode:i}=this.config;return"2"===i||"3"===i?Promise.resolve(!0):Promise.all([e,t]).then((([e,t])=>!e.CompletedFirstRun||!t))}fetchHasSeenNewCallouts(){return this.userProfileService.doesMetricExist("Fre_New_Callouts_Impression")}getCallouts(e){const{tuiFlowInTestMode:t}=this.config;return"0"===t?e?this.getReturningUserCallouts():this.getFirstRunCallouts():"2"===t?this.getFirstRunCallouts():"3"===t?this.getReturningUserCallouts():"4"===t?Promise.resolve([]):void 0}getFirstRunCallouts(){const e=this.userContextService.user.isEdu;return new Promise(((t,i)=>{Promise.all([this.shellShimService.afterShellPlusLoaded,this.modalFreClosedPromise,this.consumerSubscriptionStatusPromise,this.userConsentPromise,this.installButtonResponsePromise,this.appBarShowingPromise]).then((([i,n,r,o])=>{const s=new Array,l=i,c=this.isFreeConsumer(r),u=this.userCanViewUpsell(c,o);this.detectDomElements(),l&&this.appLauncherElement&&s.push(new De.a(this.appLauncherElement,"AppLauncher",T.b.FirstRun,this.locService.FirstRunFindMoreAppsTitle,this.isCommercialUser?this.locService.FirstRunFindMoreAppsSubtitleCommercial:this.locService.FirstRunFindMoreAppsSubtitleConsumer,null,null,null,null,null,!1,null,null,null,null,null,null,null,this.isCommercialUser?e?this.config.findMoreAppsEduSvg[this.theme]:this.config.findMoreAppsCommercialSvg[this.theme]:this.config.findMoreAppsConsumerSvg[this.theme])),this.adminCenterButtonElement&&this.userContextService.user.isAdmin&&s.push(new De.a(this.adminCenterButtonElement,"AdminTile",T.b.FirstRun,e?this.locService.FirstRunManageSchoolTitle:this.locService.FirstRunManageOrganizationTitle,this.locService.FirstRunManageOrganizationSubtitleNext,null,null,null,null,null,!0,null,null,null,null,-240,null,240,this.config.adminCenterSvg[this.theme])),this.createNewButtonElement&&s.push(new De.a(this.createNewButtonElement,"NewButton",T.b.FirstRun,this.locService.FirstRunCreateHereTitle,this.locService.FirstRunCreateHereSubtitle,null,null,null,null,null,!0,null,null,null,null,null,null,null,this.config.createSvg[this.theme])),this.myContentButtonElement&&this.isCommercialUser&&s.push(new De.a(this.myContentButtonElement,"MyContent",T.b.FirstRun,this.locService.FirstRunManageContentTitle,this.locService.FirstRunManageContentSubtitle,null,null,null,null,null,!0,null,null,null,null,null,null,null,this.config.manageContentSvg[this.theme])),this.uploadButtonElement&&s.push(new De.a(this.uploadButtonElement,"Upload",T.b.FirstRun,this.locService.FirstRunUploadExistingContentTitle,this.locService.FirstRunUploadExistingContentSubtitle,null,null,null,null,null,!1,null,null,null,null,null,null,null,this.config.uploadContentSvg[this.theme])),this.consumerBuyButtonElement&&u&&s.push(new De.a(this.consumerBuyButtonElement,"BuyOffice",T.b.FirstRun,this.locService.FirstRunUpgradeAnyTimeTitle,this.locService.FirstRunUpgradeAnyTimeSubtitleTemp,null,null,null,null,null,!1,null,null,null,null,null,null,null,this.config.upgradeSvg[this.theme])),this.installButtonElement&&!c&&this.config.installButtonCalloutEnabled&&s.push(new De.a(this.installButtonElement,"Install",T.b.FirstRun,this.locService.FirstRunDownloadAppsTitle,this.locService.FirstRunDownloadAppsSubtitle,null,null,null,null,null,!1,null,null,null,null,null,null,null,this.config.officeMobileAppSvg[this.theme])),this.feedbackContainerElement&&s.push(new De.a(this.feedbackContainerElement,"Feedback",T.b.FirstRun,this.locService.FirstRunYoureAllSetTitle,this.locService.FirstRunYoureAllSetSubtitle,null,null,null,null,null,!1,null,null,null,null,null,null,null,this.config.allSetSvg[this.theme],!0)),this.userProfileService.incrementMetric("Fre_New_Callouts_Impression"),this.capabilitiesService.capabilities.quickAccessV1Enabled&&!this.isCommercialUser&&this.userProfileService.incrementMetric("Consumer_Pinned_Favorites_Sequence");const d={};d.FirstRunTotalSteps=s.length.toString(),d.State="first-run",this.instrumentationService.logGenericEvent("Fre_New_Callouts_Event",d),Object(a.a)({featureName:"FirstRun",eventName:"Fre_New_Callouts_Event",params:d}),t(s)})).catch((e=>{this.globalErrorHandler.handleError(e,"LAtlv"),i()}))}))}getReturningUserCallouts(){const e=this.fetchHasSeenNewCallouts();return new Promise(((t,i)=>{Promise.all([this.shellShimService.afterShellPlusLoaded,this.modalFreClosedPromise,this.consumerSubscriptionStatusPromise,this.userConsentPromise,e,this.appBarShowingPromise]).then((([e,i,n,r,o])=>{this.detectDomElements();const s=new Array,l=e,c=this.isFreeConsumer(n),u=this.userCanViewUpsell(c,r);if(!o||this.contextService.sharedContext.inMockMode){if(s.push(Promise.resolve(new De.a(this.appLauncherElement,"Welcome",this.contextService.isEdgeworth?T.b.Edgeworth:T.b.Documents,this.locService.FirstRunWelcomeBackTitle,this.locService.FirstRunWelcomeBackSubtitle,null,null,null,null,null,!1,null,null,null,null,null,null,null,this.config.welcomeBackSvg[this.theme],!1,!0,"Returning_User_Callouts_Impression"))),l&&this.appLauncherElement){const e=this.userContextService.user.isEdu;s.push(Promise.resolve(new De.a(this.appLauncherElement,"AppLauncher",T.b.FirstRun,this.locService.FirstRunFindMoreAppsTitle,this.locService.FirstRunFindMoreAppsSubtitleReturningUser,null,null,null,null,null,!1,null,null,null,null,null,null,null,this.isCommercialUser?e?this.config.findMoreAppsEduSvg[this.theme]:this.config.findMoreAppsCommercialSvg[this.theme]:this.config.findMoreAppsConsumerSvg[this.theme],!1,!1,"Returning_User_Callouts_Impression"))),this.createNewButtonElement&&s.push(Promise.resolve(new De.a(this.createNewButtonElement,"NewButton",T.b.FirstRun,this.locService.ExpandedCreateCapabilitiesTitle,this.locService.FirstRunExpandedCreateCapabilitiesSubittle,null,null,null,null,null,!0,null,null,null,null,null,null,null,this.config.createSvg[this.theme],!1,!1,"Returning_User_Callouts_Impression"))),this.myContentButtonElement&&this.isCommercialUser&&s.push(Promise.resolve(new De.a(this.myContentButtonElement,"MyContent",T.b.FirstRun,this.locService.FirstRunManageContentTitle,this.locService.FirstRunManageContentSubtitle,null,null,null,null,null,!0,null,null,null,null,null,null,null,this.config.manageContentSvg[this.theme],!1,!1,"Returning_User_Callouts_Impression"))),this.consumerBuyButtonElement&&u&&s.push(Promise.resolve(new De.a(this.consumerBuyButtonElement,"BuyOffice",T.b.FirstRun,this.locService.FirstRunUpgradeAnyTimeTitle,this.locService.FirstRunUpgradeAnyTimeSubtitleTemp,null,null,null,null,null,!1,null,null,null,null,null,null,null,this.config.upgradeSvg[this.theme],!1,!1,"Returning_User_Callouts_Impression"))),this.feedbackContainerElement&&s.push(Promise.resolve(new De.a(this.feedbackContainerElement,"Feedback",T.b.FirstRun,this.locService.FirstRunYoureAllSetTitle,this.locService.FirstRunYoureAllSetSubtitleReturningUser,null,null,null,null,null,!1,null,null,null,null,null,null,null,this.config.allSetSvg[this.theme],!0,!1,"Returning_User_Callouts_Impression")))}const e={};e.FirstRunTotalSteps=s.length.toString(),e.State="after-first-run",this.instrumentationService.logGenericEvent("Fre_New_Callouts_Event",e),Object(a.a)({featureName:"FirstRun",eventName:"Fre_New_Callouts_Event",params:e}),this.userProfileService.incrementMetric("Fre_New_Callouts_Impression")}Promise.all(s).then((e=>t(e.filter((e=>null!==e)))))})).catch((e=>{this.globalErrorHandler.handleError(e,"Cgjwv"),i()}))}))}isFreeConsumer(e){return!this.isCommercialUser&&(e===Y.b.NonActive||e===Y.b.NotSubscribed)}userCanViewUpsell(e,t){return e&&(!t||0===t.userConsent)}initCalloutActions(e){const t=e.length,i=i=>{const n=e[i];n&&this.firstRunDataService.updateFirstRunData({CompletedFirstRun:!1,StepsCompleted:i+1,Version:this.firstRunVersion,TotalSteps:t},Ne.a.firstRunDataKey,n.calloutType)};e.forEach(((e,n)=>{e.buttonIdPrefix=`first-run-step-${n}-${e.calloutType.toLowerCase()}`,e.onAction=n===t-1?e=>{0!==e&&(3===e?i(n-1):this.firstRunDataService.updateFirstRunData({CompletedFirstRun:!0,StepsCompleted:t,Version:this.firstRunVersion,TotalSteps:t},Ne.a.firstRunDataKey))}:e=>{0!==e&&(1===e?this.firstRunDataService.updateFirstRunData({CompletedFirstRun:!0,StepsCompleted:n+1,Version:this.firstRunVersion,TotalSteps:t},Ne.a.firstRunDataKey):i(2===e?n+1:n-1))}}))}setupFirstCallout(e,t){const i=e.Version!==this.firstRunVersion?0:void 0!==e.FurthestCompleted&&e.FurthestCompleted<t.length?e.FurthestCompleted:e.StepsCompleted<t.length?e.StepsCompleted:0;for(let e=0;e<i;e++)t[e].completed=!0;this.firstRunDataService.updateFirstRunData({CompletedFirstRun:!1,StepsCompleted:i+1,Version:this.firstRunVersion,TotalSteps:t.length},Ne.a.firstRunDataKey,t[i].calloutType)}detectDomElements(){this.appLauncherElement=this.documentService.nativeDocument.getElementById("O365_MainLink_NavMenu"),this.adminCenterButtonElement=this.documentService.nativeDocument.getElementById("A28790FE-989B-48F6-90D8-D4996159C8D1")||this.documentService.nativeDocument.getElementById("ShellAdmin_link"),this.createNewButtonElement=this.documentService.nativeDocument.getElementById("83D3F491-B586-4266-8738-89776471BF21")||this.documentService.nativeDocument.getElementById("left-nav-create-center"),this.myContentButtonElement=this.documentService.nativeDocument.getElementById("F57D5D29-4967-495C-A648-F7AB66BF8572"),this.uploadButtonElement=this.documentService.nativeDocument.getElementById("upload-button-Edgeworth")||this.documentService.nativeDocument.getElementById("upload-button-QuickAccess")||this.documentService.nativeDocument.getElementById("upload-button"),this.installButtonElement=this.documentService.nativeDocument.getElementById("install-dropdown-link")||this.documentService.nativeDocument.getElementById("installbutton-MSA-RedirectToMyAccountPage"),this.consumerBuyButtonElement=this.documentService.nativeDocument.getElementById("consumer-buy-button"),this.feedbackContainerElement=this.documentService.nativeDocument.getElementById("feedbackContainer")}}We.ɵprov=r.kc({factory:function(){return new We(r.lc(R.a),r.lc(ee.a),r.lc(B.a),r.lc(s.a),r.lc(D.a),r.lc(Fe.a),r.lc(Ue.a),r.lc(Ne.a),r.lc(o.b),r.lc(T.a),r.lc(te.a),r.lc(k.b),r.lc(Me.a),r.lc(d.b),r.lc(Re.b),r.lc(xe.a),r.lc(Le.a),r.lc(F.b),r.lc(L.b),r.lc(Oe.a))},token:We,providedIn:"root"});var je=i("y3b+"),He=i("3g20"),Be=i("vXf5"),Ge=i("3anA"),qe=i("A/um"),Ve=i("fKR7"),$e=i("kpuN"),ze=i("fGsv"),Ze=i("OWzB"),Ke=i("kH2X"),Je=i("1LNb"),Qe=i("U8M1"),Ye=i("rBEp"),Xe=i("Bc8L"),et=i("uzn7");class tt{}var it=i("gO/A"),nt=i("EUVs"),rt=i("ufVG"),at=i("Hp80"),ot=i("k+kJ"),st=i("uUrA");class lt{constructor(e,t,i,n,r){this.documentService=e,this.uploadConfigService=t,this.uploadButtonService=i,this.accessTokenService=n,this.isConsumer=r,this.enabled=!!this.uploadConfigService.config&&this.uploadConfigService.config.dragAndDropEnabled}onDragOver(e){this.enabled&&this.isLocalFile(e.dataTransfer.types)?(e.dataTransfer.dropEffect="copy",this.showOutline(),clearTimeout(this.timeoutTracker),this.timeoutTracker=setTimeout((()=>{this.hideOutline()}),300)):e.dataTransfer.dropEffect="none"}onDrop(e){if(this.enabled&&this.isLocalFile(e.dataTransfer.types)&&e.dataTransfer.files.length>0){const t=e.dataTransfer.files;this.accessTokenService.getAccessToken("Graph",!1,null,this.isConsumer||this.uploadConfigService.config.capPopupEnabled,{category:"Upload"}).then((()=>{this.uploadFiles(t)})),clearTimeout(this.timeoutTracker),this.hideOutline()}}uploadFiles(e){1===e.length?this.uploadButtonService.uploadFile(e[0],null,st.a.createGuid(),"upload-drop",ot.d.DragAndDrop):this.uploadButtonService.uploadFiles(e,st.a.createGuid(),"upload-drop",ot.d.DragAndDrop)}showOutline(){this.documentService.addCssClassToElement(this.documentService.nativeDocument.getElementById(lt.ScrollContentId),lt.DragAndDropStyle)}hideOutline(){this.documentService.removeCssClassFromElement(this.documentService.nativeDocument.getElementById(lt.ScrollContentId),lt.DragAndDropStyle)}isLocalFile(e){for(let t=0;t<e.length;t++){const i=e[t];if("Files"!==i&&"application/x-moz-file"!==i)return!1}return!0}}lt.ScrollContentId="officeHome__scroll-content",lt.DragAndDropStyle="drag-and-drop--outline";var ct=i("vHlr"),ut=i("JScD"),dt=i("6u39"),ht=i("vSs+");class pt{constructor(e,t,i,n,r,a,o,s,l,c,u,d,h,p,m,f,g,b,v,S,y,C,w,I,T){this.accessTokenService=e,this.bannerConfigService=t,this.capabilitiesService=i,this.changeDetectorRef=n,this.consumerInstallConfigService=r,this.cookieService=a,this.createDocumentService=o,this.documentService=s,this.eventService=l,this.featureCalloutService=c,this.firstRunCalloutsConfigService=u,this.firstRunCalloutsService=d,this.firstRunDataService=h,this.floodgateService=p,this.injector=m,this.instrumentationService=f,this.jumpListService=g,this.localAppLauncherService=b,this.localStorageService=v,this.pinToTaskbarService=S,this.router=y,this.windowService=C,this.uploadLocalFileService=w,this.urlLauncherService=I,this.wacContentService=T,this.backgroundStyle={},this.officeHomeClass=[],this.visualOfficeWrapperStyle={},this.viewInitializationCompleted=!1,this.showAnnouncement=!1,this.firstVisitTimestampKey="_PwaFirstVisitTimestamp"}ngOnInit(){this.eventService.events.withScope(0).pipe(Object(Te.a)((e=>"appInitialized"===e.name)),Object(ke.a)(1)).toPromise().then((()=>Object(n.__awaiter)(this,void 0,void 0,(function*(){const e=this.injector.get(d.b),t=this.injector.get(V.a);this.interactiveAppDisplayed=Promise.resolve(),this.isPwaJumpListEnabled=t.config.pwaJumpListEnabled,this.themeRootCssClass=Be.b,this.contextService=this.injector.get(B.a),this.isConsumer=e.config.authType===d.a.MSA,this.officeRouteService=this.injector.get(M.a);const n=this.injector.get(ee.a),r=this.injector.get(at.a),a=this.injector.get(je.a),o=this.injector.get(ht.a),s=this.injector.get(H.a),l=this.injector.get(te.a),u=this.injector.get(Me.a),h=this.injector.get(rt.a);this.themingService=this.injector.get(Re.b),this.visualService=this.injector.get(it.a),this.leftNavReact=this.capabilitiesService.capabilities.leftNavReact&&!this.capabilitiesService.capabilities.appBarEnabled;const p=this.capabilitiesService.capabilities.leftNavReact||this.capabilitiesService.capabilities.appBarEnabled;this.showAnnouncement=this.capabilitiesService.capabilities.announcementEnabled,this.appBarEnabled=this.capabilitiesService.capabilities.appBarEnabled,this.appsModuleEnabled=this.capabilitiesService.capabilities.appsModuleEnabled,this.wacHostEnabled=this.capabilitiesService.capabilities.wacHostEnabled,this.taskModule=this.capabilitiesService.capabilities.m365AppsEnabled,this.webVitalsEnabled=this.capabilitiesService.capabilities.webVitalsEnabled,this.memoryProfilingEnabled=this.capabilitiesService.capabilities.memoryProfilingEnabled,this.fluentThemeRefreshEnabled=this.capabilitiesService.capabilities.fluentRefresh,this.fluentHeaderEnabled=this.capabilitiesService.capabilities.fluentHeader,this.toastContainer=this.capabilitiesService.capabilities.contentActionsEnabled,this.uploadV2=this.capabilitiesService.capabilities.uploadV2Enabled,this.createOneNotePageEnabled=this.capabilitiesService.capabilities.createOneNotePageEnabled,this.customPivots=p&&this.capabilitiesService.capabilities.quickAccessV1CustomPivotEnabled,this.actionContextMenuEnabled=this.capabilitiesService.capabilities.contentActionsEnabled&&this.capabilitiesService.capabilities.contentActionsOHomeEnabled;const m=this.capabilitiesService.capabilities.defaultHeaderLayoutEnabled;this.backgroundImageSubscription=this.themingService.themeShades.pipe(Object(Ae.a)(this.officeRouteService.getRouteChangeStartObservable(),((e,t)=>({themeEvent:e,routeEvent:t})))).subscribe((({themeEvent:e,routeEvent:t})=>{const i=t.currentRoute;this.showBackgroundImage=!e.theme.reactShellTheme.IsDarkMode&&("App"===e.theme.themeType||"Default"===e.theme.themeType||this.isConsumer)&&!!this.contextService.sharedContext.fluentHeroImageUrl&&!this.leftNavReact&&!this.appBarEnabled&&!(i&&i.app)&&"AppGallery"!==i.route,this.backgroundStyle["background-image"]=this.showBackgroundImage?`url(${this.contextService.sharedContext.fluentHeroImageUrl})`:""})),this.fluentThemeRefreshEnabled&&(this.fluentProviderClassSubscription=this.eventService.events.withScope(0).pipe(Object(Te.a)((e=>{var t;return"fluentClassNameChanged"===e.name&&1===(null===(t=e.args)||void 0===t?void 0:t.length)}))).subscribe((e=>{this.themeRootCssClass=Be.b+" "+e.args[0]}))),this.onWacContentPage=this.officeRouteService.getRouteChangeStartObservable().pipe(Object(_e.a)((e=>"Content"===e.currentRoute.route)));const f=this.injector.get(He.a);this.searchEnabled=this.capabilitiesService.capabilities.showSearch&&!!f.config,this.nativeSearchEnabled=this.capabilitiesService.capabilities.nativeSearchInHeaderEnabled,this.routeChangeSubscription=this.officeRouteService.getRouteChangeStartObservable().subscribe((e=>{const t=e.currentRoute.route;this.onAppGallery="AppGallery"===t,this.onMyContentPage="MyContent"===t,this.onFeedPage="Feed"===t,this.showFASTBreadcrumb="SearchSiteScoped"===t,this.showWorkspaceNav=this.onAppGallery&&!this.appsModuleEnabled,this.showWorkspaceNav?this.officeHomeClass.push("app-gallery-workspace-nav-offset"):this.removeOfficeHomeClass("app-gallery-workspace-nav-offset"),this.showAnnouncement=("Content"!==t||!e.currentRoute.app||e.currentRoute.app!==Q.b.Fluid)&&this.capabilitiesService.capabilities.announcementEnabled})),this.localStorageService.get(this.firstVisitTimestampKey)||(this.localStorageService.set(this.firstVisitTimestampKey,(new Date).toISOString()),this.instrumentationService.logGenericEvent("First_Site_Visit"));const g=this.injector.get(Le.a);this.capabilitiesService.capabilities.firstRunReactEnabled?Promise.all([i.e(0),i.e(218)]).then(i.bind(null,"Hnto")).then((e=>{e.fetchFirstRunState().then((e=>{e.CompletedFirstRun?this.tryPinToTaskbar():this.firstRunEnabled=!0}))})):this.injector.get(Ue.a).getConfig().then((e=>{this.firstRunEnabled=!(g.user.hasNoLicense||!e||!e.model||this.contextService.sharedContext.inMockMode),this.firstRunVersion=this.firstRunCalloutsConfigService.config.version,(this.isConsumer?this.firstRunDataService.fetchFirstRunData(this.firstRunVersion,!0,Ne.a.firstRunDataKey).then((e=>{e.CompletedFirstRun&&(this.firstRunEnabled=!1)})):Promise.resolve()).then((()=>{this.firstRunEnabled?(this.shellHeader=this.documentService.nativeDocument.getElementById("ReactShellHeader"),this.officeHomeClass=[],this.eventService.events.withScope(1).pipe(Object(Te.a)((e=>"firstRunModalOpen"===e.name)),Object(ke.a)(1)).toPromise().then((()=>{this.officeHomeClass.push("blur-background"),this.shellHeader.classList.add("blur-background")})),this.eventService.events.withScope(1).pipe(Object(Te.a)((e=>"firstRunModalClosed"===e.name)),Object(ke.a)(1)).toPromise().then((()=>{const e=this.officeHomeClass.indexOf("blur-background");e>=0&&this.officeHomeClass.splice(e,1),this.shellHeader.classList.remove("blur-background"),this.tryPinToTaskbar()}))):this.tryPinToTaskbar()}))})),this.interactiveAppDisplayed.then((()=>this.firstRunCalloutsService.initializeFirstRun())),this.featureCalloutSubscription=this.featureCalloutService.callouts.subscribe((e=>{this.loadFeatureCalloutModule=e.length>0})),this.teachingUiReactModuleEnabled=!1,this.loadTeachingUiReactModule=!1,this.featureCalloutSubscription=this.featureCalloutService.callouts.subscribe((e=>{this.loadFeatureCalloutModule=e.length>0,this.loadTeachingUiReactModule=!this.loadFeatureCalloutModule&&this.teachingUiReactModuleEnabled})),this.capabilitiesService.capabilities.teachingUiReactEnabled&&this.injector.get(We).shouldShowCallouts().then((e=>{this.loadTeachingUiReactModule=!e,this.teachingUiReactModuleEnabled=!e})),this.dragAndDropUtility=new lt(this.documentService,this.injector.get(ut.a),this.injector.get(ct.a),this.injector.get($e.a),this.isConsumer);const b=this.injector.get(c.a);if(b.scheduleWork((()=>{u.getShellShim().then((e=>{e.Header&&e.Header.OnShyHeaderModeChanged((e=>{e?this.officeHomeClass.push("shell--hidden"):this.removeOfficeHomeClass("shell--hidden"),this.changeDetectorRef.detectChanges()})),e.GetResourceLoader&&e.GetResourceLoader().loadAll()}))}),4),this.isConsumer&&!m&&(b.scheduleWork((()=>i.e(253).then(i.bind(null,"r8hs")).then((e=>{this.upsellButtonUtility=new e.UpsellButton(this.consumerInstallConfigService,this.contextService,this.eventService,this.injector,this.officeRouteService,this.capabilitiesService,this.injector.get(at.a))}))),4),b.scheduleWork((()=>Promise.all([i.e(4),i.e(236)]).then(i.bind(null,"T8N+")).then((e=>{this.meetNowButtonUtility=new e.MeetNowButton(this.contextService,this.eventService,this.injector)}))),4)),this.isConsumer&&m&&b.scheduleWork((()=>{i.e(52).then(i.bind(null,"r36c")).then((t=>{this.shellBootstrapService=new t.ShellBootstrapService(this.capabilitiesService,e,n,r,this.contextService,this.documentService,this.eventService,this.featureCalloutService,a,this.instrumentationService,l,this.localStorageService,this.officeRouteService,h,u,o,s),this.shellBootstrapService.triggerMeetNow(),this.shellBootstrapService.triggerGoPremium(),this.shellBootstrapService.triggerBenefits()}))}),4),this.capabilitiesService.capabilities.visualSettingEnabled&&b.scheduleWork((()=>{i.e(52).then(i.bind(null,"r36c")).then((t=>{this.shellBootstrapService||(this.shellBootstrapService=new t.ShellBootstrapService(this.capabilitiesService,e,n,r,this.contextService,this.documentService,this.eventService,this.featureCalloutService,a,this.instrumentationService,l,this.localStorageService,this.officeRouteService,h,u,o,s)),this.shellBootstrapService.registerSettingsFlexPane()}))}),4),this.injector.get(Ke.a).config){const t=this.injector.get(Je.a);this.capabilitiesService.capabilities.adminPolicyEnabled?this.injector.get(ze.a).getAdminPolicy().then((i=>{i&&i.SendFeedback.State&&this.setupOcvFeedback({consumerInstallConfigService:n,consumerPublicDataService:r,feedbackService:t,installConfigService:a,locService:l,reactShellConfigService:h,scheduler:b,shellShimService:u,startupConfigService:e,upsellDataService:o,urlLauncherService:s})})):this.setupOcvFeedback({consumerInstallConfigService:n,consumerPublicDataService:r,feedbackService:t,installConfigService:a,locService:l,reactShellConfigService:h,scheduler:b,shellShimService:u,startupConfigService:e,upsellDataService:o,urlLauncherService:s})}this.viewInitializationCompleted=!0,this.router.navigated||this.router.initialNavigation();const v=(e=>["mruReady","recommendedReady","appBarReady"].map((e=>this.eventService.whenEventFired(e,0))))();Promise.race(v).then((()=>{console.log("logging lifeCycle responsive event"),this.windowService.nativeWindow.logPwaLifecycleEvent(this.windowService.nativeWindow.pwaResuming?2:0)})).catch();try{const e=this.localStorageService.getGlobal(pt.PwaOnActivatePendingEventArgsKey);e&&e.by&&e.argument&&this.handlePendingEvent(e)}catch(e){const t={};t.Error=(e||"").toString(),t.Action="HandlePendingEventFromLocalStorage",this.instrumentationService.logGenericEvent("Pwa_On_Activated",t,[],2),Object(z.a)({eventName:"Pwa_On_Activated",message:(e||"").toString(),debugInfo:"HandlePendingEventFromLocalStorage"},Z.a.Enhanced)}if(this.localStorageService.removeGlobal(pt.PwaOnActivatePendingEventArgsKey),this.capabilitiesService.capabilities.showFloodgate&&this.capabilitiesService.capabilities.showPwaFeelingsSurvey){const e=new Date,t=e.getDate();8===e.getMonth()&&(t>=3&&t<14||t>=24&&t<28)&&this.floodgateService.recordFloodgate(["IsCorrectDay"])}this.visualConfigSubscription=this.visualService.visualConfigSubscription.subscribe((e=>{this.visualBackgroundEnabled=e.visualBackgroundEnabled,this.visualOfficeWrapperStyle=e.visualOfficeWrapperStyle}))}))));const e=this.windowService.nativeWindow.navigator;e&&"boolean"==typeof e.onLine&&!e.onLine&&this.sendOfflineNotification()}ngOnDestroy(){var e;this.backgroundImageSubscription&&this.backgroundImageSubscription.unsubscribe(),this.featureCalloutSubscription&&this.featureCalloutSubscription.unsubscribe(),this.upsellButtonUtility&&this.upsellButtonUtility.unsubscribe(),this.meetNowButtonUtility&&this.meetNowButtonUtility.unsubscribe(),this.routeChangeSubscription&&this.routeChangeSubscription.unsubscribe(),null===(e=this.fluentProviderClassSubscription)||void 0===e||e.unsubscribe(),this.shellBootstrapService&&this.shellBootstrapService.unsubscribe(),this.visualConfigSubscription&&this.visualConfigSubscription.unsubscribe()}sendOfflineNotification(){this.eventService.broadcastEvent({name:"newAnnouncement",args:[new Pe.a("OfflineMode",this.bannerConfigService.config.resources.OfflineModeMessage,null,`${Ge.a.FluentIconCssClass} ${Ge.a.getCssClass(qe.a.CircleInfo)}`)]})}sendOnlineNotification(){this.eventService.broadcastEvent({name:"closeAnnouncement",args:["OfflineMode"]})}onWindowFocus(){this.eventService.broadcastEvent({name:"windowFocused",args:[]})}onWindowResize(){this.eventService.broadcastEvent({name:"windowResized",args:[]})}onActivate(e){e&&e.detail&&e.detail.by&&e.detail.argument&&this.handlePendingEvent(e.detail),this.localStorageService.removeGlobal(pt.PwaOnActivatePendingEventArgsKey)}onResize(e){const{width:t,height:i}=e;this.contentWidth!==t&&(this.contentWidth=t,this.eventService.broadcastEvent({name:"contentWidthChanged",args:[t]})),this.contentHeight!==i&&(this.contentHeight=i,this.eventService.broadcastEvent({name:"contentHeightChanged",args:[i]}))}dragoverHandler(e){e.preventDefault(),this.dragAndDropUtility.onDragOver(e)}dropHandler(e){e.preventDefault(),this.dragAndDropUtility.onDrop(e)}removeOfficeHomeClass(e){this.officeHomeClass=this.officeHomeClass?this.officeHomeClass.filter((t=>t!==e)):[]}tryPinToTaskbar(){const e={State:"Init"};this.instrumentationService.logGenericEvent("Pin_To_Taskbar",e,[],2);const t="pinToTaskbarDismissed";this.cookieService.get(t)||this.pinToTaskbarService.isEligibleToPin().then((i=>{i&&(e.State="Eligible",this.instrumentationService.logGenericEvent("Pin_To_Taskbar",e,[],2),this.pinToTaskbarService.pinToTaskbar().then((i=>{e.State=i?"Success":"Failed",this.instrumentationService.logGenericEvent("Pin_To_Taskbar",e,[],2);const n=new Date;n.setFullYear(n.getFullYear()+50),this.cookieService.set(t,"1",n,"/",void 0,!0)})))}))}handlePendingEvent(e){switch(e.by){case"JumpList":this.handleJumpListEvent(e.argument,e.previousExecutionState);break;case"WordPad":case"CovidLockscreen":case"CovidStartMenu":case"CovidAMC":case"CovidActionCenter":case"HVAStartMenu":case"CGEAwareness":this.handleNavigationEvent(e.argument);break;case"M365Apps":this.handleUrlNavigationEvent(e.argument)}}handleUrlNavigationEvent(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const t=`${window.location.origin}/m365apps${e}`;this.capabilitiesService.capabilities.contentLauncherEnabled?yield Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((e=>{e.launchUrl(t,{action:"OpenInApp",linkTarget:"_self"})})):yield this.urlLauncherService.openUrl(t,"OpenInApp","_self")}))}handleNavigationEvent(e){"Word"===e?this.officeRouteService.navigateTo({route:"Start",app:Q.b.Word}):"Excel"===e?this.officeRouteService.navigateTo({route:"Start",app:Q.b.Excel}):"PowerPoint"===e&&this.officeRouteService.navigateTo({route:"Start",app:Q.b.PowerPoint})}handleJumpListEvent(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function*(){if(this.isPwaJumpListEnabled){let i;try{const t=JSON.parse(e);if(void 0!==t.createFileType)i=yield this.createNewFile(t.createFileType);else if(void 0!==t.id){const e=this.jumpListService.getJumpListItemById(t.id);i=yield this.openJumpListFiles(e)}}catch(e){const t={};t.Error=(e||"").toString(),t.Action="ActivateByJumpListEventReceived",this.instrumentationService.logGenericEvent("Pwa_Jump_List",t,[],2),Object(a.a)({featureName:"Hwa",eventName:"Pwa_Jump_List",params:t},Z.a.Enhanced),i=!1}this.exitAppOrMakeAppVisible(i,t)}}))}openJumpListFiles(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return!!e&&new Promise((t=>Object(n.__awaiter)(this,void 0,void 0,(function*(){const n={State:"Handled"};n.ItemCategory=e.group,n.Action="OpenFile";const r=Ve.b.referralFromFileType(e.fileType),o="jump-list-file-item",s=(e,t,i,s)=>{e?(this.instrumentationService.logClickEvent("Pwa_Jump_List_Item_Click",o,"jump-list",r,t,n,[],2),Object(Ie.a)({id:o,area:"JumpList",eventName:"Pwa_Jump_List_Item_Click",result:"Refer",target:Object(_.a)(r)},Z.a.Enhanced)):(n.Error=s||(i?"JumpListFileOpenUIHostError":"JumpListFileOpenError"),n.Referral=r,this.instrumentationService.logGenericEvent("Pwa_Jump_List",n,[],2),Object(a.a)({featureName:"Hwa",eventName:"Pwa_Jump_List",params:n},Z.a.Enhanced))};try{if(this.capabilitiesService.capabilities.contentLauncherEnabled)Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((i=>{i.launchApp({action:"OpenMruItem",appName:e.application,url:e.canonicalUrl,useUrl:!0}).then((i=>i.success?(s(!0,"Native",!1),t(!0)):e.isLocal?(this.uploadLocalFileService.showModal(e.url,e.fileName,1),n.Action="OpenFileNeedUpload",s(!0,"Web",!1),t(!1)):void 0))}));else{if(yield this.localAppLauncherService.launchOfficeApp(e.application,e.canonicalUrl,null))return s(!0,"Native",!1),t(!0);if(e.isLocal)return this.uploadLocalFileService.showModal(e.url,e.fileName,1),n.Action="OpenFileNeedUpload",s(!0,"Web",!1),t(!1)}}catch(e){}const l=this.capabilitiesService.wacHostEnabledForFileType(e.fileType)&&!e.isLocal,c=(!e.isOnPremOrVanity||this.isConsumer)&&this.accessTokenService.hasOneDriveToken()||this.contextService.sharedContext.inMockMode;try{if(!this.capabilitiesService.capabilities.contentLauncherEnabled){if(l&&c){const i={docId:e.docId,docUrl:e.canonicalUrl,driveId:e.driveId,fileType:e.fileType,fileName:e.fileName,wdOrigin:this.contextService.getWdOrigin("JUMPLIST")};return yield this.wacContentService.bootstrapAndRoute(i,void 0,Date.now()),s(!0,"Web",!0),t(!1)}return this.capabilitiesService.capabilities.contentLauncherEnabled?yield Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((t=>{t.launchUrl(e.url,{action:"OpenJumpListItem"})})):yield this.urlLauncherService.openUrl(e.url,"OpenJumpListItem"),s(!0,"Web",!1),t(!0)}{const n="Pwa_Jump_List",r={app:e.application,attribution:e.fileTypeName,canonicalUrl:e.canonicalUrl,docId:e.docId,driveId:e.driveId,extension:e.fileTypeName,fileName:e.fileName,id:e.jumpListItemId,isLocalFile:e.isLocal,isOnPremOrVanity:e.isOnPremOrVanity,title:e.fileName,url:e.url},a=Object(Ce.a)(r,n,0,"Click","PwaDialog");yield Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((i=>{i.launchContent({action:"OpenInApp",document:r,linkTarget:event&&event.ctrlKey?"_blank":"_self",wdOriginType:"NEW"},{area:"PwaDialog",eventName:n,elementId:e.jumpListItemId,referral:Object(we.a)(Q.b[e.fileType]),clickParams:a}).then((()=>l&&c?(s(!0,"Web",!0),t(!1)):(s(!0,"Web",!1),t(!0))))}))}}catch(e){return s(!1,"Web",l&&c,e.toString()),t(!1)}}))))}))}setupOcvFeedback(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const{reactShellConfigService:t,feedbackService:n}=e;if(this.capabilitiesService.capabilities.visualSettingEnabled){const{consumerPublicDataService:n,consumerInstallConfigService:r,installConfigService:a,locService:o,scheduler:s,shellShimService:l,startupConfigService:c,upsellDataService:u,urlLauncherService:d}=e;s.scheduleWork((()=>{i.e(52).then(i.bind(null,"r36c")).then((e=>{this.shellBootstrapService||(this.shellBootstrapService=new e.ShellBootstrapService(this.capabilitiesService,c,r,n,this.contextService,this.documentService,this.eventService,this.featureCalloutService,a,this.instrumentationService,o,this.localStorageService,this.officeRouteService,t,l,u,d)),this.shellBootstrapService.registerSettingsFlexPaneFeedbackLink(t.reactShellConfig.feedbackLinkText,(()=>{this.eventService.broadcastEvent({name:"shellOpenFeedback",args:[]})}))}))}),4)}else HomePage.ShellUtil.ShowOCVFeedbackLink(t.reactShellConfig);this.eventService.events.withScope(1).pipe(Object(Te.a)((e=>"shellOpenFeedback"===e.name))).subscribe((()=>n.loadOCVFeedback()))}))}createNewFile(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const t={State:"Handled",Action:"CreateNewFile"},n="jump-list-task-item",r="jump-list";let a=Ve.b.referralFromFileType(Q.b[e]);if(this.capabilitiesService.capabilities.pwaEnabled&&Q.b[e]===Q.b.Excel)try{if(this.capabilitiesService.capabilities.contentLauncherEnabled){if(yield Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((e=>e.launchApp({action:"OpenMruItem",appName:Q.b[Q.b.Excel],url:""}))))return this.instrumentationService.logClickEvent("Pwa_Jump_List_Item_Click",n,r,a,"Native",t,[],2),Object(Ie.a)({id:n,area:"JumpList",eventName:"Pwa_Jump_List_Item_Click",result:"Refer",target:Object(_.a)(a)},Z.a.Enhanced),!0}else if(yield this.localAppLauncherService.launchOfficeApp(Q.b[Q.b.Excel],"",null,!0))return this.instrumentationService.logClickEvent("Pwa_Jump_List_Item_Click",n,r,a,"Native",t,[],2),Object(Ie.a)({id:n,area:"JumpList",eventName:"Pwa_Jump_List_Item_Click",result:"Refer",target:Object(_.a)(a)},Z.a.Enhanced),!0}catch(e){}return new Promise((i=>{this.createDocumentService.createItem(Q.b[e],null,null,(e=>{a="Error"===e.type||"CreatePending"===e.type?"":a,this.instrumentationService.logClickEvent("Pwa_Jump_List_Item_Click",n,r,a,e.platform,t,[],2),Object(Ie.a)({id:n,area:"JumpList",eventName:"Pwa_Jump_List_Item_Click",result:a?"Refer":"Navigate",target:a?Object(_.a)(a):"Other"},Z.a.Enhanced),i(!("Error"===e.type||"CreatePending"===e.type||"GoToBlankDoc"===e.type&&"Web"===e.platform))}))}))}))}exitAppOrMakeAppVisible(e,t){if(0===t&&void 0!==Windows.ApplicationModel.Core&&void 0!==Windows.ApplicationModel.Core.CoreApplication&&void 0!==Windows.ApplicationModel.Core.CoreApplication.exit&&void 0!==Windows.UI.WindowManagement&&void 0!==Windows.UI.WindowManagement.AppWindow)try{return void(e?Windows.ApplicationModel.Core.CoreApplication.exit():(new Windows.UI.WindowManagement.AppWindow).tryShowAsync().then((e=>{e||Windows.ApplicationModel.Core.CoreApplication.exit()})))}catch(t){const i={};i.Error=(t||"ExitAppOrMakeAppVisible error").toString(),i.Action=e?"ExitAppOnJumpListHandled":"MakeAppVisibleOnJumpListHandled",this.instrumentationService.logGenericEvent("Pwa_Jump_List",i,[],2)}}}pt.PwaOnActivatePendingEventArgsKey="PwaOnActivatePendingEventArgs";var mt=i("fYis"),ft=i("KoFE"),gt=i("9c4X"),bt=i("6Po3"),vt=i("pzhl"),St=i("PkQn");class yt{constructor(e,t,i,n,r,a,o){this.capabilitiesService=e,this.feedbackService=t,this.locService=i,this.contextService=n,this.eventService=r,this.renderer=a,this.windowService=o,this.supportOffset=0,this.flexPaneOffset=0,this.pageOffset=0}ngOnInit(){this.header=this.locService.FeedbackHeader,this.minimizedHeaderAriaLabel=this.locService.FeedbackMinimizedAriaLabel}ngAfterViewInit(){this.paneOpenSubscription=this.eventService.events.withScope(1).pipe(Object(Te.a)((e=>"flexPaneOpen"===e.name&&!!e.args&&!!e.args.length))).subscribe((e=>{if(this.capabilitiesService.capabilities.supportCentralEnabled&&this.supportOffset)return;let t,i;[t,i]=e.args,this.flexPaneOffset=t?i:0,this.positionFeedbackElement()})),this.eventService.events.withScope(0).pipe(Object(Te.a)((e=>"supportCentralLoaded"===e.name&&!!e.args&&!!e.args.length)),Object(ke.a)(1)).toPromise().then((e=>{this.supportOffset=e.args[0],this.positionFeedbackElement()})),this.updatePageOffset()}ngOnDestroy(){this.paneOpenSubscription&&this.paneOpenSubscription.unsubscribe()}openFeedback(){this.feedbackService.loadOCVFeedback((()=>this.feedbackContainer.nativeElement.focus()))}positionFeedbackElement(){this.renderer.setStyle(this.feedbackContainer.nativeElement,this.contextService.isRtl?"left":"right",`${this.flexPaneOffset+(this.supportOffset||this.pageOffset)}px`)}updatePageOffset(){const e=this.windowService.nativeWindow.innerWidth<480?24:50;e!==this.pageOffset&&(this.pageOffset=e,this.positionFeedbackElement())}}var Ct=r.Fb({encapsulation:2,styles:[],data:{}});function wt(e){return r.jc(0,[r.cc(671088640,1,{feedbackContainer:0}),(e()(),r.Hb(1,0,[[1,0],["feedbackContainer",1]],null,6,"button",[["class","feedback-container"],["data-clicklog","custom"],["id","feedbackContainer"]],[[1,"aria-label",0],[8,"title",0]],[[null,"click"],[null,"ohpResize"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.openFeedback()&&n),"ohpResize"===t&&(n=!1!==r.updatePageOffset()&&n),n}),null,null)),r.Gb(2,4407296,null,0,ft.a,[gt.a,r.o,bt.a],null,{resize:"ohpResize"}),(e()(),r.Hb(3,0,null,null,4,"div",[["class","feedback-header"]],null,null,null,null,null)),(e()(),r.Hb(4,0,null,null,1,"ohp-icon-font",[["aria-hidden","true"],["cssClass","feedback-container__header-icon"],["iconFontName","Chat"],["size","14"]],null,null,null,vt.b,vt.a)),r.Gb(5,638976,null,0,St.a,[R.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null),(e()(),r.Hb(6,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),r.gc(7,null,["",""]))],(function(e,t){e(t,2,0),e(t,5,0,"feedback-container__header-icon","Chat","14")}),(function(e,t){var i=t.component;e(t,1,0,i.minimizedHeaderAriaLabel,i.minimizedHeaderAriaLabel),e(t,7,0,i.header)}))}var It=r.Db("ohp-feedback",yt,(function(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-feedback",[],null,null,null,wt,Ct)),r.Gb(1,4440064,null,0,yt,[R.a,Je.a,te.a,B.a,D.a,r.K,u.b],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]),Tt=i("7IJ8"),kt=i("QhWD"),At=i("RsrG"),_t=i("g/dT"),Pt=i("QtYd"),Et=i("OOtI"),Ft=i("QOOv"),Ot=i("7Rc8"),Dt=i("dOgD"),Mt=i("+YV+"),Rt=i("RJiy"),xt=i("9MHL"),Lt=i("mNaV"),Ut=i("vk2e");class Nt{constructor(e,t){this.capabilitiesService=e,this.clientStartupConfigService=t}ngOnInit(){this.showSuggestedActions=this.capabilitiesService.capabilities.suggestedActionsEnabled,this.showPlaces=this.clientStartupConfigService.config.authType===d.a.OrgId&&!this.capabilitiesService.capabilities.edgeworthEnabled}}var Wt=r.Fb({encapsulation:2,styles:[],data:{}});function jt(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"places#PlacesModule")}),null)}function Ht(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,6,"div",[["ohpInstrumentPageView","Home_PageView"]],null,null,null,null,null)),r.Gb(1,81920,null,0,_t.a,[L.b,T.a],{pageName:[0,"pageName"]},null),(e()(),r.Hb(2,0,null,null,4,"div",[["role","main"]],null,null,null,null,null)),(e()(),r.Hb(3,0,null,null,1,"ohp-documents-component",[],null,null,null,Pt.b,Pt.a)),r.Gb(4,4440064,null,0,Et.a,[R.a,D.a,Ft.a,te.a,Ot.a,Dt.a,Mt.a,Rt.a,xt.a,ut.a,d.b,d.b,Lt.a,B.a,it.a],{firstSection:[0,"firstSection"],headless:[1,"headless"],isSuggestedActions:[2,"isSuggestedActions"]},null),(e()(),r.qb(16777216,null,null,1,null,jt)),r.Gb(6,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,1,0,"Home_PageView"),e(t,4,0,!0,!0,i.showSuggestedActions),e(t,6,0,i.showPlaces)}),null)}var Bt=r.Db("ohp-pwa",Nt,(function(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-pwa",[],null,null,null,Ht,Wt)),r.Gb(1,114688,null,0,Nt,[R.a,d.b],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]),Gt=i("R0N1"),qt=i("VrZ9"),Vt=i("MRNN"),$t=i("rPZ4"),zt=i("Zy3K"),Zt=i("dvrM"),Kt=i("W0EU"),Jt=i("xSeq"),Qt=i("xJIt"),Yt=i("cj6A"),Xt=i("BJFG"),ei=i("ExL+"),ti=i("hoyd"),ii=i("pjz5"),ni=i("dFxn");class ri{constructor(e){this.config=e.parse("appTilesConfig")||{coreAppIds:[],mobileAppIds:[],myAccountUrl:null,resources:null,segmentSpecificAppIds:[]}}}ri.ɵprov=r.kc({factory:function(){return new ri(r.lc(ni.a))},token:ri,providedIn:"root"});class ai{constructor(e,t,i,n,a,o,s,l,c,u,d){this.appTilesConfigService=e,this.capabilitiesService=t,this.contextService=i,this.eventService=n,this.instrumentationService=a,this.workloadsService=o,this.appLauncherService=s,this.locService=l,this.changeDetectorRef=c,this.themingService=u,this.shellService=d,this.unpinWorkload=new r.q}set forceWhiteBackground(e){this._forceWhiteBackground=e,this.setBackgroundColor()}get forceWhiteBackground(){return this._forceWhiteBackground}set showHover(e){this._showHover=e}get showHover(){return this._showHover}ngOnInit(){const e=this.appTilesConfigService.config;this.isProvisioned=!!this.workload.Url,this.ariaLabel=this.workload.Text,this.thirdPartyIconAriaLabel=this.locService.format(this.locService.ThirdPartyIconAriaLabel,this.workload.Text),this.preloadPath=this.workload.InAppNav?"Start":ii.a.getOrigin(this.workload.Url),this.removeAppAriaLabel=this.locService.RemoveDocumentActionTitle,this.isProvisioned?(this.capabilitiesService.capabilities.darkModeEnabled&&(this.themeShadesSubscription=this.themingService.darkModeSubscription.subscribe((e=>{this.appColor=e&&this.workload.ChangeColorInDarkMode?"white":""}))),this.setBackgroundColor()):this.provisioningText=e.resources&&e.resources.ProvisioningTileText}ngOnChanges(e){e.hasOwnProperty("workload")&&(this.elementId=`${e.workload.currentValue.Id}_link`,this.setBackgroundColor(),this.iconLoaded=this.iconLoaded&&e.workload.currentValue.ThirdPartyIcon===e.workload.previousValue.ThirdPartyIcon)}ngOnDestroy(){this.themeShadesSubscription&&this.themeShadesSubscription.unsubscribe()}mouseOverTile(){this.workload.Url&&(this.showHover=!0),this.checkedODSPProvisioningStatus||this.workload.FileType!==Q.b.SharePoint&&this.workload.FileType!==Q.b.OneDrive||(this.shellService.initializeProvisioningStatus(),this.checkedODSPProvisioningStatus=!0)}onTileClick(e){if(this.showHover=!1,!this.workload.Url&&e)return void e.preventDefault();const t="_blank"===this.contextService.sharedContext.defaultLinkTarget;t||this.instrumentTileClick("Web"),this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((i=>{i.launchApp({action:"OpenAppTile",event:e,appName:this.workload.Text,url:this.workload.Url}).then((e=>{t&&this.instrumentTileClick(e.result)}))})):this.appLauncherService.launchApp(this.workload,e,"OpenAppTile").then((e=>{t&&this.instrumentTileClick(e)}))}unfocusTile(){this.showHover=!1}instrumentTileClick(e){const t=e?this.workload.Referral:"",i=Object(_.a)(this.workload.Referral),n=T.b.AppTiles,r={};r.State=this.inExpandedView?"expanded":"reduced",r.ReferralType=this.workloadsService.getReferralType(this.workload).toString(),this.instrumentationService.logClickEvent("Generic_Click",i,n,t,"Native"===e?"Native":"Web",r,[],0,this.workload.InAppNav),Object(Ie.a)({id:i,area:n,result:t?"Refer":"Navigate",target:t?i:"Other"}),this.eventService.broadcastEvent({name:"appTileClick",args:[this.workload.AppId]})}instrumentRightClick(){const e={};e.ElementId=Object(_.a)(this.workload.Referral),this.instrumentationService.logGenericEvent("App_Tile_Right_Click",e)}onIconLoad(){setTimeout((()=>{this.iconLoaded=!0,this.changeDetectorRef.markForCheck()}))}onIconError(){setTimeout((()=>{this.iconLoaded=!1,this.changeDetectorRef.markForCheck()}))}unpinApp(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){e&&e.preventDefault(),this.unpinWorkload.emit({item:this.workload})}))}setBackgroundColor(){this.setWhiteBackground=this.forceWhiteBackground}}var oi=r.Fb({encapsulation:2,styles:[],data:{}});function si(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-icon-font",[],null,null,null,vt.b,vt.a)),r.Gb(1,638976,null,0,St.a,[R.a],{iconFontCssClass:[0,"iconFontCssClass"],iconFontName:[1,"iconFontName"],isThirdParty:[2,"isThirdParty"]},null)],(function(e,t){var i=t.component;e(t,1,0,i.workload.IconUnicodeCodepointCssClass+" app-tile-icon--small",i.workload.IconFont,i.workload.IsThirdParty)}),null)}function li(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,0,"img",[["aria-hidden","true"],["class","workload-item__icon--image"]],[[8,"hidden",0],[8,"src",4],[1,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,i){var n=!0,r=e.component;return"load"===t&&(n=!1!==r.onIconLoad()&&n),"error"===t&&(n=!1!==r.onIconError()&&n),n}),null,null))],null,(function(e,t){var i=t.component;e(t,0,0,!i.iconLoaded,i.workload.ThirdPartyIcon,i.thirdPartyIconAriaLabel)}))}function ci(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"span",[["class","workload-item-text--provisioning--fluent"]],null,null,null,null,null)),(e()(),r.gc(1,null,[" "," "]))],null,(function(e,t){e(t,1,0,t.component.provisioningText)}))}function ui(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,2,"span",[["class","workload-item__unpin ms-fcl-nd ms-fcl-tp-h ms-fcl-tp-f ms-bgc-g40-h ms-bgc-g40-f"],["role","button"],["tabindex","0"]],[[1,"aria-label",0],[8,"title",0]],[[null,"click"],[null,"keyup.enter"],[null,"keyup.space"],[null,"focus"],[null,"blur"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.unpinApp(i)&&n),"keyup.enter"===t&&(n=!1!==r.unpinApp(i)&&n),"keyup.space"===t&&(n=!1!==r.unpinApp(i)&&n),"focus"===t&&(n=!1!==r.mouseOverTile()&&n),"blur"===t&&(n=!1!==r.unfocusTile()&&n),n}),null,null)),(e()(),r.Hb(1,0,null,null,1,"ohp-icon-font",[["iconFontName","X"]],null,null,null,vt.b,vt.a)),r.Gb(2,638976,null,0,St.a,[R.a],{iconFontName:[0,"iconFontName"]},null)],(function(e,t){e(t,2,0,"X")}),(function(e,t){var i=t.component;e(t,0,0,i.removeAppAriaLabel,i.removeAppAriaLabel)}))}function di(e){return r.jc(2,[(e()(),r.Hb(0,0,null,null,26,"div",[["class","workload-item animated-tile"]],null,[[null,"mouseover"],[null,"contextmenu"],[null,"mouseleave"]],(function(e,t,i){var n=!0,r=e.component;return"mouseover"===t&&(n=!1!==r.mouseOverTile()&&n),"contextmenu"===t&&(n=!1!==r.instrumentRightClick()&&n),"mouseleave"===t&&(n=!1!==r.unfocusTile()&&n),n}),null,null)),(e()(),r.Hb(1,0,null,null,25,"a",[["class","o365cs-base workload-item__link ms-bgc-w-h ms-bgc-w-a ms-bgc-w-f"],["data-clicklog","custom"],["ohpDefaultLinkTarget",""],["rel","noopener"]],[[8,"id",0],[8,"href",4],[1,"aria-label",0],[8,"target",0]],[[null,"focus"],[null,"blur"],[null,"click"],[null,"mouseenter"],[null,"mouseleave"]],(function(e,t,i){var n=!0,a=e.component;return"mouseenter"===t&&(n=!1!==r.Wb(e,5).onMouseEnter()&&n),"mouseleave"===t&&(n=!1!==r.Wb(e,5).onMouseLeave()&&n),"focus"===t&&(n=!1!==a.mouseOverTile()&&n),"blur"===t&&(n=!1!==a.unfocusTile()&&n),"click"===t&&(n=!1!==a.onTileClick(i)&&n),n}),null,null)),r.Gb(2,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(3,{"workload-item--provisioning":0,"workload-item--provisioned workload-item--fluent--provisioned":1,"ms-bgc-w":2}),r.Gb(4,4210688,null,0,Jt.a,[r.o,r.h],{focusOnLoad:[0,"focusOnLoad"],detectChanges:[1,"detectChanges"]},null),r.Gb(5,16384,null,0,Qt.a,[Yt.a],{preloadPath:[0,"preloadPath"]},null),r.Gb(6,81920,null,0,Gt.a,[B.a],null,null),(e()(),r.Hb(7,0,null,null,8,"span",[["class","workload-item__icon"]],null,null,null,null,null)),r.Gb(8,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(9,{"workload-item__icon--3rd-party-image":0}),r.Gb(10,278528,null,0,Ut.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),r.Zb(11,{color:0}),(e()(),r.qb(16777216,null,null,1,null,si)),r.Gb(13,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,li)),r.Gb(15,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(16,0,null,null,8,"div",[["class","workload-item__name"]],[[8,"id",0]],null,null,null,null)),r.Gb(17,278528,null,0,Ut.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),r.Zb(18,{color:0}),(e()(),r.Hb(19,0,null,null,5,"div",[["class","workload-item__text"]],[[8,"title",0]],null,null,null,null)),r.Gb(20,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(21,{"workload-item__text--third-party":0,"ms-fcl-nd":1}),(e()(),r.gc(22,null,[" "," "])),(e()(),r.qb(16777216,null,null,1,null,ci)),r.Gb(24,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,ui)),r.Gb(26,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,3,0,!i.isProvisioned,i.isProvisioned,i.setWhiteBackground);e(t,2,0,"o365cs-base workload-item__link ms-bgc-w-h ms-bgc-w-a ms-bgc-w-f",n),e(t,4,0,i.focusOnLoad,!0),e(t,5,0,i.preloadPath),e(t,6,0);var r=e(t,9,0,i.workload.IsThirdParty);e(t,8,0,"workload-item__icon",r);var a=e(t,11,0,i.isProvisioned?i.appColor||i.workload.Color:"");e(t,10,0,a),e(t,13,0,!i.workload.ThirdPartyIcon||!i.iconLoaded),e(t,15,0,i.workload.ThirdPartyIcon);var o=e(t,18,0,i.showHover&&i.isProvisioned?i.appColor||i.workload.Color:"");e(t,17,0,o);var s=e(t,21,0,i.workload.IsThirdParty,!i.showHover);e(t,20,0,"workload-item__text",s),e(t,24,0,!i.isProvisioned),e(t,26,0,i.pinnedApp)}),(function(e,t){var i=t.component;e(t,1,0,r.Ob(1,"",i.elementId,""),r.Ob(1,"",i.workload.Url,""),i.ariaLabel,r.Wb(t,6).target),e(t,16,0,r.Ob(1,"",i.elementId,"_text")),e(t,19,0,i.workload.Text),e(t,22,0,i.workload.Text)}))}r.Db("ohp-app-tile",ai,(function(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-app-tile",[],null,null,null,di,oi)),r.Gb(1,770048,null,0,ai,[ri,R.a,B.a,D.a,T.a,ti.a,Xt.a,te.a,r.h,Re.b,ei.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{workload:"workload",inExpandedView:"inExpandedView",focusOnLoad:"focusOnLoad",pinnedApp:"pinnedApp",forceWhiteBackground:"forceWhiteBackground"},{unpinWorkload:"unpinWorkload"},[]);var hi=i("gZ+X"),pi=i("mOWz"),mi=i("5WpM"),fi=i("laSs"),gi=i("dy1P"),bi=i("+ucO"),vi=i("7wk3");class Si{constructor(e,t,i,n,r,a,o,s,l,c,u,d,h,p,m,f){this.appGalleryConfigService=e,this.appTilesConfigService=t,this.capabilitiesService=i,this.consumerInstallConfigService=n,this.floodgateService=r,this.instrumentationService=a,this.performanceService=o,this.officeRouteService=s,this.startupConfigService=l,this.workloadsService=c,this.browserPaintMeasurementService=u,this.localStorageService=d,this.createMenuService=h,this.oneDriveUploadService=p,this.browserPaintService=m,this.changeDetector=f,this.fullBleedTheming=!1,this.fullBleedFontColor="",this.fullBleedBackplateEnabled=!1,this.fullBleedBackplateStyle={},this.rectangularMobileMaxInitialItems=4,this.appGalleryRoute="AppGallery",this.createMenuEnabled=!1}ngAfterViewInit(){Si.loggedMarker||(this.performanceService.mark("App_Tiles_Ready"),Si.loggedMarker=!0),this.previousRouteSubscription=this.officeRouteService.subscribeToRouteChangeEnd((e=>this.previousRoute=e.previousRoute?e.previousRoute.route:null)),this.appGalleryLinkSubscription=this.appGalleryLink.changes.subscribe((e=>{"AppGallery"===this.previousRoute&&e&&1===e.length&&this.browserPaintService.runAfterPaint((()=>{e.first.nativeElement.focus(),this.appGalleryLinkSubscription.unsubscribe()}))})),this.browserPaintMeasurementService.recordWhenPainted("App_Tiles")}ngOnInit(){this.componentArea=T.b.AppTiles;const e=this.appTilesConfigService.config.resources;this.sectionTitle=e&&e.AppTilesHeader,this.provisioningAlertText=e&&e.ProvisioningAlertText,this.showLessAppTilesText=e&&e.ShowLessAppTiles,this.exploreYourAppsAriaLabel=e&&e.ExploreYourAppsAriaLabel,this.exploreYourAppsText=e&&e.ExploreYourAppsText,this.appTilesLandmarkAriaLabel=e&&e.AppTilesListLandmarkAriaLabel,this.myAccountLinkText=e&&e.MyAccountConsumerLinkText,this.myAccountUrl=this.appTilesConfigService.config.myAccountUrl,this.isConsumer=this.startupConfigService.config.authType===d.a.MSA,this.bottomTrayEnabled=this.capabilitiesService.capabilities.bottomTrayEnabled,this.isConsumer&&this.consumerInstallConfigService.getConfig().then((e=>{const t=e&&e.currentSkuInfo?e.currentSkuInfo.skuType:Y.b.NotDetected;this.isPaidConsumer=!(t===Y.b.NotSubscribed||t===Y.b.NonActive||t===Y.b.NotDetected)})),this.createMenuService.createButtonEnabledPromise.then((e=>{this.createMenuEnabled=this.createMenuEnabled||e})),this.oneDriveUploadService.uploadEnabledPromise.then((e=>{this.createMenuEnabled=this.createMenuEnabled||e})),this.initWorkloads()}ngOnDestroy(){this.appGalleryLinkSubscription&&this.appGalleryLinkSubscription.unsubscribe(),this.previousRouteSubscription&&this.previousRouteSubscription.unsubscribe(),this.thirdPartyWorkloadsSubscription&&this.thirdPartyWorkloadsSubscription.unsubscribe()}onUnpinWorkload(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){yield this.workloadsService.unpinWorkload(e.item),this.workloads=this.workloads.filter((t=>!(t.AppId===e.item.AppId&&t.CollectorId===e.item.CollectorId))),this.changeDetector.detectChanges()}))}trackByWorkloadId(e,t){return t.Id}isShowingReducedAppTiles(){return"Reduced"===this.appTilesState}getDisplayedAppTilesCount(){return this.isShowingReducedAppTiles()?Math.min(this.reducedTilesCount,this.workloads.length):this.workloads.length}navigateToAppsPage(e){null==e||e.preventDefault(),Object(Ie.a)({eventName:"AppGallery_Link_Click",id:"app-gallery-link",area:this.componentArea,result:"NavigateTo",target:gi.a.AppGallery}),this.officeRouteService.navigateTo({route:"AppGallery"})}initWorkloads(){this.isConsumer?this.workloadsService.getCoreSegmentAndFrequentApps().then((e=>this.setupWorkloads(e))):this.workloadsService.getWorkloads().then((e=>this.setupWorkloads(e)))}setupWorkloads(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const t=this.appTilesConfigService.config;this.workloads=e.map((e=>Object.assign({},e))),this.appGalleryConfigService.config&&(this.workloads.length>0?this.showAppGalleryLink=!0:this.thirdPartyWorkloadsSubscription=this.workloadsService.getThirdPartyWorkloads().subscribe((e=>{e.length>0&&(this.showAppGalleryLink=!0,this.thirdPartyWorkloadsSubscription.unsubscribe())}))),this.showProvisioningAlert=this.workloads.some((e=>!e.Url));let i=!1;this.workloads.forEach(((e,t)=>{e.ClickCount>0&&this.capabilitiesService.capabilities.showFloodgate&&this.capabilitiesService.capabilities.officeHomeFloodgate&&!i&&(i=!0)})),i&&this.floodgateService.recordFloodgate(["ClickedOneApp"]),yield this.setUpReducedTiles(),this.isConsumer||this.showAppGalleryLink&&(this.instrumentationService.logImpressionEvent("ExploreAllYourApps_Impression"),Object(fi.a)({eventName:"ExploreAllYourApps_Impression",area:this.componentArea})),this.workloadsService.getAdditionalWorkloads().then((e=>{e&&e.length>0&&(e=e.filter((e=>!e.IsNativeClientOnlyApp||this.localStorageService.get(`AppClicked_${e.Id}`))),this.workloadsService.populateWorkloadFields(e),this.workloads.splice(this.reducedTilesCount,0,...e),this.reducedTilesCount+=e.length)})),this.sortTiles(t.mobileAppIds)}))}setUpReducedTiles(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){if(this.workloads)return this.workloadsService.getCoreSegmentAndFrequentApps().then((e=>{this.appTilesState="Reduced",this.reducedTilesCount=e.length,this.workloads=e,this.logImpressionRenderedItems(this.getDisplayedAppTilesCount())}))}))}sortTiles(e){if(!e)return;const t=this.workloads.slice(0,this.workloads.length);this.workloads=this.workloads.sort(((i,n)=>{for(let t=0;t<e.length;t++){const r=e[t];if(i.Id===r)return-1;if(n.Id===r)return 1}for(let e=0;e<t.length;e++){if(t[e]===i)return-1;if(t[e]===n)return 1}return 0}))}logImpressionRenderedItems(e){let t=[];this.workloads&&(t=this.workloads.slice(0));const i=i=>t.reduce(((t,n,r)=>r<e&&(i&&n.Url||!i&&!n.Url)?t+(0===t.length?"":";")+Object(_.a)(n.Id):t),""),n={};n.RenderSize=e.toString();const r=i(!0);n.Distribution=r;const a=i(!1);n.Provisioning=a,n.State="Mobile",n.TotalSize=this.workloads?this.workloads.length.toString():"0",n.Action=this.appTilesState,this.instrumentationService.logImpressionEvent("App_Tiles_Impression",n),Object(fi.a)({eventName:"App_Tiles",area:"AppTiles",distribution:r,renderSize:e,totalSize:this.workloads?this.workloads.length:0})}}Si.loggedMarker=!1;var yi=r.Fb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"fadeOut",definitions:[{type:1,expr:":leave",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{opacity:1},offset:null},{type:4,styles:{type:6,styles:{opacity:0},offset:null},timings:"{{ fadeDuration }} 0ms linear"}],options:{params:{fadeDuration:"100ms"}}},options:null},options:null}],options:{}}]}});function Ci(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,4,"div",[["class","tiles-section__alert--fluent ms-fcl-nd"]],null,null,null,null,null)),r.Gb(1,278528,null,0,Ut.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),r.Zb(2,{color:0}),(e()(),r.Hb(3,0,null,null,1,"ohp-alert-message",[],null,null,null,Zt.b,Zt.a)),r.Gb(4,49152,null,0,Kt.a,[],{message:[0,"message"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.fullBleedFontColor);e(t,1,0,n),e(t,4,0,i.provisioningAlertText)}),null)}function wi(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-app-tile",[],null,null,null,di,oi)),r.Gb(1,770048,null,0,ai,[ri,R.a,B.a,D.a,T.a,ti.a,Xt.a,te.a,r.h,Re.b,ei.a],{workload:[0,"workload"],inExpandedView:[1,"inExpandedView"],forceWhiteBackground:[2,"forceWhiteBackground"]},null)],(function(e,t){var i=t.component;e(t,1,0,t.parent.context.$implicit,t.parent.context.index>=i.reducedTilesCount,i.fullBleedTheming)}),null)}function Ii(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-app-tile",[],null,null,null,di,oi)),r.Gb(1,770048,null,0,ai,[ri,R.a,B.a,D.a,T.a,ti.a,Xt.a,te.a,r.h,Re.b,ei.a],{workload:[0,"workload"],inExpandedView:[1,"inExpandedView"]},null)],(function(e,t){e(t,1,0,t.parent.context.$implicit,!1)}),null)}function Ti(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,4,"div",[["class","tiles__content"]],null,null,null,null,null)),(e()(),r.qb(16777216,null,null,1,null,wi)),r.Gb(2,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Ii)),r.Gb(4,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,!i.isConsumer),e(t,4,0,i.isConsumer)}),null)}function ki(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,8,null,null,null,null,null,null,null)),(e()(),r.Hb(1,0,null,null,7,"cdk-virtual-scroll-viewport",[["class","virtual-scroll-tiles cdk-virtual-scroll-viewport"],["itemSize","100"],["maxBufferPx","100"],["minBufferPx","50"],["orientation","horizontal"]],[[2,"cdk-virtual-scroll-orientation-horizontal",null],[2,"cdk-virtual-scroll-orientation-vertical",null]],null,null,hi.b,hi.a)),r.bc(6144,null,pi.b,null,[pi.d]),r.Gb(3,540672,null,0,pi.a,[],{itemSize:[0,"itemSize"],minBufferPx:[1,"minBufferPx"],maxBufferPx:[2,"maxBufferPx"]},null),r.bc(1024,null,pi.h,pi.j,[pi.a]),r.Gb(5,245760,null,0,pi.d,[r.o,r.h,r.F,[2,pi.h],[2,mi.b],pi.f,[2,pi.i]],{orientation:[0,"orientation"]},null),(e()(),r.qb(16777216,null,0,2,null,Ti)),r.Gb(7,409600,null,0,pi.c,[r.W,r.S,r.x,[1,pi.d],r.F],{cdkVirtualForOf:[0,"cdkVirtualForOf"],cdkVirtualForTrackBy:[1,"cdkVirtualForTrackBy"]},null),r.Yb(0,Ut.r,[])],(function(e,t){var i=t.component;e(t,3,0,"100","50","100"),e(t,5,0,"horizontal"),e(t,7,0,r.hc(t,7,0,r.Wb(t,8).transform(i.workloads,0,i.getDisplayedAppTilesCount())),i.trackByWorkloadId)}),(function(e,t){e(t,1,0,"horizontal"===r.Wb(t,5).orientation,"horizontal"!==r.Wb(t,5).orientation)}))}function Ai(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,12,"div",[["class","explore-apps--fluent"]],null,null,null,null,null)),r.Gb(1,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(2,{"explore-apps--backplate":0}),(e()(),r.Hb(3,0,[[1,0],["appGalleryLink",1]],null,9,"a",[["class","explore-apps__text--fluent ms-fcl-tda ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a"],["href","#"],["id","explore-your-apps"]],[[1,"aria-label",0],[1,"data-area",0],[1,"data-nav",0]],[[null,"click"],[null,"mouseenter"],[null,"mouseleave"]],(function(e,t,i){var n=!0,a=e.component;return"mouseenter"===t&&(n=!1!==r.Wb(e,7).onMouseEnter()&&n),"mouseleave"===t&&(n=!1!==r.Wb(e,7).onMouseLeave()&&n),"click"===t&&(n=!1!==a.navigateToAppsPage(i)&&n),n}),null,null)),r.Gb(4,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(5,{"explore-apps__text--backplate":0}),r.Gb(6,278528,null,0,Ut.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),r.Gb(7,16384,null,0,Qt.a,[Yt.a],{preloadPath:[0,"preloadPath"]},null),(e()(),r.Hb(8,0,null,null,4,"div",[["class","centered-flex-container"]],null,null,null,null,null)),(e()(),r.Hb(9,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),r.gc(10,null,["",""])),(e()(),r.Hb(11,0,null,null,1,"ohp-icon-font",[["cssClass","link-arrow"],["iconFontName","ArrowRight"],["size","14"]],null,null,null,vt.b,vt.a)),r.Gb(12,638976,null,0,St.a,[R.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.fullBleedBackplateEnabled);e(t,1,0,"explore-apps--fluent",n);var r=e(t,5,0,i.fullBleedBackplateEnabled);e(t,4,0,"explore-apps__text--fluent ms-fcl-tda ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a",r),e(t,6,0,i.fullBleedBackplateStyle),e(t,7,0,i.appGalleryRoute),e(t,12,0,"link-arrow","ArrowRight","14")}),(function(e,t){var i=t.component;e(t,3,0,i.exploreYourAppsAriaLabel,i.componentArea,!0),e(t,10,0,i.exploreYourAppsText)}))}function _i(e){return r.jc(0,[r.cc(671088640,1,{appGalleryLink:1}),(e()(),r.Hb(1,0,null,null,9,"div",[["class","app-tiles-list-component"],["role","navigation"]],[[1,"aria-label",0],[24,"@fadeOut",0]],null,null,null,null)),(e()(),r.qb(16777216,null,null,1,null,Ci)),r.Gb(3,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(4,0,null,null,6,"div",[["class","tiles-section__container mobile-tiles-section__container"]],null,null,null,null,null)),(e()(),r.Hb(5,0,null,null,3,"div",[["class","mobile-tiles--outer"]],null,null,null,null,null)),(e()(),r.Hb(6,0,null,null,2,"div",[["class","fluent-tiles mobile-tiles--inner"]],null,null,null,null,null)),(e()(),r.qb(16777216,null,null,1,null,ki)),r.Gb(8,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Ai)),r.Gb(10,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,3,0,i.showProvisioningAlert),e(t,8,0,i.workloads),e(t,10,0,i.showAppGalleryLink&&!i.bottomTrayEnabled)}),(function(e,t){e(t,1,0,t.component.appTilesLandmarkAriaLabel,void 0)}))}r.Db("ohp-app-tiles-list",Si,(function(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-app-tiles-list",[],null,null,null,_i,yi)),r.Gb(1,4440064,null,0,Si,[bi.a,ri,R.a,ee.a,Qe.a,T.a,k.b,M.a,d.b,ti.a,vi.a,et.a,Mt.a,xt.a,bt.a,r.h],null,null)],(function(e,t){e(t,1,0)}),null)}),{fullBleedTheming:"fullBleedTheming",fullBleedFontColor:"fullBleedFontColor",fullBleedBackplateEnabled:"fullBleedBackplateEnabled",fullBleedBackplateStyle:"fullBleedBackplateStyle"},{},[]);var Pi=i("WJRI"),Ei=i("kVgv"),Fi=i("ERl3"),Oi=i("+3x0"),Di=i("iX+N"),Mi=i("PTf4"),Ri=i("6UlS"),xi=i("pd4Y");class Li{constructor(e,t,i,n){this.capabilitiesService=e,this.dateService=t,this.locService=i,this.userContextService=n,this.currentGreetingText=this.generateGreeting(),this.greetingSubject=new Ri.a(this.currentGreeting),this.setupTimer(Li.MorningStartHour),this.setupTimer(Li.AfternoonStartHour),this.setupTimer(Li.EveningStartHour)}get greetingObservable(){return this.greetingSubject.asObservable()}get currentGreeting(){return this.currentGreetingText}setupTimer(e){const t=new Date,i=new Date(t.getFullYear(),t.getMonth(),t.getDate(),e,0,0,0);i<t&&i.setUTCDate(i.getUTCDate()+1);const n=i.getTime()-t.getTime();setTimeout((()=>{this.updateGreeting(),this.setupTimer(e)}),n)}updateGreeting(){const e=this.generateGreeting();e!==this.currentGreetingText&&(this.currentGreetingText=e,this.greetingSubject.next(this.currentGreetingText))}generateGreeting(){const e=this.userContextService.user.displayName,t=this.dateService.getCurrentDate().getHours();let i;return this.capabilitiesService.capabilities.greetingRefreshEnabled?i=e?this.locService.format(this.locService.WelcomeGreetingWithName,e):this.locService.WelcomeGreetingNoName:(i=t>=Li.MorningStartHour&&t<Li.AfternoonStartHour?e?this.locService.WelcomeMorningWithName:this.locService.WelcomeMorningNoName:t>=Li.AfternoonStartHour&&t<Li.EveningStartHour?e?this.locService.WelcomeAfternoonWithName:this.locService.WelcomeAfternoonNoName:e?this.locService.WelcomeEveningWithName:this.locService.WelcomeEveningNoName,e&&(i=this.locService.format(i,e))),i}}Li.MorningStartHour=4,Li.AfternoonStartHour=12,Li.EveningStartHour=18,Li.ɵprov=r.kc({factory:function(){return new Li(r.lc(R.a),r.lc(xi.a),r.lc(te.a),r.lc(Le.a))},token:Li,providedIn:"root"});class Ui{constructor(e,t,i,n,r,a,o,s,l,c,u,d,h,p,m,f,g,b,v,S){this.activatedRoute=e,this.appGalleryConfigService=t,this.appTilesConfigService=i,this.capabilitiesService=n,this.consumerInstallConfigService=r,this.contextService=a,this.deviceDetector=o,this.eventService=s,this.installConfigService=l,this.instrumentationService=c,this.locService=u,this.officeRouteService=d,this.searchConfigService=h,this.themingService=p,this.welcomeContentService=m,this.windowService=f,this.workloadsService=g,this.startupConfigService=b,this.wacStartConfigService=v,this.visualService=S,this.backgroundStyle={},this.bleedBackgroundStyle={},this.heroImageStyle={},this.heroLeftImageStyle={},this.heroRightImageStyle={},this.heroTitleGradient={},this.fullBleedBackplateStyle={},this.isSearchSiteScoped=!1}ngOnInit(){const e=this.capabilitiesService.capabilities,t=!!this.appGalleryConfigService.config,i=e.wacStartPageEnabled;if(this.appsModuleEnabled=this.capabilitiesService.capabilities.appsModuleEnabled,this.appsInHero=e.appsInHero,this.bottomTrayEnabled=e.bottomTrayEnabled,this.searchEnabled=e.showSearch&&!!this.searchConfigService.config,this.pwaEnabled=e.pwaEnabled,this.isConsumer=this.startupConfigService.config.authType===d.a.MSA,this.isMobile=this.deviceDetector.isMobileDevice(),this.hideConsumerBackgroundImage=this.isConsumer&&!this.onHomePageOrPwa,this.fullHeroGradient=this.isConsumer&&e.heroGradientEnabled,this.myAccountLinkText=this.appTilesConfigService.config.resources.MyAccountConsumerLinkText,this.myAccountUrl=this.appTilesConfigService.config.myAccountUrl,this.leftNavReact=e.leftNavReact,this.quickAccessEnabled=e.quickAccessV1Enabled,this.fluentRefresh=e.fluentRefresh,this.appBarEnabled=e.appBarEnabled,this.announcementListenerAdded=!1,this.suggestedActions=e.suggestedActionsEnabled,this.modernStartPageEnabled=e.modernStartPageEnabled,this.showAppTilesHeroTitle=this.appsInHero&&!this.bottomTrayEnabled&&!this.searchEnabled,this.isConsumer?this.consumerInstallConfigService.getConfig().then((e=>{const t=e&&e.currentSkuInfo?e.currentSkuInfo.skuType:Y.b.NotDetected;this.isPaidConsumer=!(t===Y.b.NotSubscribed||t===Y.b.NonActive||t===Y.b.NotDetected),t!==Y.b.NotSubscribed&&t!==Y.b.NonActive||this.installConfigService.config.dimeEnabled&&this.eventService.events.withScope(1).pipe(Object(Te.a)((e=>"convertedToPaid"===e.name)),Object(ke.a)(1)).toPromise().then((()=>{this.isPaidConsumer=!0}))})):this.isPaidConsumer=!1,this.greetingSubscription=this.welcomeContentService.greetingObservable.subscribe((e=>{this.heroTitle&&(!this.currentRoute||"OfficeHome"===this.currentRoute||"Pwa"===this.currentRoute||"AppGallery"===this.currentRoute&&this.isConsumer)&&(this.heroTitle=e)})),this.searchEnabled||t||i){let e;e=this.officeRouteService.hasNavigated()?this.officeRouteService.getRouteChangeEndObservable():Object(Fi.a)(this.officeRouteService.getRouteChangeStartObservable().pipe(Object(ke.a)(1)),this.officeRouteService.getRouteChangeEndObservable()),this.routeSubscription=e.subscribe((e=>{this.setHeroFlags(e)})),this.changeTitleSubscription=this.eventService.events.withScope(1).pipe(Object(Te.a)((e=>"changeTitle"===e.name))).subscribe((e=>{if(!e||!e.args||!e.args.length)return;const t=e.args;this.heroTitle=this.isConsumer&&this.onAppGalleryPage?this.welcomeContentService.currentGreeting:t[0],this.accessibilityTitle=t.length>1?t[1]:this.heroTitle}))}else this.showApps=this.appsInHero&&!this.leftNavReact,this.showInstall=!0,this.showInstallButton=!0,this.heroTitle=this.welcomeContentService.currentGreeting,this.accessibilityTitle=this.locService.AuthPageTitle;this.fullBleedSubscription=this.themingService.fullBleedTheming.subscribe((e=>{const{shouldFullBleed:t,bleedColor:i,themeData:n,bleedFontColor:r}=e;this.fullBleedThemingEnabled=t,this.fullBleedColor=i,this.fullBleedFontColor=this.fullBleedThemingEnabled?r:"",this.activeThemeId=n.theme.themeId;const a=n.theme.reactShellTheme;this.fullBleedImages=a?a.FullBleedImages:null,this.setResizeSubscription(),this.setFullBleedBackground(this.fullBleedThemingEnabled,this.fullBleedImages,this.fullBleedColor,this.windowService.innerWidth)})),this.visualBackgroundInitialized=!this.capabilitiesService.capabilities.visualEnabled,this.visualConfigSubscription=this.visualService.visualConfigSubscription.subscribe((e=>{this.visualBackgroundEnabled=e.visualBackgroundEnabled!==this.visualBackgroundEnabled?e.visualBackgroundEnabled:this.visualBackgroundEnabled,e.visualInitialized&&!this.visualBackgroundInitialized&&(this.visualBackgroundInitialized=e.visualInitialized,this.setBackgroundUrl())}))}ngAfterViewInit(){this.setBackgroundUrl(),this.setResizeSubscription()}ngAfterViewChecked(){var e,t,i,n;if(this.announcementListenerAdded)return;const r=null===(t=null===(e=this.heroAnnouncement)||void 0===e?void 0:e.nativeElement)||void 0===t?void 0:t.getElementsByClassName("new-stream-announcement"),a=null===(n=null===(i=this.heroAnnouncement)||void 0===i?void 0:i.nativeElement)||void 0===n?void 0:n.getElementsByClassName("classic-stream-announcement");r&&r[0]&&r[0].addEventListener("focus",(()=>{r[0].scrollIntoView({behavior:"smooth",block:"nearest",inline:"end"})})),a&&a[0]&&(a[0].addEventListener("focus",(()=>{a[0].scrollIntoView({behavior:"smooth",block:"nearest",inline:"end"})})),a[0].addEventListener("click",(()=>{this.instrumentationService.logClickEvent("Cross_Link_Click","Cross_Link_Click",T.b.Hero),Object(Ie.a)({id:"Cross_Link_Click",area:"Hero",result:"Navigate",target:"Other"})})),this.announcementListenerAdded=!0)}ngOnDestroy(){this.greetingSubscription&&this.greetingSubscription.unsubscribe(),this.routeSubscription&&this.routeSubscription.unsubscribe(),this.changeTitleSubscription&&this.changeTitleSubscription.unsubscribe(),this.resizeSubscription&&this.resizeSubscription.unsubscribe(),this.fullBleedSubscription&&this.fullBleedSubscription.unsubscribe(),this.visualConfigSubscription&&this.visualConfigSubscription.unsubscribe()}backToSearchPage(){this.officeRouteService.back({route:"Search"})}setResizeSubscription(){this.resizeSubscription||(this.resizeSubscription=this.eventService.events.withScope(1).pipe(Object(Te.a)((e=>"contentWidthChanged"===e.name||"windowResized"===e.name)),Object(Oi.a)(10)).subscribe((e=>{this.setFullBleedBackground(this.fullBleedThemingEnabled,this.fullBleedImages,this.fullBleedColor,this.windowService.innerWidth)})))}setBackgroundUrl(){if(this.appsInHero)return;if(!this.visualBackgroundInitialized||this.visualBackgroundEnabled)return;const e=this.contextService.sharedContext;e.heroImageUrl&&(this.backgroundStyle["background-image"]=`url(${e.heroImageUrl})`),this.heroTitleGradient["background-image"]=`url(${e.heroTitleGradientImageUrl})`}setHeroFlags(e){const t=e.currentRoute;this.currentRoute=t?t.route:null,this.onCreatePage="Create"===this.currentRoute,this.onSearchPage="Search"===this.currentRoute||"SearchSiteScoped"===this.currentRoute||"SearchTopicScoped"===this.currentRoute||"SearchMeetingScoped"===this.currentRoute||"SearchPersonScoped"===this.currentRoute,this.onAppGalleryPage="AppGallery"===this.currentRoute,this.onHomePageOrPwa=!this.currentRoute||"OfficeHome"===this.currentRoute||"Pwa"===this.currentRoute,this.showApps=this.onHomePageOrPwa&&this.appsInHero&&!this.leftNavReact,this.showFASTBreadcrumb="SearchSiteScoped"===this.currentRoute,this.appContext=t?t.app:null,this.hideConsumerBackgroundImage=this.isConsumer&&!this.onHomePageOrPwa,this.announcementMarkup=Object(Mi.a)(this.locService,this.wacStartConfigService,this.appContext);const i=this.capabilitiesService.capabilities.modernStartAppsArray&&this.capabilitiesService.capabilities.modernStartApps.has(null==t?void 0:t.app);if(this.onModernStartPage=("ModernStart"===this.currentRoute||"Start"===this.currentRoute)&&this.modernStartPageEnabled&&i,this.onAppGalleryPage&&this.workloadsService.getWorkloads().then((e=>{this.store=e.find((e=>"ShellOfficeStore"===e.Id))})),this.showInstall=this.onHomePageOrPwa||this.onAppGalleryPage,this.showWelcomeBadge=this.capabilitiesService.capabilities.welcomeBadgeEnabled&&this.onHomePageOrPwa,this.showInstallButton=this.capabilitiesService.capabilities.isPwaInUwp&&this.installConfigService.config.pwaInstallMoveEnabled?this.onAppGalleryPage:this.onHomePageOrPwa||this.onAppGalleryPage,this.showHeroButtons=this.onAppGalleryPage||this.onHomePageOrPwa,!this.onSearchPage&&this.activatedRoute.snapshot.queryParams.q&&!this.isConsumer)return void this.officeRouteService.navigateTo({route:"Search"},!0);const n=this.eventService.whenEventFired("exitSearchInSearchBox",0),r=this.eventService.whenEventFired("isContextualRailEnabled",0);this.backButtonId="back-button",this.backButtonAriaLabel="";let a=Promise.resolve(!1);switch(this.defaultBackRoute=null,this.onTemplatesPage=!1,this.currentRoute){case"Search":case"SearchTopicScoped":case"SearchMeetingScoped":case"SearchPersonScoped":this.accessibilityTitle=this.locService.SearchResults,this.backButtonId="search-close-button",this.backButtonAriaLabel=this.locService.CloseSearchResultsAriaLabel,this.defaultBackRoute={route:this.pwaEnabled?"Pwa":"OfficeHome"},this.componentArea=T.b.SearchResults,a=n.then((e=>!e.args[0]));break;case"SearchSiteScoped":this.backButtonId="search-site-scoped-close-button",this.backButtonAriaLabel=this.locService.CloseSearchResultsAriaLabel,this.defaultBackRoute={route:"Search"},a=n.then((e=>!e.args[0]));break;case"AppGallery":this.accessibilityTitle=this.locService.AppGalleryHeroTitle,this.backButtonId="app-gallery-close-button",this.componentArea=T.b.AppGalleryHero;break;case"Templates":a=Promise.resolve(!0),this.defaultBackRoute={route:"Start",app:t.app},this.onTemplatesPage=!0,this.componentArea=T.b.Templates;break;case"MyForms":case"GroupForms":a=Promise.resolve(!0),this.defaultBackRoute={route:"Start",app:t.app};break;case"Start":break;default:this.componentArea=T.b.Hero}this.isSearchSiteScoped="SearchSiteScoped"===this.currentRoute,this.setShowBack(a),this.setContextualRail(r.then((e=>e.args[0]))),this.heroTitle=this.onHomePageOrPwa?this.welcomeContentService.currentGreeting:this.accessibilityTitle,this.showCreateLocation=this.onTemplatesPage&&this.appContext!==Q.b.Sway&&this.appContext!==Q.b.Forms,this.noGutter=this.fluentRefresh||this.quickAccessEnabled&&"OfficeHome"===this.currentRoute&&!this.isConsumer}setShowBack(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){this.showBackButton=yield e,this.showAppTilesHeroTitle=!this.bottomTrayEnabled&&(this.showBackButton||this.showFASTBreadcrumb||this.onHomePageOrPwa&&this.appsInHero)}))}setContextualRail(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){this.isContextualRailEnabled=yield e}))}setFullBleedBackground(e,t,i,n){const r=Re.b.eduThemeBackplateOverrides[this.activeThemeId];this.fullBleedBackplateEnabled=r&&n<640&&this.fullBleedThemingEnabled,this.fullBleedBackplateStyle=this.fullBleedBackplateEnabled?Object.assign({color:this.fullBleedFontColor},r):{color:this.fullBleedFontColor},this.bleedBackgroundStyle=e?{"background-color":i}:{};const a=e&&t?t.Type:null;this.isPatternImage=a===Re.a.Pattern,this.hasSideImages=a===Re.a.Side,this.heroLeftImageStyle=this.getBackgroundImageStyle(this.hasSideImages&&t?t.Side:null),this.heroRightImageStyle=this.getBackgroundImageStyle(this.hasSideImages&&t?t.Side:null),this.heroImageStyle=this.getBackgroundImageStyle(e&&t?this.themingService.getEduHeaderImageForWidth(t,n):null)}getBackgroundImageStyle(e){return e&&e.length?{"background-image":`url(${e})`}:{}}}var Ni=i("qk26"),Wi=r.Fb({encapsulation:2,styles:[],data:{}});function ji(e){return r.jc(0,[(e()(),r.Hb(0,0,[[1,0],["heroAnnouncement",1]],null,2,"div",[["class","hero-announcementMarkup ms-fcl-ns"]],[[8,"innerHTML",1]],null,null,null,null)),r.Gb(1,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(2,{"width-restrictor width-restrictor--responsive":0,"width-restrictor--no-gutter":1})],(function(e,t){var i=t.component,n=e(t,2,0,!i.noGutter,i.noGutter);e(t,1,0,"hero-announcementMarkup ms-fcl-ns",n)}),(function(e,t){e(t,0,0,t.component.announcementMarkup)}))}function Hi(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,3,"div",[["class","hero-title-gradient"]],null,null,null,null,null)),r.Gb(1,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(2,{"auth-hero-image hero-title-gradient--full":0}),r.Gb(3,278528,null,0,Ut.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.fullHeroGradient);e(t,1,0,"hero-title-gradient",n),e(t,3,0,i.fullHeroGradient?i.backgroundStyle:i.heroTitleGradient)}),null)}function Bi(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"div",[["class","hero-background__image hero-background__image--left"]],null,null,null,null,null)),r.Gb(1,278528,null,0,Ut.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null)],(function(e,t){e(t,1,0,t.component.heroLeftImageStyle)}),null)}function Gi(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"div",[["class","hero-background__image hero-background__image--right"]],null,null,null,null,null)),r.Gb(1,278528,null,0,Ut.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null)],(function(e,t){e(t,1,0,t.component.heroRightImageStyle)}),null)}function qi(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,9,"div",[["class","hero-background--full-bleed"]],null,null,null,null,null)),r.Gb(1,278528,null,0,Ut.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),(e()(),r.qb(16777216,null,null,1,null,Bi)),r.Gb(3,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(4,0,null,null,3,"div",[["class","hero-background__image"]],null,null,null,null,null)),r.Gb(5,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(6,{"hero-background__image--pattern":0,"hero-background__image--center":1}),r.Gb(7,278528,null,0,Ut.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),(e()(),r.qb(16777216,null,null,1,null,Gi)),r.Gb(9,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,1,0,i.bleedBackgroundStyle),e(t,3,0,i.hasSideImages);var n=e(t,6,0,i.isPatternImage,!i.isPatternImage);e(t,5,0,"hero-background__image",n),e(t,7,0,i.heroImageStyle),e(t,9,0,i.hasSideImages)}),null)}function Vi(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,3,"h1",[["class","ms-fontWeight-light welcome__title--consumer"]],null,null,null,null,null)),r.Gb(1,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(2,{"welcome__title--fluent":0,"welcome__title--visual":1,"welcome__title--dark ms-fcl-nd":2}),(e()(),r.gc(3,null,[" "," "]))],(function(e,t){var i=t.component,n=e(t,2,0,i.fluentRefresh&&!i.visualBackgroundEnabled,i.visualBackgroundEnabled,i.fullHeroGradient);e(t,1,0,"ms-fontWeight-light welcome__title--consumer",n)}),(function(e,t){e(t,3,0,t.component.heroTitle)}))}function $i(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,8,"div",[],null,null,null,null,null)),r.Gb(1,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{ngClass:[0,"ngClass"]},null),r.Zb(2,{"welcome__badge--container":0,"welcome__badge--container-refresh":1}),(e()(),r.Hb(3,0,null,null,3,"h1",[["class","ms-fontWeight-light welcome__title--consumer welcome__title--consumer-with-badge"]],null,null,null,null,null)),r.Gb(4,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(5,{"welcome__title--fluent":0,"welcome__title--visual":1,"welcome__title--dark ms-fcl-nd":2}),(e()(),r.gc(6,null,[" "," "])),(e()(),r.Hb(7,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(8,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,!i.visualBackgroundEnabled,i.visualBackgroundEnabled);e(t,1,0,n);var r=e(t,5,0,i.fluentRefresh&&!i.visualBackgroundEnabled,i.visualBackgroundEnabled,i.fullHeroGradient);e(t,4,0,"ms-fontWeight-light welcome__title--consumer welcome__title--consumer-with-badge",r),e(t,8,0,"welcome-badge-react#WelcomeBadgeReactModule")}),(function(e,t){e(t,6,0,t.component.heroTitle)}))}function zi(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-icon-font",[["cssClass","diamond-web"],["iconFontName","Diamond"]],null,null,null,vt.b,vt.a)),r.Gb(1,638976,null,0,St.a,[R.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"]},null)],(function(e,t){e(t,1,0,"diamond-web","Diamond")}),null)}function Zi(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,9,"a",[["class","widget-attribution__link my-account__link_new my-account__link_color my-account__link_new_hover_text_decoration my-account__link_margin"],["id","my-account-link"],["ohpDefaultLinkTarget",""]],[[8,"href",4],[1,"aria-label",0],[8,"target",0]],null,null,null,null)),r.Gb(1,278528,null,0,Ut.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),r.Zb(2,{color:0}),r.Gb(3,81920,null,0,Gt.a,[B.a],null,null),(e()(),r.qb(16777216,null,null,1,null,zi)),r.Gb(5,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(6,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),r.gc(7,null,["",""])),(e()(),r.Hb(8,0,null,null,1,"ohp-icon-font",[["cssClass","link-arrow"],["iconFontName","ArrowRight"],["size","14"]],null,null,null,vt.b,vt.a)),r.Gb(9,638976,null,0,St.a,[R.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.fullBleedFontColor);e(t,1,0,n),e(t,3,0),e(t,5,0,i.isPaidConsumer),e(t,9,0,"link-arrow","ArrowRight","14")}),(function(e,t){var i=t.component;e(t,0,0,i.myAccountUrl,i.myAccountLinkText,r.Wb(t,3).target),e(t,7,0,i.myAccountLinkText)}))}function Ki(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),r.Zb(2,{componentArea:0,showInstallButton:1,appFilter:2}),(e()(),r.qb(0,null,null,0))],(function(e,t){var i=t.component,n=e(t,2,0,i.componentArea,i.showInstallButton,"Office");e(t,1,0,"install-wrapper#InstallWrapperModule",n)}),null)}function Ji(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,6,"div",[["class","hero__buttons-container hero-button-section--consumer"]],null,null,null,null,null)),r.Gb(1,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(2,{"hero-button-section--consumer--fluent":0}),(e()(),r.qb(16777216,null,null,1,null,Zi)),r.Gb(4,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Ki)),r.Gb(6,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.fluentRefresh);e(t,1,0,"hero__buttons-container hero-button-section--consumer",n),e(t,4,0,i.isPaidConsumer&&!i.showWelcomeBadge),e(t,6,0,i.showInstall)}),null)}function Qi(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,11,"div",[],null,null,null,null,null)),r.Gb(1,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{ngClass:[0,"ngClass"]},null),r.Zb(2,{"hero-image-container__overlay":0,"hero-image-container__overlay--consumer":1,"hero-image-container__overlay--consumer--fluent":2}),(e()(),r.Hb(3,0,null,null,8,"div",[["class","hero-content--flex"]],null,null,null,null,null)),r.Gb(4,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(5,{"width-restrictor width-restrictor--responsive":0,"width-restrictor--no-gutter":1,"hero-content--end-aligned":2}),(e()(),r.qb(16777216,null,null,1,null,Vi)),r.Gb(7,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,$i)),r.Gb(9,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Ji)),r.Gb(11,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,!i.visualBackgroundEnabled,i.isConsumer,i.isConsumer&&i.fluentRefresh&&!i.visualBackgroundEnabled);e(t,1,0,n);var r=e(t,5,0,!i.noGutter,i.noGutter,i.fluentRefresh);e(t,4,0,"hero-content--flex",r),e(t,7,0,!i.showWelcomeBadge),e(t,9,0,i.showWelcomeBadge),e(t,11,0,i.isConsumer)}),null)}function Yi(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-back-button",[],null,null,null,qt.b,qt.a)),r.Gb(1,245760,null,0,Vt.a,[R.a,B.a,te.a,M.a],{elementId:[0,"elementId"],backButtonAriaLabel:[1,"backButtonAriaLabel"],defaultBackRoute:[2,"defaultBackRoute"],responsive:[3,"responsive"],focusOnLoad:[4,"focusOnLoad"]},null)],(function(e,t){var i=t.component;e(t,1,0,i.backButtonId,i.backButtonAriaLabel,i.defaultBackRoute,i.onTemplatesPage,i.onAppGalleryPage)}),null)}function Xi(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"bread-crumb#FastBreadcrumbModule")}),null)}function en(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,7,"h1",[["class","ms-fontWeight-light welcome__title ms-fcl-nd"],["id","hero-heading"]],null,[[null,"click"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==(r.showFASTBreadcrumb&&r.backToSearchPage())&&n),n}),null,null)),r.Gb(1,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(2,{"welcome__title--centered":0,"welcome__title--small":1,"welcome__title--responsive":2,"welcome__title--fluent":3,"welcome__title--visual":4}),r.Gb(3,278528,null,0,Ut.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),r.Zb(4,{color:0}),(e()(),r.gc(5,null,[" "," "])),(e()(),r.qb(16777216,null,null,1,null,Xi)),r.Gb(7,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.onTemplatesPage&&!i.fluentRefresh,i.onHomePageOrPwa&&!i.fluentRefresh,!i.fluentRefresh,i.fluentRefresh&&!i.visualBackgroundEnabled,i.visualBackgroundEnabled);e(t,1,0,"ms-fontWeight-light welcome__title ms-fcl-nd",n);var r=e(t,4,0,i.fullBleedFontColor);e(t,3,0,r),e(t,7,0,i.showFASTBreadcrumb)}),(function(e,t){e(t,5,0,t.component.heroTitle)}))}function tn(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"bread-crumb#FastBreadcrumbModule")}),null)}function nn(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,7,"h1",[["class","ms-fontWeight-light welcome__title ms-fcl-nd welcome__title--consumer-with-badge"],["id","hero-heading"]],null,[[null,"click"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==(r.showFASTBreadcrumb&&r.backToSearchPage())&&n),n}),null,null)),r.Gb(1,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(2,{"welcome__title--centered":0,"welcome__title--small":1,"welcome__title--responsive":2,"welcome__title--fluent":3,"welcome__title--visual":4}),r.Gb(3,278528,null,0,Ut.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),r.Zb(4,{color:0}),(e()(),r.gc(5,null,[" "," "])),(e()(),r.qb(16777216,null,null,1,null,tn)),r.Gb(7,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.onTemplatesPage&&!i.fluentRefresh,i.onHomePageOrPwa&&!i.fluentRefresh,!i.fluentRefresh,i.fluentRefresh&&!i.visualBackgroundEnabled,i.visualBackgroundEnabled);e(t,1,0,"ms-fontWeight-light welcome__title ms-fcl-nd welcome__title--consumer-with-badge",n);var r=e(t,4,0,i.fullBleedFontColor);e(t,3,0,r),e(t,7,0,i.showFASTBreadcrumb)}),(function(e,t){e(t,5,0,t.component.heroTitle)}))}function rn(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"welcome-badge-react#WelcomeBadgeReactModule")}),null)}function an(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,6,"div",[],null,null,null,null,null)),r.Gb(1,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{ngClass:[0,"ngClass"]},null),r.Zb(2,{"welcome__badge--container":0,"welcome__badge--container-refresh":1}),(e()(),r.qb(16777216,null,null,1,null,nn)),r.Gb(4,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,rn)),r.Gb(6,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,!i.visualBackgroundEnabled,i.visualBackgroundEnabled);e(t,1,0,n),e(t,4,0,i.heroTitle||i.showFASTBreadcrumb),e(t,6,0,i.showWelcomeBadge)}),null)}function on(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,2,"div",[["class","hero__create-location"]],null,null,null,null,null)),(e()(),r.Hb(1,0,null,null,1,"ohp-create-location",[],null,null,null,$t.b,$t.a)),r.Gb(2,114688,null,0,zt.a,[R.a,te.a],{app:[0,"app"]},null)],(function(e,t){e(t,2,0,t.component.appContext)}),null)}function sn(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,2,null,null,null,null,null,null,null)),(e()(),r.qb(16777216,null,null,1,null,on)),r.Gb(2,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,2,0,t.component.showCreateLocation)}),null)}function ln(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,4,"div",[],null,null,null,null,null)),(e()(),r.Hb(1,0,null,null,3,"a",[["class","generic-button generic-button--fluent generic-button--fluent--primary ms-bgc-tp ms-fcl-w ms-bgc-w-h ms-bgc-w-a ms-fcl-tp-h ms-fcl-tp-a ms-fcl-w-f"],["data-referral","OfficeStore"],["id","app-gallery-store-link"],["ohpDefaultLinkTarget",""],["rel","noopener"]],[[1,"data-area",0],[8,"href",4],[8,"target",0]],null,null,null,null)),r.Gb(2,81920,null,0,Gt.a,[B.a],null,null),(e()(),r.Hb(3,0,null,null,1,"b",[["class","generic-button__text"]],null,null,null,null,null)),(e()(),r.gc(4,null,["",""]))],(function(e,t){e(t,2,0)}),(function(e,t){var i=t.component;e(t,1,0,i.componentArea,i.store.Url,r.Wb(t,2).target),e(t,4,0,i.store.Text)}))}function cn(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,9,"a",[["class","widget-attribution__link my-account__link ms-fcl-tda ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a"],["id","my-account-link"],["ohpDefaultLinkTarget",""]],[[8,"href",4],[1,"aria-label",0],[8,"target",0]],null,null,null,null)),r.Gb(1,278528,null,0,Ut.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),r.Zb(2,{color:0}),r.Gb(3,81920,null,0,Gt.a,[B.a],null,null),(e()(),r.Hb(4,0,null,null,1,"ohp-icon-font",[["class","diamond-pwa ms-fcl-tda"],["iconFontName","Diamond"]],null,null,null,vt.b,vt.a)),r.Gb(5,638976,null,0,St.a,[R.a],{iconFontName:[0,"iconFontName"]},null),(e()(),r.Hb(6,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),r.gc(7,null,["",""])),(e()(),r.Hb(8,0,null,null,1,"ohp-icon-font",[["cssClass","link-arrow"],["iconFontName","ArrowRight"],["size","14"]],null,null,null,vt.b,vt.a)),r.Gb(9,638976,null,0,St.a,[R.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){var i=e(t,2,0,t.component.fullBleedFontColor);e(t,1,0,i),e(t,3,0),e(t,5,0,"Diamond"),e(t,9,0,"link-arrow","ArrowRight","14")}),(function(e,t){var i=t.component;e(t,0,0,i.myAccountUrl,i.myAccountLinkText,r.Wb(t,3).target),e(t,7,0,i.myAccountLinkText)}))}function un(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),r.Zb(2,{componentArea:0,showInstallButton:1,appFilter:2}),(e()(),r.qb(0,null,null,0))],(function(e,t){var i=t.component,n=e(t,2,0,i.componentArea,i.showInstallButton,"Office");e(t,1,0,"install-wrapper#InstallWrapperModule",n)}),null)}function dn(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,8,null,null,null,null,null,null,null)),(e()(),r.Hb(1,0,null,null,7,"div",[["class","section__buttons-container hero__buttons-container"]],null,null,null,null,null)),(e()(),r.qb(16777216,null,null,1,null,ln)),r.Gb(3,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,cn)),r.Gb(5,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(6,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),r.qb(16777216,null,null,1,null,un)),r.Gb(8,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,3,0,i.onAppGalleryPage&&i.store),e(t,5,0,i.isPaidConsumer&&!i.onAppGalleryPage&&!i.showWelcomeBadge),e(t,8,0,i.showInstall)}),null)}function hn(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,12,"div",[["class","hero-content--flex"]],null,null,null,null,null)),r.Gb(1,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(2,{"hero-content--centered":0,"hero-content--small":1,"hero-content--small-visual":2,"hero-content":3,"hero-content--aligned":4,"hero-content--suggested-actions":5}),(e()(),r.qb(16777216,null,null,1,null,Yi)),r.Gb(4,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,en)),r.Gb(6,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,an)),r.Gb(8,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,sn)),r.Gb(10,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,dn)),r.Gb(12,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.onTemplatesPage&&!i.fluentRefresh,i.onHomePageOrPwa,i.onHomePageOrPwa&&i.visualBackgroundEnabled,!i.isSearchSiteScoped&&!i.fluentRefresh,i.fluentRefresh,i.suggestedActions);e(t,1,0,"hero-content--flex",n),e(t,4,0,i.showBackButton),e(t,6,0,!i.showWelcomeBadge&&i.heroTitle||i.showFASTBreadcrumb),e(t,8,0,i.showWelcomeBadge),e(t,10,0,!i.onAppGalleryPage),e(t,12,0,i.showHeroButtons)}),null)}function pn(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-app-tiles-list",[],null,null,null,_i,yi)),r.Gb(1,4440064,null,0,Si,[bi.a,ri,R.a,ee.a,Qe.a,T.a,k.b,M.a,d.b,ti.a,vi.a,et.a,Mt.a,xt.a,bt.a,r.h],{fullBleedTheming:[0,"fullBleedTheming"],fullBleedFontColor:[1,"fullBleedFontColor"],fullBleedBackplateEnabled:[2,"fullBleedBackplateEnabled"],fullBleedBackplateStyle:[3,"fullBleedBackplateStyle"]},null)],(function(e,t){var i=t.component;e(t,1,0,i.fullBleedThemingEnabled&&!i.visualBackgroundEnabled,i.fullBleedFontColor,i.fullBleedBackplateEnabled,i.fullBleedBackplateStyle)}),null)}function mn(e){return r.jc(0,[r.cc(671088640,1,{heroAnnouncement:0}),(e()(),r.Hb(1,0,null,null,1,"ohp-title-announcer",[],null,null,null,Pi.b,Pi.a)),r.Gb(2,49152,null,0,Ei.a,[],{announcement:[0,"announcement"]},null),(e()(),r.Hb(3,0,null,null,21,"div",[["class","hero-section auth-hero-image"]],null,null,null,null,null)),r.Gb(4,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(5,{"hero-section--padded":0,"hero-section__2dot0--padded":1,"hero-section__homepage--padded":2,"hero-section-mobile--padded":3,"hero-section__visual--padded":4}),r.Gb(6,278528,null,0,Ut.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),(e()(),r.qb(16777216,null,null,1,null,ji)),r.Gb(8,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Hi)),r.Gb(10,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,qi)),r.Gb(12,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Qi)),r.Gb(14,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(15,0,null,null,9,"div",[],null,null,null,null,null)),r.Gb(16,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{ngClass:[0,"ngClass"]},null),r.Zb(17,{"width-restrictor":0,"width-restrictor--responsive":1,"width-restrictor--no-gutter":2,"breadcrumb-width-restrictor":3,"breadcrumb-width-restrictor-fallback":4}),(e()(),r.Hb(18,0,null,null,6,"div",[["class","hero-container"]],[[1,"role",0],[1,"aria-labelledby",0]],null,null,null,null)),r.Gb(19,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(20,{"hero-image-container--fluent":0,"hero-image-container":1}),(e()(),r.qb(16777216,null,null,1,null,hn)),r.Gb(22,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,pn)),r.Gb(24,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,i.accessibilityTitle);var n=e(t,5,0,(i.appsInHero||i.hideConsumerBackgroundImage)&&!(i.bottomTrayEnabled&&i.onAppGalleryPage)&&!i.onSearchPage&&!i.onCreatePage&&!(i.onAppGalleryPage&&i.appsModuleEnabled)&&!i.onModernStartPage,i.onCreatePage||i.onHomePageOrPwa&&i.appBarEnabled||i.onAppGalleryPage&&i.appsModuleEnabled,i.onHomePageOrPwa&&!i.leftNavReact,i.bottomTrayEnabled,i.onHomePageOrPwa&&i.visualBackgroundEnabled);e(t,4,0,"hero-section auth-hero-image",n),e(t,6,0,i.hideConsumerBackgroundImage||i.fullHeroGradient||i.visualBackgroundEnabled?"":i.backgroundStyle),e(t,8,0,void 0!==i.announcementMarkup),e(t,10,0,!i.appsInHero&&!i.hideConsumerBackgroundImage&&!i.visualBackgroundEnabled),e(t,12,0,i.fullBleedThemingEnabled&&!i.visualBackgroundEnabled),e(t,14,0,!i.appsInHero&&!i.hideConsumerBackgroundImage);var r=e(t,17,0,!i.noGutter,!i.noGutter&&i.heroTitle,i.noGutter,!i.heroTitle,!i.isContextualRailEnabled);e(t,16,0,r);var a=e(t,20,0,!i.appsInHero&&!i.hideConsumerBackgroundImage&&!i.visualBackgroundEnabled,!i.appsInHero&&!i.hideConsumerBackgroundImage&&!i.visualBackgroundEnabled);e(t,19,0,"hero-container",a),e(t,22,0,i.showAppTilesHeroTitle),e(t,24,0,i.showApps)}),(function(e,t){var i=t.component;e(t,18,0,i.showAppTilesHeroTitle?"region":void 0,i.showAppTilesHeroTitle?"hero-heading":void 0)}))}r.Db("ohp-hero",Ui,(function(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-hero",[],null,null,null,mn,Wi)),r.Gb(1,12828672,null,0,Ui,[Ni.a,bi.a,ri,R.a,ee.a,B.a,L.b,D.a,je.a,T.a,te.a,M.a,He.a,Re.b,Li,u.b,ti.a,d.b,Di.a,it.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]);var fn=i("eevI");class gn{constructor(e,t,i){this.elementRef=e,this.eventService=t,this.zone=i,this.eventName=this.eventName||"contentScrolled"}ngDoCheck(){this.initialized||(this.initialized=!0,this.setScrollListener())}ngOnDestroy(){this.scrollEventSubscription&&this.scrollEventSubscription.unsubscribe()}setScrollListener(){this.zone.runOutsideAngular((()=>{this.scrollEventSubscription=Object(fn.a)(this.elementRef.nativeElement,"scroll").pipe(Object(Oi.a)(10)).subscribe((()=>{this.eventService.broadcastEvent({name:this.eventName,args:[]})}))}))}}var bn=i("4lGG"),vn=r.Fb({encapsulation:2,styles:[],data:{}});function Sn(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),r.Hb(1,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(2,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null)],(function(e,t){e(t,2,0,"left-nav-react#LeftNavReactModule")}),null)}function yn(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,3,"div",[],null,null,null,null,null)),(e()(),r.Hb(1,0,null,null,0,"div",[["class","ms-bgc-d appbar-placeholder"],["id","appBar"]],null,null,null,null,null)),(e()(),r.Hb(2,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(3,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null)],(function(e,t){e(t,3,0,"appbar#AppBarModule")}),null)}function Cn(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"feature-callout#FeatureCalloutModule")}),null)}function wn(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"workspace-nav#WorkspaceNavModule")}),null)}function In(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"visual-background-react#VisualBackgroundReactModule")}),null)}function Tn(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"announcement#AnnouncementModule")}),null)}function kn(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-hero",[],null,null,null,mn,Wi)),r.Gb(1,12828672,null,0,Ui,[Ni.a,bi.a,ri,R.a,ee.a,B.a,L.b,D.a,je.a,T.a,te.a,M.a,He.a,Re.b,Li,u.b,ti.a,d.b,Di.a,it.a],null,null)],(function(e,t){e(t,1,0)}),null)}function An(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"web-vitals#WebVitalsModule")}),null)}function _n(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"action-context-menu-react#ActionContextMenuReactModule")}),null)}function Pn(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"confirmation-dialog-react#ConfirmationDialogReactModule")}),null)}function En(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"create-onenote-page-dialog-react#CreateOneNotePageDialogReactModule")}),null)}function Fn(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"task-module-dialog-react#TaskModuleDialogReactModule")}),null)}function On(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"toast-container-react#ToastContainerReactModule")}),null)}function Dn(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"upload-react#UploadReactModule")}),null)}function Mn(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),r.Zb(2,{showFASTBreadcrumb:0}),(e()(),r.qb(0,null,null,0))],(function(e,t){var i=e(t,2,0,t.component.showFASTBreadcrumb);e(t,1,0,"auto-suggest#AutoSuggestModule",i)}),null)}function Rn(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"first-run-wrapper#FirstRunWrapperModule")}),null)}function xn(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"teaching-ui-react#TeachingUiReactModule")}),null)}function Ln(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),r.Zb(2,{mobileShareMenu:0,contentShareMenu:1}),(e()(),r.qb(0,null,null,0))],(function(e,t){var i=e(t,2,0,!1,t.component.onWacContentPage);e(t,1,0,"share-control#ShareControlModule",i)}),null)}function Un(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"search-preload#SearchPreloadModule")}),null)}function Nn(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"wac-content#WacContentModule")}),null)}function Wn(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"fluent-theme-provider#FluentThemeProviderModule")}),null)}function jn(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,83,"div",[["id","officeHomeRoot"]],null,null,null,null,null)),r.Gb(1,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{ngClass:[0,"ngClass"]},null),(e()(),r.Hb(2,0,null,null,69,"div",[["class","pwa ms-fontWeight-regular ms-bgc-nla"],["id","officeHome"]],null,null,null,null,null)),r.Gb(3,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),(e()(),r.qb(16777216,null,null,2,null,Sn)),r.Gb(5,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),r.Yb(131072,Ut.b,[r.h]),(e()(),r.qb(16777216,null,null,2,null,yn)),r.Gb(8,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),r.Yb(131072,Ut.b,[r.h]),(e()(),r.Hb(10,16777216,null,null,1,"router-outlet",[["name","install-wizard"]],null,null,null,null,null)),r.Gb(11,212992,null,0,Ni.p,[Ni.b,r.W,r.k,[8,"install-wizard"],r.h],null,null),(e()(),r.qb(16777216,null,null,1,null,Cn)),r.Gb(13,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(14,0,null,null,35,"div",[["class","o365cs-base o365cst"],["id","officeHome__container"]],null,null,null,null,null)),r.Gb(15,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(16,{"office-box-sizing":0,"left-nav-offset":1,"appbar-offset":2,"ms-bgc-nla":3,"fluent-background-color":4,"fluentvnext-background":5,"fluentvnext-background-shadow":6}),(e()(),r.qb(16777216,null,null,1,null,wn)),r.Gb(18,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(19,0,null,null,30,"div",[["id","officeHome__scroll-content"],["ohpScrollListener",""]],null,[[null,"dragover"],[null,"drop"]],(function(e,t,i){var n=!0,r=e.component;return"dragover"===t&&(n=!1!==r.dragoverHandler(i)&&n),"drop"===t&&(n=!1!==r.dropHandler(i)&&n),n}),null,null)),r.Gb(20,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{ngClass:[0,"ngClass"]},null),r.Yb(131072,Ut.b,[r.h]),r.Yb(131072,Ut.b,[r.h]),r.Zb(23,{"scroll-content":0,"app-gallery-workspace-nav-offset":1,"scroll-content--transform":2}),r.Gb(24,409600,null,0,gn,[r.o,D.a,r.F],null,null),(e()(),r.Hb(25,0,null,null,24,"div",[["id","officeHome__wrapper"]],null,[[null,"ohpResize"]],(function(e,t,i){var n=!0;return"ohpResize"===t&&(n=!1!==e.component.onResize(i)&&n),n}),null,null)),r.Gb(26,278528,null,0,Ut.i,[r.x,r.y,r.o,r.K],{ngClass:[0,"ngClass"]},null),r.Zb(27,{"fluent-background":0,"with-appbar-min-width":1}),r.Gb(28,278528,null,0,Ut.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),r.Gb(29,4407296,null,0,ft.a,[gt.a,r.o,bt.a],null,{resize:"ohpResize"}),(e()(),r.qb(16777216,null,null,1,null,In)),r.Gb(31,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Tn)),r.Gb(33,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(34,0,null,null,15,"div",[],null,null,null,null,null)),r.Gb(35,278528,null,0,Ut.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),(e()(),r.Hb(36,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(37,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(16777216,null,null,1,null,kn)),r.Gb(39,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,An)),r.Gb(41,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(42,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),r.Gb(43,212992,null,0,Ni.p,[Ni.b,r.W,r.k,[8,null],r.h],null,null),(e()(),r.Hb(44,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(45,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.Hb(46,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(47,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(16777216,null,null,1,null,_n)),r.Gb(49,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(50,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(51,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.Hb(52,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(53,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.Hb(54,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(55,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.Hb(56,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(57,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.Hb(58,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(59,475136,null,0,Tt.a,[kt.a,r.W,T.a,d.b,c.a,At.a,bt.a,r.F,Se.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(16777216,null,null,1,null,Pn)),r.Gb(61,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,En)),r.Gb(63,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Fn)),r.Gb(65,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,On)),r.Gb(67,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Dn)),r.Gb(69,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Mn)),r.Gb(71,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Rn)),r.Gb(73,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,xn)),r.Gb(75,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Ln)),r.Gb(77,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Un)),r.Gb(79,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Nn)),r.Gb(81,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Wn)),r.Gb(83,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,1,0,i.themeRootCssClass),e(t,3,0,"pwa ms-fontWeight-regular ms-bgc-nla",i.officeHomeClass),e(t,5,0,i.leftNavReact&&!r.hc(t,5,0,r.Wb(t,6).transform(i.onWacContentPage))),e(t,8,0,i.appBarEnabled&&!r.hc(t,8,0,r.Wb(t,9).transform(i.onWacContentPage))),e(t,11,0),e(t,13,0,i.loadFeatureCalloutModule);var n=e(t,16,0,!i.onFeedPage,i.leftNavReact,i.appBarEnabled,!i.fluentThemeRefreshEnabled,!i.fluentThemeRefreshEnabled,i.fluentThemeRefreshEnabled,i.fluentHeaderEnabled);e(t,15,0,"o365cs-base o365cst",n),e(t,18,0,i.showWorkspaceNav);var a=e(t,23,0,!r.hc(t,20,0,r.Wb(t,21).transform(i.onWacContentPage)),i.showWorkspaceNav,!i.onMyContentPage&&!r.hc(t,20,0,r.Wb(t,22).transform(i.onWacContentPage)));e(t,20,0,a),e(t,24,0);var o=e(t,27,0,i.showBackgroundImage&&!i.visualBackgroundEnabled,i.onAppGallery&&i.appsModuleEnabled);e(t,26,0,o),e(t,28,0,i.showBackgroundImage&&!i.visualBackgroundEnabled?i.backgroundStyle:""),e(t,29,0),e(t,31,0,i.visualBackgroundEnabled),e(t,33,0,i.showAnnouncement),e(t,35,0,i.visualBackgroundEnabled?i.visualOfficeWrapperStyle:""),e(t,37,0,"banner#BannerModule"),e(t,39,0,!i.onMyContentPage&&!i.onFeedPage),e(t,41,0,i.webVitalsEnabled||i.memoryProfilingEnabled),e(t,43,0),e(t,45,0,"feature-tooltip-container#FeatureTooltipContainerModule"),e(t,47,0,"context-menu#ContextMenuModule"),e(t,49,0,i.actionContextMenuEnabled),e(t,51,0,"upload-dialog#UploadDialogModule"),e(t,53,0,"upload-local-file#UploadLocalFileModule"),e(t,55,0,"error-dialog#ErrorDialogModule"),e(t,57,0,"input-dialog#InputDialogModule"),e(t,59,0,"allow-filesystem-access#AllowFileSystemAccessModule"),e(t,61,0,i.customPivots),e(t,63,0,i.createOneNotePageEnabled),e(t,65,0,i.taskModule),e(t,67,0,i.toastContainer),e(t,69,0,i.uploadV2),e(t,71,0,i.searchEnabled&&!i.nativeSearchEnabled),e(t,73,0,i.firstRunEnabled),e(t,75,0,i.loadTeachingUiReactModule),e(t,77,0,i.onWacContentPage),e(t,79,0,i.nativeSearchEnabled),e(t,81,0,i.wacHostEnabled),e(t,83,0,i.fluentThemeRefreshEnabled)}),null)}function Hn(e){return r.jc(0,[(e()(),r.qb(16777216,null,null,1,null,jn)),r.Gb(1,16384,null,0,Ut.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,1,0,t.component.viewInitializationCompleted)}),null)}var Bn=r.Db("ohp-pwa-root",pt,(function(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-pwa-root",[],null,[["window","offline"],["window","online"],["window","focus"],["window","resize"],["window","activated"]],(function(e,t,i){var n=!0;return"window:offline"===t&&(n=!1!==r.Wb(e,1).sendOfflineNotification()&&n),"window:online"===t&&(n=!1!==r.Wb(e,1).sendOnlineNotification()&&n),"window:focus"===t&&(n=!1!==r.Wb(e,1).onWindowFocus()&&n),"window:resize"===t&&(n=!1!==r.Wb(e,1).onWindowResize()&&n),"window:activated"===t&&(n=!1!==r.Wb(e,1).onActivate(i)&&n),n}),Hn,vn)),r.Gb(1,245760,null,0,pt,[$e.a,Ee.a,R.a,r.h,ee.a,bn.a,Ze.a,s.a,D.a,Fe.a,Oe.a,We,Ne.a,Qe.a,r.v,T.a,Ye.a,Xe.a,et.a,tt,Ni.n,u.b,dt.a,H.a,nt.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]);class Gn extends $e.a{constructor(e,t,i,n,r,a,o){super(),this.clientStartupConfigService=e,this.contextService=t,this.pwaConfigService=n,this.windowService=r,this.instrumentationService=a,this.officeApiService=o,this.init(i,e.config.authType===d.a.MSA?"RPSCompact":"JWT","WAM"),this.wamAccessTokenRequests=this.windowService.nativeWindow.wamAccessTokenRequests||new Map,this.resourceMap=this.pwaConfigService.config.resourceUrlMap?new Map(Object.entries(this.pwaConfigService.config.resourceUrlMap)):new Map;const s=this.windowService.nativeWindow.shellTokenRequestDictionary;s&&this.resourceMap.size>0&&["Graph","WCSS"].forEach((e=>{s[this.resourceMap.get(e)]=()=>this.getAccessTokenResponse(e).then((e=>e.token))}))}hasPermanentAuthError(){throw new Error("Method not implemented.")}hasOneDriveToken(){return!0}hasCAPError(e,t){return!1}getAccessTokenResponse(e,t,i,n,r,a,o,s,l){return this.getAccessTokenPromise(e,i,t,a,l)}getAccessTokenPromise(e,t,i,n,r){const a=this.clientStartupConfigService.config;let o,s,l;if(o="OfficeHome"===e&&a.sharedClientStartupContext.pwaV2TokenEnabled&&this.officeApiService.config.jwtAuthEnabled?"JWT":a.authType===d.a.MSA?"RPSCompact":"JWT",this.contextService.sharedContext.inMockMode)return Promise.resolve({success:!0,token:"mock token",format:o,source:"WAM"});const c=e;return s=t||this.resourceMap.get(c),s?(this.wamAccessTokenRequests.has(s)?l=this.wamAccessTokenRequests.get(s).result.then((e=>{if(this.wamAccessTokenRequests.get(s).pending)return this.wamAccessTokenRequests.get(s).pending=!1,this.logAccessTokenState("Succeeded",c),e;if(!this.tokenIsValid(e)||i){const e=this.windowService.nativeWindow.getWamAccessToken(s,c,n,r);return this.logAccessTokenState("RefreshTokenRequested",c),this.wamAccessTokenRequests.set(s,{pending:!0,result:e}),e}return this.logAccessTokenState("Fetched",c),e})):(l=this.windowService.nativeWindow.getWamAccessToken(s,c,n,r),this.wamAccessTokenRequests.set(s,{pending:!0,result:l})),l.catch((()=>(this.wamAccessTokenRequests.has(s)&&this.wamAccessTokenRequests.delete(s),{success:!1,token:"",format:o,source:"WAM",error:new Error("Token fetch failed from WAM")})))):Promise.reject("Invalid resource")}tokenIsValid(e){return e&&("JWT"!==e.format||!e.expiryMs||e.expiryMs>(new Date).getTime())}logAccessTokenState(e,t){const i={ResourceUrl:t,State:e};this.instrumentationService.logGenericEvent("WAM_Token_Request",i),Object(a.a)({featureName:"Hwa",eventName:"WAM_Token",params:i})}}var qn=i("ZJrL");class Vn{constructor(e){this.windowService=e,this.initialize()}getShellAndConfigPromise(){return window.queuedMarks=window.queuedMarks||[],window.performance&&window.performance.mark&&window.performance.mark("App_Initialization_Complete"),window.queuedMarks.push({markName:"App_Initialization_Complete",measureFrom:"App_Begin_Bootstrap"}),this.shellAndConfigResponse}reset(){this.setShellAndConfigPromise()}initialize(){this.initialized||(this.initialized=!0,this.setShellAndConfigPromise())}fetchShellAndConfig(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.windowService.nativeWindow.shellAndConfigResponse;if(e)try{this.shellAndConfigData=JSON.parse(e)}catch(t){this.shellAndConfigData=e}}))}setShellAndConfigPromise(){this.shellAndConfigResponse=this.fetchShellAndConfig()}}Vn.ɵprov=r.kc({factory:function(){return new Vn(r.lc(u.b))},token:Vn,providedIn:"root"});class $n{constructor(e,t){this.apiConfigurationDataService=e,this.globalErrorHandler=t,this.configMap=new Map(Object.entries(this.apiConfigurationDataService.shellAndConfigData))}parse(e,t=!1){try{if(this.configMap.has(e)){if(t){const t=qn.a.decodeJsonString(this.configMap.get(e));return JSON.parse(t)}return JSON.parse(this.configMap.get(e))}return qn.a.parseJsonElementWithId(e)}catch(t){const i=new o.a(`Failure to parse ${e} from ShellConfig response`,t);this.globalErrorHandler.handleError(i)}}}var zn=i("xoWf"),Zn=i("Xn3c"),Kn=i("R7NL"),Jn=i("MMsA"),Qn=i("4d0o"),Yn=i("Dpxn"),Xn=i("n826"),er=i("Brer");function tr(e,t,i){return e.capabilities.useVroomForOneDriveApis?i:t}class ir{}var nr=i("C0xW"),rr=i("P6pJ"),ar=i("s/Ys");const or=new r.u("DISK_PRELOAD_URL_PATTERNS");var sr=i("aQ3G");const lr=window.diskPreloadRequestMap,cr=function(e,t,i,n){var r;if(e.sharedContext.inMockMode)return[{pattern:new RegExp("/mock/v2/recent/docs","i"),markerName:"MRU"},{pattern:new RegExp("/mock/docs/recent","i"),markerName:"MRU"},{pattern:new RegExp("/mock/sites","i"),markerName:"SharePointSites"},{pattern:new RegExp("/mock/recommended/api","i"),markerName:"RecommendedDocs"},{pattern:new RegExp("/mock/(.*)/me/drive/root","i"),markerName:"OneDriveRoot"},{pattern:new RegExp("/mock/PeoplePredictionsB2/api","i"),markerName:"OfficeFeedDocs"},{pattern:new RegExp("/mock/PeoplePredictionsB2/MicrosoftFeed","i"),markerName:"OfficeFeedV2Docs"}];const a=[],o=!!(null===(r=null==n?void 0:n.capabilities)||void 0===r?void 0:r.edgeworthEnabled);if(t&&t.config){const{mruServiceRoot:e,substrateApiEndpoint:i,officeFeedApiRootPath:n,recommendedB2ApiFilesPath:r,recommendedB2ApiRootPath:s}=t.config;o||a.push({pattern:new RegExp(`^${e}/v2/recent/docs`,"i"),markerName:"MRU"}),a.push({pattern:new RegExp(`^${i}/${s}/${r}`,"i"),markerName:"RecommendedDocsV1"},{pattern:new RegExp(`^${i}/${n}/(.*)/insights/query\\(context=null,scenario='(.*)',target=null,section='(.*)'\\)`,"i"),markerName:"OfficeFeedDocs"},{pattern:new RegExp(`^${i}/PeoplePredictionsB2/MicrosoftFeed\\?section=(.*)&rs=(.*)&forceNewSchema=true`,"i"),markerName:"OfficeFeedV2Docs"})}if(!o&&(i&&i.config&&a.push({pattern:new RegExp(`^${i.config.sharePointServiceRoot}`,"i"),markerName:"SharePointSites"}),e&&e.sharedContext)){const{graphBeta:t,graphV1:i}=sr.a;a.push({pattern:new RegExp(`^${e.sharedContext.graphApiRoot}/(${t}|${i})/${Xn.a.myDriveEndpoint}root$`,"i"),markerName:"OneDriveRoot"})}return a},ur=window.diskPreloadUrlStorageKey,dr=window.diskPreloadUserIdStorageKey;class hr{}var pr=i("/6za"),mr=i("nTqU");const fr=function(e,t){if(!Object(Ut.t)(t))return!1;try{const t=e.nativeWindow,i=t.navigator;if(!("serviceWorker"in i))return!1;const{getRegistration:n,getRegistrations:r}=i.serviceWorker;return!(!n||!r)&&"URL"in t&&URL.prototype.hasOwnProperty("searchParams")}catch(e){return!1}},gr=function(e,t){return t&&e.config.enabled};class br{}const vr=new r.u("SERVICE_WORKER_USER_ID_FACTORY");var Sr=i("oECA"),yr=i("3GGT"),Cr=i("Ft/N");class wr{constructor(e){this.serviceWorkerEnabled=e}intercept(e,t){return this.serviceWorkerEnabled&&"cache-only"===e.headers.get(Cr.a)?t.handle(e).pipe(Object(Sr.a)((e=>{if(!(e instanceof mr.f))throw e;if(e.status!==yr.a.Unknown)throw e;throw new mr.f({error:e.error,headers:e.headers,status:yr.a.CacheMiss,statusText:yr.a[yr.a.CacheMiss],url:e.url})}))):t.handle(e)}}var Ir=i("HbWZ"),Tr=i("e6ST"),kr=i("jV/k"),Ar=i("XA6Z");class _r{constructor(e,t,i,n){this.serviceWorkerEnabled=e,this.serviceWorkerUserIdFactory=t,this.serviceWorkerStateService=i,this.globalErrorHandler=n}intercept(e,t){if(!this.serviceWorkerEnabled)return t.handle(e);if("Controlled"!==this.serviceWorkerStateService.currentState)return t.handle(e);const i=e.headers.get(Cr.a);if(!i)return t.handle(e);if("network-only"===i)return t.handle(e.clone({headers:e.headers.delete(Cr.a)}));if(e.reportProgress){const t="Cannot report progress for non-NetworkOnly requests";throw new mr.f({error:t,statusText:t,status:yr.a.NotImplemented,url:e.urlWithParams})}return Object(Ir.a)(this.serviceWorkerUserIdFactory()).pipe(Object(_e.a)((t=>e.clone({headers:e.headers.append("X-SW-OHP-UserCacheId",t)}))),Object(Sr.a)((t=>(this.globalErrorHandler.handleError(t,"j9XG4"),"cache-only"===i?Object(Tr.a)(new mr.f({error:"Could not send CacheOnly request without a service worker user cache ID",status:yr.a.Cancelled,statusText:"CacheOnly request cancelled"})):Object(kr.a)(e.clone({headers:e.headers.delete(Cr.a)}))))),Object(Ar.a)((e=>t.handle(e))))}}var Pr=i("vfyW");const Er=new r.u("DISK_PRELOAD_USER_ID_STORAGE_KEY"),Fr=new r.u("DISK_PRELOAD_STORAGE_KEY"),Or=new r.u("DISK_PRELOAD_REQUEST_MAP");class Dr{constructor(e,t,i,n,r,a,o,s){this.localStorageService=e,this.userIdStorageKey=t,this.urlPatternStorageKey=i,this.urlPatternEntries=n,this.serviceWorkerUserIdFactory=r,this.diskPreloadRequestMap=a,this.serviceWorkerEnabled=o,this.serviceWorkerConfigService=s,this.diskPreloadEnabled=!0,this.diskPreloadStorageEntries=[],this.initialized=this.init()}tryAddToPreloadList(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){if(yield this.initialized,!this.diskPreloadEnabled)return;const t=this.getMarkerName(e);t&&!this.hasUrl(e)&&this.updateStorageEntries([...this.diskPreloadStorageEntries,{url:e,markerName:t}])}))}loadPreloadResponse(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return yield this.initialized,this.diskPreloadEnabled?this.diskPreloadRequestMap.get(e):null}))}init(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){if(this.initialized)throw new Error("`init()` can only be called once.");if(!this.serviceWorkerConfigService.config.diskPreloadEnabled||!this.serviceWorkerEnabled)return void(this.diskPreloadEnabled=!1);const e=this.localStorageService.getGlobal(this.userIdStorageKey),t=yield this.serviceWorkerUserIdFactory();if(e!==t)return this.diskPreloadEnabled=!1,this.localStorageService.setGlobal(this.userIdStorageKey,t),void this.updateStorageEntries([]);const i=this.localStorageService.getGlobal(this.urlPatternStorageKey);i&&this.updateStorageEntries(i.filter((e=>!!this.getMarkerName(e.url))))}))}getMarkerName(e){try{return this.urlPatternEntries.find((t=>t.pattern.test(e))).markerName}catch(e){return}}hasUrl(e){return this.diskPreloadStorageEntries.map((e=>e.url)).indexOf(e)>=0}updateStorageEntries(e){this.diskPreloadStorageEntries=e,this.localStorageService.setGlobal(this.urlPatternStorageKey,this.diskPreloadStorageEntries)}}Dr.ɵprov=r.kc({factory:function(){return new Dr(r.lc(et.a),r.lc(Er),r.lc(Fr),r.lc(or),r.lc(vr),r.lc(Or),r.lc(g),r.lc(p.a))},token:Dr,providedIn:"root"});class Mr{constructor(e){this.diskPreloadService=e}intercept(e,t){return"cache-only"===e.headers.get(Cr.a)?Object(Ir.a)(this.diskPreloadService.loadPreloadResponse(e.urlWithParams)).pipe(Object(Ar.a)((i=>i?i.ok?Object(Ir.a)(this.convertToAngularHttpResponse(i,e.responseType)):Object(Tr.a)(this.convertToAngularHttpErrorResponse(i)):t.handle(e)))):t.handle(e).pipe(Object(Pr.a)((t=>{t instanceof mr.l&&t.ok&&this.diskPreloadService.tryAddToPreloadList(e.urlWithParams)})))}convertToAngularHttpResponse(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function*(){let i;switch(t){case"json":i=yield e.json();break;case"text":i=yield e.text();break;case"arraybuffer":i=yield e.arrayBuffer();break;case"blob":i=yield e.blob()}return new mr.l({body:i,headers:this.convertToAngularHeaders(e.headers),status:e.status,statusText:e.statusText,url:e.url})}))}convertToAngularHttpErrorResponse(e){return new mr.f({error:e.statusText,status:e.status,statusText:e.statusText,headers:this.convertToAngularHeaders(e.headers),url:e.url})}convertToAngularHeaders(e){let t=new mr.i;return e.forEach(((e,i)=>{t=t.append(i,e)})),t}}var Rr=i("PZOQ"),xr=i("1Bt+"),Lr=i("uH9+"),Ur=i("EYJY");class Nr{constructor(e=!1){this.id=st.a.createGuid(),this.startTime=k.a.now(),e&&this.complete()}complete(){this.endTime=k.a.now()}timeSinceUpdate(){return this.endTime?k.a.now()-this.endTime:0}}class Wr{constructor(e,t,i){this.instrumentationService=t,this.officeRouteService=i,this.updates=new Map,this.defaultUpdateTimeout=e.sharedContext.dataUpdateTimeoutInSeconds*Wr.MsPerSecond,this.defaultUpdateCooldown=e.sharedContext.dataUpdateCooldownInSeconds*Wr.MsPerSecond,this.defaultUpdateFailures=e.sharedContext.dataUpdateMaxConsecutiveFailures}getOrAddUpdateStream(e,t,i,n,r,a=!1){const o=this.officeRouteService.getRouteItemForCurrentLocation();return this.updates.has(e)||this.updates.set(e,{consecutiveFailures:0,cooldown:n||this.defaultUpdateCooldown,lastUpdate:a?null:new Nr(!0),maxFailures:i||this.defaultUpdateFailures,operation:t,route:o,subject:new Ur.a,timeout:r||this.defaultUpdateTimeout}),this.updates.get(e).subject.asObservable()}pushUpdate(e){return this.updates.has(e)?this.safeUpdate(this.updates.get(e),e):Promise.resolve()}updateAllowed(e){if(!e.lastUpdate)return!0;const t=e.lastUpdate.timeSinceUpdate();return t>0?t>e.cooldown:e.timeout&&e.lastUpdate.startTime+e.timeout<=k.a.now()}safeUpdate(e,t){if(!this.updateAllowed(e))return Promise.resolve();const i=new Nr;return e.lastUpdate=i,e.operation().then((t=>{i.id===e.lastUpdate.id&&(e.subject.next(t),e.consecutiveFailures=0)})).catch((n=>{const r=(null==n?void 0:n.error)||n,a=`Error message: ${"string"==typeof r?r:(null==r?void 0:r.message)||"not available"}`,o=`Call stack: ${(null==r?void 0:r.errorstack)||"not available"}`;Object(z.a)({eventName:"BaseUpdateContentServiceError",debugInfo:o,message:a}),this.instrumentationService.logDebugCacheEvent("Base_Update_Content_Service_Error",{Error:a,DebugInfo:o}),i.id===e.lastUpdate.id&&(e.consecutiveFailures++,e.consecutiveFailures>=e.maxFailures&&this.updates.delete(t))})).then((()=>{i.complete()}))}}Wr.MsPerSecond=1e3;class jr extends Wr{constructor(e,t,i,n,r,a){super(e,n,r),this.documentService=t,this.instrumentationService=n,this.pageVisibilityService=a,this.updateInterval=e.sharedContext.dataUpdateIntervalInSeconds*Wr.MsPerSecond,e.sharedContext.updateDataOnViewEnabled&&(this.focusSubscription=i.events.withScope(1).pipe(Object(Te.a)((e=>"windowFocused"===e.name))).subscribe((()=>{const e=this.documentService.nativeDocument.activeElement;e&&"IFRAME"===e.tagName||(this.updateInterval&&this.resetUpdateTimer(),this.broadcastUpdates())}))),this.updateInterval&&this.resetUpdateTimer()}ngOnDestroy(){this.focusSubscription&&this.focusSubscription.unsubscribe()}resetUpdateTimer(){"number"==typeof this.updateTimer&&clearInterval(this.updateTimer),this.updateTimer=setInterval((()=>{this.pageVisibilityService.isVisible()&&this.broadcastUpdates()}),this.updateInterval)}broadcastUpdates(){const e=this.officeRouteService.getRouteItemForCurrentLocation();this.updates.forEach(((t,i)=>{M.a.areRoutesEqual(e,t.route)&&this.safeUpdate(t,i)}))}}class Hr{constructor(e,t,i){this.errorHandler=e,this.contextService=t,this.serviceWorkerEnabled=i}handleRegistration(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){if(this.serviceWorkerEnabled)try{const t=this.contextService.sharedContext.serviceWorkerIntervalUpdateEnabled,i=()=>{e.addEventListener("updatefound",(()=>{this.postAppLoadedMessage(e.installing)}))};e.installing?(this.postAppLoadedMessage(e.installing),t&&i()):i()}catch(e){this.errorHandler.handleError(e,"GDHPG")}}))}postAppLoadedMessage(e){e.postMessage({type:"OFFICECOM_LOAD_COMPLETE",meta:"installation-app",payload:{success:!0,unregister:!1}})}}class Br extends class{constructor(e){this.windowService=e}addParamFromWindow(e,t){const i=new URL(this.windowService.nativeWindow.location.href).searchParams.get(t);i&&(e.apiQsParams?e.apiQsParams[t]=i:e.apiQsParams={[t]:i})}}{constructor(e,t,i,n,r,a,o,s,l){super(l),this.accessTokenService=e,this.configParserService=t,this.contextService=i,this.instrumentationService=n,this.officeApiService=r,this.serviceWorkerEnabled=a,this.serviceWorkerUserIdFactory=o,this.startupConfigService=s}handleRegistration(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){if(this.serviceWorkerEnabled)try{const t=this.contextService.sharedContext.serviceWorkerIntervalUpdateEnabled,i=()=>{e.addEventListener("updatefound",(()=>{this.postAuthorizedInstallMessage(e.installing)}))};e.installing?(this.postAuthorizedInstallMessage(e.installing),t&&i()):i()}catch(e){const t={Error:(e||"").toString()};this.instrumentationService.logGenericEvent("Pwa_Sw_Handle_Registration_Error",t),Object(z.a)({eventName:"Pwa_Sw_Handle_Registration",message:(e||"").toString()})}}))}postAuthorizedInstallMessage(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const t=this.startupConfigService.config.authType===d.a.MSA,i={token:null,userId:yield this.serviceWorkerUserIdFactory()};if(!t||this.startupConfigService.config.sharedClientStartupContext.pwaV2TokenEnabled&&this.officeApiService.config.jwtAuthEnabled){const e=yield this.accessTokenService.getAccessToken("OfficeHome");if(!e.success){const t={Error:(e.error||"").toString()};return this.instrumentationService.logGenericEvent("Pwa_Sw_Get_Token_Error",t),void Object(z.a)({eventName:"Pwa_Sw_Get_Token_Error",message:(e.error||"").toString()})}i.token=e.token}else i.token=".";i.apiQsParams={[window.forcedMockAuth?"mockauth":"auth"]:t?"1":"2"},this.contextService.sharedContext.inMockMode&&this.addParamFromWindow(i,"envType"),this.addParamFromWindow(i,"flight");const n=this.configParserService.parse("pwaConfig");n&&n.shellAndConfigApiEndpoint&&(i.apiPath=n.shellAndConfigApiEndpoint),e.postMessage({type:"OFFICECOM_AUTH_WARMUP",meta:"installation-credentials",payload:i})}))}}class Gr{constructor(e){this.serviceWorkerEnabled=e}handleRegistration(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){this.serviceWorkerEnabled||(yield e.unregister())}))}}class qr{constructor(e,t,i,n){this.serviceWorkerEnabled=e,this.updateContentService=t,this.contextService=i,this.instrumentationService=n}handleRegistration(e){this.serviceWorkerEnabled&&this.contextService.sharedContext.serviceWorkerIntervalUpdateEnabled&&this.updateContentService.getOrAddUpdateStream("serviceWorker",(()=>this.updateServiceWorkerRegistration(e)))}updateServiceWorkerRegistration(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){try{yield e.update()}catch(t){const i=(null==t?void 0:t.error)||t,n=`Error message: ${"string"==typeof i?i:(null==i?void 0:i.message)||"not available"}`,r=`installing:${null==e?void 0:e.installing}.onLine:${null===navigator||void 0===navigator?void 0:navigator.onLine}.Call stack:${(null==i?void 0:i.stack)||"not available"}`;Object(z.a)({eventName:"ServiceWorkerUpdateContentServiceError",debugInfo:r,message:n}),this.instrumentationService.logDebugCacheEvent("Service_Worker_Update_Content_Service_Error",{Error:n,DebugInfo:r})}}))}}class Vr{constructor(e,t){this.windowService=e,this.serviceWorkerApiAvailable=t}sendTransactionalMessage(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function*(){if(this.serviceWorkerApiAvailable&&"undefined"!=typeof MessageChannel)return(t=t||(yield this.getServiceWorker()))?new Promise((i=>{const n=new MessageChannel;n.port1.onmessage=e=>{i(e),n.port1.close(),n.port2.close()},t.postMessage(e,[n.port2])})):void 0}))}sendUnidirectionMessage(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function*(){this.serviceWorkerApiAvailable&&(t=t||(yield this.getServiceWorker()))&&t.postMessage(e)}))}getServiceWorker(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){try{const e=this.windowService.nativeWindow.navigator.serviceWorker;return(yield e.ready).active}catch(e){return null}}))}}Vr.ɵprov=r.kc({factory:function(){return new Vr(r.lc(u.b),r.lc(b.a))},token:Vr,providedIn:"root"});class $r{constructor(e,t,i,n,r){this.errorHandler=e,this.contextService=t,this.instrumentationService=i,this.serviceWorkerEnabled=n,this.serviceWorkerMessageService=r}handleRegistration(e){if(this.serviceWorkerEnabled)try{const t=this.contextService.sharedContext.serviceWorkerIntervalUpdateEnabled,i=()=>{e.addEventListener("updatefound",(()=>{this.subscribeToInstallingServiceWorkerActivationTelemetry(e.installing)}))};e.installing?(this.subscribeToInstallingServiceWorkerActivationTelemetry(e.installing),t&&i()):i()}catch(e){this.errorHandler.handleError(e)}}subscribeToInstallingServiceWorkerActivationTelemetry(e){this.serviceWorkerMessageService.sendTransactionalMessage({type:"OFFICECOM_SW_TELEMETRY",meta:"activation"},e).then((e=>{const t=e.data;"OFFICECOM_SW_TELEMETRY"===t.type&&"activation"===t.meta&&this.instrumentationService.logGenericEvent(t.payload.eventName,t.payload.params)}))}}var zr,Zr,Kr=i("qfyf"),Jr=i("Xc4i"),Qr=i("aZf6"),Yr=i("GAcG");!function(e){e[e.NotSupported=0]="NotSupported",e[e.SameDocOnly=1]="SameDocOnly",e[e.AnyDoc=2]="AnyDoc",e[e.OtherMode=4]="OtherMode"}(zr||(zr={})),function(e){e.AccessToken="AccessToken",e.FileGetUrl="FileGetUrl"}(Zr||(Zr={}));var Xr=i("idgT"),ea=i("IBRu"),ta=i("ZBli"),ia=i("y9oG"),na=i("pOWU");class ra extends na.a{constructor(e,t,i,n,r,a,o,s){super(e,t,i,"Graph",n,r,a,s),this.globalErrorHandler=o,this.requestConfig={headers:new Map([["content-type","application/x-www-form-urlencoded"]])}}postPreboot(e,t,i,n){return new Promise(((r,a)=>{super.post(e,t,i,n,(e=>{e.instrument(((e,t)=>{t.RequestId=this.getRequestIdFromResponse(e)})).then((()=>r(null)))}),(e=>{a(e)}),this.requestConfig,void 0,void 0,void 0,void 0,"None")}))}}ra.ɵprov=r.kc({factory:function(){return new ra(r.lc($e.a),r.lc(T.a),r.lc(Kn.a),r.lc(B.a),r.lc(l.a),r.lc(Ut.q),r.lc(o.b),r.lc(c.a))},token:ra,providedIn:"root"});var aa=i("Ax7d");class oa extends Jr.a{constructor(e,t,i,n,r,a,o,s,l,c,u){super(e,t,i,n,r,a,o,s),this.webPwaService=l,this.windowService=c,this.wacPrebootService=u,this.prebootedApplications=new Map,this.bootstrappedDocuments=new Map,this.prebootedDocuments=new Map,this.prebootedWopiFetchData=new Map,this.prebootedSessionId=new Map,this.webPwaService.isStandalone.subscribe((e=>{this.isStandalone=e,this.uihit=this.getUihit(e),this.uih=`officecom${this.uihit}`}))}prebootDocument(e){if(!e.driveId||!e.docId||this.prebootedDocuments.has(this.getPrebootKey(e)))return;const t=this.getWopiData(e,!1,!1,!0);t.then((i=>{const n=st.a.createGuid(),r=this.index++,a=this.getPrebootKey(e);this.prebootedDocuments.set(a,r),this.prebootedWopiFetchData.set(a,t),this.prebootedSessionId.set(a,n);const o="access_token="+encodeURIComponent(i.wopiHostData.wac.accessToken)+"&access_token_ttl="+encodeURIComponent(i.wopiHostData.wac.accessTokenExpiry)+"&bundleSrc="+encodeURIComponent(i.wopiHostData.bundleUrl)+"&fileExtension="+encodeURIComponent(Q.a.getFileExtension(i.wopiHostData.fileName))+"&user_id="+encodeURIComponent(i.wopiHostData.wac.userId);this.wacPrebootService.postPreboot("WacDocument_Preboot","WacDocument_Preboot",this.getPrebootUrl(i.wopiHostData.wac.applicationUrl)+"?op=preboot&usid="+encodeURI(n),o)}))}bootstrapItem(e,t,i){let n,r,a;this.prebootedApplications.clear();let o=!1;if(this.capabilitiesService.wacHostHoverPrebootEnabledForFileType(e.fileType)&&e.driveId&&e.docId){const t=this.getPrebootKey(e);r=this.prebootedDocuments.get(t),n=this.prebootedWopiFetchData.get(t),a=this.prebootedSessionId.get(t),o=Number.isInteger(r),o&&(this.prebootedDocuments.delete(t),this.prebootedSessionId.delete(t))}const[s,l]=this.generateCorrelationAndBootId(r);this.logPerformanceBootStart(l,s,e.wdOrigin,e.fileType);const c=new Qr.a;this.logPerformanceEventFromClick(l,"WacContent_Document_Wopi_Fetch_Start",e.fileType);const u=null!=n?n:i||this.getWopiData(e,!1,!1,!0);u.then((i=>{this.logPerformanceEventFromClick(l,"WacContent_Document_Wopi_Fetch_End",e.fileType),this.bootstrapFile(c,l,e,i.wopiHostData,s,t,i.fetchDiagnostics,!0,o?a:void 0)})).catch((e=>{this.sendBootError("WacDocument_Vroom_Error",e,c)}));const{fileName:d}=e,h={correlationId:s,bootstrapperObservable:c.asObservable(),fileNamePromise:d?Promise.resolve(Q.a.fileNameWithoutExtension(d)):u.then((e=>Q.a.fileNameWithoutExtension(e.wopiHostData.fileName))),documentIdentifierPromise:u.then((e=>e.fetchedDocumentInfo))},p={correlationId:s,bootedDocumentInfo:{bootId:l,documentInfo:e},data:h};return this.bootstrappedDocuments.set(l,p),p}bootstrapZeroByteDocument(e,t,i,r,a){let o=this.prebootedApplications.get(e.fileType);Date.now()>(null==o?void 0:o.expirationTime)&&(o=void 0,this.prebootedApplications.clear());const[s,l]=o?o.correlationAndBoot:this.generateCorrelationAndBootId();this.logPerformanceBootStart(l,s,e.wdOrigin,e.fileType);const c=o?o.loadFunctionSubject:new Qr.a,u=i.then((t=>(this.logPerformanceEventFromClick(l,"WacContent_Document_Wopi_Fetch_Start",e.fileType),this.getWopiData(t,!0,!1,!0))));u.then((i=>Object(n.__awaiter)(this,void 0,void 0,(function*(){this.logPerformanceEventFromClick(l,"WacContent_Document_Wopi_Fetch_End",e.fileType);const n=yield i.fetchedDocumentInfo;let u=null;u=a?Object.assign(Object.assign({},n.applicationUrlParams),{templateItemId:r,templateDriveId:a}):r?Object.assign(Object.assign({},n.applicationUrlParams),{wdTpl:r}):n.applicationUrlParams,o?o.finishLoad(i.wopiHostData,n.newFileInfo):this.bootstrapFile(c,l,Object.assign(Object.assign({},n),{applicationUrlParams:u}),i.wopiHostData,s,t,Object.assign(Object.assign({},i.fetchDiagnostics),{endTime:Date.now()}))})))).catch((e=>{this.sendBootError("WacDocument_Vroom_Error",e,c)}));const d=u.then((e=>e.fetchedDocumentInfo)),h={bootstrapperObservable:c.asObservable(),fileNamePromise:d.then((e=>Q.a.fileNameWithoutExtension(e.fileName))),documentIdentifierPromise:d},p={bootId:l,documentInfo:Object.assign(Object.assign({},e),{newFile:!0,templateId:r})},m={correlationId:s,bootedDocumentInfo:p,data:h};return this.bootstrappedDocuments.set(l,m),o&&this.prebootedApplications.clear(),m}bootstrapApplication(e,t){if(!this.capabilitiesService.capabilities.wacHostPrebootApps.has(e)||this.prebootedApplications.has(e))return;const[i,r]=this.getOfficeBootstrapper(e);if(!i||r)return;const[a,o]=this.generateCorrelationAndBootId(),s=new Qr.a,[l,c,u]=Object(ea.a)();s.next((({container:r,flushTime:a,loadCorrelationId:s})=>new Yr.a((c=>{const u=this.getInitParams(e,s,t,r.nativeElement,a,a,(t=>Object(n.__awaiter)(this,void 0,void 0,(function*(){this.logPerformanceEventFromClick(o,"WacContent_Document_Load_End",e);const[i]=yield l;c.next({wopiHostData:i,officeApplication:t}),c.complete()}))),(e=>{this.sendBootError("WacDocument_JsApi_Error",e,c)}),void 0,void 0,void 0,void 0,void 0,{wdasp:1});this.logPerformanceEventFromClick(o,"WacContent_Document_InitializeWopiPending",e);const d=i.Application.InitializeWopiPending(u);d?l.then((([e,t])=>{const i=this.getWopiInfo(e.wac);d.Complete(i,t)})).catch((()=>{})):this.sendBootError("Initialize_Wopi_Pending_Failed",fail,c)})))),s.complete();const d=u,h={bootstrapperObservable:s.asObservable(),fileNamePromise:l.then((([e])=>e.fileName))},p={finishLoad:(e,t)=>c([e,t]),cancelLoad:d,loadData:{correlationId:a,bootedDocumentInfo:{bootId:o,documentInfo:{fileType:e,wdOrigin:t}},data:h},loadFunctionSubject:s,expirationTime:Date.now()+this.contextService.sharedContext.wacHostAppPrebootTimeout,correlationAndBoot:[a,o]};return this.prebootedApplications.set(e,p),p}bootstrapFile(e,t,i,n,r,a,o,s=!0,l){const{fileType:c}=i,u=null==n?void 0:n.wac;let d=0;try{d=(null==u?void 0:u.accessTokenExpiry)?parseInt(u.accessTokenExpiry):0}catch(e){}if(!(null==u?void 0:u.bootstrapperUrl)||d<Date.now())return void(s?this.getWopiData(i,i.newFile,!0).then((n=>{n?this.bootstrapFile(e,t,i,n.wopiHostData,r,a,n.fetchDiagnostics,!1):this.sendBootError("WacDocument_Generic_Boot_Error","Error occurred while trying to fetch wopi data",e)})).catch((t=>{this.sendBootError("WacDocument_Vroom_Error",t,e)})):this.sendBootError("WacDocument_Vroom_Error","Failed to get wopi data for the item",e));const h=n.wac.bootstrapperUrl,p=n.wac.applicationUrl;this.logPerformanceEventFromClick(t,"WacContent_Document_Bootstrapper_Load_Start",c),this.loadBootstrapper(h,p,c).then((()=>{const[s,u]=this.getOfficeBootstrapper(c);if(u)return void this.sendBootError("WacHost_Bootstrapper_Load_Error",u,e);this.logPerformanceEventFromClick(t,"WacContent_Document_Bootstrapper_Load_End",c);const d=this.getWopiInfo(n.wac);e.next((({container:e,flushTime:u,loadCorrelationId:p})=>new Yr.a((m=>{const f=setTimeout((()=>{this.logError(r,i,"WacDocument_JsApi_Timeout")}),15e4),g=this.getInitParams(i.fileType,p,i.wdOrigin,e.nativeElement,r!==p?u:a,u,((e,o)=>{clearTimeout(f),this.logPerformanceEventFromClick(t,"WacContent_Document_Load_End",c),this.logBootPerformance(r,i,o,a),m.next({wopiHostData:n,officeApplication:e}),m.complete()}),(e=>{clearTimeout(f),this.sendBootError("WacDocument_JsApi_Error",e,m)}),i.docId,n,d,h,o,i.applicationUrlParams,i.rebootOverrideData);this.logPerformanceEventFromClick(t,"WacContent_Document_InitializeWopiPending",c);const b=s.Application.InitializeWopiPending(g,void 0,l);b?b.Complete(d):this.sendBootError("Initialize_Wopi_Pending_Failed",fail,m)})))),e.complete()})).catch((()=>{this.sendBootError("WacHost_Bootstrapper_Load_Error","Failed to load the bootstrapper",e)}))}getOfficeBootstrapper(e){const t=this.windowService.nativeWindow.Microsoft;if(void 0===t)return[null,"Microsoft is undefined"];const i=t.Office,n=Q.b[e];return i&&i[n]?[i[n],null]:[null,`Failed to find bootstrapper for app: ${n}`]}getSessionContext(){return{pmo:this.windowService.nativeWindow.location.origin,pmshare:!0,surl:void 0,curl:void 0,vurl:void 0,eurl:this.windowService.nativeWindow.location.href}}getSessionInformation(e,t,i={}){const n=this.contextService.sharedContext.officeMarket,r=this.capabilitiesService.capabilities;return{HostName:"office.com",HostSessionId:t,UserId:e,OwnerId:void 0,UiLocale:n,DataLocale:n,DisableChat:!0,CookieCompliant:!0,WdParams:i,DisableFocusOnBoot:!1,SessionContext:JSON.stringify(this.getSessionContext()),HideHeader:this.capabilitiesService.capabilities.isEmbedMode,SupportsDocReboot:zr.AnyDoc|zr.OtherMode,SupportsCreateNewDocument:!0,SupportsAuthToken:r.wacHostGetAuthTokenEnabled,UiHostIntegrationType:this.uihit,SupportsAtMentions:!0,SupportsCustomAuthConfig:r.wacHostGetCustomAuthConfigEnabled,SupportsExcelExternalLinks:r.wacHostExternalLinkEnabled,SupportsMoveToFolder:r.wacHostMoveToFolderEnabled}}getOrCreateDefaultPrecheckInfo(e,t){var i,n;return e?Object.assign({FileName:e.fileName,FileGetUrl:e.downloadUrl||e.wac.fileGetUrl,FileSize:e.fileSize,BundleInfo:{Url:e.bundleUrl,MajorVersion:e.bundleVersion},ReadOnly:null!==(i=e.readOnly)&&void 0!==i&&i,IrmEnabled:null!==(n=e.irmEnabled)&&void 0!==n&&n,ETag:e.eTag,ClientThrottlingProtection:e.wac.clientThrottlingProtection,RequestedCallThrottling:e.wac.requestedCallThrottling,IsNewFile:e.isNewFile},t&&{DocUniqueId:t}):{FileName:""}}getWopiInfo(e){return{WopiSrc:e.wopiSrc,AccessToken:e.accessToken,AccessTokenExpiry:new Date(parseInt(e.accessTokenExpiry))}}getDiagnostics(e,t,i,n={startTime:0,endTime:0},r){const a=r?this.bootstrapperDiagnostics.get(r):{startTime:0,endTime:0},o=Math.max(this.performanceService.navigationStart,e),s=Math.max(n.startTime?n.startTime:0,o),l=Math.max(n.endTime?n.endTime:0,s),c=Math.max(t,l),u=Math.max(a?a.startTime:0,c);return{entryPoint:i,userClickTime:e,hostPageNavigationStartTime:o,hostPageFetchStartTime:s,hostPageFetchEndTime:l,hostPageFirstFlushTime:c,officeBootstrapperStartTime:u,officeBootstrapperEndTime:Math.max(a?a.endTime:0,u),officeInitializationTime:Date.now()}}getInitParams(e,t,i,n,r,a,o,s,l,c,u,d,h,p,m){const{bootstrapperUrl:f,applicationUrl:g}=this.applicationUrls.get(e),b=c?c.wac.applicationUrl||c.wac.editUrl:ta.a.removeQueryParams(g,["wopisrc"],!1),v=Object.assign(Object.assign({},p),{uiEmbed:1,uih:this.uih}),S=ta.a.appendQueryParams(b,v),y={},C=this.capabilitiesService.capabilities.scenarioId;return C&&(y.wdscenarioId=C),Object.assign({BootstrapperUrl:d||f,Container:n,SessionInformation:this.getSessionInformation(c?c.wac.userId:this.clientStartupConfigService.config.puid,t,y),ApplicationUrl:S,WopiPrecheckInfo:this.getOrCreateDefaultPrecheckInfo(c,l),ApplicationCustomSettings:{HostUIControls:[{id:"close",visibility:0},{id:"share",visibility:1}]},Diagnostics:this.getDiagnostics(r,a,i,h,f),FnOnInitializeSuccess:o,FnOnInitializeFailure:s,FnIsFeatureEnabled:this.createIsFeatureEnabledCallback(e),RebootOverrideData:m},u?{WopiInfo:u}:{})}createIsFeatureEnabledCallback(e){return t=>{switch(t){case"OfficeComUiHost":return!this.isStandalone&&!this.capabilitiesService.capabilities.isPwaInUwp;case"OfficeHwaUiHost":return this.capabilitiesService.capabilities.isPwaInUwp;case"OfficeComPreboot":return!(!this.capabilitiesService.wacHostEnabledForFileType(e)||!this.capabilitiesService.wacHostHoverPrebootEnabledForFileType(e))||!this.capabilitiesService.capabilities.wacHostHoverPrebootControlFlight&&void 0;default:return}}}logError(e,t,i,n){const r={Error:n};this.instrumentationService.logErrorEvent(i,Object(ia.a)(e,t,r))}sendBootError(e,t,i){i.error({instrumentationEvent:e,error:t})}getUihit(e=!1){return this.capabilitiesService.capabilities.isPwaInUwp?oa.uihitOfficeComHwa:e?oa.uihitOfficeComPwa:""}getPrebootUrl(e){if(!e)return null;const t=ii.a.getLocation(e),i=t.path.substring(0,t.path.lastIndexOf("/"))+"/preboot.ashx";return ii.a.getOrigin(e)+i}getPrebootKey(e){return e.driveId+"_"+e.docId}}oa.uihitOfficeComPwa="pwa",oa.uihitOfficeComHwa="hwa";class sa{constructor(e){this.config=e.parse("universalStoreConfig")||{BulkLicensePreviewApiPath:"",CollectionsApiRoot:"",O365HomeProductId:"",O365PersonalProductId:"",O365SoloProductId:"",PerpetualSuiteIds:"",PerpetualSuiteIds2019:"",SubscriptionSuiteIds:""}}}sa.ɵprov=r.kc({factory:function(){return new sa(r.lc(ni.a))},token:sa,providedIn:"root"});var la=i("oAX+");class ca extends na.a{constructor(e,t,i,n,r,o,s,l,c,u,h,p,m){if(super(e,t,i,"BulkLicensePreview",n,o,s,p),this.globalErrorHandler=u,this.serviceWorkerMessageService=m,this.capabilities=l.capabilities,this.startupConfig=c.config,this.ustConfig=h.config,this.startupConfig.authType===d.a.MSA&&this.capabilities.pwaEnabled){if(this.market=n.sharedContext.officeMarket,this.ustConfig.BulkLicensePreviewApiPath&&this.ustConfig.BulkLicensePreviewApiPath)if(this.inMockMode){this.serviceUrl=`${n.sharedContext.officeHomeApiRoot}/${this.ustConfig.BulkLicensePreviewApiPath}`;for(const e in this.queryParams)e&&this.queryParams.hasOwnProperty(e)&&"skutype"===e.toLowerCase()&&(this.serviceUrl+=`?skutype=${this.queryParams[e]}`)}else this.serviceUrl=`${this.ustConfig.CollectionsApiRoot}/${this.ustConfig.BulkLicensePreviewApiPath}`;this.cvExtension=-1,this.accessTokenService.getAccessToken("BulkLicensePreview"),r.events.withScope(1).pipe(Object(Te.a)((e=>"convertedToPaid"===e.name)),Object(ke.a)(1)).toPromise().then((()=>{this.serviceWorkerMessageService.sendTransactionalMessage({type:"runtime-cache",meta:"delete-cache",payload:{cacheName:"bulk-license-preview-api"}}).then((e=>{const t=e.data,i=t.payload;t&&"runtime-cache"===t.type&&"delete-cache"===t.meta&&i&&"bulk-license-preview-api"===i.cacheName&&(this.instrumentationService.logGenericEvent("Clear_SW_Cache",{State:i.params?i.params.state:"Processed",ElementId:"bulk-license-preview-api"}),Object(a.a)({featureName:"Upsell",eventName:"Clear_SW_Cache",area:"Other",params:{ElementId:"bulk-license-preview-api",State:i.params?i.params.state:"Processed"}}))}))}))}this.requestConfig={headers:new Map([["content-type","application/json"],["MS-CorrelationId",c.config.sharedClientStartupContext.correlationId]])}}getLicenses(){if(this.startupConfig.authType!==d.a.MSA||!this.capabilities.pwaEnabled)throw new Error("Not implemented");const e=this.fetchLicenses("cache-only"),t=this.fetchLicenses("network-first");return la.a.createResultsWithCacheObservable(e,t)}handleQueryParam(e,t){"skutype"===e&&this.mockRequestHeader&&this.requestConfig.headers.set(this.mockRequestHeader,t)}fetchLicenses(e){return new Promise(((t,i)=>{this.serviceUrl?(this.requestConfig.headers.set("MS-CV",this.startupConfig.sharedClientStartupContext.correlationId+"."+(++this.cvExtension).toString()),this.requestConfig.body=this.getBody(),this.post("Bulk_License_Preview_Request","Bulk_License_Preview",this.serviceUrl,this.requestConfig.body,(e=>{e.then((e=>{e.ok&&e.data?t(this.convertToUserLicenses(e.data.items,e.fromCache)):i(new na.b(e,"No data returned"))})).catch((e=>{this.globalErrorHandler.handleError(e,"zyhCG")}))}),i,this.requestConfig,null,null,null,null,"BulkLicensePreview",null,((e,t)=>{e&&t&&(e.body.beneficiaries[0].identityValue=t.token)}),e)):i(new na.b(null,"Failed to get license. Service url is not defined"))}))}getBody(e=""){const t=[{identityType:"msa",identityValue:e,localTicketReference:"OfficeHomeMsa"}],i=`${this.ustConfig.SubscriptionSuiteIds},${this.ustConfig.PerpetualSuiteIds},${this.ustConfig.PerpetualSuiteIds2019}`.split(",").map((e=>({productId:e})));return{beneficiaries:t,market:this.market,validityType:"All",excludeDuplicates:!0,excludeSharingExpansion:!1,expandSatisfyingItems:!0,logFilteredItems:!0,productSkuIds:i}}convertToUserLicenses(e,t=!1){if(e&&0===e.length)return{currentSkuInfo:{skuType:Y.b.NotSubscribed,daysExpired:-1},expiredSkuInfo:{skuType:Y.b.NotSubscribed,daysExpired:-1},diagnosticInfo:"",fromCache:t};let i=Y.b.NotDetected,n=-1,r=Y.b.NotDetected,a=-1,o="";if(e&&e.length>0){i=Y.b.NotSubscribed,r=Y.b.NotSubscribed,o=e.map((e=>e.productId+":"+e.status)).join();const t=e.filter((e=>"active"===e.status.toLowerCase())).map((e=>this.mapToLightLicenseItem(e))).sort(((e,t)=>this.sortBySkuOrder(e,t)));t.length>0&&(i=t[0].skuType,n=Math.ceil((Date.parse(t[0].endDate)-Date.now())/864e5));const s=e.filter((e=>"expired"===e.status.toLowerCase())).sort(((e,t)=>this.sortByEndDate(e,t)));s.length>0&&(r=this.getSkuType(s[0]),a=Math.ceil((Date.now()-Date.parse(s[0].endDate))/864e5))}return{currentSkuInfo:{skuType:i,daysExpired:-n},expiredSkuInfo:{skuType:r,daysExpired:a},diagnosticInfo:o,fromCache:t}}mapToLightLicenseItem(e){return{endDate:e.endDate,skuType:this.getSkuType(e)}}sortByEndDate(e,t){return(Date.parse(e.endDate)||0)>=(Date.parse(t.endDate)||0)?-1:1}sortBySkuOrder(e,t){return e.skuType<=t.skuType?-1:1}getSkuType(e){if(!e.productId)return Y.b.NotDetected;let t=Y.b.NotSubscribed;const i=this.ustConfig.O365PersonalProductId,n=this.ustConfig.O365SoloProductId,r=this.ustConfig.O365HomeProductId,a=this.ustConfig.SubscriptionSuiteIds,o=this.ustConfig.PerpetualSuiteIds,s=this.ustConfig.PerpetualSuiteIds2019,l=e.productId.toUpperCase();if(a.indexOf(l)>=0)switch(l){case r:t=e.trialData.isTrial?Y.b.O365HomeTrial:Y.b.O365Home;break;case i:t=Y.b.O365Personal;break;case n:t=Y.b.O365Solo;break;default:t=Y.b.OtherSubscription}else o.indexOf(l)>=0?t=Y.b.Perpetual:s.indexOf(l)>=0&&(t=Y.b.Perpetual2019);return t}}class ua{constructor(e,t,i,n,r,o){this.capabilitiesService=e,this.createDocumentService=t,this.instrumentationService=i,this.localStorageService=n,this.locService=r,this.pwaConfigService=o,this.taskStatus=0,this.isUpdateWaiting=!1,this.tasks=[],this.latestRecommendedDocs=[],this.latestRecentDocs=[],this.jumpListEnabled=!1,this.jumpListFiles={items:[]},this.jumpListRemovedFiles=new Set,this.jumpListEnabled=this.capabilitiesService.capabilities.isPwaInUwp&&(!this.capabilitiesService.capabilities.isPwaInWebView2||this.capabilitiesService.capabilities.isPwaInWebView2&&void 0!==Windows.ApplicationModel.Core&&void 0!==Windows.ApplicationModel.Core.CoreApplication&&void 0!==Windows.ApplicationModel.Core.CoreApplication.exit&&void 0!==Windows.UI.WindowManagement&&void 0!==Windows.UI.WindowManagement.AppWindow)&&this.pwaConfigService.config.pwaJumpListEnabled,this.jumpListEnabled&&this.createDocumentService.getCreateLinks().then((e=>{this.tasks=e,this.updateJumpList()})).catch((e=>{const t={};t.Error=(e||"").toString(),t.Action="GetCreateLinks",this.instrumentationService.logGenericEvent("Pwa_Jump_List",t,[],2),Object(a.a)({featureName:"Hwa",eventName:"Pwa_Jump_List",params:t},Z.a.Enhanced)}))}registerRecommendedJumpList(e){if(this.jumpListEnabled){let t=!1;if(e.length!==this.latestRecommendedDocs.length)t=!0;else for(let i=0;i<e.length;i++)if(this.latestRecommendedDocs[i].url!==e[i].url){t=!0;break}t&&(this.latestRecommendedDocs=JSON.parse(JSON.stringify(e)),this.updateJumpList())}}registerRecentJumpList(e){if(this.jumpListEnabled){let t=!1;if(e.length!==this.latestRecentDocs.length)t=!0;else for(let i=0;i<e.length;i++)if(this.latestRecentDocs[i].url!==e[i].url){t=!0;break}t&&(this.latestRecentDocs=JSON.parse(JSON.stringify(e)),this.updateJumpList())}}getJumpListItemById(e){if(this.jumpListEnabled)try{const t=this.localStorageService.getGlobal(ua.LocalStorageJumpListMappingKey);if(t&&void 0!==t[e])return t[e]}catch(e){const t={};t.Error=(e||"").toString(),t.Action="GetJumpListItemById",this.instrumentationService.logGenericEvent("Pwa_Jump_List",t,[],2),Object(a.a)({featureName:"Hwa",eventName:"Pwa_Jump_List",params:t},Z.a.Enhanced)}return null}saveToMapping(){let e;try{const t=this.localStorageService.getGlobal(ua.LocalStorageJumpListMappingKey);e=t||{}}catch(t){e={};const i={};i.Error=(t||"").toString(),i.Action="GetJumpListMappingFromLocalStorage",this.instrumentationService.logGenericEvent("Pwa_Jump_List",i,[],2),Object(a.a)({featureName:"Hwa",eventName:"Pwa_Jump_List",params:i},Z.a.Enhanced)}if(this.jumpListFiles.items.forEach((t=>{e[t.jumpListItemId]=t})),Object.keys(e).length>=ua.MaxSavedFiles){const t=Object.keys(e).map((t=>e[t].lastShownTime));t.sort(((e,t)=>t-e));const i=t[ua.MaintenanceSavedFiles];Object.keys(e).forEach((t=>{e[t].lastShownTime<=i&&delete e[t]}))}this.localStorageService.setGlobal(ua.LocalStorageJumpListMappingKey,e)}updateRemovedFiles(){let e;try{e=this.localStorageService.getGlobal(ua.LocalStorageJumpListRemovedItemsKey)||[]}catch(t){e=[]}e.forEach((e=>this.jumpListRemovedFiles.add(e))),this.jumpListRemovedFiles.size>=ua.MaxSavedRemovedFiles&&this.jumpListRemovedFiles.clear(),this.localStorageService.setGlobal(ua.LocalStorageJumpListRemovedItemsKey,[...this.jumpListRemovedFiles])}generateJumpListItemId(e){const t=Windows.Security.Cryptography,i=t.CryptographicBuffer.convertStringToBinary(e,t.BinaryStringEncoding.utf8),n=t.Core.HashAlgorithmProvider.openAlgorithm("SHA256").hashData(i);return t.CryptographicBuffer.encodeToHexString(n)}addGroupToList(e,t,i,n,r){let a=0;for(let o=0;o<t.length;o++){const s=t[o],l=this.generateJumpListItemId(s.url);if(!this.jumpListRemovedFiles.has(l)){const t={application:s.application,fileName:s.fileName,fileType:s.fileType,fileTypeName:s.fileTypeName,group:n,jumpListItemId:l,isLocal:s.isLocal,url:s.url,canonicalUrl:s.canonicalUrl,lastShownTime:Date.now()};s.isLocal||(t.docId=s.docId,t.driveId=s.driveId,t.isOnPremOrVanity=s.isOnPremOrVanity),this.jumpListFiles.items.push(t);const o=JSON.stringify({id:t.jumpListItemId}),c=Windows.UI.StartScreen.JumpListItem.createWithArguments(o,s.title);c.description=s.title,c.groupName=r;const u=ua.SupportedFileTypeName.has(t.fileTypeName.toLowerCase())?"ms-appx:///images/File"+t.fileTypeName+"32x32.png":"ms-appx:///images/FileText32x32.png";if(c.logo=new Windows.Foundation.Uri(u),e.items.append(c),++a===i)return}}}updateJumpList(){0===this.taskStatus?(this.taskStatus=1,this.jumpListFiles.items=[],Windows.UI.StartScreen.JumpList.loadCurrentAsync().then((e=>{this.taskStatus=2,e.items.forEach((e=>{if(e.removedByUser){const t=JSON.parse(e.arguments);void 0!==t.id&&this.jumpListRemovedFiles.add(t.id)}})),this.updateRemovedFiles(),e.systemGroupKind=Windows.UI.StartScreen.JumpListSystemGroupKind.none,e.items.clear();for(let t=0;t<this.tasks.length;t++){const i=this.tasks[t];if(ua.SupportedTaskFileType.has(i.workload.FileType)){const t=this.locService.format(this.locService.PwaJumpListNewFileText,i.title),n=JSON.stringify({createFileType:Q.b[i.workload.FileType]}),r=Windows.UI.StartScreen.JumpListItem.createWithArguments(n,t);r.description=t,r.groupName="",r.logo=new Windows.Foundation.Uri("ms-appx:///images/App"+Q.b[i.workload.FileType]+"32x32.png"),e.items.append(r)}}this.addGroupToList(e,this.latestRecommendedDocs,ua.MaxRecommended,ua.GroupRecommended,this.locService.RecommendedDocumentsSectionTitle),this.addGroupToList(e,this.latestRecentDocs,ua.MaxRecent,ua.GroupRecent,this.locService.RecentDocumentsSectionTitleLowercase),e.saveAsync().then((()=>{const e={State:"Success",Action:"SaveJumpList"};this.instrumentationService.logGenericEvent("Pwa_Jump_List",e,[],2),Object(a.a)({featureName:"Hwa",eventName:"Pwa_Jump_List",params:e},Z.a.Enhanced),this.saveToMapping(),this.completeCurrentTask()}),(e=>{const t={};t.Error=(e||"").toString(),t.Action="SaveJumpList",Object(a.a)({featureName:"Hwa",eventName:"Pwa_Jump_List",params:t},Z.a.Enhanced),this.completeCurrentTask()}))}),(e=>{const t={};t.Error=(e||"").toString(),t.Action="LoadJumpList",this.instrumentationService.logGenericEvent("Pwa_Jump_List",t,[],2),this.taskStatus=0,this.isUpdateWaiting&&(this.isUpdateWaiting=!1,this.updateJumpList())}))):2===this.taskStatus&&(this.isUpdateWaiting=!0)}completeCurrentTask(){this.taskStatus=0,this.isUpdateWaiting&&(this.isUpdateWaiting=!1,this.updateJumpList())}}function da(e,t,i,n){if(!(null==t?void 0:t.length))return;const r=t.lastIndexOf("?");let a;r>=0&&(t=t.substring(0,r));let o=[n?"nft":"ofe"];switch(e){case Q.b.Excel:n||(o=["ofv","ofc"]),a="ms-excel:";break;case Q.b.Word:a="ms-word:";break;case Q.b.Visio:a="ms-visio:";break;case Q.b.PowerPoint:a="ms-powerpoint:";break;case Q.b.OneNote:return`onenote:${t}`;default:return}return o.push("u",t),(null==i?void 0:i.length)&&o.push("f",i),function(e,t){"string"==typeof t&&(t=[t]);let i=!1;for(const n of t)n.length&&(e=`${e}${i?"|":""}${n}`,i=!0);return e}(a,o)}ua.LocalStorageJumpListMappingKey="PwaJumpListMapping",ua.LocalStorageJumpListRemovedItemsKey="PwaJumpListRemovedItems",ua.GroupRecent="Recent",ua.GroupRecommended="Recommended",ua.SupportedFileTypeName=new Set(["word","excel","powerpoint","onenote","sway","pdf","forms","visio","text"]),ua.SupportedTaskFileType=new Set([Q.b.Word,Q.b.Excel,Q.b.PowerPoint]),ua.MaxRecommended=3,ua.MaxRecent=8,ua.MaxSavedFiles=1e3,ua.MaintenanceSavedFiles=500,ua.MaxSavedRemovedFiles=500;class ha{constructor(e,t,i,n,r,a,o){this.capabilitiesService=e,this.clientStartupConfigService=t,this.eventService=i,this.instrumentationService=n,this.pwaConfigService=r,this.pwaNativeBridgeService=a,this.urlLauncherService=o,this.correlationId=this.clientStartupConfigService.config.sharedClientStartupContext.correlationId}launchOfficeApp(e,t="",r=null,o=!1){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const s=k.a.now();if(r&&r(),this.pwaConfigService.config.PwaStartPageEnabled&&this.capabilitiesService.capabilities.startPageApps&&this.capabilitiesService.capabilities.startPageApps.has(Q.a.fileTypeNameToFileType(e))&&""===t&&!o)return!1;if(t){const e=(t=decodeURI(t)).indexOf("?");t=e>=0?t.substring(0,e):t}if(this.pwaConfigService.config.officeUriProtocolEnabled&&e&&""!==t&&!t.startsWith("https://1drv.ms")){const r=(()=>{try{return new URL(t)}catch(e){return new URL("file://"+t)}})(),o=da(Q.a.fileTypeNameToFileType(e),r.toString(),this.correlationId);if(yield(()=>Object(n.__awaiter)(this,void 0,void 0,(function*(){var t;if(!o)return!1;const n={};let r=!1;try{if(!(yield this.pwaNativeBridgeService.getInstalledApp(e)))return!1;this.capabilitiesService.capabilities.contentLauncherEnabled?yield Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((e=>e.launchUrl(o,{action:"LaunchProtocol"}))):yield this.urlLauncherService.openUrl(o,"LaunchProtocol"),r=!0}catch(e){n.Error=null!==(t=null==e?void 0:e.toString())&&void 0!==t?t:""}return n.Action="AppsProtocol",n.State=r?"Success":"Failed",n.Latency=Math.ceil(performance.now()-s).toString(),this.instrumentationService.logGenericEvent("Launch_Local_App",n,[],2),Object(a.a)({featureName:"Hwa",eventName:"Launch_Local_App",params:n},Z.a.Enhanced),r})))())return!0}return this.pwaNativeBridgeService.launchOfficeApp(e,t,s)}))}launchOfficeAppWithTemplate(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function*(){if(!e||!t)return!1;const n=da(Q.a.fileTypeNameToFileType(e),t,this.correlationId,!0);if(!n)return!1;try{if(yield this.pwaNativeBridgeService.getInstalledApp(e))return this.capabilitiesService.capabilities.contentLauncherEnabled?yield Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((e=>e.launchUrl(n,{action:"CreateFileWithTemplate"}))):yield this.urlLauncherService.openUrl(n,"CreateFileWithTemplate"),!0}catch(e){}return!1}))}openPathInExplorer(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return this.capabilitiesService.capabilities.isPwaInUwp?new Promise(((t,i)=>{Windows.Storage.StorageFolder.getFolderFromPathAsync(e).then((e=>{if(!e)throw new Error("GetFolderFromPath returned null");return Windows.System.Launcher.launchFolderAsync(e).then((e=>{if(!e)throw new Error("Failed to open folder");t()}),(()=>{throw new Error("LaunchFolder exception")}))}),(()=>{throw this.eventService.broadcastEvent({name:"needAccessToFileSystem",args:["allow-file-system-access-open-file-location"]}),new Error("GetFolderFromPath exception")})).then(null,(e=>{const t={};t.Error=e?e.message:"",this.instrumentationService.logGenericEvent("Launch_File_Explorer_Failed",t,[],2),Object(a.a)({featureName:"Hwa",eventName:"Launch_File_Explorer_Failed",params:t},Z.a.Enhanced),i()}))})):Promise.reject()}))}shouldOpenInOfficeApp(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return this.pwaNativeBridgeService.getInstalledApp(e).then((e=>!!e)).catch((()=>!1))}))}}var pa=i("S5zL"),ma=i("tm5M");class fa{constructor(e,t){this.pwaNativeBridgeService=t,this.cloudMruService=e.getMruService()}getMruDocuments(e){const t=this.cloudMruService.getMruDocuments(e),i=this.pwaNativeBridgeService.getLocalMru(e),n=(e,t)=>t.LastAccessedTime-e.LastAccessedTime;return{results:t.results.pipe(Object(Ae.a)(i,((e,t)=>{const i=t&&t.items?e.items.concat(t.items).sort(n):e.items;return Object.assign(Object.assign({},e),{items:i})})),Object(pa.a)(((e,t)=>e.items&&t.items&&e.items.length&&e.items.length===t.items.length&&e.items[0].WebUrl===t.items[0].WebUrl&&e.items[0].LastAccessedTime.getTime()===t.items[0].LastAccessedTime.getTime()))),initialCompletion:t.initialCompletion}}updateMruDocuments(e){return this.cloudMruService.updateMruDocuments(e)}removeDocument(e){return e.IsLocal?Promise.resolve():this.cloudMruService.removeDocument(e)}updatePinnedState(e){return e.IsLocal?Promise.resolve():this.cloudMruService.updatePinnedState(e)}writeMruDocument(e){return e.IsLocal?Promise.resolve():this.cloudMruService.writeMruDocument(e)}}class ga{constructor(e,t){this.capabilitiesService=e,this.instrumentationService=t;try{const e=this.capabilitiesService.capabilities.isPwaInUwp&&Windows.Foundation.Metadata.ApiInformation.isTypePresent("Windows.UI.Shell.TaskbarManager");this.taskbarManager=e?Windows.UI.Shell.TaskbarManager.getDefault():null,this.pinSupported=this.taskbarManager&&this.taskbarManager.isPinningAllowed}catch(e){const t={State:"NotSupported"};this.instrumentationService.logGenericEvent("Pin_To_Taskbar",t,[],2),Object(a.a)({featureName:"Hwa",eventName:"Pin_To_Taskbar",params:t},Z.a.Enhanced)}}isEligibleToPin(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return new Promise((e=>{if(!this.pinSupported){const t={State:"NotSupported"};return this.instrumentationService.logGenericEvent("Pin_To_Taskbar",t,[],2),Object(a.a)({featureName:"Hwa",eventName:"Pin_To_Taskbar",params:t},Z.a.Enhanced),void e(!1)}this.taskbarManager.isCurrentAppPinnedAsync().then((t=>e(!t)))}))}))}pinToTaskbar(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return new Promise((e=>{if(!this.pinSupported){const t={State:"NotSupported"};return this.instrumentationService.logGenericEvent("Pin_To_Taskbar",t,[],2),Object(a.a)({featureName:"Hwa",eventName:"Pin_To_Taskbar",params:t},Z.a.Enhanced),void e(!1)}this.taskbarManager.requestPinCurrentAppAsync().then(e)}))}))}}class ba{}class va{isSurfaceDevice(){if(void 0!==Windows.System.Profile.SystemManufacturers&&void 0!==Windows.System.Profile.SystemManufacturers.SystemSupportInfo&&void 0!==Windows.System.Profile.SystemManufacturers.SystemSupportInfo.localDeviceInfo){const e=Windows.System.Profile.SystemManufacturers.SystemSupportInfo.localDeviceInfo.systemManufacturer,t=Windows.System.Profile.SystemManufacturers.SystemSupportInfo.localDeviceInfo.systemProductName;if(e&&t)return e.toLowerCase().indexOf("microsoft")>=0&&t.toLowerCase().indexOf("surface")>=0}return!1}}var Sa=i("H90i");class ya extends ti.a{constructor(e,t,i,n,r,a,o,s,l){super(),this.appTilesConfigService=e,this.capabilitiesService=t,this.configParserService=i,this.contextService=n,this.dateService=r,this.globalErrorHandler=a,this.startupConfigService=o,this.scheduler=s,this.shellShimService=l,this.nativeWorkloads=new Array,this.allWorkloads=this.configParserService.parse("workloadsData")||{nonCoreAndSegmentApps:[],coreAndSegmentApps:[],pinnedApps:[]},this.shellPinEnabled=this.capabilitiesService.capabilities.shellPinEnabled,this.allWorkloads.pinnedApps&&this.populateWorkloadFields(this.allWorkloads.pinnedApps),this.allWorkloads.coreAndSegmentApps=this.allWorkloads.coreAndSegmentApps.filter((e=>this.filterLocalOnlyApps(e))),this.usedThirdPartyWorkloads=[],this.thirdPartyWorkloads=[],this.thirdPartyWorkloadsSubject=new Ri.a([]),this.capabilitiesService.capabilities.officeStartUsedThirdPartyAppsEnabled||(this.subscribeToThirdPartyAppUpdates(),this.getWorkloads().then((e=>{this.usedThirdPartyWorkloads=e.filter((e=>e.IsThirdParty)),this.cleanUnusedThirdPartyWorkloads()})))}getProvisionedWorkloads(){return new Promise(((e,t)=>{this.getWorkloads().then((t=>{const i=t.filter((e=>!!e.Url));i.forEach((e=>{e.IsThirdParty||(e.AppId=e.Id.slice(5),e.CollectorId="FirstParty")})),e(i)})).catch((e=>{this.globalErrorHandler.handleError(e,"Dnsgi"),t("Failed to get workloads list")}))}))}getCoreSegmentAndFrequentApps(){return this.coreSegmentAndOtherAppsPromise||(this.coreSegmentAndOtherAppsPromise=new Promise((e=>{const t=this.allWorkloads,i=this.getFrequentAppsWithAnyClicks(t.nonCoreAndSegmentApps),n=t.coreAndSegmentApps.concat(i);this.populateWorkloadFields(n),this.startupConfigService.config.authType===d.a.MSA?this.getMsaWorkloadsData(n).then(e):e(n)}))),this.coreSegmentAndOtherAppsPromise.then((e=>[...e]))}getPinnedWorkloads(){return this.allWorkloads.pinnedApps}unpinWorkload(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){this.allWorkloads.pinnedApps=this.allWorkloads.pinnedApps.filter((t=>!(t.AppId===e.AppId&&t.CollectorId===e.CollectorId)));const t=yield this.shellShimService.getShellShim();t&&t.Apps.Unpin(e.CollectorId,e.AppId)}))}getWorkloads(){return this.workloadsPromise||(this.workloadsPromise=new Promise((e=>{let t,i,n;const r=this.allWorkloads;t=r.nonCoreAndSegmentApps,i=r.coreAndSegmentApps,n=i.concat(t),this.populateWorkloadFields(n),this.startupConfigService.config.authType===d.a.MSA?this.getMsaWorkloadsData(n).then(e):e(n)}))),this.workloadsPromise.then((e=>[...e]))}getWorkloadId(e){return ya.fileTypeToIdMap.has(e)?ya.fileTypeToIdMap.get(e):""}getReferralType(e){const t=this.dateService.addDays(this.dateService.getCurrentDate(),-45);return e.ClickCount?e.LastOccurrence<t.getTime()?T.c.ResurrectedReferral:e.LastOccurrence>=t.getTime()?T.c.RepeatReferral:T.c.NotDetected:T.c.FirsttimeReferral}getDisplayedApps(e){const t=this.appTilesConfigService.config,i=t.coreAppIds&&t.segmentSpecificAppIds?t.coreAppIds.concat(t.segmentSpecificAppIds):t.coreAppIds||t.segmentSpecificAppIds,n=new Array;if(i&&i.length){const r=e.filter((e=>i.indexOf(e.Id)>-1)),a=e.filter((e=>i.indexOf(e.Id)<0)),o=t.coreAppIds?e.filter((e=>t.coreAppIds.indexOf(e.Id)>-1)):[];if(!r.length||!a.length||o.length<3)for(const t of e)n.push(t.Id);else{const e=this.getFrequentAppsWithAnyClicks(a);for(const e of r)n.push(e.Id);if(e.length)for(const t of e)n.push(t.Id)}return n.toString()}}getFrequentAppsWithAnyClicks(e){const t=this.dateService.addDays(this.dateService.getCurrentDate(),-45);return e.filter((e=>e.ClickCount>0&&e.LastOccurrence>=t.getTime()))}getThirdPartyWorkloads(){return this.thirdPartyWorkloadsSubject.asObservable()}updateUsedThirdPartyApps(e){if(this.capabilitiesService.capabilities.officeStartUsedThirdPartyAppsEnabled);else{const t=this.usedThirdPartyWorkloads.findIndex((t=>t.Id.toLowerCase()===e.Id.toLowerCase())),i=t>=0?this.usedThirdPartyWorkloads[t]:void 0;i?this.areThirdPartyAppsEqual(i,e)||(this.usedThirdPartyWorkloads[t]=e):this.usedThirdPartyWorkloads.push(e)}}populateWorkloadFields(e){e.forEach((e=>{e.getId=()=>e.Id,e.Referral=e.IsThirdParty?e.Id:ya.referralFromWorkloadId(e.Id),e.FileType=this.getFileType(e.Id),e.Url=this.getWorkloadCustomUrl(e.FileType,e.Url)}))}getAdditionalWorkloads(){return Promise.resolve([])}pinWorkload(e){this.shellPinEnabled&&this.shellShimService.getShellShim().then((t=>{const i=e.AppId,n=e.CollectorId;n&&i&&!t.Apps.IsPinned(n,i)&&t.Apps.Pin(n,i)}))}getInAppNav(e){const t=this.allWorkloads.coreAndSegmentApps.concat(this.allWorkloads.nonCoreAndSegmentApps).concat(this.allWorkloads.pinnedApps).find((t=>t.Id===e));return!!t&&t.InAppNav}getFileType(e){return ya.idToFileTypeMap.has(e)?ya.idToFileTypeMap.get(e):Q.b.Unknown}getMsaWorkloadsData(e){return this.getShellWorkloadsData().then((t=>(this.populateMSAWorkloadFields(e,t),e)))}static referralFromWorkloadId(e){return e&&e.length&&0===e.lastIndexOf(ya.AppTileElementIdPrefix,ya.AppTileElementIdPrefixLength)?e.substring(ya.AppTileElementIdPrefixLength):null}filterLocalOnlyApps(e){return!e.IsNativeClientOnlyApp||(this.nativeWorkloads.push(e),!1)}populateMSAWorkloadFields(e,t){e.forEach((e=>{const i=e.Id.toLowerCase();for(let n=0;n<t.length;n++){const r=t[n];if(r.Id.toLowerCase()===i){e.Color=r.BackgroundColor,e.FileType=this.getFileType(e.Id),e.Url&&(e.Url=this.getWorkloadCustomUrl(e.FileType,r.LaunchUrl));break}}}))}getWorkloadCustomUrl(e,t){switch(e){case Q.b.Forms:t=ta.a.appendAndReplaceQueryParams(t,{origin:Sa.a,lang:this.contextService.sharedContext.officeMarket,sessionId:this.startupConfigService.config.sharedClientStartupContext.sessionId},!1,!0)}return t}getShellWorkloadsData(){return new Promise(((e,t)=>Object(n.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.shellShimService.getShellShim();i?i.Apps.OnAppsUpdated((i=>{if(i&&i.Apps){const t=i.Apps.map((e=>({BackgroundColor:e.BackgroundColor,FontIconCss:e.FontIconCss,Id:e.Id,LaunchUrl:e.LaunchFullUrl})));e(t)}else t("Shell shim apps not available.")})):t("Shell shim is not available")}))))}subscribeToThirdPartyAppUpdates(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.shellShimService.getShellShim();yield this.shellShimService.afterShellPlusLoaded;const t=new Promise((t=>{let i=0,n=0,r=!1;e.Apps.OnAppsUpdated((a=>{if(a&&a.Apps){let o=a.Apps.filter((e=>"FirstParty"!==e.CollectorId&&!this.thirdPartyWorkloads.find((t=>t.Id===e.Id))));o=o.filter((e=>"LineOfBusiness"!==e.CollectorId)),this.capabilitiesService.capabilities.showBusinessApps||(o=o.filter((e=>"Dynamics"!==e.CollectorId))),o.forEach((a=>{const o=a.LaunchFullUrl;this.thirdPartyWorkloads.push({ChangeColorInDarkMode:"Dynamics"===a.CollectorId,Color:a.BackgroundColor,Id:a.Id,AppId:a.Id,CollectorId:a.CollectorId,Title:a.AriaLabel?a.AriaLabel:"",SubText:a.Subtitle,Text:a.Title,IsNativeClientOnlyApp:a.isNativeClientOnlyApp,Url:o?o.trim():"",IconUnicodeCodepointCssClass:"ms-fcl-tp ms-Icon ms-Icon--OfficeAddinsLogo",ThirdPartyIcon:a.IconAnonymousUrl?a.IconAnonymousUrl:null,Referral:a.Id,IsThirdParty:!0,getId:()=>a.Id}),a.IconAnonymousUrl||(++i,this.scheduler.scheduleWork((()=>{e.Apps.GetAuthenticatedAppIcon(a,(e=>{if(++n,e){const t=this.thirdPartyWorkloads.findIndex((e=>e.Id.toLowerCase()===a.Id.toLowerCase()));this.thirdPartyWorkloads[t]=Object.assign(Object.assign({},this.thirdPartyWorkloads[t]),{ThirdPartyIcon:`data:${e.MimeType};base64,${e.Base64EncodedImage}`}),this.thirdPartyWorkloadsSubject.next(this.thirdPartyWorkloads)}r&&i===n&&t()}))}),3))})),this.thirdPartyWorkloadsSubject.next(this.thirdPartyWorkloads),r=a.DataSource===ya.AppsShimDataSourceAppCollectors||a.DataSource===ya.AppsShimDataSourceShellDataComplete,r&&i===n&&t()}}))}));yield t,this.capabilitiesService.capabilities.officeStartUsedThirdPartyAppsEnabled||this.invalidateThirdPartyAppCache()}))}cleanUnusedThirdPartyWorkloads(){if(0===this.usedThirdPartyWorkloads.length)return;const e=this.dateService.addDays(this.dateService.getCurrentDate(),-45).getTime();this.usedThirdPartyWorkloads=this.usedThirdPartyWorkloads.filter((t=>t.LastOccurrence>=e))}areThirdPartyAppsEqual(e,t){return e.Text===t.Text&&e.Url===t.Url&&e.ThirdPartyIcon===t.ThirdPartyIcon&&e.Title===t.Title}invalidateThirdPartyAppCache(){if(0===this.usedThirdPartyWorkloads.length)return;const e=[];let t=!1;this.usedThirdPartyWorkloads.forEach((i=>{const n=this.thirdPartyWorkloads.find((e=>e.Id===i.Id));n?this.areThirdPartyAppsEqual(n,i)?e.push(n):(e.push(n),t=!0):t=!0})),t&&(this.usedThirdPartyWorkloads=e)}}ya.AppTileElementIdPrefix="Shell",ya.AppTileElementIdPrefixLength=ya.AppTileElementIdPrefix.length,ya.AppsShimDataSourceAppCollectors=3,ya.AppsShimDataSourceShellDataComplete=4,ya.idToFileTypeMap=new Map([["ShellWordOnline",Q.b.Word],["ShellExcelOnline",Q.b.Excel],["ShellPowerPointOnline",Q.b.PowerPoint],["ShellOneNoteOnline",Q.b.OneNote],["ShellClassNotebook",Q.b.OneNoteClassNoteBook],["ShellVisioOnline",Q.b.Visio],["ShellSway",Q.b.Sway],["ShellOfficeForms",Q.b.Forms],["ShellDocuments",Q.b.OneDrive],["ShellSites",Q.b.SharePoint],["ShellMicrosoftStream",Q.b.Stream]]),ya.fileTypeToIdMap=new Map([[Q.b.Word,"ShellWordOnline"],[Q.b.Excel,"ShellExcelOnline"],[Q.b.PowerPoint,"ShellPowerPointOnline"],[Q.b.OneNote,"ShellOneNoteOnline"],[Q.b.Visio,"ShellVisioOnline"],[Q.b.Sway,"ShellSway"],[Q.b.Forms,"ShellOfficeForms"],[Q.b.OneDrive,"ShellSway"],[Q.b.SharePoint,"ShellOfficeForms"],[Q.b.Stream,"ShellMicrosoftStream"]]);class Ca extends ya{constructor(e,t,i,n,r,a,o,s,l,c){super(e,t,i,n,r,a,s,l,c),this.pwaNativeBridgeService=o}getAdditionalWorkloads(){return this.pwaNativeBridgeService.filterUninstalledApps(this.nativeWorkloads)}getMsaWorkloadsData(e){return e.forEach((e=>{Ca.UpnRegex.test(e.Url)&&(e.Url=ta.a.appendAndReplaceQueryParams(e.Url,{auth_upn:this.startupConfigService.config.userPrincipalName||""},!1))})),Promise.resolve(e)}}Ca.UpnRegex=/auth_upn=(?:&|$)/gi;var wa=i("dRqz");class Ia{constructor(e){this.pwaNativeBridgeService=e,this.pathToIdMap=new Map}getLocalMru(){return this.pwaNativeBridgeService.getLocalMru().pipe(Object(_e.a)((e=>e.items.map((e=>{const t=e.PathArray[0],i=t+"\\"+e.FileName;let n;return this.pathToIdMap.has(i)?n=this.pathToIdMap.get(i):(n=`LocalBridgeFile:${st.a.createGuid()}`,this.pathToIdMap.set(i,n)),{author:null,created_datetime:e.LastAccessedTime,creation_info:{timestamp:e.LastAccessedTime},data_source:["LocalBridgeFile"],extension:Q.a.getFileExtension(e.FileName),id:n,indexed:!0,is_pinned:!1,is_hidden:!1,last_recommended_modified_datetime:e.LastAccessedTime.toISOString(),last_store_modified_datetime:e.LastAccessedTime.toISOString(),mru_id:n,mru_type:e.FileType,mru_url:e.Url,onedrive_info:null,sharepoint_info:null,source:"LocalBridgeFile",title:Q.a.fileNameWithoutExtension(e.FileName),type:e.FileType,subject:"",url:e.Url,web_url:i,user_relationship:{last_action_datetime:e.LastAccessedTime},container_title:t,wset_id:n}})))))}}class Ta extends Re.b{constructor(e,t,i,n,r,a,o,s,l,c,u,d,h,p,m){super(e,t,i,n,r,a,o,s,l,c,u,d,p,m),this.ngZone=h,this.init()}createThemeChangeObservable(){return Yr.a.create((e=>{this.eventService.events.withScope(0).pipe(Object(Te.a)((e=>"themeChanged"===e.name&&e.args&&2===e.args.length&&e.args[0]))).subscribe((t=>{const i=t.args,n=i[0];!n.IsDarkMode||"base"!==n.ThemeId||n.PreferOfficeTheme&&this.capabilitiesService.capabilities.fluentHeader||(n.Primary=n.Accent);const r=[n.Darker||n.Primary,n.Dark||n.Primary,n.DarkAlt||n.Primary,n.Primary||n.Primary,n.Secondary||n.Primary,n.Tertiary||n.Primary,n.Light||n.Primary,n.Lighter||n.Primary,n.LighterAlt||n.Primary],a=this.showDarkMode();this.ngZone.run((()=>e.next({theme:{shades:r,reactShellTheme:n,themeType:n.ThemeType,themeId:n.ThemeId,grayscaleThemeShades:a?Re.b.grayscaleThemeShadesDark:Re.b.grayscaleThemeShades},userSelected:i[1]})))}))}))}showDarkMode(){return this.capabilitiesService.capabilities.darkModeEnabled&&!!(this.userTheme&&this.userTheme.reactShellTheme&&this.userTheme.reactShellTheme.IsDarkMode)&&this.darkModeSupported()}showContrastMode(){return!1}getInitialUserTheme(){const e=this.themeConfig;if(this.capabilitiesService.capabilities.darkModeEnabled)if(this.capabilitiesService.capabilities.isPwaInUwp){const e=(new Windows.UI.ViewManagement.UISettings).getColorValue(Windows.UI.ViewManagement.UIColorType.background);if(255===e.a&&0===e.b&&0===e.g&&0===e.r)return this.getDefaultDarkTheme()}else if(e.isDarkMode||this.capabilitiesService.capabilities.darkModeOverride)return this.getDefaultDarkTheme();if(e.preferOfficeTheme){const e=this.defaultTheme;return{shades:this.getThemeShades(e),reactShellTheme:e,themeType:"App",themeId:this.userContext.user.themeId}}{const e=(this.themeConfig&&this.themeConfig.userThemeShades||[]).map((e=>`#${e}`));return{shades:e,reactShellTheme:Object.assign(Object.assign({},this.defaultTheme),this.getAppBrandTheme(e)),themeType:this.themeConfig.useTenantTheme?"Tenant":"User",themeId:this.userContext.user.themeId}}}getStartingTheme(){const e=this.themeConfig.appPageTypeOnLoad;if(e){const t=Q.a.fileTypeNameToFileType(e);if(this.supportedAppThemes.has(t)){const e=this.supportedAppThemes.get(t),i=this.showDarkMode()&&e.darkTheme||e.theme;if(i){const e=this.getThemeShades(i);return{theme:{shades:e,reactShellTheme:Object.assign(Object.assign({},this.defaultTheme),this.getAppBrandTheme(e)),themeType:"App",themeId:this.userContext.user.themeId},userSelected:!1,appPage:t}}}}return{theme:this.userTheme,userSelected:!0}}}var ka=i("xIlw"),Aa=i("+a0u"),_a=i("lQwO"),Pa=i("sCgQ"),Ea=i("izKO"),Fa=i("D6F8"),Oa=i("ApBt"),Da=i("+P5Z"),Ma=i("CfLe"),Ra=i("ej7j"),xa=i("tv+F");class La extends xa.a{constructor(e,t,i){super(t,e),this.searchEnabled=e.capabilities.showSearch&&!!i.config}canActivate(){return this.checkEnabledAndRedirect(this.searchEnabled)}canLoad(){return this.checkEnabledAndRedirect(this.searchEnabled)}}La.ɵprov=r.kc({factory:function(){return new La(r.lc(R.a),r.lc(Ni.n),r.lc(He.a))},token:La,providedIn:"root"});class Ua extends xa.a{constructor(e,t,i){super(i,t),this.appGalleryConfigService=e,this.appGalleryEnabled=!!this.appGalleryConfigService.config}canActivate(){return this.checkEnabledAndRedirect(this.appGalleryEnabled)}canLoad(){return this.checkEnabledAndRedirect(this.appGalleryEnabled)}}Ua.ɵprov=r.kc({factory:function(){return new Ua(r.lc(bi.a),r.lc(R.a),r.lc(Ni.n))},token:Ua,providedIn:"root"});class Na extends xa.a{constructor(e,t,i){super(t,e),this.wacContentService=i}canActivate(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return yield this.wacContentService.bootstrapDocumentFromLoader(this.wacContentService.getDocumentInfoFromParams(e.queryParams,Q.a.fileTypeNameToFileType(e.params.app)),Date.now(),!0),this.checkEnabledAndRedirect(this.capabilitiesService.wacHostEnabled())}))}canLoad(){return this.checkEnabledAndRedirect(this.capabilitiesService.wacHostEnabled())}}Na.ɵprov=r.kc({factory:function(){return new Na(r.lc(R.a),r.lc(Ni.n),r.lc(nt.a))},token:Na,providedIn:"root"});class Wa extends xa.a{constructor(e,t,i,n){super(e,t),this.createDocumentService=i,this.instrumentationService=n,this.startEnabled=t.capabilities.wacStartPageEnabled}canActivate(e){const t=e.queryParams["ms.url"];return t?this.checkAndNavigateToCreateNew(t,e.queryParams.templateId):this.checkEnabledAndRedirect(this.startEnabled)}canLoad(){return this.checkEnabledAndRedirect(this.startEnabled)}checkAndNavigateToCreateNew(e,t){return e=e.toLowerCase(),new Promise((i=>{const n=Wa.CREATE_NEW_REDIRECTS[e];if(n){let r;0===e.lastIndexOf("templates.")&&t&&(r={AssetId:t}),this.createDocumentService.createItem(n,null,r,(t=>{const n={MsNewParam:e,Action:t&&t.type||""};t&&"Error"!==t.type&&"CreatePending"!==t.type?(this.instrumentationService.logGenericEvent("Create_New_Redirect_Success",n),i(!1)):(this.instrumentationService.logGenericEvent("Create_New_Redirect_Fail",n),i(!0))}),null,null,"_self")}}))}}Wa.CREATE_NEW_REDIRECTS={"word.new":Q.b.Word,"templates.word.new":Q.b.Word,"powerpoint.new":Q.b.PowerPoint,"templates.powerpoint.new":Q.b.PowerPoint,"excel.new":Q.b.Excel,"templates.excel.new":Q.b.Excel,"sway.new":Q.b.Sway},Wa.ɵprov=r.kc({factory:function(){return new Wa(r.lc(Ni.n),r.lc(R.a),r.lc(Ze.a),r.lc(T.a))},token:Wa,providedIn:"root"});class ja extends xa.a{constructor(e,t,i,n){super(e,t),this.createDocumentService=i,this.instrumentationService=n,this.modernStartEnabled=t.capabilities.modernStartPageEnabled}canActivate(e){const t=e.queryParams["ms.url"];return t?this.checkAndNavigateToCreateNew(t,e.queryParams.templateId):this.checkEnabledAndRedirect(this.modernStartEnabled)}canLoad(){return this.checkEnabledAndRedirect(this.modernStartEnabled)}checkAndNavigateToCreateNew(e,t){return e=e.toLowerCase(),new Promise((i=>{const n=ja.CREATE_NEW_REDIRECTS[e];if(n){let r;0===e.lastIndexOf("templates.")&&t&&(r={AssetId:t}),this.createDocumentService.createItem(n,null,r,(t=>{const n={MsNewParam:e,Action:t&&t.type||""};t&&"Error"!==t.type&&"CreatePending"!==t.type?(this.instrumentationService.logGenericEvent("Create_New_Redirect_Success",n),i(!1)):(this.instrumentationService.logGenericEvent("Create_New_Redirect_Fail",n),i(!0))}),null,null,"_self")}}))}}ja.CREATE_NEW_REDIRECTS={"word.new":Q.b.Word,"templates.word.new":Q.b.Word,"powerpoint.new":Q.b.PowerPoint,"templates.powerpoint.new":Q.b.PowerPoint,"excel.new":Q.b.Excel,"templates.excel.new":Q.b.Excel,"sway.new":Q.b.Sway},ja.ɵprov=r.kc({factory:function(){return new ja(r.lc(Ni.n),r.lc(R.a),r.lc(Ze.a),r.lc(T.a))},token:ja,providedIn:"root"});class Ha extends xa.a{constructor(e,t){super(t,e),this.m365AppsNavigationEnabled=this.capabilitiesService.capabilities.leftNavReact&&this.capabilitiesService.capabilities.m365AppsEnabled}canActivate(){return this.checkEnabledAndRedirect(this.m365AppsNavigationEnabled)}canLoad(){return this.checkEnabledAndRedirect(this.m365AppsNavigationEnabled)}}Ha.ɵprov=r.kc({factory:function(){return new Ha(r.lc(R.a),r.lc(Ni.n))},token:Ha,providedIn:"root"});class Ba extends xa.a{constructor(e,t){super(t,e),this.createCenterEnabled=this.capabilitiesService.capabilities.createCenterEnabled}canActivate(){return this.checkEnabledAndRedirect(this.createCenterEnabled)}canLoad(){return this.checkEnabledAndRedirect(this.createCenterEnabled)}}Ba.ɵprov=r.kc({factory:function(){return new Ba(r.lc(R.a),r.lc(Ni.n))},token:Ba,providedIn:"root"});class Ga extends xa.a{constructor(e,t){super(t,e),this.myContentPageEnabled=this.capabilitiesService.capabilities.myContentEnabled}canActivate(){return this.checkEnabledAndRedirect(this.myContentPageEnabled)}canLoad(){return this.checkEnabledAndRedirect(this.myContentPageEnabled)}}Ga.ɵprov=r.kc({factory:function(){return new Ga(r.lc(R.a),r.lc(Ni.n))},token:Ga,providedIn:"root"});class qa extends xa.a{constructor(e,t){super(t,e),this.feedEnabled=this.capabilitiesService.capabilities.feedEnabled}canActivate(){return this.checkEnabledAndRedirect(this.feedEnabled)}canLoad(){return this.checkEnabledAndRedirect(this.feedEnabled)}}qa.ɵprov=r.kc({factory:function(){return new qa(r.lc(R.a),r.lc(Ni.n))},token:qa,providedIn:"root"});class Va{shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig&&e.paramMap.get("app")===t.paramMap.get("app")&&e.paramMap.get("spaceId")===t.paramMap.get("spaceId")&&e.paramMap.get("appId")===t.paramMap.get("appId")&&e.paramMap.get("entityId")===t.paramMap.get("entityId")&&e.paramMap.get("subEntityId")===t.paramMap.get("subEntityId")}shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}}var $a=i("VY7U"),za=i("GPFm");const Za=new r.u("INSTRUMENTATION_QUEUE");var Ka=i("AXqk");class Ja extends Ka.a{constructor(e){super(),this.windowService=e}get securityLevel(){return this.windowService.nativeWindow.windowsDataSecuritySetting||0}}var Qa=i("L9A/");const Ya=yt;class Xa{}var eo=i("wHld"),to=i("Bmgn"),io=i("EuUe");class no{}var ro=i("T6pR"),ao=i("T/SX"),oo=i("up2P"),so=i("D8EG"),lo=i("9InZ"),co=i("upmJ"),uo=i("ci1G"),ho=i("M3TP");class po{}class mo{}var fo=i("32VK"),go=i("CCRL"),bo=i("vW6f"),vo=i("cZRF"),So=r.Eb(ve,[pt],(function(e){return r.Tb([r.Ub(512,r.k,r.hb,[[8,[mt.a,It,Bt,Bn]],[3,r.k],r.D]),r.Ub(5120,r.z,r.ub,[[3,r.z]]),r.Ub(4608,Ut.m,Ut.l,[r.z]),r.Ub(4608,$e.a,Gn,[d.b,B.a,o.b,V.a,u.b,T.a,l.a]),r.Ub(4608,ni.a,$n,[Vn,r.p]),r.Ub(4608,zn.a,Zn.a,[$e.a,B.a,T.a,Kn.a,Jn.a,l.a,Qn.a,ni.a,o.b,c.a]),r.Ub(5120,Yn.a,tr,[R.a,Xn.a,er.a]),r.Ub(5120,r.xb,r.vb,[r.F]),r.Ub(5120,r.c,r.rb,[]),r.Ub(5120,r.x,r.sb,[]),r.Ub(5120,r.y,r.tb,[]),r.Ub(4608,nr.b,nr.l,[Ut.d]),r.Ub(6144,r.N,null,[nr.b]),r.Ub(4608,nr.e,nr.g,[]),r.Ub(5120,nr.c,(function(e,t,i,n,r,a,o,s){return[new nr.j(e,t,i),new nr.o(n),new nr.n(r,a,o,s)]}),[Ut.d,r.F,r.I,Ut.d,Ut.d,nr.e,r.ib,[2,nr.f]]),r.Ub(4608,nr.d,nr.d,[nr.c,r.F]),r.Ub(135680,nr.m,nr.m,[Ut.d]),r.Ub(4608,nr.k,nr.k,[nr.d,nr.m,r.c]),r.Ub(5120,x.a,he,[d.b]),r.Ub(5120,x.c,rr.e,[]),r.Ub(4608,x.b,rr.d,[Ut.d,x.a,x.c]),r.Ub(5120,r.L,rr.f,[nr.k,x.b,r.F]),r.Ub(6144,nr.p,null,[nr.m]),r.Ub(4608,r.T,r.T,[r.F]),r.Ub(4608,ar.b,rr.c,[r.L,Ut.d]),r.Ub(5120,or,cr,[B.a,Ft.a,pr.a,R.a]),r.Ub(4608,mr.n,mr.t,[Ut.d,r.I,mr.r]),r.Ub(4608,mr.u,mr.u,[mr.n,mr.s]),r.Ub(5120,b.a,fr,[u.b,r.I]),r.Ub(5120,g,gr,[p.a,b.a]),r.Ub(5120,vr,be,[u.b]),r.Ub(5120,mr.a,(function(e,t,i,n,r,a,o){return[e,new wr(t),new _r(i,n,r,a),new Mr(o)]}),[mr.u,g,g,vr,f.a,o.b,Dr]),r.Ub(4608,mr.q,mr.q,[]),r.Ub(6144,mr.o,null,[mr.q]),r.Ub(4608,mr.m,mr.m,[mr.o]),r.Ub(6144,mr.b,null,[mr.m]),r.Ub(4608,mr.h,mr.p,[mr.b,r.v]),r.Ub(4608,mr.c,mr.c,[mr.h]),r.Ub(5120,Ni.a,Ni.z,[Ni.n]),r.Ub(4608,Ni.f,Ni.f,[]),r.Ub(6144,Ni.i,null,[Ni.f]),r.Ub(135680,Ni.q,Ni.q,[Ni.n,r.C,r.i,r.v,Ni.i]),r.Ub(4608,Ni.h,Ni.h,[]),r.Ub(5120,Ni.E,Ni.v,[Ni.n,Ut.s,Ni.j]),r.Ub(5120,Ni.k,Ni.C,[Ni.A]),r.Ub(5120,r.b,(function(e){return[e]}),[Ni.k]),r.Ub(4608,Rr.a,Rr.a,[te.a]),r.Ub(4608,xr.a,xr.a,[xi.a,te.a,Lr.a]),r.Ub(4608,bn.a,bn.a,[Ut.d,r.I]),r.Ub(4608,X.a,jr,[B.a,s.a,D.a,T.a,M.a,Se.a]),r.Ub(5120,h,(function(e,t,i,n,r,a,o,s,l,c,u,d,h,p,m,f,g,b,v,S,y,C){return[new Hr(e,t,i),new Br(n,r,a,o,s,l,c,u,d),new Gr(h),new qr(p,m,f,g),new $r(b,v,S,y,C)]}),[o.b,B.a,g,$e.a,ni.a,B.a,T.a,l.a,g,vr,d.b,u.b,g,g,X.a,B.a,T.a,r.p,B.a,T.a,g,Vr]),r.Ub(5120,Kr.a,fe,[]),r.Ub(5120,H.a,ce,[R.a,U.a,T.a,V.a,G]),r.Ub(5120,q,ue,[d.b,T.a,V.a]),r.Ub(5120,j.a,de,[d.b,L.b,r.F,V.a,u.b]),r.Ub(4608,Jr.a,oa,[R.a,d.b,B.a,s.a,T.a,k.b,Xr.a,er.a,aa.a,u.b,ra]),r.Ub(5120,ie.a,ge,[V.a]),r.Ub(4608,Y.a,ca,[$e.a,T.a,Kn.a,B.a,D.a,l.a,Ut.q,R.a,d.b,o.b,sa,c.a,Vr]),r.Ub(4608,Ye.a,ua,[R.a,Ze.a,T.a,et.a,te.a,V.a]),r.Ub(4608,Xe.a,ha,[R.a,d.b,D.a,T.a,V.a,ne,H.a]),r.Ub(4608,Ot.a,fa,[ma.a,ne]),r.Ub(4608,tt,ga,[R.a,T.a]),r.Ub(4608,ba,va,[]),r.Ub(4608,ti.a,Ca,[ri,R.a,ni.a,B.a,xi.a,o.b,ne,d.b,c.a,Me.a]),r.Ub(4608,wa.a,Ia,[ne]),r.Ub(4608,Re.b,Ta,[s.a,D.a,R.a,ni.a,d.b,B.a,T.a,Le.a,M.a,c.a,te.a,u.b,r.F,Me.a,aa.a]),r.Ub(1073742336,Ut.c,Ut.c,[]),r.Ub(1073742336,ka.a,ka.a,[]),r.Ub(1073742336,Aa.a,Aa.a,[]),r.Ub(1073742336,_a.a,_a.a,[]),r.Ub(1073742336,Pa.a,Pa.a,[]),r.Ub(1073742336,Ea.a,Ea.a,[]),r.Ub(1073742336,Fa.a,Fa.a,[]),r.Ub(1073742336,mi.a,mi.a,[]),r.Ub(1073742336,Oa.b,Oa.b,[]),r.Ub(1073742336,pi.g,pi.g,[]),r.Ub(1073742336,Da.a,Da.a,[]),r.Ub(1073742336,Ma.a,Ma.a,[]),r.Ub(1073742336,Ra.a,Ra.a,[]),r.Ub(1024,Ni.t,Ni.x,[[3,Ni.n]]),r.Ub(512,Ni.s,Ni.c,[]),r.Ub(512,Ni.b,Ni.b,[]),r.Ub(256,Ut.a,"/",[]),r.Ub(256,Ni.j,{enableTracing:!1,initialNavigation:!1,useHash:!1},[]),r.Ub(1024,Ut.h,Ni.w,[Ut.q,[2,Ut.a],Ni.j]),r.Ub(512,Ut.g,Ut.g,[Ut.h,Ut.q]),r.Ub(512,r.i,r.i,[]),r.Ub(512,r.C,r.Q,[r.i,[2,r.R]]),r.Ub(1024,Ni.l,(function(){return[[{path:"pwa",component:Nt},{path:"home",component:Nt},{path:"search",loadChildren:"../search-results/search-results.module#SearchResultsModule",canActivate:[La],canLoad:[La]},{outlet:"install-wizard",path:"",children:[{path:"open",loadChildren:"../install/install-wizard/install-wizard.module#InstallWizardModule"}]},{path:"apps",loadChildren:"../app-gallery-wrapper/app-gallery-wrapper.module#AppGalleryWrapperModule",canActivate:[Ua],canLoad:[Ua]},{path:"launch/:app/content",loadChildren:"../wac-content/wac-content.module#WacContentModule",canActivate:[Na],canLoad:[Na]},{path:"launch/:app",loadChildren:"../start-page-wrapper/start-page-wrapper.module#StartPageWrapperModule",canActivate:[Wa],canLoad:[Wa]},{path:"modernlaunch/:app",loadChildren:"../modern-start/modern-start.module#ModernStartModule",canActivate:[ja],canLoad:[ja]},{path:"template/:app",loadChildren:"../templates/templates.module#TemplatesModule",canActivate:[Wa],canLoad:[Wa]},{path:"m365apps",loadChildren:"../m365-apps/m365-apps.module#M365AppsModule",canActivate:[Ha],canLoad:[Ha]},{path:"create",loadChildren:"../create-center/create-center-wrapper/create-center-wrapper.module#CreateCenterWrapperModule",canActivate:[Ba],canLoad:[Ba]},{path:"mycontent",loadChildren:"../my-content/my-content.module#MyContentModule",canActivate:[Ga],canLoad:[Ga]},{path:"feed",loadChildren:"../feed/feed.module#FeedModule",canActivate:[qa],canLoad:[qa]}]]}),[]),r.Ub(512,Ni.m,Va,[]),r.Ub(1024,Ni.n,Ni.y,[Ni.s,Ni.b,Ut.g,r.v,r.C,r.i,Ni.l,Ni.j,[2,Ni.r],[2,Ni.m]]),r.Ub(1073742336,Ni.o,Ni.o,[[2,Ni.t],[2,Ni.n]]),r.Ub(1073742336,$a.a,$a.a,[]),r.Ub(1073742336,za.a,za.a,[]),r.Ub(1073742336,ir,ir,[]),r.Ub(1024,Za,me,[]),r.Ub(512,Ka.a,Ja,[u.b]),r.Ub(512,T.a,E.a,[[2,Za],Ka.a,L.b]),r.Ub(512,r.p,o.b,[T.a,u.b]),r.Ub(1024,r.E,(function(){return[Ni.u()]}),[]),r.Ub(512,Ni.A,Ni.A,[r.v]),r.Ub(1024,r.d,(function(e,t,i){return[nr.q(e),Ni.B(t),pe(i)]}),[[2,r.E],Ni.A,Vn]),r.Ub(512,r.e,r.e,[[2,r.d]]),r.Ub(131584,r.g,r.g,[r.F,r.ib,r.v,r.p,r.k,r.e]),r.Ub(1073742336,r.f,r.f,[r.g]),r.Ub(1073742336,nr.a,nr.a,[[3,nr.a]]),r.Ub(1073742336,rr.b,rr.b,[]),r.Ub(1073742336,hr,hr,[]),r.Ub(1073742336,Qa.a,Qa.a,[]),r.Ub(1073742336,Xa,Xa,[]),r.Ub(1073742336,eo.b,eo.b,[]),r.Ub(1073742336,to.a,to.a,[]),r.Ub(1073742336,io.a,io.a,[]),r.Ub(1073742336,no,no,[]),r.Ub(1073742336,mr.e,mr.e,[]),r.Ub(1073742336,mr.d,mr.d,[]),r.Ub(1073742336,ro.a,ro.a,[]),r.Ub(1073742336,ao.a,ao.a,[]),r.Ub(1073742336,oo.a,oo.a,[]),r.Ub(1073742336,so.a,so.a,[]),r.Ub(1073742336,lo.a,lo.a,[]),r.Ub(1073742336,co.a,co.a,[]),r.Ub(1073742336,uo.a,uo.a,[]),r.Ub(1073742336,ho.a,ho.a,[]),r.Ub(1073742336,po,po,[]),r.Ub(1073742336,mo,mo,[]),r.Ub(1073742336,br,br,[]),r.Ub(1073742336,fo.a,fo.a,[]),r.Ub(1073742336,ve,ve,[]),r.Ub(256,r.m,r.wb,[]),r.Ub(256,r.kb,"root",[]),r.Ub(256,rr.a,"BrowserAnimations",[]),r.Ub(256,Or,lr,[]),r.Ub(256,Fr,ur,[]),r.Ub(256,Er,dr,[]),r.Ub(256,go.a,Ya,[]),r.Ub(256,mr.r,"XSRF-TOKEN",[]),r.Ub(256,mr.s,"X-XSRF-TOKEN",[]),r.Ub(256,bo.a,50,[]),r.Ub(256,v.a,"pwa",[]),r.Ub(256,S,!0,[]),r.Ub(256,vo.a,null,[])])}));/localhost(:\d+)?$/.test(window.location.hostname)||Object(r.bb)(),window.queuedMarks=window.queuedMarks||[],window.performance.mark("App_Begin_Bootstrap"),window.queuedMarks.push({markName:"App_Begin_Bootstrap",measureFrom:window.measureAppFrom}),nr.i().bootstrapModuleFactory(So,{preserveWhitespaces:!1}).then((e=>{window.performance.mark("App_Complete_Bootstrap"),window.queuedMarks.push({markName:"App_Complete_Bootstrap",measureFrom:"App_Begin_Bootstrap"});const t=e.injector,r=t.get(d.b);r.config.sharedClientStartupContext&&(window.overrideCID&&(r.config.sharedClientStartupContext.correlationId=window.overrideCID),window.overrideSID&&(r.config.sharedClientStartupContext.sessionId=window.overrideSID),window.requestOriginOverride&&(r.config.sharedClientStartupContext.requestOrigin=window.requestOriginOverride));const o=t.get(R.a);t.get(o.capabilities.delayedServiceWorkerInit?C:y).initialize();const s=t.get(M.a),l=t.get(f.a);s.start();const c=t.get(T.a);if(P.setup(c),t.get(ye).startTrackingDiagnostics(),c instanceof E.a){c.registerOfficeRouteService(s),c.registerServiceWorkerStateService(l,!0);const e=t.get(F.a),i=t.get(I.a);c.registerEventFactories(r.config.authType===d.a.MSA?[i]:[e,i])}r.config.sharedClientStartupContext.oTelEnabled&&t.get(O.a).bootstrapOfficeStart(),c.logGenericEvent("Pwa_Bootstrap_End"),Object(a.a)({featureName:"Hwa",eventName:"Pwa_Bootstrap_End"});const u=t.get(k.b);window.performanceService=u,window.instrumentationService=c,t.get(D.a).broadcastEvent({name:"appInitialized",args:[]}),((e,r)=>{Object(n.__awaiter)(void 0,void 0,void 0,(function*(){if(r){t.get(O.a).bootstrapOfficeStart();const n=Promise.all([i.e(0),i.e(179),i.e(93)]).then(i.bind(null,"3xKL"));e?Promise.all([i.e(0),i.e(137)]).then(i.bind(null,"hfNz")).then((e=>{e.prefetchNorthStar(),n.then((e=>{e.prefetchEdgeworthData()}))})):n.then((e=>{e.prefetchEdgeworthData()}))}}))})(o.capabilities.northStarEnabled,o.capabilities.edgeworthReactEnabled)})).catch((e=>{window.shellAndConfigResponse.then((t=>{let i;try{i=JSON.parse(t)}catch(e){i=t}i&&i.clientStartupConfiguration&&function(e,t,i=!0){if(i&&console.error(e),!t)return;const n=I.b.createAriaLogger(t);if(!n)return;let r=!1;try{Zone.assertZonePatched()}catch(e){r=!0}const a=window.queuedEvents||[],o=window.queuedMarks,s="number"==typeof window.windowsDataSecuritySetting?window.windowsDataSecuritySetting:3;if(k.b.performanceLoggingSupported(window)){const e=(e,t,i)=>{(i=i||{}).Latency=t.toString(),i.ItemCategory="Bootstrapper",a.push({streamName:"Performance_Dump",eventName:e,eventParams:i,metrics:[],securityThreshold:0})},t=(e,t,i)=>{(i=i||{}).Error=e,i.DebugInfo=t,i.ItemCategory="Bootstrapper",a.push({streamName:"Generic_Event",eventName:"Performance_Mark_Failure",eventParams:i,metrics:[],securityThreshold:0})};o&&o.splice(0,o.length).forEach((i=>{const n=i.measureFrom||"navigationStart";try{window.performance.measure(i.markName,n,i.markName)}catch(e){return void t(i.markName,`Failed to record <${i.markName}> starting from <${n}>: exception is thrown`,i.eventParams)}const r=window.performance.getEntriesByName(i.markName,"measure");if(!r||!r.length)return void t(i.markName,`Failed to record <${i.markName}>: measure missing`,i.eventParams);const a=Math.ceil(r[0].duration);e(i.markName,a,i.eventParams)})),k.b.getBrowserTimingMeasures(window,((e,i)=>{t(e,i)})).forEach((t=>{e(t.name,t.duration)}))}a.length>0&&(a.forEach((e=>{if((e.securityThreshold||0)>s)return;const t=new w.AWTEventProperties,i=e.eventParams;if(i)for(const e in i)i.hasOwnProperty(e)&&t.setProperty(e,i[e]);t.setName(e.streamName),t.setProperty("EventName",e.eventName),t.setProperty("AppSecurityLevel",s),n.logEvent(t)})),window.queuedEvents=[]);const l=e&&e.stack||"Browser did not provide stack trace";let c=e&&e.message||"No Error Message Provided";c.lastIndexOf(".")!==c.length-1&&(c+=".");const u=`Fatal error preventing Angular bootstrap: ${c} Zone error: ${r}`,d=e=>{const t=new w.AWTEventProperties;return t.setName(e),t.setProperty("EventName","Unhandled_Exception"),t.setProperty("ItemCategory","Bootstrap"),t.setProperty("Error",T.a.filterPii(u)),t.setProperty("AppSecurityLevel",s),t},h=d("Generic_Event");t.logPiiAllowed&&h.setPropertyWithPii("DebugInfo",l,t.logPiiInClearText?w.AWTPiiKind.NotSet:w.AWTPiiKind.GenericData),n.logEvent(h);const p=d("Generic_Debug_Cache_2");p.setProperty("DebugInfo",l),n.logEvent(p),I.b.endSession(n,!0)}(e,JSON.parse(i.clientStartupConfiguration))}))}))},qpkC:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.default="default",e.dark="dark",e.highContrast="contrast"}(n||(n={}))},rBEp:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},rPZ4:function(e,t,i){"use strict";i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return d}));var n=i("Mlb/"),r=i("vk2e"),a=i("pzhl"),o=i("PkQn"),s=i("4/We"),l=i("Zy3K"),c=i("PBJH"),u=n.Fb({encapsulation:2,styles:[],data:{}});function d(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,13,"div",[["class","create-location-wrapper"]],null,null,null,null,null)),n.Gb(1,278528,null,0,r.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),(e()(),n.Hb(2,0,null,null,11,"div",[["class","create-location"]],null,null,null,null,null)),n.Gb(3,278528,null,0,r.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(4,{"create-location--margin":0,"create-location--fluent":1}),(e()(),n.Hb(5,0,null,null,3,"span",[["class","create-location__prompt"]],null,null,null,null,null)),n.Gb(6,278528,null,0,r.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(7,{"ms-fcl-ns":0,"ms-fcl-np":1}),(e()(),n.gc(8,null,["",""])),(e()(),n.Hb(9,0,null,null,1,"ohp-icon-font",[["cssClass","ms-ohp-svg-Icon ms-ohp-Icon--oneDriveLogo create-location__icon"],["size","16"]],null,null,null,a.b,a.a)),n.Gb(10,638976,null,0,o.a,[s.a],{color:[0,"color"],cssClass:[1,"cssClass"],size:[2,"size"]},null),(e()(),n.Hb(11,0,null,null,2,"span",[["class","create-location__path"]],[[8,"innerHTML",1]],null,null,null,null)),n.Gb(12,278528,null,0,r.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(13,{"ms-fcl-ns":0,"ms-fcl-np":1})],(function(e,t){var i=t.component;e(t,1,0,"create-location-wrapper",i.cssClass);var n=e(t,4,0,i.showMargin,i.fluentRefresh);e(t,3,0,"create-location",n);var r=e(t,7,0,!i.fluentRefresh,i.fluentRefresh);e(t,6,0,"create-location__prompt",r),e(t,10,0,i.oneDriveColor,"ms-ohp-svg-Icon ms-ohp-Icon--oneDriveLogo create-location__icon","16");var a=e(t,13,0,!i.fluentRefresh,i.fluentRefresh);e(t,12,0,"create-location__path",a)}),(function(e,t){var i=t.component;e(t,8,0,i.createLocationPrompt),e(t,11,0,i.createLocation)}))}n.Db("ohp-create-location",l.a,(function(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-create-location",[],null,null,null,d,u)),n.Gb(1,114688,null,0,l.a,[s.a,c.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{app:"app",showMargin:"showMargin",cssClass:"cssClass"},{},[])},rTyw:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("dy1P");function r(e){var t=e.replace(/Shell/,"");if(Object.values(n.a).find((function(e){return e===t})))return t;if(function(e){return new RegExp("Microsoft.BusinessAppDiscovery").test(e)}(t))return n.a.DynamicsApp;if(function(e){return/[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}/.test(e)}(t))return function(e){return new RegExp("GraphApp").test(e)}(t)?n.a.GraphApp:function(e){return new RegExp("LineOfBusinessApp").test(e)}(t)?n.a.LineOfBusinessApp:function(e){return new RegExp("SharePointApp").test(e)||/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}\|[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)}(t)?n.a.SharePointApp:function(e){return new RegExp("providers/Microsoft.PowerApps").test(e)}(t)?n.a.PowerAppsApp:n.a.ThirdPartyApp;switch(t){case"Admin":return n.a.AdminPortal;case"Document":case"Documents":case"OneDrive":return n.a.Documents;case"Forms":case"OfficeForms":return n.a.OfficeForms;case"Lists":case"List":return n.a.Lists;case"MeetingObject":return n.a.MeetingObject;case"M365app":return n.a.MetaOSApp;case"Office":return n.a.OfficeDotCom;case"PowerBI":case"PowerBIv2":return n.a.PowerBI;case"SharePoint":case"Sites":return n.a.SharePoint;case"Streams":case"Stream":return n.a.MicrosoftStream;case"Teams":return n.a.SkypeTeams;default:return n.a.UnknownApp}}},rbdM:function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i("EUVs"),i("4/We");var n=i("adME");class r extends n.a{constructor(e,t){super((()=>this.wacContentService.loadMruItem(this.itemInfo.item,this.itemInfo.wdOriginType,!0))),this.capabilitiesService=e,this.wacContentService=t}enabled(){return this.capabilitiesService.wacHostEnabledForFileType(this.itemInfo.item.fileType)&&this.capabilitiesService.capabilities.wacHostHoverPreloadEnabled}}},re3B:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("W3Zz"),r=i("BMb5"),a=i("Mlb/");class o{constructor(e,t){this.windowService=e;const i=t.getDeviceInfo(),r=i.platform.platformType;this.handlePageHide=(r===n.d.iPhone||r===n.d.iPad)&&i.browser.browserType===n.a.Safari}addUnloadEvent(e,t=!1){let i=!1;const n=this.windowService.nativeWindow,r=(n,r)=>{let a;return t&&r&&(a=r(n)),i||(i=!0,e()),!t&&r&&(a=r(n)),a},a=n.onbeforeunload;if(n.onbeforeunload=e=>r(e,a&&a.bind(n)),this.handlePageHide){const e=n.onpagehide;n.onpagehide=t=>r(t,e&&e.bind(n))}}}o.ɵprov=a.kc({factory:function(){return new o(a.lc(r.b),a.lc(n.b))},token:o,providedIn:"root"})},"s+Eq":function(e,t,i){"use strict";i.d(t,"c",(function(){return o})),i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return l}));var n=i("Mlb/"),r=i("lrJm"),a=(i("5FMq"),i("24t9"));i("mu6k");class o{}class s{constructor(e){this.templateRef=e}}class l{constructor(e,t){this.changeDetectorRef=e,this.contextMenuService=t,this.leftAlignedCard=!1,this.fullWidth=!1,this.toggleDisabled=!1,this.hideContent=!1,this.multiSelect=!1,this.ariaRole="option",this.selectedIndex=-1,this.toggleMenu=new n.q,this.selectItem=new n.q,this.focusLink=new n.q}ngOnInit(){this.opened=!1,this.focusActive=!1,this.mobileContextMenu&&this.contextMenuService.subscribeToCloseEvents((e=>{e&&e.menu&&this.menuModel&&e.menu.id===this.menuModel.id&&this.onCloseMenu()})),this.themeEnabled&&this.themeEnabled.subscribe((e=>{this.isThemeEnabled=e}))}ngOnDestroy(){this.opened&&this.toggleMenu.emit(!1)}ngAfterViewInit(){if(1!==this.menuItems.length)throw new r.a("Must have exactly 1 *ohpDropdownMenuItemContent in a DropdownMenu as a child");this.menuItemTemplate=this.menuItems.first.templateRef,this.changeDetectorRef.detectChanges()}onToggleMenu(e,t){if(null==t||t.preventDefault(),this.toggleDisabled&&!this.fullWidth)return this.opened=!0,void this.toggleMenu.emit(!0);this.opened!==e&&(e||!this.menu?(e&&!this.hideContent&&this.mobileContextMenu&&this.contextMenuService.showMenu({menu:this.menuModel,position:{left:0,top:0},focusFirstItem:this.focusActive}),this.opened=e,this.toggleMenu.emit(e)):this.menu.close())}onSelectItem(e){this.selectItem.emit(e)}onCloseMenu(e){this.opened=!1,(this.focusActive||e)&&this.dropdownLink.nativeElement.focus(),this.focusActive=!1,this.toggleMenu.emit(!1)}handleKey(e){const t=a.a.getKey(e);if(!this.opened)return void(2===t&&(this.focusActive=!0));if(-1===l.expectedKeys.indexOf(t))return;e.preventDefault();const i=this.menuModel.items.length-1;switch(t){case 1:case 2:case 3:this.onToggleMenu(!1,e);break;case 4:this.focusActive=!0,this.menu.setActiveIndex(i,!0);break;case 5:this.focusActive=!0,this.menu.setActiveIndex(0,!0)}}handleFocus(e){this.focusLink.emit(e)}}l.expectedKeys=[1,2,3,4,5]},sCgQ:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},"sH0/":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("dFxn"),r=i("Mlb/");class a{constructor(e){this.config=e.parse("firstRunCalloutsConfig")||{hideInTestMode:!0,tuiFlowInTestMode:"0",version:0,findMoreAppsCommercialSvg:{light:"",dark:""},findMoreAppsConsumerSvg:{light:"",dark:""},findMoreAppsEduSvg:{light:"",dark:""},manageContentSvg:{light:"",dark:""},createSvg:{light:"",dark:""},uploadContentSvg:{light:"",dark:""},allSetSvg:{light:"",dark:""},upgradeSvg:{light:"",dark:""},welcomeBackSvg:{light:"",dark:""},adminCenterSvg:{light:"",dark:""},officeMobileAppSvg:{light:"",dark:""},installButtonCalloutEnabled:!0}}}a.ɵprov=r.kc({factory:function(){return new a(r.lc(n.a))},token:a,providedIn:"root"})},tjsK:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("QjXU"),r=function(e){function t(t,i){var n=e.call(this,t)||this;return n.message=t,n.originalError=i,n.name="ApplicationError",n}return Object(n.__extends)(t,e),t}(Error)},tm5M:function(e,t,i){"use strict";i.d(t,"a",(function(){return T}));var n=i("lrJm"),r=i("hhzZ"),a=i("R7NL"),o=i("BaAg"),s=i("kpuN"),l=i("W3Zz"),c=i("Z0U4"),u=i("wwmn"),d=i("Uqr9"),h=i("casz"),p=i("ZtId"),m=i("BJbw"),f=i("BMb5"),g=i("4/We"),b=i("cgnd"),v=i("/I02"),S=i("JH4S"),y=i("QOOv"),C=i("RR/o"),w=i("Mlb/"),I=i("vk2e");class T{constructor(e,t,i,n,r,a,o,s,l,c,u,d,h,p,m,f,g,b){this.mruService=new C.b(e,i,t,n,r,a,o,s,l,c,u,h,p,m,f,g,b),f.capabilities.edgeworthEnabled||d.subscribeToRouteChangeStart((e=>{e.currentRoute&&this.warmDocumentCache(e.currentRoute)}))}getMruService(){return this.mruService}warmDocumentCache(e){switch(e.route){case"OfficeHome":case"Pwa":this.mruService.getMruDocuments();break;case"Start":e.app!==o.b.SharePoint&&e.app!==o.b.OneDrive&&this.mruService.getMruDocuments(new Set([e.app]))}}}T.ɵprov=w.kc({factory:function(){return new T(w.lc(s.a),w.lc(a.a),w.lc(r.a),w.lc(v.a),w.lc(u.a),w.lc(S.a),w.lc(y.a),w.lc(I.q),w.lc(n.b),w.lc(b.b),w.lc(d.b),w.lc(c.a),w.lc(p.a),w.lc(h.a),w.lc(f.b),w.lc(g.a),w.lc(m.a),w.lc(l.b))},token:T,providedIn:"root"})},ttrr:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i("5FMq"),i("W3Zz");class n{constructor(e,t){this.contextMenuService=e,this.deviceDetector=t}ngOnInit(){this.desktop=this.deviceDetector.isDesktopDevice()}onContextMenu(e){this.desktop&&this.model&&e&&!this.disabled&&(e.preventDefault(),setTimeout((()=>{this.contextMenuService.showMenu({menu:this.model,position:{left:e.clientX,top:e.clientY}})}),0))}}},tuJr:function(e,t,i){"use strict";i.d(t,"a",(function(){return f})),i.d(t,"b",(function(){return S}));var n=i("Mlb/"),r=i("vk2e"),a=i("RitX"),o=i("mu6k"),s=i("W3Zz"),l=i("hZW2"),c=i("PBJH"),u=i("BMb5"),d=i("g0MB"),h=i("w1PR"),p=i("s+Eq"),m=i("5FMq"),f=n.Fb({encapsulation:2,styles:[],data:{}});function g(e){return n.jc(0,[(e()(),n.qb(0,null,null,0))],null,null)}function b(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,3,null,null,null,null,null,null,null)),(e()(),n.qb(16777216,null,null,2,null,g)),n.Gb(2,540672,null,0,r.o,[n.W],{ngTemplateOutletContext:[0,"ngTemplateOutletContext"],ngTemplateOutlet:[1,"ngTemplateOutlet"]},null),n.Zb(3,{item:0,index:1}),(e()(),n.qb(0,null,null,0))],(function(e,t){var i=t.component,n=e(t,3,0,t.context.item,t.context.index);e(t,2,0,n,i.menuItemTemplate)}),null)}function v(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,"ohp-menu",[],null,[[null,"selectItem"],[null,"closeMenu"]],(function(e,t,i){var n=!0,r=e.component;return"selectItem"===t&&(n=!1!==r.onSelectItem(i)&&n),"closeMenu"===t&&(n=!1!==r.onCloseMenu(i)&&n),n}),a.b,a.a)),n.Gb(1,4440064,[[2,4]],1,o.a,[s.b,l.a,n.h,c.a,n.K,n.o,u.b],{menuModel:[0,"menuModel"],animateClose:[1,"animateClose"],leftAlignedCard:[2,"leftAlignedCard"],multiSelect:[3,"multiSelect"],contextAriaLabel:[4,"contextAriaLabel"],ariaRole:[5,"ariaRole"],selectedIndex:[6,"selectedIndex"]},{selectItem:"selectItem",closeMenu:"closeMenu"}),n.cc(603979776,3,{menuItems:1}),(e()(),n.qb(0,null,null,1,null,b)),n.Gb(4,16384,[[3,4]],0,o.b,[n.S],null,null)],(function(e,t){var i=t.component;e(t,1,0,i.menuModel,!0,i.leftAlignedCard,i.multiSelect,i.menuModel.linkAriaLabel,i.ariaRole,i.selectedIndex)}),null)}function S(e){return n.jc(0,[n.cc(671088640,1,{dropdownLink:0}),n.cc(671088640,2,{menu:0}),(e()(),n.Hb(2,0,null,null,11,"div",[["class","dropdown-menu-wrapper"]],[[8,"id",0]],null,null,null,null)),n.Gb(3,278528,null,0,r.i,[n.x,n.y,n.o,n.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Zb(4,{"dropdown-menu-wrapper--relative":0,"dropdown-menu-wrapper--max-width":1}),(e()(),n.Hb(5,0,[[1,0],["dropdownLink",1]],null,4,"button",[["data-clicklog","custom"],["keyboardFocusTooltip",""]],[[8,"id",0],[1,"aria-label",0],[1,"aria-expanded",0],[1,"aria-owns",0],[1,"aria-describedby",0],[8,"title",0]],[[null,"click"],[null,"keydown"],[null,"focus"],[null,"blur"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.onToggleMenu(!r.opened,i)&&n),"keydown"===t&&(n=!1!==r.handleKey(i)&&n),"focus"===t&&(n=!1!==r.handleFocus(!0)&&n),"blur"===t&&(n=!1!==r.handleFocus(!1)&&n),n}),null,null)),n.Gb(6,278528,null,0,r.i,[n.x,n.y,n.o,n.K],{ngClass:[0,"ngClass"]},null),n.Xb(7,3),n.Gb(8,4210688,null,0,d.a,[n.o,n.K,h.b],null,null),n.Vb(null,0),(e()(),n.Hb(10,0,null,null,1,"p",[["class","aria-description"]],[[8,"id",0]],null,null,null,null)),(e()(),n.gc(11,null,["",""])),(e()(),n.qb(16777216,null,null,1,null,v)),n.Gb(13,16384,null,0,r.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,4,0,!i.overridePositioning,i.fullWidth);e(t,3,0,"dropdown-menu-wrapper",n);var r=e(t,7,0,i.menuModel.linkCssClass,i.isThemeEnabled&&i.menuModel.themeCssClass&&!i.opened?i.menuModel.themeCssClass:"",i.opened&&i.menuModel.openCssClass?i.menuModel.openCssClass:"");e(t,6,0,r),e(t,13,0,i.opened&&!i.mobileContextMenu&&!i.hideContent)}),(function(e,t){var i=t.component;e(t,2,0,n.Ob(1,"",i.menuModel.id,"-dropdown-wrapper")),e(t,5,0,n.Ob(1,"",i.menuModel.id+"-dropdown-link",""),i.menuModel.linkAriaLabel,i.opened?"true":"false",i.opened?i.menuModel.id+"-dropdown":null,i.menuModel.id+"-button-description",i.menuModel.linkTooltip||""),e(t,10,0,n.Ob(1,"",i.menuModel.id+"-button-description","")),e(t,11,0,i.menuModel.linkAriaDescription)}))}n.Db("ohp-dropdown-menu",p.a,(function(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,2,"ohp-dropdown-menu",[],null,null,null,S,f)),n.Gb(1,4440064,null,1,p.a,[n.h,m.a],null,null),n.cc(603979776,1,{menuItems:1})],(function(e,t){e(t,1,0)}),null)}),{menuModel:"menuModel",overridePositioning:"overridePositioning",mobileContextMenu:"mobileContextMenu",leftAlignedCard:"leftAlignedCard",fullWidth:"fullWidth",toggleDisabled:"toggleDisabled",themeEnabled:"themeEnabled",hideContent:"hideContent",multiSelect:"multiSelect",ariaRole:"ariaRole",selectedIndex:"selectedIndex"},{toggleMenu:"toggleMenu",selectItem:"selectItem",focusLink:"focusLink"},["[ohpMenuLinkContent]"])},"tv+F":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e,t){this.router=e,this.capabilitiesService=t}checkEnabledAndRedirect(e,t,i,n){return e||(null!=n?!n:this.router.navigated)||this.router.navigate([null!=t?t:this.getDefaultRedirect()],i?{queryParams:i}:{}),e}getDefaultRedirect(){switch(this.capabilitiesService.getWorkload()){case"embed":return"embed/home";default:return"home"}}}},tyUq:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("TfV2"),r=i("ZBSS"),a=i("uqr+"),o=i("dSKW"),s=i("uV9m");function l(e,t){void 0===t&&(t=n.a.Security),Object(s.e)("Request",function(e){var t,i,n={};if(n[r.y]="Request",n[r.z]=e.eventName,n[Object(a.a)([r.bb,r.F])]=e.httpCode.toString(),n[Object(a.a)([r.bb,r.t])]=e.error?e.error:"",n[Object(a.a)([r.bb,r.E])]=!!e.fromCache&&e.fromCache,n[Object(a.a)([r.bb,r.S])]=e.latency?e.latency.toString():"",n[Object(a.a)([r.bb,r.j])]=null!==(t=e.area)&&void 0!==t?t:"",n[Object(a.a)([r.bb,r.fb])]=null!==(i=e.subArea)&&void 0!==i?i:"",Object(s.c)()){var l=Object(o.a)(Object(s.a)());n[Object(a.a)([r.bb,r.V])]=l,n[Object(a.a)([r.bb,r.W])]=Object(o.c)(l),n[Object(a.a)([r.bb,r.U])]=Object(o.b)(l)}return n}(e),t)}},u51t:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("Uqr9");i("hhzZ"),i("4/We");class r{constructor(e,t){this.instrumentationService=t,this.enabled=e.capabilities.hoverPreloadTelemetryEnabled}onMouseEnter(){this.enabled&&(this.startTime=n.a.now())}onMouseLeave(){this.startTime&&this.log(!1)}onClick(){this.startTime&&this.log(!0)}reset(){this.startTime=null}log(e){const t=this.getTimeElapsed().toString(),i={};i.TimeElapsed=t,i.Area=this.area,i.DocumentHoverClick=e.toString(),this.instrumentationService.logGenericEvent("Document_Hover",i),this.reset()}getTimeElapsed(){return n.a.now()-this.startTime}}},uG5N:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("6UlS"),r=i("k+kJ"),a=i("Mlb/");class o{constructor(){this._uploadResources=new n.a(null),this.uploadResources=this._uploadResources.asObservable(),this._uploadSession=new n.a(null),this.uploadSession=this._uploadSession.asObservable()}upload(e,t,i,n,r){if(this.uploadInProgress&&!this.uploadInProgress.finished())return null;this.currentSubscription&&(this.currentSubscription.unsubscribe(),this.currentSubscription=null,this.uploadInProgress=null);const a=t.upload(e,i,r);return a&&(this.currentSubscription=a.subscribe((e=>{this._uploadResources.next(n),this.uploadInProgress=e,this._uploadSession.next(e)}))),a}uploadFiles(e,t,i,a){if(this.uploadInProgress&&!this.uploadInProgress.finished())return null;this.currentSubscription&&(this.currentSubscription.unsubscribe(),this.currentSubscription=null,this.uploadInProgress=null);const o=new r.b(t,e[0],a),s=new n.a(o);return o.cancellationToken.onCancel((()=>{o.state=r.c.Cancelled,s.next(o)})),o.error={title:i.multipleFilesErrorTitle,type:r.a.MultipleFiles,message:i.multipleFiles},o.state=r.c.Failed,s.next(o),this.currentSubscription=s.subscribe((e=>{this._uploadResources.next(i),this.uploadInProgress=e,this._uploadSession.next(e)})),s.asObservable()}cancelUpload(){this.uploadInProgress&&this.uploadInProgress.cancellationToken.cancel()}}o.ɵprov=a.kc({factory:function(){return new o},token:o,providedIn:"root"})},"uH9+":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("pd4Y"),r=i("Mlb/");class a{constructor(e){this.dateService=e}getTimestampType(e){const t=this.dateService.timespanInSeconds(e),i=this.dateService.getLocalMidnight(),n=this.dateService.addDays(i,-1),r=this.dateService.addDays(i,-6),a=this.dateService.getStartOfYear();return t>=-3300&&t<-60?9:t<0?0:t<120?1:t<3600?2:e>=i?3:e>=n?4:e>=r?5:e>=a?6:7}}a.ɵprov=r.kc({factory:function(){return new a(r.lc(n.a))},token:a,providedIn:"root"})},uNUv:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("hhzZ"),r=i("BaAg"),a=i("kfAr"),o=i("QOOv"),s=i("Mlb/");class l{constructor(e,t){this.instrumentationService=e,this.mruConfigService=t,this.recordedThumbnails=new Set}instrumentThumbnailLoad(e,t,i,n,r){if(!this.mruConfigService.config.logThumbnailLoadSuccess||this.recordedThumbnails.has(t)||!a.a.thumbnailFileTypes.has(r))return;const o=this.getInstrumentationParams(e?"Success":"Failed",i,n,r);this.instrumentationService.logGenericEvent("Thumbnail_Load",o),this.recordedThumbnails.add(t)}getInstrumentationParams(e,t,i,n){const a={};return a.State=e,a.ItemCategory=t,a.Index=i.toString(),a.DocumentType=r.b[n],a}}l.ɵprov=s.kc({factory:function(){return new l(s.lc(n.a),s.lc(o.a))},token:l,providedIn:"root"})},uUrA:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("Uqr9");class r{static createGuid(){let e=n.a.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?i:3&i|8).toString(16)}))}}},uV9m:function(e,t,i){"use strict";i.d(t,"e",(function(){return b})),i.d(t,"b",(function(){return v})),i.d(t,"c",(function(){return S})),i.d(t,"a",(function(){return y})),i.d(t,"d",(function(){return C}));var n,r,a,o=i("tjsK"),s=i("TfV2"),l=i("ZBSS"),c=i("Y22C"),u=i("Dn7E"),d=i("kxm0"),h=[],p=new c.a,m=!1,f=s.a.Full,g=!1;function b(e,t,i){void 0===t&&(t={}),f<i||(h.length>0?h.forEach((function(i){e&&function(e){switch(e[l.y]){case"Action":return r.actionEnabled;case"Diagnostic":return r.diagnosticEnabled;case"Error":return r.errorEnabled;case"Feature":return r.featureEnabled;case"Impression":return r.impressionEnabled;case"PageView":return r.pageViewEnabled;case"Performance":return r.perfEnabled;case"Request":return r.requestEnabled;default:return!1}}(t)&&i.logEvent(e,t,function(e){switch(e[l.y]){case"Performance":return a.perfSamplingEnabled;case"Request":return a.requestSamplingEnabled;default:return!1}}(t))})):(e||void 0===e&&Object(d.c)(t))&&p.queueEvent({eventName:e,params:t,securityThreshold:i}))}function v(e,t,i,s,l){if(h.length>0)throw new o.a("initializeInstrumentationService is not allowed to be called more than once");if(!e||0===e.length)throw new o.a("Must specify at least one event factory when calling initializeInstrumentation");n=t,m=!0,r=i,a=s,h=e.slice(),"number"==typeof l&&(f=l),p.drainQueue().forEach((function(e){Object(d.c)(e.params)&&(e.params=Object(d.e)(e.params),e.eventName=Object(d.a)(Object(d.b)(e.params))),b(e.eventName,e.params,e.securityThreshold)})),Object(u.a)({featureName:"Other",eventName:"FlushQueue"}),g=!0}function S(){return m}function y(){return n()}function C(){return g}},uWZl:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{static fullPageReady(){return n.readyPromise||(n.readyPromise=n.createListener("FullAuthPageRendered")),n.readyPromise}static shellAndConfigsReady(){return n.shellAndConfigsReadyPromise||(n.shellAndConfigsReadyPromise=n.createListener("ShellInfoLoaded")),n.shellAndConfigsReadyPromise}static createListener(e){const t="readystatechange";return new Promise((i=>{const n=()=>{/^(?:interactive|complete)$/.test(document.readyState)&&(document.removeEventListener(t,n),document.getElementById(e)&&i())};document.addEventListener(t,n),n()}))}}},ufVG:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("dFxn"),r=i("Mlb/");class a{constructor(e){this.reactShellConfig=e.parse("reactShellConfiguration")||{activityTimeout:0,correlationId:null,culture:null,feedbackLinkText:null,homePageTitle:null,isConsumer:!1,logoutText:null,logoutUrl:null,mePhotoSource:null,puid:null,responsiveShellEnabled:!1,searchInHeader:!1,shellBootHost:null,shellDelayResourcesEnabled:!1,showOCVFeedbackLink:!1,signinState:[],controlsClaim:[],stickyNotesEnabled:!1,switchAccountLinkText:null,testTraffic:!1,thirdPartyNoticeLinkText:null,thirdPartyNoticeUrl:null,upn:null,userDisplayName:null,version:null,workloadSettingsSubLinksTitle:null,darkModeEnabled:!1,resourceUrl:null,environment:null,consumerShellServiceEnabled:!1,languageCode:null,acctSwitchingConfig:null,meetNowLinkUrl:"",meetNowEnabled:!1}}}a.ɵprov=r.kc({factory:function(){return new a(r.lc(n.a))},token:a,providedIn:"root"})},up2P:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},upmJ:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},"uqr+":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("zGJG");function r(e){return e.join(n.a)}},uzn7:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("CMIS"),r=i("hhzZ"),a=i("cgnd");class o{constructor(e,t){if(this.userId=e||o.unknownUserId,this.nativeStorage=t,this.nativeStorage){const e=this.getUserBasedKey(`_${Math.round(1e6*Math.random())}`);try{this.nativeStorage.setItem(e,e),this.nativeStorage.removeItem(e)}catch(e){this.nativeStorage=null}}}get(e){return this.getItem(this.getUserBasedKey(e))}set(e,t){this.setItem(this.getUserBasedKey(e),t)}remove(e){this.removeItem(this.getUserBasedKey(e))}getGlobal(e){return this.getItem(e)}setGlobal(e,t){this.setItem(e,t)}removeGlobal(e){this.removeItem(e)}findKeys(e){if(!this.nativeStorage||!e)return null;const t=[];for(let i=0;i<this.nativeStorage.length;i++){const n=this.nativeStorage.key(i);n.indexOf(e)>=0&&t.push(n)}return t}getItem(e){if(!this.nativeStorage)return null;const t=this.nativeStorage.getItem(e);return"string"==typeof t?JSON.parse(t):void 0}setItem(e,t){if(this.nativeStorage)try{const i=void 0===t?void 0:JSON.stringify(t);this.nativeStorage.setItem(e,i)}catch(e){}}removeItem(e){this.nativeStorage&&this.nativeStorage.removeItem(e)}getUserBasedKey(e){return`${o.officeHomeStorageKeyPrefix}-${this.userId}${e}`}}o.officeHomeStorageKeyPrefix="officeHome",o.unknownUserId="Unknown";var s=i("BMb5"),l=i("Mlb/");class c extends o{constructor(e,t,i){try{super(t.config.puid,i.getStorage(s.a.LocalStorage)),i.isStorageAvailable(s.a.LocalStorage)||(e.logGenericEvent("Local_Storage_Unavailable"),Object(n.a)({eventName:"Local_Storage_Unavailable"}))}catch(e){}}}c.ɵprov=l.kc({factory:function(){return new c(l.lc(r.a),l.lc(a.b),l.lc(s.b))},token:c,providedIn:"root"})},v3sZ:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("dFxn"),r=i("Mlb/");class a{constructor(e){this.config=e.parse("oneNoteConfig")||{oneNoteApiPath:null,enableOneNoteApis:!1}}}a.ɵprov=r.kc({factory:function(){return new a(r.lc(n.a))},token:a,providedIn:"root"})},vHlr:function(e,t,i){"use strict";i.d(t,"a",(function(){return T}));var n=i("FZB6"),r=i("Dn7E"),a=i("lUkk"),o=i("dy1P"),s=i("hhzZ"),l=i("BaAg"),c=i("p6Zr"),u=i("kpuN"),d=i("hZW2"),h=i("Bc8L"),p=i("TIi1"),m=i("EUVs"),f=i("4/We"),g=i("cgnd"),b=i("/I02"),v=i("ZBli"),S=i("k+kJ"),y=i("JScD"),C=i("uG5N"),w=i("9MHL"),I=i("Mlb/");class T{constructor(e,t,i,n,r,a,o,s,l,c,u,d){this.accessTokenService=e,this.documentService=t,this.capabilitiesService=i,this.contextService=n,this.instrumentationService=r,this.localAppLauncherService=a,this.startupConfigService=o,this.uploadManagerService=s,this.uploadConfigService=l,this.oneDriveUploadService=c,this.urlLauncherService=u,this.wacContentService=d}getClickDataForId(e,t,i,n,r){const a={};a.UploadSessionId=t,a.ElementId=e=n?`${e}-${n}`:e,a.Area=this.contextService.isEdgeworth?s.b.Edgeworth:s.b.Documents,a.ItemCount=(r||0).toString(),a.ItemCategory=S.d[i];const o=this.getPartnerCorrelationId();return void 0!==o&&(a.PartnerCorrelationId=o),{eventName:"Upload_Click",params:a,metrics:[]}}uploadFile(e,t,n,a,o){const s=l.a.fileTypeFromFileName(e.name);let c=!1;const u=(e,t)=>{c||(c=!0,this.logClick(a,n,o,s,e,t))},d=this.uploadManagerService.upload(e,this.oneDriveUploadService,n,this.uploadConfigService.config.oneDriveResources,o);if(d){const a=(new Date).getTime(),c=a.toString();let h=!1;this.uploadSubscription=d.subscribe((d=>{if(d.state===S.c.Completed){h=!0;const t={};t.UploadSessionId=n,t.Latency=Math.ceil(d.duration).toString(),t.ItemCategory=S.d[o];const p=this.getPartnerCorrelationId();void 0!==p&&(t.PartnerCorrelationId=p),this.instrumentationService.logGenericEvent("Upload_Completed",t,["Upload_Completed"]),Object(r.a)({featureName:"Upload",eventName:"Upload_Completed",params:t});const m=this.capabilitiesService.capabilities.outgoingLoginHintEnabled,f=v.a.appendLoginHint(d.result.canonicalUrl,this.startupConfigService.config.loginHint,m),g={wdNewAndOpenCt:c,ct:c,wdPreviousSession:this.startupConfigService.config.sharedClientStartupContext.correlationId,wdOrigin:this.contextService.getWdOrigin("UPLOAD")};m&&(g.login_hint=this.startupConfigService.config.loginHint);const b=v.a.appendQueryParams(d.result.webUrl,g),y=()=>{if("cloudtest"===this.startupConfigService.config.sharedClientStartupContext.deploymentEnvironment)return;const t=e=>{if(u(!0,"Web"),this.capabilitiesService.wacHostEnabledForFileType(s)){const e=d.result;this.wacContentService.bootstrapAndRoute({docId:e.docId,driveId:e.driveId,docUrl:b,fileType:s,wdOrigin:g.wdOrigin},void 0,a),d.markCompletedAndOpenedInOfficeHome()}else this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((t=>{t.launchUrl(b,{action:"Upload",linkTarget:e})})):this.urlLauncherService.openUrl(b,"Upload",e)};this.capabilitiesService.capabilities.isEmbedMode&&this.capabilitiesService.capabilities.embedModeEnabled?t("_blank"):f?this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((i=>{i.launchContent({action:"Upload",document:{canonicalUrl:f,webUrl:b,app:l.b[s],attribution:"",url:f,extension:"",title:e.name,id:d.result.docId||""},useWebUrl:!0,wdOriginType:"UPLOAD"}).then((e=>{e.success?u(!0,"Native"):t("_blank")})).catch((()=>t("_top")))})):this.localAppLauncherService.launchOfficeApp(l.b[s],f).then((e=>{e?u(!0,"Native"):t("_blank")})).catch((()=>t("_top"))):t(this.capabilitiesService.capabilities.pwaEnabled?"_blank":"_top")},C=this.uploadConfigService.config.minUploadDuration-d.duration;C<=0?y():setTimeout(y,C)}else d.state===S.c.Cancelled?(this.uploadSubscription.unsubscribe(),t&&setTimeout((()=>t.nativeElement.focus()),0),h||u(!1)):d.state===S.c.Failed&&u(!1)}))}}uploadFiles(e,t,i,r){const s=l.a.fileTypeFromFileName(e[0].name);let u=!1;const d=(e,d)=>{if(u)return;u=!0;const h=this.getClickDataForId(i,t,r);this.instrumentationService.logClickEvent(h.eventName,i,h.params.Area,e?this.uploadConfigService.config.uploadFileTypes.has(s)?l.a.referralFromFileType(s):c.a.OneDrive:"",d,h.params,h.metrics),Object(a.a)({eventName:h.eventName,id:i,area:h.params.Area,result:e?"Refer":"Navigate",target:e?this.uploadConfigService.config.uploadFileTypes.has(s)?Object(n.a)(s):o.a.Documents:"Other"})},h=this.uploadManagerService.uploadFiles(e,t,this.uploadConfigService.config.oneDriveResources,r);h&&(this.uploadSubscription=h.subscribe((e=>{e.state===S.c.Cancelled?(this.uploadSubscription.unsubscribe(),d(!1)):e.state===S.c.Failed&&d(!1)})))}startUploadFlow(e,t,i,n,r){this.documentService.selectFile(e).then((e=>{const a=e[0],o=l.a.fileTypeFromFileName(a.name);this.accessTokenService.getAccessToken("Graph",!1,null,this.startupConfigService.config.authType===g.a.MSA||this.uploadConfigService.config.capPopupEnabled,{category:"Upload",fileType:o}).then((()=>{this.uploadFile(a,i,t,n,r)}))}))}logClick(e,t,i,r,s,u){const d=this.getClickDataForId(e,t,i);this.instrumentationService.logClickEvent(d.eventName,e,d.params.Area,s?this.uploadConfigService.config.uploadFileTypes.has(r)?l.a.referralFromFileType(r):c.a.OneDrive:"",u,d.params,d.metrics),Object(a.a)({eventName:d.eventName,id:e,area:d.params.Area,result:s?"Refer":"Navigate",target:s?this.uploadConfigService.config.uploadFileTypes.has(r)?Object(n.a)(r):o.a.Documents:"Other"})}getPartnerCorrelationId(){var e;return null!==(e=new URLSearchParams(window.location.search).get("partnerCid"))&&void 0!==e?e:void 0}}T.ɵprov=I.kc({factory:function(){return new T(I.lc(u.a),I.lc(d.a),I.lc(f.a),I.lc(b.a),I.lc(s.a),I.lc(h.a),I.lc(g.b),I.lc(C.a),I.lc(y.a),I.lc(w.a),I.lc(p.a),I.lc(m.a))},token:T,providedIn:"root"})},"vSs+":function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var n=i("Dn7E"),r=i("70cc"),a=i("WKA6"),o=i("y3b+"),s=i("hhzZ"),l=i("hZW2"),c=i("7Gwk"),u=i("Uqr9"),d=i("casz"),h=i("TIi1"),p=i("4/We"),m=i("cgnd"),f=i("/I02"),g=i("pjz5"),b=i("Mlb/");class v{constructor(e,t,i,n,r,a,o,s,l,c){this.eventService=e,this.capabilitiesService=t,this.clientStartupConfigService=i,this.contextService=n,this.documentService=r,this.installConfigService=a,this.instrumentationService=o,this.performanceService=s,this.schedulerService=l,this.urlLauncherService=c,this.upsellTrackingParam="",this.dimeDisabled=!1,this.preloadedExperiences=[]}getUpsellTrackingParam(){return""!==this.upsellTrackingParam||(this.capabilitiesService.capabilities.isPwaInUwp?(this.upsellTrackingParam="PWA",["WordPad","CovidLockscreen","CovidStartMenu","CovidAMC","CovidActionCenter","HVAStartMenu","CGEAwareness"].forEach((e=>{this.checkOrigin(e)&&(this.upsellTrackingParam+="-"+e)}))):(this.upsellTrackingParam="HomePage",["RFMGraceToOnline","RFMGraceToOnline2","CovidLockscreen","CovidStartMenu","CovidAMC","CovidActionCenter","RFMSubExpB","RFMSubExpC","EduExp1","EduExp2","HVAStartMenu","MacWXPOO","GetGenuine","FreeOfframpFromDialog","FreeOfframpFromTBA","5DayPassEndedBizbar","GenericRFMBizbar","CommExp1","CommExp2"].forEach((e=>{this.checkOrigin(e)&&(this.upsellTrackingParam+="-"+(e.startsWith("RFM")?"RFM":e))})))),this.upsellTrackingParam}warmupDime(e){this.clientStartupConfigService.config.authType!==m.a.MSA||this.capabilitiesService.capabilities.isPwaInUwp&&window.prelaunchMode||-1===this.preloadedExperiences.indexOf(e)&&(this.preloadedExperiences.push(e),this.logDimeEvent("Dime_Warmup",e),this.scheduleWarmupTask({experiences:[e]}))}launchDime(e,t,n){if(this.dimeDisabled)return this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((e=>{e.launchUrl(t,{action:"Upsell"})})):this.urlLauncherService.openUrl(t,"Upsell"),void this.logDimeEvent("Dime_Launch",e,"Failed","RedirectToPOC;DimeDisabled");let r=null;const a=this.loadDime(),o=new Promise((e=>{r=setTimeout((()=>{e(0)}),this.installConfigService.config.dimeTimeoutMs)}));return Promise.race([a,o]).then((a=>{if(r&&clearTimeout(r),1!==a)return this.dimeDisabled=!0,void this.logDimeEvent("Dime_Launch",e,"Failed","TimeOut");try{const i=this.getCampainIdFromTargetUrl(t),r={experience:e,campaignId:i};n&&(r.parentElementId=n),this.logDimeEvent("Dime_Launch",e,"Start"),this.eventService.broadcastEvent({name:"dimeUpsellDialogOpened",args:[]}),this.dime.launch(r,(()=>{this.logDimeEvent("DimeTransactionCompleted",e),this.eventService.broadcastEvent({name:"convertedToPaid",args:[]})})).then((t=>{this.logDimeEvent("Dime_Completed",e,t.status,t.metaData),this.eventService.broadcastEvent({name:"dimeUpsellDialogClosed",args:[]})}))}catch(n){this.dimeDisabled=!0,this.logDimeEvent("Dime_Launch",e,"Failed",n,"RedirectToPOC;LaunchException"),this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3)]).then(i.bind(null,"DZQ9")).then((e=>{e.launchUrl(t,{action:"Upsell"})})):this.urlLauncherService.openUrl(t,"Upsell")}}))}scheduleWarmupTask(e){return this.eventService.events.withScope(0).pipe(Object(r.a)((e=>"mruFailed"===e.name||"mruReady"===e.name)),Object(a.a)(1)).toPromise().then((()=>{this.schedulerService.scheduleWork((()=>{this.loadDime().then((t=>{1===t&&this.preloadDimeExperience(e)}))}),4)}))}loadDime(){return this.loadDimePromise||(this.performanceService.mark("LoadDimeScript_Started"),this.loadDimePromise=new Promise((e=>{this.documentService.addScriptToPage(this.installConfigService.config.dimeJSUrl,(()=>{this.logDimeEvent("Dime_LoadScript","","Succeeded"),this.performanceService.mark("LoadDimeScript_Completed"),this.initializeDime().then((()=>{e(1)})).catch((()=>{e(2)}))}),(()=>{this.logDimeEvent("Dime_LoadScript","","Failed"),e(2)}),!1,"dimeScript")}))),this.loadDimePromise}checkOrigin(e){return this.clientStartupConfigService.config.sharedClientStartupContext.requestOrigin.toLowerCase()===e.toLowerCase()}getCampainIdFromTargetUrl(e){if(e&&e.indexOf("ocid=")>0){const t=g.a.getLocation(e),i=g.a.getQueryParams(t.search);return""!==i.ocid?i.ocid:"PROD_OfficeCom"}return"PROD_OfficeCom"}initializeDime(){return new Promise(((e,t)=>{if(this.dime&&e(1),this.dimeDisabled&&e(2),"undefined"!=typeof Dime){this.performanceService.mark("DimeInitialize_Start");const i={partnerId:this.capabilitiesService.capabilities.pwaEnabled?"officepwa":"officedotcom",language:this.contextService.sharedContext.officeMarket,sessionId:this.clientStartupConfigService.config.sharedClientStartupContext.sessionId,authHint:this.capabilitiesService.capabilities.pwaEnabled?this.clientStartupConfigService.config.puid:this.clientStartupConfigService.config.userPrincipalName,userInfo:{puid:this.clientStartupConfigService.config.puid}};try{this.dime=new Dime(i),this.performanceService.mark("DimeInitialize_Complete"),this.logDimeEvent("Dime_Initialize","","Succeeded"),e(1)}catch(e){this.dimeDisabled=!0,this.logDimeEvent("Dime_Initialize","","Failed",e),t()}}else this.dimeDisabled=!0,this.logDimeEvent("Dime_Initialize","","Failed","Dime_Undefined"),t()}))}preloadDimeExperience(e){this.dime&&(this.performanceService.mark("DimePreload_Start"),this.logDimeEvent("Dime_Preload",e.experiences.toString(),"Start"),this.dime.preload(e).catch((t=>this.logDimeEvent("Dime_Preload",e.experiences.toString(),"Failed",t))))}logDimeEvent(e,t="",i="",r,a){const o={},s=this.clientStartupConfigService.config.userCountryCode;o.DimeExperience=t,o.State=i,o.UserCountryCode=s;const l=a?a+";":"";o.DebugInfo="string"==typeof r?l+r:r?l+JSON.stringify(r):l,this.instrumentationService.logGenericEvent(e,o),Object(n.a)({featureName:"Upsell",eventName:e,area:"Other",params:{DimeExperience:t,State:i,DebugInfo:"string"==typeof r?l+r:r?l+JSON.stringify(r):l,UserCountryCode:s}})}}v.ɵprov=b.kc({factory:function(){return new v(b.lc(c.a),b.lc(p.a),b.lc(m.b),b.lc(f.a),b.lc(l.a),b.lc(o.a),b.lc(s.a),b.lc(u.b),b.lc(d.a),b.lc(h.a))},token:v,providedIn:"root"})},vW6f:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));let n=new(i("Mlb/").u)("ShellHeight")},vXf5:function(e,t,i){"use strict";var n,r;i.d(t,"c",(function(){return n})),i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return a})),function(e){e[e.Darker=0]="Darker",e[e.Dark=1]="Dark",e[e.DarkAlt=2]="DarkAlt",e[e.Primary=3]="Primary",e[e.Secondary=4]="Secondary",e[e.Tertiary=5]="Tertiary",e[e.Light=6]="Light",e[e.Lighter=7]="Lighter",e[e.LighterAlt=8]="LighterAlt"}(n||(n={})),function(e){e[e.White=0]="White",e[e.NeutralLighterAlt=1]="NeutralLighterAlt",e[e.NeutralLighter=2]="NeutralLighter",e[e.NeutralLight=3]="NeutralLight",e[e.NeutralQuaternaryAlt=4]="NeutralQuaternaryAlt",e[e.NeutralQuaternary=5]="NeutralQuaternary",e[e.NeutralTertiaryAlt=6]="NeutralTertiaryAlt",e[e.NeutralTertiary=7]="NeutralTertiary",e[e.NeutralSecondaryAlt=8]="NeutralSecondaryAlt",e[e.NeutralSecondary=9]="NeutralSecondary",e[e.NeutralPrimaryAlt=10]="NeutralPrimaryAlt",e[e.NeutralPrimary=11]="NeutralPrimary",e[e.NeutralDark=12]="NeutralDark",e[e.Black=13]="Black",e[e.WhiteHover=14]="WhiteHover",e[e.NeutralLighterAltHover=15]="NeutralLighterAltHover",e[e.NeutralLighterHover=16]="NeutralLighterHover",e[e.WhitePressed=17]="WhitePressed",e[e.NeutralLighterAltPressed=18]="NeutralLighterAltPressed",e[e.NeutralLighterPressed=19]="NeutralLighterPressed",e[e.WhiteSelected=20]="WhiteSelected",e[e.NeutralLighterSelected=21]="NeutralLighterSelected",e[e.Disabled=22]="Disabled"}(r||(r={}));const a="ohpAppTheme"},vcPZ:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e,t,i,n,r,a=[],o=[],s="callout",l=!1,c=!1,u=!1,d="",h=!1,p=null,m,f,g,b,v,S,y=!1,C){this.calloutElement=e,this.calloutType=t,this.area=i,this.title=n,this.subTitle=r,this.activationClasses=a,this.initialClasses=o,this.buttonIdPrefix=s,this.persistDismissal=l,this.persistCompletion=c,this.inline=u,this.imageClass=d,this.teachingCallout=h,this.dismissCalloutObservable=p,this.horizontalOffsetOverride=m,this.verticalOffsetOverride=f,this.footer=g,this.arrowDisplacementOffset=b,this.svgImage=v,this.calloutOnTop=S,this.centered=y,this.instrumentImpressionEvent=C,this.completed=!1,this.shouldScroll=this.checkScroll()}isValid(){return(this.calloutElement||this.centered)&&(!!this.subTitle||!!this.title)}checkScroll(){switch(this.calloutType){case"BuyOffice":case"DiscoverTab":case"DragAndDrop":case"Edgeworth":case"Feedback":case"FormsFeatureCallout":case"Install":case"MyAccount":case"Recommended":case"SharedTab":case"Upload":return!0;default:return!1}}}},w1PR:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return y}));var n,r=i("QjXU"),a=i("CMIS"),o=i("qpkC"),s=i("jV/k"),l=i("59BC"),c=i("fRG8"),u=i("PxQI"),d=i("O6Zd"),h=i("S5zL"),p=i("RT4L"),m=i("Y8if"),f=i("70cc"),g=i("vXf5"),b=(i("hhzZ"),i("BaAg")),v=(i("4/We"),i("cgnd")),S=(i("/I02"),i("PBJH"),i("JH4S"),i("MFXD"));i("dFxn"),i("hZW2"),i("7Gwk"),i("Z0U4"),i("casz"),i("5aVq"),i("Ax7d"),i("BMb5"),function(e){e.Side="Side",e.Pattern="Pattern",e.Default="Default"}(n||(n={}));class y{constructor(e,t,i,n,r,a,o,s,l,c,u,d,h,p){this.documentService=e,this.eventService=t,this.capabilitiesService=i,this.configParserService=n,this.clientStartupService=r,this.contextService=a,this.instrumentationService=o,this.userContext=s,this.routeService=l,this.schedulerService=c,this.locService=u,this.windowService=d,this.shellShimService=h,this.webPwaService=p,this.fluentThemeSubject=new S.a,this.fluentThemeSubscription=this.fluentThemeSubject.asScopableObservable(),this.isSearchDarkModeEcsConfigEnable=!1}get fullBleedTheming(){return this._fullBleedTheming}getEduHeaderImageForWidth(e,t){return t>=1366?e[1920]:t>=1024?e[1366]:t>=640?e[1024]:e[640]}updateVisualsTheme(e,t,i){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(e!==y.officeThemeId)return;let n;n=t?this.getDefaultDarkTheme():{shades:this.getThemeShades(this.defaultTheme),reactShellTheme:this.defaultTheme,themeType:"App",themeId:y.baseThemeId},(yield this.shellShimService.getShellShim()).Theme.SetThemeOverrideData({IsDarkTheme:t,PreferOfficeTheme:this.preferOfficeTheme(),UserPersonalizationAllowed:i,UserThemeId:y.baseThemeId,UserThemePalette:n.reactShellTheme}),this.eventService.broadcastEvent({name:"themeChanged",args:[Object.assign(Object.assign(Object.assign({},n),n.reactShellTheme),{ThemeId:y.officeThemeId,IsDarkMode:t}),!0]})}))}init(){const e=this.capabilitiesService.capabilities;this.defaultTheme=e.fluentHeader?this.windowService.nativeWindow.commercialDefaultThemeFluent:this.windowService.nativeWindow.commercialDefaultTheme,e.fluentRefresh&&this.schedulerService.scheduleWork((()=>{Promise.all([i.e(5),i.e(115)]).then(i.bind(null,"fFwu")).then((e=>{e.initializeFluentTheme(this.fluentThemeSubscription)}))}),0),this.isPWA=e.pwaEnabled,this.themeShadeClassPostfixes=new Map,this.grayscaleThemeShadeClassPostfixes=new Map,this.supportedAppThemes=new Map,this.currentRouteApp=b.b.Unknown;const t=this.createThemeChangeObservable();this.themeConfig=this.configParserService.parse("themeConfig"),this.initializeUserTheme();const n=this.getStartingTheme();this.themeShades=Object(s.a)(n).pipe(Object(c.a)(t),Object(u.a)(1)),this.darkModeSubscription=Object(l.b)(this.themeShades,this.routeService.getRouteChangeEndObservable()).pipe(Object(d.a)((([e,t])=>!("OfficeHome"!==t.currentRoute.route&&"Pwa"!==t.currentRoute.route&&"AppGallery"!==t.currentRoute.route&&"Start"!==t.currentRoute.route&&"ModernStart"!==t.currentRoute.route&&"Templates"!==t.currentRoute.route&&"Create"!==t.currentRoute.route&&"MyContent"!==t.currentRoute.route&&"M365Apps"!==t.currentRoute.route&&(!this.isSearchDarkModeEcsConfigEnable||"SearchPersonScoped"!==t.currentRoute.route&&"SearchTopicScoped"!==t.currentRoute.route&&"SearchMeetingScoped"!==t.currentRoute.route&&"Search"!==t.currentRoute.route))&&e.theme.reactShellTheme.IsDarkMode)));const a=this.eventService.whenEventFired("darkModeAvailable",1).then((e=>e.args[0]));this.setShowSearchDarkMode(a),this.processedInitialPageLoad=!1,this.displayedAppTheme=b.b.Unknown,this.initializeThemeUtilities(),n.userSelected||this.changeAppTheme(n.theme.shades,n.appPage),(e.wacStartPageEnabled||e.fluidSupportEnabled)&&(this.initializeAppThemeChangeHandler(),this.shellShimService.afterShellRendered.then((()=>{const e=this.themeConfig.appPageTypeOnLoad&&b.a.fileTypeNameToFileType(this.themeConfig.appPageTypeOnLoad)||this.currentRouteApp;e!==b.b.Unknown&&this.changeShell(e),this.processedInitialPageLoad=!0})));const o=this.routeService.getRouteChangeEndObservable().pipe(Object(d.a)((e=>!(!e.currentRoute||this.capabilitiesService.capabilities.leftNavReact||"OfficeHome"!==e.currentRoute.route&&"Pwa"!==e.currentRoute.route))),Object(h.a)());o.pipe(Object(p.a)(1)).subscribe((e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.shellShimService.getShellShim();t&&t.Theme&&t.Theme.SetFullBleedEnabled&&t.Theme.SetFullBleedEnabled(e)}))));const g=this.themeShades.pipe(Object(h.a)());this._fullBleedTheming=Object(l.b)(g,o).pipe(Object(d.a)((([e,t])=>({shouldFullBleed:this.determineFullBleedTheming(e)&&t,bleedColor:this.getNavBarColor(e),bleedFontColor:this.getBleedFontColor(e),themeData:e})))).pipe(Object(u.a)()).pipe(Object(m.a)({shouldFullBleed:!1,bleedColor:this.getNavBarColor(n),bleedFontColor:this.getBleedFontColor(n),themeData:n})),Object(l.b)(g,this.webPwaService.isStandalone).pipe(Object(f.a)((([e,t])=>t))).subscribe((([e])=>{this.webPwaService.isOfficeApp()&&this.documentService.updateThemeColor(this.getNavBarColor(e))}))}getAppBrandTheme(e){return{Darker:e[0],Dark:e[1],DarkAlt:e[2],Primary:e[3],Secondary:e[4],Tertiary:e[5],Light:e[6],Lighter:e[7],LighterAlt:e[8]}}getThemeShades(e){return[e.Darker,e.Dark,e.DarkAlt,e.Primary,e.Secondary,e.Tertiary,e.Light,e.Lighter,e.LighterAlt]}darkModeSupported(){const e="Search"===this.currentPage||"SearchPersonScoped"===this.currentPage||"SearchTopicScoped"===this.currentPage||"SearchMeetingScoped"===this.currentPage||"SearchSiteScoped"===this.currentPage;return this.isSearchDarkModeEcsConfigEnable&&e||!e&&(!("Content"===this.currentPage)||!(this.currentRouteApp===b.b.Fluid||this.currentRouteApp===b.b.FluidActivityBlueprint))}contrastModeSupported(){return!1}getDefaultDarkTheme(e){let t=y.darkTheme;return this.capabilitiesService.capabilities.fluentHeader&&(t=Object.assign(Object.assign({},t),this.defaultTheme.DarkTheme)),e&&(t.ThemeId=e),t.IsDarkMode=!0,{shades:this.getThemeShades(t),reactShellTheme:t,themeType:"App",themeId:t.ThemeId}}updateShellHeader(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.shellShimService.getShellShim();t&&t.Header.UpdateHeaderLink(e,null)}))}getNavBarColor(e){const t=e.theme.reactShellTheme;return t?t.NavBar||t.Primary:e.theme.shades[g.c.Primary]}getBleedFontColor(e){const t=e.theme.reactShellTheme;return t&&t.DefaultText?t.DefaultText:"#FFFFFF"}determineFullBleedTheming(e){return!this.capabilitiesService.capabilities.leftNavReact&&e.theme.reactShellTheme&&null!=e.theme.reactShellTheme.FullBleedImages}changeShell(e){this.changeShellAppTheme(e),this.changeShellAppHeader(e),this.changeShellHelpPane(e)}changeShellAppTheme(e,t=!1){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!this.supportedAppThemes.has(e)||e===this.displayedAppTheme&&!t)return;const i=this.supportedAppThemes.get(e),n=this.showDarkMode()&&i.darkTheme||i.theme;if(!n)return;const r=this.userTheme,a=Object.assign(Object.assign({},n),{IsDarkMode:this.showDarkMode(),ThemeId:r.themeId,ThemeType:r.themeType}),o=this.getThemeShades(n);e!==this.displayedAppTheme&&this.changeAppTheme(o,e);const s=yield this.shellShimService.getShellShim(),l=this.capabilitiesService.capabilities.fluentRefresh?Object.assign(Object.assign(Object.assign({},this.defaultTheme),i.theme),{AppName:i.theme.Primary,Accent:i.theme.Dark}):i.theme;i.darkTheme&&(l.DarkTheme=this.capabilitiesService.capabilities.fluentRefresh?Object.assign(Object.assign(Object.assign({},this.defaultTheme.DarkTheme),i.darkTheme),{AppName:i.darkTheme.Primary}):i.darkTheme),s.Theme.SetAppBrandTheme(l),this.eventService.broadcastEvent({name:"themeChanged",args:[a,!1]}),this.displayedAppTheme=e}))}changeShellAppHeader(e){if(!this.supportedAppThemes.has(e))return;const t=this.supportedAppThemes.get(e);this.updateShellHeader(t.headerText)}changeShellHelpPane(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!this.supportedAppThemes.has(e))return;const t=this.supportedAppThemes.get(e);t.helpPaneNamespace&&(yield this.shellShimService.getShellShim()).NFD.UpdateHelpNamespace(t.helpPaneNamespace)}))}resetShellHelpPane(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let e="";e=this.isPWA?this.clientStartupService.config.authType===v.a.OrgId?"IWPWA":"MSAPWA":this.clientStartupService.config.authType===v.a.OrgId?"IWAPP":"IWAPPC",(yield this.shellShimService.getShellShim()).NFD.UpdateHelpNamespace(e)}))}resetShellTheme(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.displayedAppTheme!==b.b.Unknown&&(this.clientStartupService.config.authType===v.a.MSA&&this.changeAppTheme(this.userTheme.shades),(yield this.shellShimService.getShellShim()).Theme.SetAppBrandTheme(this.defaultTheme),this.eventService.broadcastEvent({name:"themeChanged",args:[Object.assign({IsDarkMode:this.showDarkMode(),ThemeId:this.userTheme.themeId,ThemeType:this.userTheme.themeType},this.userTheme.reactShellTheme),!1]}),this.displayedAppTheme=b.b.Unknown)}))}resetShellHeader(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.updateShellHeader(this.isPWA&&"Tenant"!==this.userTheme.themeType?"":this.themeConfig.homePageTitle)}))}resetShell(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.resetShellTheme(),this.resetShellHeader(),this.resetShellHelpPane()}))}initializeThemeUtilities(){this.themeShadeClassPostfixes.set(g.c.Darker,"tdr"),this.themeShadeClassPostfixes.set(g.c.Dark,"td"),this.themeShadeClassPostfixes.set(g.c.DarkAlt,"tda"),this.themeShadeClassPostfixes.set(g.c.Primary,"tp"),this.themeShadeClassPostfixes.set(g.c.Secondary,"ts"),this.themeShadeClassPostfixes.set(g.c.Tertiary,"tt"),this.themeShadeClassPostfixes.set(g.c.Light,"tl"),this.themeShadeClassPostfixes.set(g.c.Lighter,"tlr"),this.themeShadeClassPostfixes.set(g.c.LighterAlt,"tlra"),this.grayscaleThemeShadeClassPostfixes.set(g.a.White,"w"),this.grayscaleThemeShadeClassPostfixes.set(g.a.NeutralLighterAlt,"nla"),this.grayscaleThemeShadeClassPostfixes.set(g.a.NeutralLighter,"nlr"),this.grayscaleThemeShadeClassPostfixes.set(g.a.NeutralLight,"nl"),this.grayscaleThemeShadeClassPostfixes.set(g.a.NeutralQuaternaryAlt,"g50"),this.grayscaleThemeShadeClassPostfixes.set(g.a.NeutralQuaternary,"g40"),this.grayscaleThemeShadeClassPostfixes.set(g.a.NeutralTertiaryAlt,"nta"),this.grayscaleThemeShadeClassPostfixes.set(g.a.NeutralTertiary,"nt"),this.grayscaleThemeShadeClassPostfixes.set(g.a.NeutralSecondaryAlt,"nsa"),this.grayscaleThemeShadeClassPostfixes.set(g.a.NeutralSecondary,"ns"),this.grayscaleThemeShadeClassPostfixes.set(g.a.NeutralPrimaryAlt,"npa"),this.grayscaleThemeShadeClassPostfixes.set(g.a.NeutralPrimary,"np"),this.grayscaleThemeShadeClassPostfixes.set(g.a.NeutralDark,"nd"),this.grayscaleThemeShadeClassPostfixes.set(g.a.Black,"bl"),this.grayscaleThemeShadeClassPostfixes.set(g.a.WhiteHover,"wh"),this.grayscaleThemeShadeClassPostfixes.set(g.a.NeutralLighterAltHover,"nlah"),this.grayscaleThemeShadeClassPostfixes.set(g.a.NeutralLighterHover,"nlh"),this.grayscaleThemeShadeClassPostfixes.set(g.a.WhitePressed,"wp"),this.grayscaleThemeShadeClassPostfixes.set(g.a.NeutralLighterAltPressed,"nlap"),this.grayscaleThemeShadeClassPostfixes.set(g.a.NeutralLighterPressed,"nlp"),this.grayscaleThemeShadeClassPostfixes.set(g.a.WhiteSelected,"ws"),this.grayscaleThemeShadeClassPostfixes.set(g.a.NeutralLighterSelected,"nls"),this.grayscaleThemeShadeClassPostfixes.set(g.a.Disabled,"d"),this.themeShades.subscribe((e=>{if(e.userSelected)if(this.userTheme=e.theme,this.currentRouteApp===b.b.Unknown||this.currentRouteApp!==b.b.FluidActivityBlueprint&&this.currentRouteApp!==b.b.Fluid)if(this.currentRouteApp===b.b.Unknown)this.isPWA&&this.updateShellHeader("Tenant"!==this.userTheme.themeType?"":this.themeConfig.homePageTitle),this.changeAppTheme(this.userTheme.shades);else{const e=this.supportedAppThemes.get(this.currentRouteApp),t=this.showDarkMode()&&(null==e?void 0:e.darkTheme)||(null==e?void 0:e.theme),i=t?this.getThemeShades(t):this.userTheme.shades;this.changeAppTheme(i,t?this.currentRouteApp:null)}else this.changeAppTheme(this.userTheme.shades)}))}setShowSearchDarkMode(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.isSearchDarkModeEcsConfigEnable=yield e}))}initializeAppThemeChangeHandler(){this.routeService.getRouteChangeStartObservable().pipe(Object(f.a)((e=>{var t;return e.currentRoute&&"Content"!==e.currentRoute.route||"Content"===(null===(t=e.currentRoute)||void 0===t?void 0:t.route)&&(e.currentRoute.app===b.b.Fluid||e.currentRoute.app===b.b.FluidActivityBlueprint)}))).subscribe((e=>{this.currentRouteApp=e.currentRoute&&e.currentRoute.app?e.currentRoute.app:b.b.Unknown,this.currentPage=e.currentRoute.route,this.processedInitialPageLoad&&(this.currentRouteApp===b.b.Fluid||this.currentRouteApp===b.b.FluidActivityBlueprint?(this.resetShellTheme(),this.resetShellHeader(),this.changeShellHelpPane(this.currentRouteApp),this.changeAppTheme(this.userTheme.shades)):this.currentRouteApp?this.changeShell(this.currentRouteApp):(this.resetShell(),!this.capabilitiesService.capabilities.darkModeEnabled&&this.preferOfficeTheme()||this.changeAppTheme(this.userTheme.shades)))}))}initializeUserTheme(){const e=this.themeConfig;this.supportedAppThemes.set(b.b.Word,{theme:this.configThemeShadesToTheme(e.wordThemeShades),darkTheme:this.configThemeShadesToTheme(e.wordThemeShadesDark),headerText:this.locService.WordName,helpPaneNamespace:"WDWAENDUSER"}),this.supportedAppThemes.set(b.b.Excel,{theme:this.configThemeShadesToTheme(e.excelThemeShades),darkTheme:this.configThemeShadesToTheme(e.excelThemeShadesDark),headerText:this.locService.ExcelName,helpPaneNamespace:"XLWAENDUSER"}),this.supportedAppThemes.set(b.b.PowerPoint,{theme:this.configThemeShadesToTheme(e.powerpointThemeShades),darkTheme:this.configThemeShadesToTheme(e.powerpointThemeShadesDark),headerText:this.locService.PowerPointName,helpPaneNamespace:"PPWAENDUSER"}),this.supportedAppThemes.set(b.b.Sway,{theme:this.configThemeShadesToTheme(e.swayThemeShades),darkTheme:this.configThemeShadesToTheme(e.swayThemeShadesDark),headerText:this.locService.SwayName,helpPaneNamespace:"STORYIM"}),this.supportedAppThemes.set(b.b.OneNote,{theme:this.configThemeShadesToTheme(e.onenoteThemeShades),darkTheme:this.configThemeShadesToTheme(e.onenoteThemeShadesDark),headerText:this.locService.OneNoteName,helpPaneNamespace:"ONWAENDUSER"}),this.supportedAppThemes.set(b.b.Forms,{theme:this.configThemeShadesToTheme(e.formsThemeShades),darkTheme:this.configThemeShadesToTheme(e.formsThemeShadesDark),headerText:"Forms",helpPaneNamespace:"MICROSOFTFORMS"}),this.supportedAppThemes.set(b.b.Visio,{theme:this.configThemeShadesToTheme(e.visioThemeShades),darkTheme:this.configThemeShadesToTheme(e.visioThemeShadesDark),headerText:this.locService.VisioName,helpPaneNamespace:"VIWAENDUSER"}),this.supportedAppThemes.set(b.b.Stream,{theme:this.configThemeShadesToTheme(e.streamThemeShades),darkTheme:this.configThemeShadesToTheme(e.streamThemeShadesDark),headerText:this.locService.StreamName,helpPaneNamespace:"STREAM"}),this.supportedAppThemes.set(b.b.Fluid,{theme:null,headerText:e.homePageTitle,helpPaneNamespace:"FLUID365"}),this.supportedAppThemes.set(b.b.FluidActivityBlueprint,{theme:null,headerText:e.homePageTitle,helpPaneNamespace:"FLUID365"}),this.userTheme=this.getInitialUserTheme()}configThemeShadesToTheme(e){return this.getAppBrandTheme(e.map((e=>`#${e}`)))}getGreyShades(){return this.capabilitiesService.capabilities.fluentRefresh?this.showDarkMode()?y.grayscaleThemeShadesFluentDark:y.grayscaleThemeShadesFluent:this.showDarkMode()?y.grayscaleThemeShadesDark:y.grayscaleThemeShades}changeAppTheme(e,t){if(!e||9!==e.length)return;const i=this.showDarkMode(),n=this.showContrastMode(),r=(e,t)=>{let i="";for(let n=0;n<y.themeProperties.length;n++){const r=y.themeProperties[n];let a=r.propName;this.contextService.isRtl&&(a=a.replace(/(left|right)/g,(e=>"left"===e?"right":"left"))),i+=`.${g.b} .ms-${r.className}-${e}{${a}:${t}}`;for(let n=0;n<y.themeSelectorPostfixes.length;n++)i+=`.${g.b} .ms-${r.className}-${e}-${y.themeSelectorPostfixes[n]}{${a}:${t}}`}return i},a=this.getGreyShades().reduce(((e,t,i)=>{const n=this.grayscaleThemeShadeClassPostfixes.get(i);return`${e}${r(n,t)}`}),""),o=e.reduce(((e,t,i)=>{const n=this.themeShadeClassPostfixes.get(i);return`${e}${r(n,t)}`}),a);this.documentService.addOrUpdateStyleTag("ohp-app-theme",o),this.changeFluentTheme(i,n,t)}brandThemeFromBase(e){return{themeDarker:e.Darker,themeDark:e.Dark,themeDarkAlt:e.DarkAlt,themePrimary:e.Primary,themeSecondary:e.Secondary,themeTertiary:e.Tertiary,themeLight:e.Light,themeLighter:e.Lighter,themeLighterAlt:e.LighterAlt}}hasRequiredDarkShades(e){const t=null==e?void 0:e.DarkTheme;return!!((null==t?void 0:t.Darker)&&(null==t?void 0:t.Dark)&&(null==t?void 0:t.DarkAlt)&&(null==t?void 0:t.Primary)&&(null==t?void 0:t.Secondary)&&(null==t?void 0:t.Tertiary)&&(null==t?void 0:t.Light)&&(null==t?void 0:t.Lighter))}preferOfficeTheme(){return this.clientStartupService.config.authType===v.a.MSA?this.themeConfig.preferOfficeTheme:this.userTheme.reactShellTheme.PreferOfficeTheme}changeFluentTheme(e,t,i){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=this.userTheme.themeId,r=`${n}${e}${t}${i}`;this.lastFluentTheme=r;const s=(i,n,r,a,s)=>{const l={mode:e?o.a.dark:t?o.a.highContrast:o.a.default,lightBrandColors:this.brandThemeFromBase(i),darkBrandColors:n&&this.brandThemeFromBase(n),themeId:null!=s?s:y.baseThemeId};this.capabilitiesService.capabilities.themeOverridesEnabled&&(l.overridePaletteMapping=a,l.overrideTokenMapping=r),this.fluentThemeSubject.next(l)};if(i&&this.supportedAppThemes.has(i)){const e=this.supportedAppThemes.get(i);if(e.theme)return void s(e.theme,e.darkTheme,!0,i===b.b.Forms||i===b.b.Sway,b.b[i])}const l=this.clientStartupService.config.authType===v.a.MSA||(null==n?void 0:n.toLowerCase())===y.baseThemeId||n===y.staticDarkTheme,c=this.preferOfficeTheme();if(l&&(c||e)){const e=this.windowService.nativeWindow.commercialDefaultThemeFluent;s(e,e.DarkTheme,!0,!1,c?y.officeThemeId:n)}else this.clientStartupService.config.authType!==v.a.MSA?(yield this.shellShimService.getShellShim()).Theme.GetUserThemeJsonByID(n,(t=>{if(r!==this.lastFluentTheme)return;const i=this.hasRequiredDarkShades(t);if(!t||e&&!i){t||(this.instrumentationService.logGenericEvent("Unknown_Theme",{DebugInfo:n}),Object(a.a)({eventName:"Unknown_Theme",errorType:"Other"}));const e=this.windowService.nativeWindow.commercialDefaultThemeFluent;s(e,e.DarkTheme,!0,!1,y.baseThemeId)}else s(t,i?t.DarkTheme:void 0,i,!1,n===y.baseWithOfficeThemePreferredThemeId?y.officeThemeId:n)})):s(y.msaFluentThemeLight,y.msaFluentThemeDark,!1,!1,y.officeThemeId)}))}}y.staticDarkTheme="dark-mode",y.baseThemeId="base",y.officeThemeId="Office",y.baseWithOfficeThemePreferredThemeId="BaseWithOfficeThemePreferred",y.darkTheme={IsDarkMode:!0,ThemeType:"User",ThemeId:y.staticDarkTheme,NavBar:"#1B1A19",Accent:"#F7894A",Dark:"#F7894A",Darker:"#F7894A",DarkAlt:"#F7894A",Primary:"#F7894A",Secondary:"#F7894A",Tertiary:"#F7894A",Light:"#F7894A",Lighter:"#F7894A",LighterAlt:"#F7894A"},y.msaFluentThemeLight={Darker:"#004578",Dark:"#005A9E",DarkAlt:"#106EBE",Primary:"#0078D4",Secondary:"#2B88D8",Tertiary:"#C7E0F4",Light:"#DEECF9",Lighter:"#EFF6FC",LighterAlt:"#EFF6FC"},y.msaFluentThemeDark={Darker:"#6CB8F6",Dark:"#3AA0F3",DarkAlt:"#1890F1",Primary:"#0086F0",Secondary:"#0074D3",Tertiary:"#004F90",Light:"#002848",Lighter:"#001526",LighterAlt:"#001526"},y.eduThemeBackplateOverrides={backpack:{"background-color":"rgba(255, 179, 221, 0.9)"},unicorn:{"background-color":"rgba(72, 117, 46, 0.9)",color:"#FFFFFF"}},y.themeProperties=[{className:"fcl",propName:"color"},{className:"bgc",propName:"background-color"},{className:"bcl",propName:"border-color"},{className:"bclt",propName:"border-top-color"},{className:"bclb",propName:"border-bottom-color"},{className:"bclr",propName:"border-right-color"}],y.themeSelectorPostfixes=["f:focus","h:hover","a:active","af:after"],y.grayscaleThemeShades=["#FFFFFF","#FAF9F8","#F3F2F1","#EDEBE9","#E1DFDD","#D2D0CE","#C8C6C4","#A19F9D","#8A8886","#605E5C","#3B3A39","#323130","#252423","#000000","#F3F2F1","#EDEBE9","#E1DFDD","#C8C6C4","#C8C6C4","#C8C6C4","#E1DFDD","#C8C6C4","#EDEBE9"],y.grayscaleThemeShadesDark=["#252423","#1B1A19","#F3F2F1","#323130","#323130","#3B3A39","#484644","#A19F9D","#8A8886","#B3B0AD","#3B3A39","#D2D0CE","#E9E8E8","#FFFFFF","#323130","#323130","#252423","#1B1A19","#1B1A19","#1B1A19","#323130","#252423","#1B1A19"],y.grayscaleThemeShadesFluent=["#FFFFFF","#FAFAFA","#F5F5F5","#F0F0F0","#EBEBEB","#E5E5E5","#E0E0E0","#D1D1D1","#BDBDBD","#707070","#616161","#424242","#242424","#000000","#F5F5F5","#F0F0F0","#EBEBEB","#E0E0E0","#DBDBDB","#D6D6D6","#EBEBEB","#E0E0E0","#F0F0F0"],y.grayscaleThemeShadesFluentDark=["#292929","#1F1F1F","#141414","#3D3D3D","#333333","#2E2E2E","#525252","#525252","#5C5C5C","#999999","#ADADAD","#D6D6D6","#FFFFFF","#FFFFFF","#3D3D3D","#333333","#292929","#1F1F1F","#141414","#0A0A0A","#383838","#242424","#141414"]},wwmn:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("dFxn"),r=i("Mlb/");class a{constructor(e){this.config=e.parse("officeHomeApiConfig")||{authTypeHeader:null,authVersionHeader:null,correlationIdHeader:null,defaultTimeoutInMs:3e5,externalTrafficHeader:null,featureOverrides:null,featureOverridesParamName:null,flightOverrides:null,flightOverridesParamName:null,jwtAuthEnabled:!1,jwtAuthOnOfficeHome:!1,mockRequestHeader:null,tenantIdHeader:null,testTrafficHeader:null,userIdHeader:null,workloadQueryParameter:null}}}a.ɵprov=r.kc({factory:function(){return new a(r.lc(n.a))},token:a,providedIn:"root"})},"x+6c":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},xIlw:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},xJIt:function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i("cj6A");var n=i("adME");class r extends n.a{constructor(e){super((()=>this.preloadService.preload(this.preloadPath))),this.preloadService=e}enabled(){return!!this.preloadPath}}},xSeq:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e,t){this.elementRef=e,this.changeDetectorRef=t}ngAfterViewInit(){this.focusOnLoad&&(this.elementRef.nativeElement.focus(),this.detectChanges&&this.changeDetectorRef.detectChanges())}}},xoWf:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},"y3b+":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("dFxn"),r=i("Mlb/");class a{constructor(e){this.config=e.parse("installConfig")||{consumerDirectInstallUrl:"",consumerInstallLink:"",consumerSSUInstallLink:"",commercialMySoftwarePageUrl:"",dimeEnabled:!1,dimeJSUrl:"",dimeTimeoutMs:5e3,goPremiumUrl:"",goPremiumUrlPremiumTemplates:"",welcomeBadgeOneDriveUrl:"",installApiRoot:"",installApiSWEnabled:!1,pwaInstallMoveEnabled:!1,resources:null,sendRequestId:!1,shellGoPremiumUrl:"",wizardImageAssets:"",wizardSupportLink:"",learnAboutM365Link:"",needHelpLink:"",buyOffice365Url:"",haveOfficeProductKeyUrl:"",needHelpInstallingOfficeUrl:"",ecsInstallNoLicenseOptionsEnabled:!1,installMessagePopupEnabled:!1,paidConsumerSubscriptionBenefitsUrl:""}}}a.ɵprov=r.kc({factory:function(){return new a(r.lc(n.a))},token:a,providedIn:"root"})},y9oG:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("BaAg");function r(e,t,i={}){return Object.assign({ResourceId:e,WacHostEntry:t.wdOrigin,FileFormat:n.a.fileTypeNameFromType(t.fileType)},i)}},z0B0:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("AGMK");function r(e){var t=function(){return e(Object(n.b)())};return document.addEventListener("visibilitychange",t),t}},zGJG:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r}));var n=".",r="1.0.0"},zPZ9:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return a}));var r=new Promise((function(e){return n=e}));function a(e){n(e)}},zwsB:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("dFxn"),r=i("Mlb/");class a{constructor(e){this.config=e.parse("formsConfig")||{defaultImagesAvailable:null,defaultThumbnailColor:null,formsApiPath:null,formsCdnPath:null,formsMsaTenantId:null,formsThemingConfigUrl:null,formsThumbnailImagesUrl:null,neoPortalPageEnabled:!1,groupPhotoRequestInBatch:!1,termsOfServiceLinkOrgId:null}}}a.ɵprov=r.kc({factory:function(){return new a(r.lc(n.a))},token:a,providedIn:"root"})}});
//# sourceMappingURL=pwa-bundle-bf1bfe6553b9b60574ca.js.map