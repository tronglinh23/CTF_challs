var WSB;(function(n){function nu(n,i){var r=[],u,f;if(i)if(n)r=i.slice();else{u=function(n){var t=i.find(function(t){return t.verb&&t.verb.toLocaleLowerCase()==n.toLocaleLowerCase()});t&&r.push(t)};for(f in t)u(f)}return r}function tu(n){return n?n.filter(function(n){return!n.verb||n.verb.toLowerCase()!="open"}):[]}function f(t,i,r,u,f,e){e()&&(t=t.slice(),i.getExtraVerbsAsync?n.Async.safeChain("getExtraVerbsAsync",function(){return i.getExtraVerbsAsync(u)},function(n){return l(et(t,n,!0),i,u,f,e)},function(){return l(t,i,u,f,e)},null,r):l(t,i,u,f,e))}function l(n,t,i,r,u){if(u()){var f=t.getExtraVerbs?et(n,t.getExtraVerbs(i),!1):n;f[0]==b&&f.shift();r(f)}}function iu(i,r,u,f){return i.map(function(i){var e,o,s,h;if(i.verb){switch(i.verb.toLocaleLowerCase()){case gt:e="PinnedToStart";break;case g:e="PinnedToTaskbar";break;case ni:e="UnpinnedFromStart";break;case nt:e="UnpinnedFromTaskbar";break;case dt:o=n.config.useCobaltCSS?"UninstallMessage":"UninstallConfirmation";e="UninstallationInProgress";break;case wr:e="PathCopied"}return s=function(t){t();n.RuntimeConfig.AlwaysWide&&e=="UninstallationInProgress"?(r.uninstallationInProgress=!0,f&&f()):e?u.showTemporaryMessage(n.Host.getLocString(e,HitHighlightingParser.removeMarkers(r.text))):u.hideTemporaryMessage();i.verb.toLocaleLowerCase()==g&&n.Host.addItemToPinnedToTaskbar(r.deviceItem.id);i.verb.toLocaleLowerCase()==nt&&n.Host.removeItemFromPinnedToTaskbar(r.deviceItem.id)},h=i.icon||t[i.verb.toLocaleLowerCase()],new n.DeviceItemVerbWrapper(i,h,function(t){o&&n.DialogBox?n.DialogBox.show(n.Host.getLocString(o),[{id:null,text:i.displayName,action:function(){return s(t)},selected:!1,useAccentColor:n.config.useCobaltCSS?!0:!1},{id:null,text:n.Host.getLocString("Cancel"),selected:!0}],n.config.useCobaltCSS?n.Host.getLocString("UninstallConfirmationTitle",HitHighlightingParser.removeMarkers(r.text)):""):s(t)})}return i})}function fi(t,i,r,u,e,o){if(n.isJumpListSuggestion(i))return n.Async.safeChain("jumpListItem.getVerbsAsync",function(){return i.jumpListItem.getVerbsAsync()},function(n){return f(tu(n),i,s,u,e,o)},function(){return f([],i,s,u,e,o)},null,t+" "+i.type),!0;var s=t+" "+i.type,h=n.getItemWithFileMetadata(i);return h&&h.canHaveContextMenu?(n.Async.safeChain("item.getVerbsAsync",function(){return h.getVerbsAsync()},function(n){return f(nu(r,n),i,s,u,e,o)},function(){return f([],i,s,u,e,o)},null,s),!0):i.getExtraVerbsAsync?(f([],i,s,u,e,o),!0):i.getExtraVerbs?(l([],i,u,e,o),!0):(u&&e([]),!1)}function e(n,t,i){var r=HitHighlightingParser.removeMarkers(n.text),u=r?r.length:0;return n.additionalInfoText&&!i&&(u+=n.additionalInfoText.length),u>(i?yr:pr)}function ei(n){for(var i,r={topResults:n.topResults.slice(0),groups:[]},t=0,u=n.groups;t<u.length;t++)i=u[t],r.groups.push({typeWithSource:i.typeWithSource,suggestions:i.suggestions.slice(0)});return r}function oi(t,i){if(t.isHtmlAnswer)return gi;if(t.grid)return(i?n.IconSize_GridLayout:n.IconSize_GridLayout_Medium)+2*r;var u=t.numberOfLines==3?di:t.numberOfLines==2?ki:bi;return t.mainTextWrapsToTwoLines&&(u+=at),u<lt&&(u=lt),u}function ru(t,i){if(!t)return 0;if(i&&n.uses3lineTemplate(n.getScope(i.type)))return oi({mainTextWrapsToTwoLines:!1,numberOfLines:3,isHtmlAnswer:!1,isSuppressed:t.isSuppressed,grid:!1},!1);if(t.isSuppressed)return 0;var r=pi;return t.hasTwoLines?r+=v+2:t.mainTextWrapsToTwoLines&&(r+=at),r}function uu(t,i){var r=ct;if(i.typeWithSource&&n.displayedInGridLayout(i.typeWithSource.type)){var u=n.isL2(t),f=Math.ceil(i.suggestions.length/(u?bt:kt)),e=u?yt:pt;r+=e*f;r+=2*y}else i.suggestions.forEach(function(n){return r+=ru(n,i.typeWithSource)});return r}function fu(n){switch(n){case 0:return"CP";case 7:return"DI";case 1:return"PP";case 2:return"PD";case 4:return"SP";case 5:return"TP";case 6:return"SD"}return undefined}function et(n,t,i){if(n.length>0&&t.length>0){var r=i?n.concat(b):n;return r.concat(t)}return n.length>0?n:t.length>0?i?[b].concat(t):t:[]}function i(t,i){return t.find(function(t){return n.sameGroup(t.typeWithSource,i)})}function si(t,i){return t.find(function(t){return n.sameGroup(t.group.typeWithSource,i)})}function hi(n,t){return n.queryToFetch.substring(0,t.queryToFetch.lastIndexOf("\\"))}function ci(t){switch(t){case n.GroupType.AnaheimDataTile:case n.GroupType.TopApps:case n.GroupType.People:return!0}return!1}function eu(t,i){if(!t.isSearchHomeZI||t.scope==n.Scope.All||i==n.GroupType.RecommendedDocs)return null;if(t.scope==n.Scope.Web){if(i==n.GroupType.Websites)return n.Host.getLocString("RecentWebsiteSection");if(i==n.GroupType.SearchSuggestions)return n.Host.getLocString("RecentWebSearchSection")}return ci(i)?n.Host.getLocString("FrequentSection"):n.Host.getLocString("RecentSection")}function ou(t){return n.Host.getLocString(t?typeof n.getIsMsbEduTenantEnabled=="function"&&n.getIsMsbEduTenantEnabled()?"SearchSchoolAndWeb":"SearchWorkAndWeb":"SearchTheWeb")}function su(){return n.Host.getLocString("Websites")}function hu(){return n.SubstrateTenantName?typeof n.getIsMsbEduTenantEnabled=="function"&&n.getIsMsbEduTenantEnabled()?n.Host.getLocString("MsbRecommendedForYouText"):n.Host.getLocString("MsbTenantRecommended").replace("{0}",n.SubstrateTenantName):n.Host.getLocString("QuickWorkSearchSuggestionsSection")}function li(t,i,r,u){var o,e,f,s,h;if(i==n.GroupType.PathCompletion)return o=hi(t,t)+"\\"+String.fromCharCode(8206),{title:o,narratorText:o};if(r&&(e=r.groupDisplayName,e))return{title:e,narratorText:u?n.Host.getLocString("AddingScopeNarratorText",e):e};if(f=eu(t,i),!f)switch(i){case n.GroupType.Command:f=n.Host.getLocString("CommandGroup");break;case n.GroupType.Cortana:f=n.Host.getLocString("CortanaGroup");break;case n.GroupType.Store:f=n.Host.getLocString("StoreGroup");break;case n.GroupType.LocalPlaces:f=n.Host.getLocString("LocalPlacesGroup");break;case n.GroupType.Related:f=n.Host.getLocString("RelatedSuggestionsGroup");break;case n.GroupType.SearchSuggestions:f=ou(n.msbEnabledForQuery(t));break;case n.GroupType.Websites:f=su();break;case n.GroupType.Contact:f=n.Host.getLocString("ContactGroup");break;case n.GroupType.LocalSearchHistory:f="Search history";break;case n.GroupType.CuratedSuggestions:f=n.Host.getLocString("SuggestedSection");break;case n.GroupType.CuratedSettings:f=n.Host.getLocString("QuickSearchSuggestionsSection");break;case n.GroupType.TopApps:f=n.Host.getLocString("TopAppsSection");break;case n.GroupType.QuickSearch:f=n.Host.getLocString("QuickSearchSuggestionsSection");break;case n.GroupType.QuickWorkSearch:case n.GroupType.QuickWorkSearchTopList:case n.GroupType.QuickWorkQueriesTopList:f=hu();break;case n.GroupType.VisualSearch:f="Visual search";break;case n.GroupType.MSNNews:f=n.Host.getLocString(n.config.msnNewsTitleResource);break;case n.GroupType.WelcomeExperience:f=n.Host.getLocString("WelcomeExperienceTitle");break;case n.GroupType.Upsell:f=n.Host.getLocString("RecommendedGroup");break;case n.GroupType.MRUHistory:f=n.Host.getLocString("MRUHistoryGroup");break;case n.GroupType.AnaheimDataTile:f=n.Host.getLocString("AnaheimDataTopSites");break;case n.GroupType.AnaheimDataList:r.type=="QSSG"?f=n.Host.getLocString("QuickSearchSuggestionsSection"):r.type=="ANAH"?f=n.Host.getLocString("AnaheimDataHistory"):r.type=="ANAT"?f=n.Host.getLocString("AnaheimDataTopSites"):r.type=="ANAR"&&(f=n.Host.getLocString("AnaheimDataRecentlyClosed"));break;case n.GroupType.AnaheimDataTopHit:n.config.topHitMuse&&r.type=="ANATH"&&(f="Best match for Edge history");break;case n.GroupType.RecommendedDocs:f=n.Host.getLocString("RecommendedDocsGroup");n.config.msbEnableDocumentZQ&&t.scope==n.Scope.Documents&&(f=n.Host.getLocString("RecommendedZQGroup"));break;case n.GroupType.PromoBanner:f=n.Host.getLocString("VaccineUpdate");break;case n.GroupType.MsbOnRampButton:f="MSB On ramp button";break;case n.GroupType.TrendingSearchData:f=n.Host.getLocString("DSBTrendingTitle")}if(!f){if(s=n.getScope(i),s==n.Scope.All)throw new Error("Unknown group type: "+i);h=n.ScopeConfig[s];f=n.getScopeDisplayName(h)}return{title:f,narratorText:u?n.Host.getLocString("AddingScopeNarratorText",f.toLocaleLowerCase()):f}}function cu(t){var r,u,i=n.AnaheimDataProvider.getSelectedProfile();return n.config.enableAnaheimDataProfile&&i&&(i.accountType=="MSA"?r=i.id:i.accountType=="AAD"&&(u=i.id)),[{text:n.Host.getLocString("AnaheimDataEdgeSettings"),id:"anaheimDataEdgeSettings",selected:!1,useAccentColor:!0,action:function(){return n.Host.launchUrlWithEdgeProtocol(null,{edgeSettingsUrl:n.config.anaheimDataEdgeSettings,cid:r,oid:u})},instItem:n.InstrumentedItem.getNonSuggestionInstrumentedItem("ANA",n.SyntheticQSCodesMaps.KValues,19),sequenceNumber:t}]}function ai(t,i,r,u){var f,e=[],s,h,c=n.canShowAnaheimDataSHTile(),y=n.canShowAnaheimDataSHList(),p=n.canShowAnaheimDataQF(),l=t==n.GroupType.AnaheimDataTile&&c;if((t==n.GroupType.AnaheimDataTile&&c||t==n.GroupType.AnaheimDataList&&y||t==n.GroupType.SearchSuggestions&&p||t==n.GroupType.AnaheimDataTopHit&&n.config.topHitMuse)&&(f="AnaheimDataGroupPopup",h="anaheimDataPopover",e=cu(u)),f){var o=t+"informationBubble",a=h||t+"groupTitlePopover",v=function(){return i.showPopover(n.Host.getLocString(f),e,_ge(o),!0,!0,a,l)},w=function(t,r){if(r==1){v();return}i.showPopover(n.Host.getLocString(f),e,_ge(o),!0,!1,a,l)};s={subItem:{id:o,selected:!1,selectedStyleSuspended:!1,narratorText:"",tooltip:"",text:"",onSelected:v},onMouseEnter:w}}return s}var ot=4,st=6,a=8,r=12,ht=1,u=20,v=n.config.useCobaltCSS?20:16,yi=n.config.useCobaltCSS?20:16,pi=n.config.useCobaltCSS?42:u+2*a,ct=n.config.useCobaltCSS?40:yi+2*a,wi=n.config.useCobaltCSS?40:ct,lt=n.config.useCobaltCSS?70:60,bi=n.config.useCobaltCSS?50:u+2*r,ki=n.config.useCobaltCSS?70:u+v+ot+2*r,di=n.config.useCobaltCSS?88:u+2*(v+ot)+2*r,gi=80+2*r,nr=n.config.useCobaltCSS?18:a,at=u,tr=n.config.useCobaltCSS?58:48,vt=48,y=1,yt=n.IconSize_GridLayout+2*(st+ht),pt=n.IconSize_GridLayout_Medium+2*(st+ht),ir=n.config.useCobaltCSS?44:32,rr=8,ur=n.config.useCobaltCSS?139:140,fr=156,p=8,er=n.config.useCobaltCSS?572:600,or=510,sr=400,hr=350,o=184,w=692,cr=628,lr=565,ar=501,vr=6,wt=200,bt=3,kt=4,yr=n.config.useCobaltCSS?33:39,pr=n.config.useCobaltCSS?33:42,b={},k="runas",d="tabletmode_opennewwindow",dt="tile.uninstall",gt="startpin",g="taskbarpin",ni="startunpin",nt="taskbarunpin",ti="MRUNoItemsAvailable",s="launchIndexingOptions",wr="s_copyfullpath",tt="workUpsellDismiss",it="workUpsellButton",ii="dynamic-pane-iframe",rt="ws-pills-see-more-less",h=[{id:"FlyoutNextButton",selected:!1,text:null},{id:"FlyoutButton",selected:!1,text:null},{id:"FlyoutHyperLinkButton",selected:!1,text:null},{id:"FlyoutDismissFooterButton",selected:!1,text:null},{id:"flyoutDismissIcon",selected:!1,text:null}],c={id:"SearchBox",selected:!1,text:"SearchBox"},br={id:tt,selected:!1,text:null},kr={id:it,selected:!1,text:null},dr=[br,kr],gr={id:rt,selected:!1,text:null},ut=1,ft="WorkUpsellInfo",t={},ri,ui,vi;t[k]={content:"&#xE7EF",type:1};t.runasuser={content:"&#xE7EE",type:1};t.openinbrowser={content:"&#xE774",type:1};t.openfilelocation={content:"&#xE838",type:2};t.opencontaining={content:"&#xE838",type:2};t[d]={content:"&#xE8A7",type:2};t[ni]={content:"&#xE77A",type:1};t[nt]={content:"&#xE77A",type:1};t[gt]={content:"&#xE718",type:2};t[g]={content:"&#xE718",type:2};t.settings={content:"&#xE713",type:2};t.manage={content:"&#xE912",type:1};t.review={content:"&#xE728",type:2};t.share={content:"&#xE72D",type:1};t.connectnetworkdrive={content:"&#xE8CE",type:1};t.disconnectnetworkdrive={content:"&#xE8CD",type:1};t.uninstall={content:"&#xE74D",type:2};t[dt]={content:"&#xE74D",type:2};t.itemproperties={content:"&#xF106",type:2};ri=function(){var t={};return t[n.GroupType.PathCompletion]="GPT",t[n.GroupType.Store]="GT",t[n.GroupType.SearchSuggestions]="GW",t[n.GroupType.WelcomeExperience]="WWE",t[n.GroupType.MRUHistory]="MRUH",t[n.GroupType.QuickSearch]="QSCH",t[n.GroupType.CuratedSuggestions]="DFLS",t[n.GroupType.CuratedSettings]="CUSE",t[n.GroupType.MSNNews]="MSNN",t[n.GroupType.VisualSearch]="SNSC",t}();ui=["Bookmark","Building","Person","Qna","File","Group"];n.extendVerbs=iu;n.getVerbsAsync=fi;n.wrapsToTwoLines=e;n.joinVerbs=et;n.getGroupTitleAndNarratorText=li;n.getGroupPopover=ai;vi=function(){function t(t,i,r,u,f,e,o,s){var h=this;this._autoComplete=t;this._navigationHelper=i;this._page=r;this._previewPane=u;this._menuFactory=f;this._upsellViewModel=e;this._popoverFactory=o;this._headerFooterViewModel=s;this._pendingSubmitSequenceNumber=-1;this._pendingSubmitModifierKeys=null;this._pendingSubmitTimeStamp=null;this._itemLaunchEventHandlers=[];this._conversationEndsHandlers=[];this.groups=[];this.topResults=[];this._lastUpdatedSequenceNumber=-1;this._topResultsRenderingDisabled=!1;this._groupRenderingDisabled=!1;this._resultsCounter={topResults:[],groups:[]};this._shouldHideWorkUpsell=!1;this._pendingSuggestionsInExistingGroups=[];this._pendingSuggestionsInMissingGroups=[];this._lastMiniSerpAutoSuggestion=null;this._addedManualLbshToMru=!1;this.updateExpandedState=function(){var i,t=(i=h.groups)===null||i===void 0?void 0:i.findIndex(function(t){return t.type===n.GroupType.Related});t>-1&&(h.groups[t].isGroupContainerFullyExpanded=!h.groups[t].isGroupContainerFullyExpanded,h._selectedItem.isGroupContainerFullyExpanded=h.groups[t].isGroupContainerFullyExpanded)};n.Host.bindShown(function(){h._selectedItem=null;h._lastMiniSerpAutoSuggestion=null;h._addedManualLbshToMru=!1});r.setSuggestionClickHandler(this.doubleClickGuardedHandler(function(t,i){var r={shiftKey:i===null||i===void 0?void 0:i.shiftKey,ctrlKey:i===null||i===void 0?void 0:i.ctrlKey,altKey:i===null||i===void 0?void 0:i.altKey};n.safeExecute(function(){return h.click(n.getCurrentTime(),t,n.getInputType(i),r)},"suggestionClickHandler")}));r.setContextMenuHandler(function(t,i){n.safeExecute(function(){return h._menuFactory.showContextMenuOnXY(t,i.pageX,i.pageY,function(){return n.Host.setFocusInSearchBox(null,"contextMenuDismiss")},n.getInputType(i))},"contextMenuHandler")});r.setOpenPreviewPaneClickHandler(function(t,i){var r=t;ui.indexOf(r.msbDomain)>-1&&_w.bfbWsbTel&&bfbWsbTel.logQFSuggestionArrowClick(r.msbDomain);n.safeExecute(function(){return h.openPreviewPane(t,i)},"openPreviewPaneClickHandler")});r.setExpanderClickInstrumentation(function(t,i,r){var u="Expander"+(r?"Opened":"Closed"),f={st:i,K:t.instItem.getLayoutKValue()};n.InstrumentationHelper.logClientInstEvent("Select",u,null,f)});this._previewPane&&(this._previewPane.init(this),this._previewPane.bindBeforeItemLaunch(function(t,i,r,u,f,e){return n.InstrumentationHelper.instrumentItemClickForPreviewPane(t,i.instItem,i.sequenceNumber,i.instrumentPingBack,r,null,u,f,e)}),this._previewPane.bindAfterItemLaunch(function(n,t,i){h.onSuggestionLaunch(n,t,i)}));n.Host.bindShown(function(){n.config.setIndexerDefaultValue&&(n.config.searchServiceDisabled=!0);SearchAppWrapper.CortanaApp.queryFormulationView.deviceSearch.getSearchServiceStatusAsync&&n.Async.safeChain("getSearchServiceStatusAsync",function(){return SearchAppWrapper.CortanaApp.queryFormulationView.deviceSearch.getSearchServiceStatusAsync()},function(t){n.InstrumentationHelper.setSearchServiceStatus(fu(t));switch(t){case 1:case 2:case 5:case 6:case 7:n.config.searchServiceDisabled=!0;h.showIndexingMessage(!1);break;case 0:case 4:if(n.config.queryIndexerOnRunningOnly){n.config.searchServiceDisabled=!0;h.showIndexingMessage(!0);break}n.config.searchServiceDisabled=!1;break;case 3:n.config.searchServiceDisabled=!1}})});r.bindOnNarratorLaunch(function(t){for(var i,f=n.getCurrentTime(),e=h.getSelectableItems(),r=0,u=e;r<u.length;r++)if(i=u[r],i.id==t){h.isSuggestionOrGroup(i)?(h.select(i,!1),h.submit(f,!1,i.sequenceNumber,null,!0)):h.isScopeElement(i)&&_ge(i.id).click();break}});n.Host.bindSearchBoxGotFocus(function(){h._menuFactory.dismiss();var t=n.getCurrentActiveElement();t&&t.blur();h._selectedItem&&!h.isScopeElement(h._selectedItem)&&h.renderSelectedSuggestionState(!1)});n.Host.bindSearchBoxLostFocus(function(){var t=h.isScopeTile(n.getCurrentActiveElement());t?n.safeSetTimeout(function(){n.Host.searchBoxHasFocus()||h.isScopeElement(h._selectedItem)||h.renderSelectedSuggestionState(!0)},75,"RootViewModel.bindSearchBoxLostFocus"):h.renderSelectedSuggestionState(!0)});sj_evt.bind("CortanaPaneWidthSet",function(n){return h.onPaneWidthSet(n[1])});sj_be(n.StaticHtmlElements.qfContainer,"scroll",function(){h._menuFactory.dismiss();h._popoverFactory&&h._popoverFactory.dismiss()});this._iconRenderInfos=[]}return t.prototype.isScopeTile=function(n){return n&&n.classList.contains("scope-tile")},t.prototype.shouldAddLastAutoSuggToMRU=function(){var i,r,t;return!n.config.disableMRULBSHIncludeAutoMiniSerp&&!this._addedManualLbshToMru&&this._lastMiniSerpAutoSuggestion&&n.getGroupType(this._lastMiniSerpAutoSuggestion)==n.GroupType.SearchSuggestions&&(t=(r=(i=this._partialQuery)===null||i===void 0?void 0:i.queryToFetch)===null||r===void 0?void 0:r.trim(),(t===null||t===void 0?void 0:t.length)>=n.config.minQueryLengthForMiniSerpAutoSuggestion||(t===null||t===void 0?void 0:t.split(" ").length)>1)?!0:!1},t.prototype.onDismiss=function(){this.shouldAddLastAutoSuggToMRU()&&this.addLastMiniSerpAutoSuggestionToMru();this.topResults=[];this.renderTopResults(!0);this.groups=[];this.renderGroups(!0);this._partialQuery=null;this._lastUpdatedSequenceNumber=-1;this._pendingSuggestionsInExistingGroups=[];this._pendingSuggestionsInMissingGroups=[];this.toggleProgressBar(!1);this._menuFactory.dismiss();this._previewPane&&n.RuntimeConfig.PreviewPaneAvailable&&this._previewPane.dismiss();this._page.hideTemporaryMessage();this.hideIndexingMessage();n.DialogBox&&n.DialogBox.hide();this._headerFooterViewModel&&this._headerFooterViewModel.render(null,!1,!1,!1,!0);n.Host.setSearchBoxGlyphIcon()},t.prototype.bindItemLaunch=function(n){this._itemLaunchEventHandlers.push(n)},t.prototype.bindConversationEnds=function(n){this._conversationEndsHandlers.push(n)},t.prototype.onPaneWidthSet=function(n){kt=Math.floor((n-2*y)/pt);bt=Math.floor((n-2*y)/yt)},t.prototype.setSelectedStyleSuspended=function(t,i){t.selectedStyleSuspended=i&&n.Host.isRequestFocusAvailable()},t.prototype.renderSelectedSuggestionState=function(n){this._selectedItem&&(this.setSelectedStyleSuspended(this._selectedItem,n),this.renderSelection(this._selectedItem))},t.prototype.toggleProgressBar=function(t){var i=this;n.config.dataSourcesWithProgressBar.length>0&&(this._progressTimer&&(sb_ct(this._progressTimer),this._progressTimer=null),t?(this._partialQuery.showProgressBar||this._partialQuery.queryToFetch=="")&&(this._progressTimer=n.safeSetTimeout(function(){i._progressTimer&&(i._page.setProgressIndicatorVisibility(!0),i._progressTimer=null)},250,"showProgress")):n.config.dataSourcesWithProgressBar.length>0&&(this._progressTimer&&(sb_ct(this._progressTimer),this._progressTimer=null),this._page.setProgressIndicatorVisibility(!1)))},t.prototype.resetPendingSubmitSequenceNumber=function(){this._pendingSubmitSequenceNumber=null;this._pendingSubmitModifierKeys=null;this._pendingSubmitTimeStamp=null},t.prototype.onAfterKeyDown=function(t,i,r,u){var a,v,y,o,e,b,c,f,l,k,d,p,w;if(!this._partialQuery||!this._menuFactory.isMenuVisible()&&(!this._popoverFactory||!this._popoverFactory.isPopoverVisible())&&t==13&&this._partialQuery.scope!==n.Scope.Work)return!1;if(o=i&&i.shiftKey,n.DialogBox&&n.DialogBox.isVisible())return t!=9||u||this.handleCrossViewModelsTabKeyNavigation(null,o),!0;if(e=this._previewPane&&this._previewPane.hasFocus(),b="rvm onAfterKeyDown",this._page.hideTemporaryMessage(),this.resetPendingSubmitSequenceNumber(),!r&&n.isContextMenuKey(t,o)&&!e)return this.tryShowContextMenuOnSelectedSuggestion(),!0;if(this._menuFactory.isMenuVisible()){if(t==37||t==39||t==13||n.isUpOrDownKey(t)){if(c=this._menuFactory.onAfterKeyDown(t,i,r,u),c)return!0;if(n.isUpOrDownKey(t))return!1}else if(t==9)return this._menuFactory.dismiss(!0),!0;this._menuFactory.dismiss(!0)}if(this._popoverFactory&&this._popoverFactory.isPopoverVisible()){if(t==37||t==39||t==13||n.isUpOrDownKey(t)){if(c=this._popoverFactory.onAfterKeyDown(t,i,r,u),c)return!0;if(t==37||t==39)return!1}this._popoverFactory.dismiss(!1)}if((n.RuntimeConfig.QfMode==0||n.RuntimeConfig.QfMode==1)&&(f=this._selectedItem,f&&f.removeIcon&&f.selected)){if(t==39)return f.removeIcon.selected=!0,this.renderSelectedSuggestionState(!0),!0;if(t==46&&f.removeIcon.selected)return f.removeIcon.click(n.getCurrentTime(),1),!0;f.removeIcon.selected=!1;this.renderSelection(f)}if(n.RuntimeConfig.QfMode==5&&t==46)return(f=this._selectedItem,f&&f.removeIcon)?(f.removeIcon.click(n.getCurrentTime(),1),!0):!1;if(l=n.getCurrentActiveElement(),!this.isScopeTile(l)||e||this._menuFactory.isMenuVisible()||this._popoverFactory&&this._popoverFactory.isPopoverVisible()||t!=39&&t!=37){if(t==9)if(n.config.allowTabToSelectSuggestions||o||!this._selectedItem||e||this.isScopeElement(this._selectedItem))if(u){if(n.RuntimeConfig.PreviewPaneAvailable&&this._previewPane&&this._selectedItem&&!this.isScopeElement(this._selectedItem)){this._previewPane.onAfterKeyDownWhenNewSelection(t,this._partialQuery,this._selectedItem);if(e)return!0}}else this.handleCrossViewModelsTabKeyNavigation(l,o);else this.select(this._headerFooterViewModel.getSelectableItems()[0],!1);else if(n.RuntimeConfig.PreviewPaneAvailable&&this._previewPane&&this._selectedItem&&!this.isScopeElement(this._selectedItem)){this._previewPane.onAfterKeyDownWhenNewSelection(t,this._partialQuery,this._selectedItem);if(e)return!0}}else k=n.getRtlAdjustedKey(t),this._headerFooterViewModel.focusNextScopeTile(l,k==39),d=this._headerFooterViewModel.getSelectableItems(),this.select(d[0],!1);return e=this._previewPane&&this._previewPane.hasFocus(),this._selectedItem&&(n.isUpOrDownKey(t)||t==9||n.config.msbDsbTabNavigation&&this.isDSBItem(this._selectedItem)&&this.isLeftRightArrowKey(t))&&!e&&(p=this.isScopeElement(this._selectedItem),p||this._selectedItem==this.topResults[0]?this._page.scrollToTop():this._page.scrollTo(this._selectedItem,n.isWin11DSB(this._partialQuery),this.isWorkScope()),w=b+"-AdjustFocus",p||this.isAdvancedOption(this._selectedItem)||this.isFlyout(this._selectedItem)?(this.isAdvancedOption(this._selectedItem)&&this._selectedItem.id!==s?(a=_ge(this._selectedItem.id))===null||a===void 0?void 0:a.querySelector("input").focus():(v=_ge(this._selectedItem.id))===null||v===void 0?void 0:v.focus(),n.Host.searchBoxHasFocus()&&n.Host.setFocusInWebView(w)):this._selectedItem.id==ii?(this._DSBIframeSelected=!0,n.dsbManager.focus()):this.isDSBItem(this._selectedItem)||this._selectedItem.id==tt||this._selectedItem.id==it||this.isWorkScope()&&this._selectedItem.type===n.GroupType.Related||this._selectedItem.id==rt?(y=_ge(this._selectedItem.id))===null||y===void 0?void 0:y.focus():t!=9&&n.Host.searchBoxHasFocus()||n.Host.setFocusInSearchBox(t,w)),this.isFlyoutVisible()&&h.indexOf(this._selectedItem)>=0&&(t==39?this.selectNextFlyoutItem(1):t==37&&this.selectNextFlyoutItem(-1)),!1},t.prototype.isFlyoutVisible=function(){return n.config.enableEducationalFlyout&&!n.StaticHtmlElements.flyoutContainer.classList.contains("b_hide")},t.prototype.selectNextFlyoutItem=function(n){if(this.isFlyoutVisible()){var t=h.filter(function(n){return _ge(n.id)}),r=t.indexOf(this._selectedItem),i=(r+n)%t.length;this._selectedItem=t[i>=0?i:t.length-1];_ge(this._selectedItem.id).focus()}},t.prototype.handleCrossViewModelsTabKeyNavigation=function(t,i){var y=n.RuntimeConfig.PreviewPaneAvailable&&!!this._previewPane,h=y&&this._previewPane.isOpened(),p=h&&this._previewPane.hasFocus(),o,c,l,e,s,u,a,v,r,f;if(n.DialogBox&&n.DialogBox.isVisible())o=n.DialogBox.getSelectableItemsByGroup(),i?this.select(o[o.length-1][0],!1):this.select(o[0][0],!1);else if(p)if(i)this._previewPane.blur(),f=null,this._headerFooterViewModel&&(c=this._headerFooterViewModel.getSelectableItemsByGroup(),f=c[c.length-1][0]),this.select(f,!1);else{this._previewPane.blur();u=this.getSelectableItems();this.select(u[0],!0);this._previewPane.onAfterKeyDownWhenNewSelection(9,this._partialQuery,u[0])}else this.isScopeTile(t)?(l=!1,n.dsbManager&&i&&(r=n.dsbManager.getSelectableItemsByGroup(),r.length>0&&(s=r[r.length-1][0],this.select(s,!1),l=!0)),l||(!h||i?(e=this.getSelectableSuggestionsByGroup(),e.length>0?(s=i?e[e.length-1][0]:e[0][0],this.select(s,!0)):(u=this.getSelectableItems(),u.length>0?this.select(u[0],!0):this.select(null,!0)),a="handleCrossBordersNavigationWithTab",n.safeSetTimeout(function(){return n.Host.setFocusInSearchBox(9,a)},0,a)):(this.select(this._previewPane.getPreviewedSuggestion(),!0),this._previewPane.focus(!0)))):this._selectedItem?this._selectedItem.id==ii?this._DSBIframeSelected?(this._DSBIframeSelected=!1,r=this.getSelectableItemsByGroup(),v=r[0][0],this.select(v,!1)):(this._DSBIframeSelected=!0,n.dsbManager.focus()):i?h?this._previewPane.focus():(r=this.getSelectableItemsByGroup(),f=r[r.length-1][0],this.select(f,!1)):this.select(this.getSelectableItemsByGroup()[0][0],!1):this.select(this.getSelectableItemsByGroup()[0][0],!1)},t.prototype.tryShowContextMenuOnSelectedSuggestion=function(t){var r=this,i=this._selectedItem&&this.isSuggestion(this._selectedItem)?this._selectedItem:null;i&&n.safeExecute(function(){return r._menuFactory.showContextMenuOnElement(i,_ge(i.id),function(){return n.Host.setFocusInSearchBox(null,"contextMenuDismiss")},t)},"contextMenuHandler")},t.prototype.onQueryChanged=function(t,i){var h=this,c,f,u,e,o,l,a,s,v,r,y;if(n.DialogBox&&n.DialogBox.hide(),this._menuFactory.dismiss(),!this._partialQuery||!this._partialQuery.equals(t)){if(this._page.hideTemporaryMessage(),n.config.dataSourcesWithProgressBar.length>0&&(this._progressTimer&&(sb_ct(this._progressTimer),this._progressTimer=null),t.showProgressBar?this._progressTimer=n.safeSetTimeout(function(){h._progressTimer&&(h._page.setProgressIndicatorVisibility(!0),h._progressTimer=null)},250,"showProgress"):this._page.setProgressIndicatorVisibility(!1)),this._partialQuery&&this._partialQuery.scope!=t.scope&&(this._turnOnIndexingInstItem||this.hideIndexingMessage()),f=this._partialQuery?this._partialQuery.queryToFetch:"",u=t.queryToFetch,this._previewPane&&n.RuntimeConfig.PreviewPaneAvailable)this._previewPane.onQueryChanged(t);for(this._partialQuery=t,e=!1,o=0,l=this.topResults;o<l.length;o++)r=l[o],r.updateFromQuery&&!r.hasPreviewPaneOpened?r.updateFromQuery(t)&&(e=!0):u.length>f.length&&u.startsWith(f)&&r.query.toLowerCase().includes(t.queryToFetch.toLowerCase())&&(a=r.text.indexOf(HitHighlightingParser.endMarker),a>=0&&a<r.text.length-1&&(r.text=HitHighlightingParser.addMarkers(HitHighlightingParser.removeMarkers(r.text),u),e=!0));if(e){for(s=0,v=this.topResults;s<v.length;s++)r=v[s],r.sequenceNumber=i,this.updateNarratorWithPreviewMessage(r);this.renderTopResults()}y=n.RuntimeConfig.EntryPointApp==1;n.config.scopeWithBackground&&u===""&&f.length>=1&&!y&&((c=this._headerFooterViewModel)===null||c===void 0?void 0:c.scopesSliderReset());this.resetIconTimers();this._iconRenderInfos=[]}},t.prototype.onSuggestionsParsed=function(t,i,r,u,f){var o=t.enabledDataSources[r].groupType,s,a,h,v,c,y,l,p,e;if(o===n.GroupType.QuickWorkSearch&&typeof n.qwsShowTopList=="function"&&n.qwsShowTopList()&&t.isSearchHomeZI)for(s=0,a=f;s<a.length;s++)e=a[s],e.staticGroupType=e.msbDomain==="Person"?n.GroupType.QuickWorkSearchTopList:o;else if(o===n.GroupType.AnaheimDataList)for(h=0,v=f;h<v.length;h++)e=v[h],e.staticGroupType=n.config.enableAnaheimDataTSTile&&e.type=="ANAT"?n.GroupType.AnaheimDataTile:o;else if(o===n.GroupType.SearchSuggestions)for(c=0,y=f;c<y.length;c++)e=y[c],e.staticGroupType=n.config.topHitMuse&&e.type=="ANATH"?n.GroupType.AnaheimDataTopHit:o;else if(typeof o=="number")for(l=0,p=f;l<p.length;l++)e=p[l],e.staticGroupType=o;(u==="NI"||u==="PI")&&(r=="PP"||r=="ST"||t.scope!=n.Scope.All)&&n.RuntimeConfig.ScopesAvailable&&t.scope!=n.Scope.Web&&this.showIndexingMessage(!0)},t.prototype.areSuggestionsPresent=function(){return this.topResults.length>0||this.groups.length>0&&this.groups.some(function(n){return n.suggestions.length>0})},t.prototype.isWorkScope=function(){var t;return n.config.msbNewWorkScopeEnabled&&((t=this._partialQuery)===null||t===void 0?void 0:t.scope)===n.Scope.Work},t.prototype.getSuggestions=function(n){var t=this.getCurrentTopResults();return this.groups.forEach(function(n){return t=t.concat(n.suggestions)}),n&&(this._pendingSuggestionsInExistingGroups.forEach(function(n){return t=t.concat(n.suggestions)}),this._pendingSuggestionsInMissingGroups.forEach(function(n){return t=t.concat(n.suggestions)})),t},t.prototype.getSelectableItems=function(){var f,e,o,t,u,s,i,r;if(n.DialogBox&&n.DialogBox.isVisible())return n.DialogBox.getSelectableItems();if(this._menuFactory.isMenuVisible())return this._menuFactory.getSelectableItems();if(this._previewPane&&this._previewPane.hasFocus())return this._previewPane.getSelectableItems();if(!n.config.msbDsbTabNavigation&&typeof n.msbDsbHost=="object"&&n.msbDsbHost.hasFocus())return[];for(t=[],this._launchIndexingDataModel&&t.push(this._launchIndexingDataModel.action),t.push.apply(t,this.topResults),u=0,s=this.groups;u<s.length;u++)i=s[u],i.click&&t.push(i),i.popover&&t.push(i.popover.subItem),this.isWorkScope()&&i.type===n.GroupType.Related&&i.isGroupContainerCollapsed||(r=i.suggestions.filter(function(n){return!n.suppressed}),i.maxSuggestionsToShow!=undefined&&(r===null||r===void 0?void 0:r.length)>i.maxSuggestionsToShow&&!i.isGroupContainerFullyExpanded&&(r=r.slice(0,i.maxSuggestionsToShow)),r.forEach(function(n){n.unselectable||t.push(n);n.subItems&&t.push.apply(t,n.subItems.filter(function(n){return!n.disabled}))}));return!this.isWorkScope()||!n.config.msbWorkScopePillsEnabled||((f=this._selectedItem)===null||f===void 0?void 0:f.isGroupContainerCollapsed)||t.push(gr),n.dsbManager&&t.push.apply(t,n.dsbManager.getSelectableItems()),this.areSuggestionsPresent()||t.push(c),this._headerFooterViewModel&&t.push.apply(t,this._headerFooterViewModel.getSelectableItems()),!this.shouldShowWorkUpsellMessage()||((o=(e=n.StaticHtmlElements.workUpsellBanner)===null||e===void 0?void 0:e.className)===null||o===void 0?void 0:o.includes("b_hide"))||t.push.apply(t,dr),t},t.prototype.getSelectableSuggestionsByGroup=function(){var i=this,t;return n.config.allowTabToSelectSuggestions?(t=[],t.push(this.topResults),this.groups.forEach(function(r){if(r.click&&t.push([r]),r.popover&&t.push([r.popover.subItem]),!(i.isWorkScope()&&r.type===n.GroupType.Related&&r.isGroupContainerCollapsed)){var f=[],u=r.suggestions.filter(function(n){return!n.suppressed});r.maxSuggestionsToShow!=undefined&&(u===null||u===void 0?void 0:u.length)>r.maxSuggestionsToShow&&!r.isGroupContainerFullyExpanded&&(u=u.slice(0,r.maxSuggestionsToShow));u.forEach(function(n){n.unselectable||f.push(n);n.subItems&&f.push.apply(f,n.subItems.filter(function(n){return!n.disabled}))});t.push(f)}}),t.filter(function(n){return n.length>0})):[]},t.prototype.getSelectableItemsByGroup=function(){if(n.DialogBox&&n.DialogBox.isVisible())return n.DialogBox.getSelectableItemsByGroup();if(this._menuFactory.isMenuVisible())return this._menuFactory.getSelectableItemsByGroup();if(this._previewPane&&this._previewPane.hasFocus())return this._previewPane.getSelectableItemsByGroup();var t=[];return this.isFlyoutVisible()&&t.push([h.find(function(n){return!!_ge(n.id)})]),this._headerFooterViewModel&&t.push.apply(t,this._headerFooterViewModel.getSelectableItemsByGroup()),this._launchIndexingDataModel&&t.push([this._launchIndexingDataModel.action]),this.areSuggestionsPresent()?(t.push.apply(t,this.getSelectableSuggestionsByGroup()),n.dsbManager&&t.push.apply(t,n.dsbManager.getSelectableItemsByGroup())):(n.dsbManager&&t.push.apply(t,n.dsbManager.getSelectableItemsByGroup()),t.push([c])),t},t.prototype.getSelectedItem=function(){return n.DialogBox&&n.DialogBox.isVisible()?n.DialogBox.getSelectedItem():this._menuFactory.isMenuVisible()?this._menuFactory.getSelectedItem():this._previewPane&&this._previewPane.hasFocus()?this._previewPane.getSelectedItem():this._selectedItem?this._selectedItem:c},t.prototype.updateSelectionState=function(t){n.contains(this.topResults,t)?this.renderTopResults():this.groups.some(function(i){return n.contains(i.suggestions,t)})&&this.renderGroups()},t.prototype.updateLastMiniSerpAutoSuggestion=function(n){this._lastMiniSerpAutoSuggestion=n},t.prototype.addLastMiniSerpAutoSuggestionToMru=function(){var n=this;this._conversationEndsHandlers.forEach(function(t){return t(n._lastMiniSerpAutoSuggestion,n._partialQuery)})},t.prototype.isSubItem=function(n){return n&&typeof n.itemView!="undefined"},t.prototype.getSuggestionById=function(n){for(var i,t=0;t<this.groups.length;t++)for(i=0;i<this.groups[t].suggestions.length;i++)if(this.groups[t].suggestions[i].id==n)return this.groups[t].suggestions[i];return null},t.prototype.selectGroupItem=function(n){for(var s,r,e,u,o,t,i=0,f=this.groups;i<f.length;i++)for(s=f[i],r=0,e=s.suggestions;r<e.length;r++)t=e[r],t.reactKey==n.reactKey?(t.selected=!0,this._selectedItem=t):t.selected=!1;for(u=0,o=this.topResults;u<o.length;u++)t=o[u],t.reactKey==n.reactKey?(t.selected=!0,this._selectedItem=t):t.selected=!1},t.prototype.doesGroupsContain=function(n){for(var f,i,u,e,t=0,r=this.groups;t<r.length;t++)for(f=r[t],i=0,u=f.suggestions;i<u.length;i++)if(e=u[i],e.reactKey==n.reactKey)return!0;return!1},t.prototype.renderSelection=function(t,i){var r,u,f,e;this.updateGroupSuggestion(i);this.isSubItem(t)&&(t=this.getSuggestionById(t.suggestionId));i&&this.isSubItem(i)&&(i=this.getSuggestionById(i.suggestionId));(t&&this.isSuggestion(t)&&n.contains(this.topResults,t)||i&&this.isSuggestion(i)&&n.contains(this.topResults,i))&&(this.renderTopResults(),this.groups&&(i&&i.handoffType===21||((r=this.groups[0])===null||r===void 0?void 0:r.suggestions)&&((u=this.groups[0].suggestions[0])===null||u===void 0?void 0:u.handoffType)===21)&&this.renderGroups());this._headerFooterViewModel&&(t&&this.isAdvancedOption(t)||i&&this.isAdvancedOption(i))&&this._headerFooterViewModel.updateTopHitHeader();t&&((e=(f=this._launchIndexingDataModel)===null||f===void 0?void 0:f.action)===null||e===void 0?void 0:e.id)===s&&this._page.updateTemporaryMessageView(this._launchIndexingDataModel);(t&&n.isGroup(t)&&n.contains(this.groups,t)||t&&this.isSuggestion(t)&&this.doesGroupsContain(t)||i&&n.isGroup(i)&&n.contains(this.groups,i)||i&&this.isSuggestion(i)&&this.groups.some(function(t){return n.contains(t.suggestions,i)}))&&this.renderGroups()},t.prototype.updateGroupSuggestion=function(n){var t,i;n&&n.handoffType===21&&this.groups&&(t=this.groups.findIndex(function(t){return t.type===n.groupType}),t>-1&&(i=this.groups[t].suggestions.findIndex(function(t){return t.id===n.id}),i>-1&&(this.groups[t].suggestions[i].selected=!1)))},t.prototype.renderGroups=function(t){var r,i;this._partialQuery&&(i=this._partialQuery.queryToFetch?n.config.maxSuggestionsPerGroup:0,i&&i>0&&this.groups.forEach(function(n,t,r){r[t].suggestions=n.suggestions.slice(0,i)}));this._groupRenderingDisabled||(((r=this._contentQuery)===null||r===void 0?void 0:r.scope)==n.Scope.All&&(this.adjustMsbGroups(),this.limitWebSuggestions()),this._page.updateGroupsView({query:this._contentQuery,topResults:this.topResults,groups:this.groups},t,this.isWorkScope()&&this.updateExpandedState),n.InstrumentationHelper.updateSuggestionsList(this.topResults,this.groups))},t.prototype.limitWebSuggestions=function(){var i,r;if(n.config.msbEnableSearchTheWebMaxSuggestionsPresent&&(i=this.topResults.filter(function(t){return n.isMsbQFSuggestion(t)||n.isWebSuggestion(t)||t.isAnswer}).length>0,r=this.groups.filter(function(t){return t.suggestions.filter(function(t){return n.isMsbQFSuggestion(t)&&!t.suppressed}).length>0}).length>0,!i&&r)){var u=[n.GroupType.SearchSuggestions,n.GroupType.Websites],f=this.groups.filter(function(t){return n.contains(u,t.type)}),t=[];f.forEach(function(n){return t.push.apply(t,n.suggestions)});n.limitWebSuggestions(this._partialQuery,[],t,u,[])}},t.prototype.adjustMsbGroups=function(){this.msbGroupsSuppressDefault();this.msbGroupsMergeDocsIntoQws();this.msbGroupsSetupTopList();this.msbGroupsSetLayout()},t.prototype.msbGroupsSuppressDefault=function(){var t;if(typeof n.enableQws=="function"&&n.enableQws()&&((t=this._contentQuery)===null||t===void 0?void 0:t.isSearchHomeZI)){var i=this.groups.filter(function(t){return t.type===n.GroupType.QuickWorkSearchTopList})[0],r=this.groups.filter(function(t){return t.type===n.GroupType.QuickWorkSearch})[0],u=this.groups.filter(function(t){return t.type===n.GroupType.RecommendedDocs})[0],f=this.groups.filter(function(t){return t.type===n.GroupType.QuickWorkQueriesTopList})[0];(i||r||u||f)&&(this.groups=this.groups.filter(function(t){return t.type!==n.GroupType.TopApps&&t.type!==n.GroupType.QuickSearch&&t.type!==n.GroupType.CuratedSettings}))}},t.prototype.getMaxMsbItems=function(){var i,r=this.getMaxNumberOfRecentItems(n.GroupType.CuratedSuggestions),t;return typeof n.qwsShowTopList=="function"&&n.qwsShowTopList()&&(t=this.groups.filter(function(t){return t.type===n.GroupType.QuickWorkSearchTopList||t.type===n.GroupType.QuickWorkQueriesTopList})[0],((i=t===null||t===void 0?void 0:t.suggestions)===null||i===void 0?void 0:i.length)>0)?r-2:r},t.prototype.msbGroupsMergeDocsIntoQws=function(){var s,f,e,o,t;if(typeof n.enableQwsRecDocs=="function"&&n.enableQwsRecDocs()&&((f=this._contentQuery)===null||f===void 0?void 0:f.isSearchHomeZI)){var u=this.groups.filter(function(t){return t.type===n.GroupType.QuickWorkSearch})[0],i=this.groups.filter(function(t){return t.type===n.GroupType.RecommendedDocs})[0],r=this.groups.filter(function(t){return t.type===n.GroupType.MsbOnRampButton})[0];if(u&&((e=i===null||i===void 0?void 0:i.suggestions)===null||e===void 0?void 0:e.length)>0){t=u.suggestions;n.isMsbQwsDocsCacheEnabled(this._partialQuery)&&(t=t.filter(function(n){return n.type!=="FL"}));var h=i.suggestions.slice(0,n.config.ziRecommendedDocsResultsCount),c=this.getMaxMsbItems(),l=c-h.length;t=t.slice(0,l);t.push.apply(t,h);r&&(r.suggestions[0].suppressed=!1,t.push.apply(t,r.suggestions),this.groups=this.groups.filter(function(t){return t.type!==n.GroupType.MsbOnRampButton}));u.suggestions=t;this.groups=this.groups.filter(function(t){return t.type!==n.GroupType.RecommendedDocs});this.groups.filter(function(t){return t.type===n.GroupType.QuickWorkSearch}).map(function(n){return n.instRegionName="QuickWorkSearchWithRecDocs"})}!u&&((o=i===null||i===void 0?void 0:i.suggestions)===null||o===void 0?void 0:o.length)>0&&r&&(r.suggestions[0].suppressed=!1,(s=i.suggestions).push.apply(s,r.suggestions),this.groups=this.groups.filter(function(t){return t.type!==n.GroupType.MsbOnRampButton}))}},t.prototype.msbGroupsSetupTopList=function(){var r,u,t,f,e,i;typeof n.qwsShowTopList=="function"&&n.qwsShowTopList()&&((r=this._contentQuery)===null||r===void 0?void 0:r.isSearchHomeZI)&&(t=this.groups.filter(function(t){return t.type===n.GroupType.QuickWorkSearchTopList||t.type===n.GroupType.QuickWorkQueriesTopList})[0],t&&(f=this.groups.filter(function(t){return t.type===n.GroupType.QuickWorkSearch})[0],f&&(f.hideGroupHeader=!0),e=this.groups.filter(function(t){return t.type===n.GroupType.RecommendedDocs})[0],e&&(e.hideGroupHeader=!0),t.cssClasses="".concat(t.cssClasses||""," msbQwsTop"),i=this.groups.filter(function(t){return t.type===n.GroupType.QuickWorkQueriesTopList})[0],i&&((u=i===null||i===void 0?void 0:i.suggestions)===null||u===void 0?void 0:u.length)>0&&(t.cssClasses="".concat(t.cssClasses||""," msbQwqTop"))))},t.prototype.msbGroupsSetLayout=function(){var u,t,i,r;typeof n.qwsShowTopList=="function"&&n.qwsShowTopList()&&((u=this._contentQuery)===null||u===void 0?void 0:u.isSearchHomeZI)&&n.RuntimeConfig.AlwaysWide&&(t=this.groups.filter(function(t){return t.type===n.GroupType.QuickWorkSearch})[0],t?t.cssClasses="".concat(t.cssClasses||""," colRight fbig"):typeof n.qwsShowTopList=="function"&&n.qwsShowTopList()&&(i=this.groups.filter(function(t){return t.type===n.GroupType.RecommendedDocs})[0],i&&(i.cssClasses="".concat(i.cssClasses||""," colRight fbig"))),r=this.groups.filter(function(t){return t.type===n.GroupType.QuickWorkSearchTopList||t.type===n.GroupType.QuickWorkQueriesTopList})[0],r&&(r.cssClasses="".concat(r.cssClasses||""," colRight fbig")))},t.prototype.select=function(t,i){var f,e,o,s,h,r,u;(n.cohortProfileManager===null||n.cohortProfileManager===void 0?void 0:n.cohortProfileManager.isTourVisible())&&((f=t===null||t===void 0?void 0:t.id)===null||f===void 0?void 0:f.toLowerCase().search(/flyout/i))==-1||(n.DialogBox&&n.DialogBox.isVisible()?n.DialogBox.select(t):this._menuFactory.isMenuVisible()&&n.contains(this._menuFactory.getSelectableItems(),t)?this._menuFactory.select(t,!1):this._previewPane&&n.contains(this._previewPane.getSelectableItems(),t)?this._previewPane.select(t,!1):(r=this._selectedItem,r&&(r.selected=!1,n.config.msbNewWorkScopeEnabled&&((e=this._partialQuery)===null||e===void 0?void 0:e.scope)===n.Scope.Work&&(r.hasPreviewPaneOpened=!1,(r===null||r===void 0?void 0:r.type)===n.GroupType.Related&&((o=_ge(r.id))===null||o===void 0?void 0:o.blur())),this.setSelectedStyleSuspended(r,!1)),t==c?(this._selectedItem=null,n.Host.searchBoxHasFocus()||n.Host.setFocusInSearchBox(null,"rvm_select")):(this._selectedItem=t,t&&(this.isDSBItem(t)&&n.Host.searchBoxHasFocus()&&n.Host.setFocusInWebView("rvm_dsb_select"),t.selected=!0,n.config.msbNewWorkScopeEnabled&&((s=this._partialQuery)===null||s===void 0?void 0:s.scope)===n.Scope.Work&&(this._selectedItem.hasPreviewPaneOpened=!0),(h=t.onSelected)===null||h===void 0?void 0:h.call(t),this.setSelectedStyleSuspended(t,!n.Host.searchBoxHasFocus()))),i&&t&&(t.arrowOrTabAction=!0),this.renderSelection(this._selectedItem,r),this.isScopeElement(t)&&this._headerFooterViewModel.select(t,!1),i&&(u=t?t.query:null,u&&this._partialQuery.scopePrefix&&(u=this._partialQuery.scopePrefix.trim()+": "+u),n.Host.updateQueryWithoutRefetching(u))))},t.prototype.resetIconTimers=function(n,t){var o=typeof n=="undefined"||!n,s=typeof n=="undefined"||n,i,f,u,e,r;if(o){if(t)for(i=0,f=this._renderGroupsIconsCBs;i<f.length;i++)r=f[i],r();this._renderGroupsIconsCBs=[];this._renderGroupsTimerForIcons&&(sb_ct(this._renderGroupsTimerForIcons),this._renderGroupsTimerForIcons=null)}if(s){if(t)for(u=0,e=this._renderTopResultsIconsCBs;u<e.length;u++)r=e[u],r();this._renderTopResultsIconsCBs=[];this._renderTopResultsTimerForIcons&&(sb_ct(this._renderTopResultsTimerForIcons),this._renderTopResultsTimerForIcons=null)}},t.prototype.setupIcon=function(i,r,u,f){var e=this,o,s,h;if(n.config.noFetchIcons||n.config.reactGroups){f();return}if(o=function(){u.isTopResult?e.renderTopResults():e.renderGroups();e.resetIconTimers(u.isTopResult,!0)},s=function(t){u.iconsPendingReturn==0?(o(),t&&t()):u.isTopResult?(t&&e._renderTopResultsIconsCBs.push(t),e._renderTopResultsTimerForIcons||(e._renderTopResultsTimerForIcons=n.safeSetTimeout(function(){e._renderTopResultsTimerForIcons=null;o()},wt,"renderTRIconsAsync"))):(t&&e._renderGroupsIconsCBs.push(t),e._renderGroupsTimerForIcons||(e._renderGroupsTimerForIcons=n.safeSetTimeout(function(){e._renderGroupsTimerForIcons=null;o()},wt,"renderGRPIconsAsync")))},++u.iconsPendingReturn,!r.suppressed&&r.getIcon)n.InstrumentationHelper.notifyIconPending(i,u.isTopResult),h=this._partialQuery,r.getIcon(t.getImageSize(h,r,u.isTopResult),function(t){r.icon=t;var o=function(){--u.iconsPendingReturn;e._partialQuery&&i==n.SequenceNumberManager.getSequenceNumber()&&(n.InstrumentationHelper.notifyIconReadyOrFailed(i,u.isTopResult),(u.isTopResult&&n.contains(e.topResults,r)||!u.isTopResult&&e.groups.some(function(t){return n.contains(t.suggestions,r)}))&&s(f))};n.populateImageRatio(r.icon,r.type,o)});else if(!r.suppressed&&r.icon&&n.canIconFail(r.icon)){n.InstrumentationHelper.notifyIconPending(i,u.isTopResult);var c=r.icon.getFallbackIcon,l=function(n,t){return t(r.icon)},a=r.icon.isValidSize,v=function(){r.getIcon=c;e.setupIcon(i,r,u,f);n.InstrumentationHelper.notifyIconReadyOrFailed(i,u.isTopResult)},y=function(){r.icon.isSmall=!0;r.getIcon=l;e.setupIcon(i,r,u,f);n.InstrumentationHelper.notifyIconReadyOrFailed(i,u.isTopResult)};r.icon.onIconError=v;r.icon.onIconRendered=function(t,e){a(t,e)||r.icon.isSmall?(n.InstrumentationHelper.notifyIconReadyOrFailed(i,u.isTopResult),f()):y()};--u.iconsPendingReturn;s()}else--u.iconsPendingReturn,f()},t.getImageSize=function(t,i,r){return t.isSearchHomeZI?i.type=="TOPL"?7:8:t.scope==n.Scope.Apps&&!t.queryToFetch?3:n.displayedInGridLayout(i.type)?2:r?0:1},t.prototype.isSuggestionOrGroup=function(n){return!this.isScopeElement(n)},t.prototype.isSuggestion=function(t){return!n.isGroup(t)&&!this.isScopeElement(t)&&!this.isAdvancedOption(t)},t.prototype.isDSBItem=function(n){return!!(n===null||n===void 0?void 0:n.dsb)},t.prototype.isLeftRightArrowKey=function(n){return n==37||n==39},t.prototype.isAdvancedOption=function(n){return typeof n.layout=="number"},t.prototype.isFlyout=function(n){return this.isFlyoutVisible()&&h.indexOf(n)>=0},t.prototype.isBodyOrSuggestion=function(n){return n&&(n.tagName.toLowerCase()=="body"||n.tagName.toLowerCase()=="iframe"||n.className&&n.classList.contains("suggestion"))},t.prototype.submit=function(t,i,r,u,f){var l,a,h=f?5:i?6:1,e=n.getCurrentActiveElement(),o,c,v,y;if(n.DialogBox&&n.DialogBox.isVisible()){n.DialogBox.submit();return}if(this._previewPane&&this._previewPane.hasFocus()){if(o=this._previewPane.getSelectedItem(),o&&o.click&&o.optionType===undefined){o.click(t,h);return}}else if(!this._selectedItem||!this.isScopeElement(this._selectedItem)||this._menuFactory.isMenuVisible()||this._popoverFactory&&this._popoverFactory.isPopoverVisible()){if((n.RuntimeConfig.QfMode==5||n.RuntimeConfig.QfMode==9)&&!this._selectedItem){n.Host.submitFileExplorerTextSuggestion(this._partialQuery.queryToFetch);return}}else{_ge(this._selectedItem.id).click();return}if(c=this._menuFactory.getSelectedItem(),c){c.click&&c.click(t,h,u);return}if(v=this._popoverFactory?this._popoverFactory.getSelectedItem():null,v){this._popoverFactory.submit(v);return}if(((l=this._selectedItem)===null||l===void 0?void 0:l.id)===s){this.click(t,this._selectedItem,h,u);return}if(y=!this.isBodyOrSuggestion(e),y){n.Host.isRequestFocusAvailable()?e.id==it||e.id==tt?e.click():(this._partialQuery.scope===n.Scope.Work&&((a=this._selectedItem.typeWithSource)===null||a===void 0?void 0:a.type)===n.GroupType.Related||this._selectedItem.id==rt)&&e.click():e.click();return}if(this._lastUpdatedSequenceNumber!=r&&(!this._selectedItem||this._selectedItem==this.topResults[0])){this._pendingSubmitSequenceNumber=r;this._pendingSubmitModifierKeys=u;this._pendingSubmitTimeStamp=t;return}this._selectedItem?this.click(t,this._selectedItem,h,u):this.groups.length>0&&this._partialQuery.fullPartialQuery&&this.showDisableEnterMessage()},t.prototype.doubleClickGuardedHandler=function(t){var i;return function(r,u){i&&n.getCurrentTime()-i<=250||(i=n.getCurrentTime(),t(r,u))}},t.prototype.click=function(t,i,r,u){if(this._page.hideTemporaryMessage(),this.isAdvancedOption(i)){i.click&&i.click(t,r,u);return}var f=n.isGroup(i)||this.isSubItem(i)?null:i;if(!i.instItem||f&&f.isReformulation||n.InstrumentationHelper.instrumentItemClick(t,i.instItem,i.sequenceNumber,f?f.instrumentPingBack:null,r,u),!f){i.click&&i.click(t,r,u);return}u=u||n.Host.getModifierKeyState();u.ctrlKey&&u.shiftKey?this.launchVerb(f,k,t):u.shiftKey?this.launchVerb(f,d,t):f.click(t,r,u);this.onSuggestionLaunch(f,this._partialQuery)},t.prototype.onSuggestionLaunch=function(t,i,r){n.isChildSuggestion(t)&&t.parent&&(t=t.parent);this._itemLaunchEventHandlers.forEach(function(n){return n(t,i,r)});n.getGroupType(t)!=n.GroupType.QuickSearch&&(this._addedManualLbshToMru=!0)},t.prototype.launchVerb=function(t,i,r){var u=fi("launchVerb",t,n.config.rawVerbs,!1,function(u){for(var s,h,e=!1,c=function(t){if(t.verb&&t.verb.toLocaleLowerCase()==i.toLocaleLowerCase())return t.executeSync?n.safeExecute(function(){return t.executeSync()},"verb.executeSync",null,i):n.Async.safeChain("verb.executeAsync",function(){return t.executeAsync()},function(){return n.Host.manuallyDismissApp()},null,null,i),e=!0,"break"},f=0,o=u;f<o.length;f++)if(s=o[f],h=c(s),h==="break")break;e||t.click(r,0)},function(){return!0});u||t.click(r,0)},t.prototype.getGroupHeaderClickAction=function(t,i,r){var s=this,u,f,e=null,o=null,h,c;if(n.RuntimeConfig.ScopesAvailable){if(this.isWorkScope())return u=null,i.type===n.GroupType.Related&&(u=function(){var t=s.groups.findIndex(function(t){return t.type===n.GroupType.Related});t>-1&&(s.groups[t].isGroupContainerCollapsed=!s.groups[t].isGroupContainerCollapsed,s._selectedItem.isGroupContainerCollapsed=s.groups[t].isGroupContainerCollapsed)}),[u,null,null,null,null];if(h=n.getScope(i.type),h!=n.Scope.All)if(i.type==n.GroupType.SearchSuggestions&&t.isSearchHomeZI)f=n.Host.getLocString("OpenPrivacyPortalButtonText"),e=n.Host.getLocString("ManageSearchHistory"),u=function(){return n.Host.launchPrivacyPortal()};else return n.isL2(t)||!n.isScopeEnabled(h,n.ScopeConfig[h])?[null,null,null,null,null]:(u=function(){return s._headerFooterViewModel.clickHandler(h,"groupHeader",i)},[u,null,null,null,null])}if(!u)switch(i.type){case n.GroupType.Store:u=function(){return n.Host.launchStoreSearch(t.queryToFetch)};break;case n.GroupType.SearchSuggestions:u=function(){return s.launchSearch(t,r)};break;case n.GroupType.PathCompletion:u=function(){return n.Host.launchFolder(hi(t,s._partialQuery))};break;case n.GroupType.MSNNews:if(!n.config.msnNewsAlternativeUX)return f=n.Host.getLocString("QuickSearchSuggestionsSection"),e=n.Host.getLocString("MSNNewsQuickSearchHover"),u=function(){n.LightweightStorage.setItem(n.currentTabStorageKey,n.MSNNewsTabs.QuickSearches);n.Host.refreshCurrentPane();n.InstrumentationHelper.logClientInstEvent("Select","MSNNewsTabChange",null,{newtab:"QuickSearches"})},[u,null,f,e,o];break;case n.GroupType.Upsell:if(t.isSearchHomeZI)return o={content:"&#xE711",type:2},f=n.Host.getLocString("DismissUpsell"),e=n.Host.getLocString("DismissUpsell"),u=this._upsellViewModel.getDismissButtonAction(),[u,null,f,e,o];break;case n.GroupType.QuickSearch:if(n.config.msnNewsSearch&&n.shouldEnableMSNNewsSearches(n.getCurrentLanguage()))return f=n.Host.getLocString(n.config.msnNewsTitleResource),e=n.Host.getLocString(n.config.msnNewsHoverResource),u=function(){n.LightweightStorage.setItem(n.currentTabStorageKey,n.MSNNewsTabs.News);n.Host.refreshCurrentPane();n.InstrumentationHelper.logClientInstEvent("Select","MSNNewsTabChange",null,{newtab:"MSNNews"})},[u,null,f,e,o];break;case n.GroupType.WelcomeExperience:if(n.config.enableWWETour&&n.RuntimeConfig.PreviewPaneAvailable&&SearchAppWrapper.CortanaApp.height>=615)return o={content:"&#xE711",type:2},f=n.Host.getLocString("DismissUpsell"),e=n.Host.getLocString("DismissUpsell"),u=function(){return s.dismissTour(t)},[u,null,f,e,o];break;case n.GroupType.AnaheimDataTile:if(n.canShowAnaheimDataSHTile())return o={content:"&#xE711",type:2,className:"anaheimDataTileDismissGroup"},f=n.Host.getLocString("DismissAnaheimData"),e=n.Host.getLocString("DismissAnaheimData"),u=function(){n.config.enableAnaheimDataTSTile&&(n.LightweightStorage.setItem("AnaheimDataTSTileDismissed","1"),n.InstrumentationHelper.logClientInstEvent("Select","AnaheimDataTSTileDismissed",null));n.Host.refreshCurrentPane()},[u,null,f,e,o];break;case n.GroupType.AnaheimDataList:if(n.canShowAnaheimDataSHList())return o={content:"&#xE711",type:2,className:"anaheimDataListDismissGroup"},f=n.Host.getLocString("DismissAnaheimData"),e=n.Host.getLocString("DismissAnaheimData"),u=function(){n.config.enableAnaheimDataHS&&(n.LightweightStorage.setItem("AnaheimDataBHListDismissed","1"),n.InstrumentationHelper.logClientInstEvent("Select","AnaheimDataBHListDismissed",null));n.Host.refreshCurrentPane()},[u,null,f,e,o];break;case n.GroupType.PromoBanner:return o={content:"&#xE711",type:2},f=n.Host.getLocString("DismissUpsell"),e=n.Host.getLocString("DismissUpsell"),u=this._upsellViewModel.getDismissButtonAction(),[u,null,f,e,o]}if(u){if(!r)throw"No QS code for: "+n.GroupType[i.type];return c=n.InstrumentedItem.getNonSuggestionInstrumentedItem(r,n.SyntheticQSCodesMaps.KValues),[u,c,f,e,o]}return[null,null,null,null,null]},t.prototype.shouldShowPlusIconInGroupHeader=function(t,i){if(n.getScope(t)==n.Scope.Web||t==n.GroupType.Store)return!1;if(t==n.GroupType.Apps&&this._partialQuery.queryToFetch.length<n.config.minLengthForIBAonL1)return!0;if(t==n.GroupType.Apps||t==n.GroupType.Settings){var r=i[t==n.GroupType.Apps?"PP":"ST"];return!(r&&r.maxedOut)}return!0},t.prototype.shouldHideGroupHeader=function(t,i){var r=i===n.Host.getLocString("MsbVerticalSuggestionGroupName");return n.config.msbNewWorkScopeEnabled&&this._partialQuery.scope===n.Scope.Work&&!r?!n.config.msbWorkScopeGroupHeaderEnabled:t===n.GroupType.QuickSearch&&n.shouldEnableMSNNewsSearches(n.getCurrentLanguage())&&n.canShowMSNNewsTab()?!0:t===n.GroupType.VisualSearch||t===n.GroupType.MSNNews&&n.config.msnNewsAlternativeUX||t===n.GroupType.MsbOnRampButton||r&&!n.config.msbNewWorkScopeEnabled?!0:!1},t.prototype.addGroup=function(t,r,u,f,e){var l,c,d,o,y;if(i(this.groups,t))throw new Error("Trying to add repeated group "+t);var p=ri[t.type],h=this.getGroupHeaderClickAction(this._partialQuery,t,p,r),a=h[0],v=h[1],w=h[2],g=h[3],b=h[4],s=li(this._partialQuery,t.type,r,!!a),k=((l=this._partialQuery)===null||l===void 0?void 0:l.scope)===n.Scope.Work;return t.source&&(c=n.getGroupSourceDisplayName(t.source),c&&!k&&(typeof n.isTenantMsbEnabled=="function"&&n.isTenantMsbEnabled()&&t.source==1&&t.type==n.GroupType.Documents&&(n.config.msbHeaderLabelGroupTypePrefix||n.config.msbHeaderLabelTenantSourcePrefix)?s.title=c+" - "+s.title:s.title+=" - "+c)),d=ai(t.type,this._popoverFactory,this._partialQuery.isSearchHomeZI,u),o=[],n.isTopHitChildGroup(t)&&!k?o.push("topHitConnectedToGroup"):t.type==n.GroupType.TopApps||this._partialQuery.isSearchHomeZI&&t.type==n.GroupType.People||t.type==n.GroupType.AnaheimDataTile?o.push("topItemsGroup"):t.type==n.GroupType.QuickSearch?o.push("balloonSuggGroup"):t.type==n.GroupType.QuickWorkSearch?(o.push("quickWorkSearchGroup"),typeof n.shouldHideTopApp=="function"&&n.shouldHideTopApp()&&n.isQwsSuccessRateThresholdMet()&&n.isMsbEnterprise()&&typeof n.isGccHighTenant=="function"&&!n.isGccHighTenant()&&o.push("topMostGroup")):t.type==n.GroupType.VisualSearch?o.push("snipSuggGroup"):t.type==n.GroupType.MSNNews?o.push("msnNewsGroup"):t.type==n.GroupType.WelcomeExperience?o.push("welcomeExperience"):t.type==n.GroupType.Upsell?(o.push("upsellSuggGroup"),n.shouldEnableAnaheimResetDefault()&&o.push("edgeUpsellDefaultTopBanner")):t.type==n.GroupType.PromoBanner?o.push("skypePromoSuggGroup"):t.type==n.GroupType.MRUHistory||t.type==n.GroupType.CuratedSuggestions?o.push("leftPaneZIsuggestions"):t.type==n.GroupType.RecommendedDocs||t.type==n.GroupType.Documents&&n.isRecommendedDocsGroupEnabled(this._partialQuery)?(o.push("recommendedDocsGroup"),typeof n.shouldHideTopApp=="function"&&n.shouldHideTopApp()&&n.isQwsSuccessRateThresholdMet()&&n.isMsbEnterprise()&&typeof n.isGccHighTenant=="function"&&!n.isGccHighTenant()&&o.push("topMostGroup")):t.type==n.GroupType.AnaheimDataList?o.push("anaheimDataGroup"):t.type==n.GroupType.AnaheimDataTopHit?o.push("anaheimDataGroup"):t.type==n.GroupType.TrendingSearchData?o.push("trendingSearchDataGroup"):t.type==n.GroupType.CuratedSettings&&o.push("curatedSettingsGroup"),n.config.enableMRU10&&!n.config.useCobaltCSS&&(n.isMsbEnterprise()||o.push("mru10")),y={type:t.type,typeWithSource:t,id:"gr"+t.type+(t.source||""),text:s.title,secondaryText:w,secondaryIcon:b,narratorText:s.narratorText,tooltip:g,click:(n.cohortProfileManager===null||n.cohortProfileManager===void 0?void 0:n.cohortProfileManager.isTourVisible())?null:a,onlyAnnotationIsClickable:a&&(!!w||!!b),suggestions:[],instRegionName:n.GroupType[t.type],instItem:v,selected:!1,cssClasses:o.join(" ")||undefined,sequenceNumber:u,showPlusIconInHeader:this.shouldShowPlusIconInGroupHeader(t.type,e),hideGroupHeader:this.shouldHideGroupHeader(t.type,s.title),popover:d},v&&n.InstrumentationHelper.instrumentSyntheticInstrumentedItem(u,p,v),this._resultsCounter.groups.push({typeWithSource:t,suggestions:[]}),this.insertGroup(y,f),y},t.prototype.insertGroup=function(t,i){for(var f,e=this,o=i.findIndex(function(i){return n.sameGroup(i,t.typeWithSource)}),u=!1,s=function(r){var f=i.findIndex(function(t){return n.sameGroup(t,e.groups[r].typeWithSource)});if(f>o)return h.groups.splice(r,0,t),u=!0,"break"},h=this,r=0;r<this.groups.length;r++)if(f=s(r),f==="break")break;u||this.groups.push(t)},t.prototype.handlePendingSubmit=function(t){if(this._pendingSubmitSequenceNumber==this._lastUpdatedSequenceNumber)try{if(this.topResults.length==0)(this.groups.length>0||t.length>0)&&this.showDisableEnterMessage();else{var i=this.topResults[0];return n.InstrumentationHelper.instrumentItemClick(this._pendingSubmitTimeStamp,i.instItem,i.sequenceNumber,i.instrumentPingBack,1,this._pendingSubmitModifierKeys),this._pendingSubmitModifierKeys&&this._pendingSubmitModifierKeys.ctrlKey&&this._pendingSubmitModifierKeys.shiftKey?this.launchVerb(i,k,this._pendingSubmitTimeStamp):this._pendingSubmitModifierKeys&&this._pendingSubmitModifierKeys.shiftKey?this.launchVerb(i,d,this._pendingSubmitTimeStamp):i.click(this._pendingSubmitTimeStamp,0,this._pendingSubmitModifierKeys),0}}finally{this.resetPendingSubmitSequenceNumber()}return 1},t.prototype.showDisableEnterMessage=function(){this._page.showTemporaryMessage(n.Host.getLocString("EnterOnAmbiguousTopHitMessageText"))},t.prototype.showIndexingMessage=function(t){var i=this,r;t?(this._turnOnIndexingInstItem=null,this._launchIndexingDataModel=null):(this._turnOnIndexingInstItem=n.InstrumentedItem.getNonSuggestionInstrumentedItem("IMIO",n.SyntheticQSCodesMaps.KValues),r={id:s,selected:null,text:n.Host.getLocString("WindowsIndexingDisabledAction"),title:null,instItem:this._turnOnIndexingInstItem,click:function(t,r){var u=n.SequenceNumberManager.getSequenceNumber();u>i._lastUpdatedSequenceNumber&&n.InstrumentationHelper.instrumentSyntheticInstrumentedItem(u,"IMIO",i._turnOnIndexingInstItem);n.InstrumentationHelper.instrumentItemClick(t,i._turnOnIndexingInstItem,u,null,r,null);n.LocalDataProvider.launchIndexingOptions(!1)},layout:1,isSelectable:!0});this._launchIndexingDataModel={messageText:t?n.Host.getLocString("WindowsIndexingInProgressMessage"):n.Host.getLocString("WindowsIndexingDisabledMessage"),icon:t?{content:"&#xE895",type:2}:null,messageClassName:"indexingMessage",title:t?n.Host.getLocString("WindowsIndexingInProgressToolTip"):n.Host.getLocString("WindowsIndexingDisabledToolTip"),action:r};this._page.updateTemporaryMessageView(this._launchIndexingDataModel);this._shouldHideWorkUpsell=!0},t.prototype.hideIndexingMessage=function(){this._turnOnIndexingInstItem=null;this._page.updateTemporaryMessageView(null);this._shouldHideWorkUpsell=!1},t.prototype.shouldShowWorkUpsellMessage=function(){var i,r=typeof n.isMsbWorkUpsellApplicable=="function"&&n.isMsbWorkUpsellApplicable(),t;if(r&&!this._shouldHideWorkUpsell)try{if(t=JSON.parse(n.LightweightStorage.getItem(ft)),!this.isWorkUpspellExpired(t))return((t===null||t===void 0?void 0:t.clicked)!==ut||this.isOldVersion(t.version))&&((i=this._partialQuery)===null||i===void 0?void 0:i.scope)==n.Scope.All}catch(u){return!1}return!1},t.prototype.isWorkUpspellExpired=function(t){var i=new Date,f=i.getDate(),e=i.getTime(),r,u;return t&&t.expireDate&&!this.isOldVersion(t.version)?e>t.expireDate:(r=i.setDate(f+(n.config.msbWorkScopeBannerExpiryInDays||0)),u={clicked:0,expireDate:r,version:n.config.msbWorkScopeBannerIndicatorVersion},this.setWorkUpsellInfo(u),!1)},t.prototype.isOldVersion=function(t){return t?t<n.config.msbWorkScopeBannerIndicatorVersion:!0},t.prototype.setWorkUpsellInfo=function(t){n.LightweightStorage.setItem(ft,JSON.stringify(t))},t.prototype.updateWorkUpsellMessage=function(t){var i=this,u=n.config.useCobaltCSS;if(t)try{var r=JSON.parse(n.LightweightStorage.getItem(ft)),f=typeof n.getStoredMsbTenantName=="function"&&n.getStoredMsbTenantName(),e={title:n.Host.getLocString("WorkUpsellTitle"),message:n.Host.getLocString("WorkUpsellMessage"),icon:{content:"data:image/png;base64,".concat(u?"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":"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"),type:0},buttonMessage:n.Host.getLocString("WorkUpsellButtonMessage"),buttonDismissMessage:n.Host.getLocString("WorkUpsellCobaltDismissButtonMessage"),tooltip:n.Host.getLocString("WorkUpsellButtonTooltip",f),buttonClickHandler:function(){i._headerFooterViewModel.clickHandler(n.Scope.Work,"WsbWorkUpsell");i._page.updateWorkUpsellAreaView(null);r.clicked=ut;i.setWorkUpsellInfo(r);bfbWsbTel.logWorkScopeClick("WsbWorkUpsell")},dismissClickHandler:function(){r.clicked=ut;i.setWorkUpsellInfo(r);i._page.updateWorkUpsellAreaView(null);bfbWsbTel.logWorkScopeClick("WsbWorkUpsellDismiss")}};this._page.updateWorkUpsellAreaView(e)}catch(o){this._page.updateWorkUpsellAreaView(null)}else this._page.updateWorkUpsellAreaView(null)},t.prototype.getAvailableSpace=function(t){var r=this,i;return n.isL2(this._partialQuery)&&this._partialQuery.queryToFetch?Number.MAX_VALUE:(i=this._page.getSuggestionsContainerHeight(),typeof n.enableBrandingBar=="function"&&n.enableBrandingBar()&&!n.config.useCobaltCSS&&(i-=vt+10),n.config.extraTopPadding&&!n.RuntimeConfig.SearchBoxOnTop&&(i-=n.config.extraTopPadding),n.RuntimeConfig.ScopesAvailable&&(i-=tr),t.topResults.length==0||n.RuntimeConfig.FlatListWithoutGroups||(i-=wi),t.topResults.forEach(function(t){return i-=oi(t,n.isL2(r._partialQuery))}),t.groups.forEach(function(n){return i-=uu(r._partialQuery,n)}),t.groups.some(function(t){return t.typeWithSource&&n.isTopHitChildGroup(t.typeWithSource)})&&t.groups.some(function(t){return t.typeWithSource&&!n.isTopHitChildGroup(t.typeWithSource)})&&(i-=nr),i)},t.prototype.getAvailableSpaceForZeroInputHomeTopSection=function(t,i){var r=this._page.getSuggestionsContainerWidth(),u,f;return n.shouldShowStaticSearchHome(this._partialQuery)||n.shouldShowDSBLayout(this._partialQuery)?r:(r-=n.RuntimeConfig.AlwaysWide?ir:rr,r-=p,u=t?t.suggestions.filter(function(n){return n&&!n.suppressed}).length:0,u+=i.suppressed?0:1,f=n.RuntimeConfig.AlwaysWide?ur:fr,r-=(f+p)*u,n.config.useCobaltCSS&&(r+=2*p),r)},t.prototype.canFitSuggestion=function(t,r,u){if(n.config.enableFullFitSearchTheWebMaxSuggestions&&r.type==n.GroupType.SearchSuggestions&&!this._partialQuery.isSearchHomeZI&&!t&&this.getAvailableSpace(this._resultsCounter)>=43)return u.suppressed&&(u.suppressed=!1),!0;if(u.suppressed||n.getTweakedSetting("scrollBarInL1")||u.handoffType===21&&n.config.msbVerticalChildSuggestionsNoTrim)return!0;var o=ei(this._resultsCounter),f;return t?(f={typeWithSource:r,suggestions:[]},o.groups.push(f)):f=i(o.groups,r),f.suggestions.push({mainTextWrapsToTwoLines:u&&e(u,r.type,!1),isSuppressed:u&&u.suppressed,hasTwoLines:u&&n.contains(u.classNames,"forceNoWrapOutsideTopResult")}),this._partialQuery.isSearchHomeZI?this.canFitSuggestionInZeroInputHome(r,u):this.getAvailableSpace(o)>=0},t.prototype.canFitSuggestionInZeroInputHome=function(t,r){if(r.type==="SNSC"||t.type===n.GroupType.TrendingSearchData||typeof n.enableQws=="function"&&n.enableQws()&&(t.type===n.GroupType.QuickWorkSearch||t.type===n.GroupType.RecommendedDocs))return!0;var u=i(this.groups,t);return t.type==n.GroupType.MRUHistory?!0:ci(t.type)?this.getAvailableSpaceForZeroInputHomeTopSection(u,r)>=0:(u?u.suggestions.length:0)<this.getMaxNumberOfRecentItems(t.type)},t.prototype.getCountOfSuggestionsToReduce=function(){var t=0,i=SearchAppWrapper.CortanaApp.height;typeof n.enableBrandingBar=="function"&&n.enableBrandingBar()&&n.isTwoPanesZIEnabled()&&!n.config.useCobaltCSS&&(i-=vt);var f=n.shouldShowStaticSearchHome(this._partialQuery)||n.shouldShowDSBLayout(this._partialQuery),u=i-w,r=n.canShowSearchHomeUpsell(this._partialQuery)&&f;return f?i<ar?t=r?7:4:i<lr?t=r?6:3:i<cr?t=r?5:2:i<w?t=r?4:1:i>w&&r&&(u<o/3?t=4:u<o/2?t=3:u<o/1.5?t=2:u<o&&(t=1)):i<hr?t=4:i<sr?t=3:i<or?t=2:i<er&&(t=1),t},t.prototype.getMaxNumberOfRecentItems=function(t){if(t===n.GroupType.MSNNews)return 5;if(t==n.GroupType.MRUHistory||t==n.GroupType.RecommendedDocs||t==n.GroupType.CuratedSuggestions){var i=n.ScopeConfig[n.Scope.All].enabledDataSourcesForZeroInput,r=i.some(function(n){return n&&n.suggestionGroupToggler&&n.suggestionGroupToggler.isHidden()}),u=n.RuntimeConfig.PreviewPaneAvailable&&n.shouldEnableQuickSearches(n.Host.getLanguage().toLowerCase())&&!r||n.shouldShowStaticSearchHome(this._partialQuery)||n.shouldShowDSBLayout(this._partialQuery);if(u)return n.isL2(this._partialQuery)?10:this._partialQuery.isSearchHomeZI&&n.isMsbEnterprise()&&typeof n.isGccHighTenant=="function"&&!n.isGccHighTenant()&&typeof n.msbDsbHost=="undefined"&&typeof n.shouldHideTopApp=="function"&&n.shouldHideTopApp()&&n.isQwsSuccessRateThresholdMet()&&typeof n.isTenantMsbEnabled=="function"&&n.isTenantMsbEnabled()?6:(n.isMsbEnterprise()&&n.config.enableMRU10&&(n.config.activityInZI=9),n.config.activityInZI-this.getCountOfSuggestionsToReduce())}return n.config.activityInZI},t.prototype.getMaxNumberOfGroupsToFitMinSuggestionsPerGroup=function(){var i,r,u,t,f;if(n.isL2(this._partialQuery)&&this._partialQuery.queryToFetch||n.getTweakedSetting("scrollBarInL1"))return Number.MAX_VALUE;if(this._partialQuery.isSearchHomeZI)return typeof n.enableQwsRecDocs=="function"&&n.enableQwsRecDocs()&&typeof n.qwsShowTopList=="function"&&n.qwsShowTopList()&&n.isQwsSuccessRateThresholdMet()&&n.isMsbEnterprise()&&typeof n.isGccHighTenant=="function"&&!n.isGccHighTenant()?(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.msbSHGroupsLimit)!=null?n.TestHookUrlParameters.msbSHGroupsLimit:5+(n.config.msbQwsDynamicDisableEnabled?2:0)+(n.config.msbEnableDocumentZQ?1:0):4;for(i=ei(this._resultsCounter),r=0,u=i.groups;r<u.length;r++)for(t=u[r];t.suggestions.length<n.config.minSuggestionsPerGroup;)t.suggestions.push(t.suggestions[0]);while(this.getAvailableSpace(i)>0){for(t={suggestions:[]},f=0;f<n.config.minSuggestionsPerGroup;++f)t.suggestions.push({mainTextWrapsToTwoLines:!1,isSuppressed:!1,hasTwoLines:!1});i.groups.push(t)}return i.groups.length-1},t.prototype.onSuggestionAddedToGroup=function(t,r){var f=this,u,o;this.updateNarratorWithPreviewMessage(t);n.isChildSuggestion(t)&&(t.displayed=!0,u=t.parent,t.id=u.id+"_"+u.childSuggestions.indexOf(t),n.isJumpListSuggestion(t)&&t.tooltip===undefined&&n.Async.safeChain("getJumpListDescription",function(){return t.jumpListItem.getDescriptionAsync()},function(i){t.tooltip=i;f.groups.some(function(i){return n.contains(i.suggestions,t)})&&f.renderGroups()}));this.setRemoveIcon(t);o=i(this._resultsCounter.groups,r.typeWithSource);o.suggestions.push({mainTextWrapsToTwoLines:e(t,r.typeWithSource.type,!1),isSuppressed:t.suppressed,hasTwoLines:n.contains(t.classNames,"forceNoWrapOutsideTopResult")});n.displayedInGridLayout(r.typeWithSource.type)&&r.suggestions.filter(function(n){return!n.suppressed}).length>0&&(r.cssClasses+=n.isL2(this._partialQuery)?" gridLayout":" gridLayout gridLayoutMedium")},t.prototype.onGroupsCleared=function(){this._pendingSuggestionsInExistingGroups=[];this._pendingSuggestionsInMissingGroups=[];this._resultsCounter.groups=[];this._turnOnIndexingInstItem&&n.InstrumentationHelper.instrumentSyntheticInstrumentedItem(this._lastUpdatedSequenceNumber,"IMIO",this._turnOnIndexingInstItem)},t.prototype.dismissTour=function(t){var i={query:t.queryToFetch};n.LightweightStorage.setItem("wweTourTook","1");n.LightweightStorage.setItem("wweTourRefreshed","1");n.LightweightStorage.removeItem("wweTourEnabled");n.StaticHtmlElements.root.classList.remove("overlayEnabled");n.setZeroInputDataSourcesForL1();n.Host.refreshCurrentPane();n.LightweightStorage.removeItem("wweTourRefreshed");n.InstrumentationHelper.logClientInstEvent("Select","WWETourDismiss",null,i)},t.prototype.launchSearch=function(t,i){var r=t.queryToFetch;n.config.enableMoreEdgeProtocol?n.Host.launchSearch(r,this._navigationHelper.getSearchUrl(t.fullPartialQuery,r,i),!1,i):n.Host.launchSearch(r,this._navigationHelper.getSearchUrl(t.fullPartialQuery,r,i),!1)},t.prototype.setRemoveIcon=function(t){var r=this,u=t.getExtraVerbs&&t.getExtraVerbs(!1).some(function(n){return n.verb=="RemoveFromDeviceHistory"}),o=t.type=="HS"&&n.config.removeSuggUrl,s=n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.forceRemoveIcon,f=t.getExtraVerbs&&t.getExtraVerbs(!1).some(function(n){return n.verb=="RemoveFromDeviceHistoryAll"}),e=this._partialQuery.isSearchHomeZI&&t.type=="ANAH",i;(s||u||o||f||e)&&(i="RemoveFromWebHistory",f?i="RemoveFromDeviceHistoryAll":(u||e)&&(i="RemoveFromDeviceHistory"),t.removeIcon={icon:{content:"&#xE711",type:2},title:n.Host.getLocString(i),selected:!1,click:function(u,f){r._page.hideTemporaryMessage();n.InstrumentationHelper.instrumentItemClickForContextMenu(u,t.instItem,t.sequenceNumber,t.instrumentPingBack,f,null,i);r.launchVerb(t,i,u);n.Host.setFocusInSearchBox(null,"remove")}})},t.prototype.updateNarratorWithPreviewMessage=function(t){var r=n.RuntimeConfig.AlwaysWide?"PreviewPaneButtonNarratorMessageWidePane":"PreviewPaneButtonNarratorMessage",i=n.Host.getLocString(r);t.narratorText&&t.previewPaneType&&t.narratorText.indexOf(i)==-1&&(t.narratorText+=", "+i)},t.prototype.handleWorkScopeRequeryTophit=function(n,t){var i=t.findIndex(function(t){return t.msbVerticalHash===n.msbVerticalHash});i>-1&&(t[i].selected=!0,this._selectedItem=n);this._previewPane.onQueryChanged(this._partialQuery,n)},t.prototype.onBeforeRenderTopResults=function(t,i,r,u,f){var s=this,l,d=typeof n.isMsbWorkUpsellApplicable=="function"&&n.isMsbWorkUpsellApplicable(),a=!1,v,h,y,e,o,p,w,k;this.topResults.forEach(function(n){s.setRemoveIcon(n);s.updateNarratorWithPreviewMessage(n)});d&&!a&&this._partialQuery.queryToFetch&&(a=this.shouldShowWorkUpsellMessage());this.updateWorkUpsellMessage(a);v=1;this.topResults.length!=1||this.topResults[0].hasChildSuggestionsDisplayed||r.some(function(t){return n.isChildSuggestion(t)})&&(((l=this._partialQuery)===null||l===void 0?void 0:l.scope)!==n.Scope.Work&&(this.topResults[0].hasChildSuggestionsDisplayed=!0),v=0);h=!1;y=this.getSelectableItems();n.RuntimeConfig.FirstSuggestionSelectedByDefault?(!this._selectedItem||!n.contains(y,this._selectedItem)||this.isScopeElement(this._selectedItem)||this._selectedItem==i[0]&&this.topResults[0]!=i[0]||this._selectedItem!=y[0]||this._selectedItem.previewPaneNeedsRefreshAfterDeduping)&&(e=this._partialQuery.queryToFetch&&this.topResults.length>0?this.topResults[0]:null,o=this._selectedItem&&this.isSuggestion(this._selectedItem)?this._selectedItem:null,n.config.synthWebNoBestMatch&&n.isNullOrUndefined(e)&&(p=[n.GroupType.SearchSuggestions,n.GroupType.Websites],w=r.filter(function(t){return!n.contains(p,n.getGroupType(t))}),w.length==0&&(e=r.length>0?r[0]:null)),this._previewPane&&n.RuntimeConfig.PreviewPaneAvailable&&(!n.config.msbNewWorkScopeEnabled&&this._partialQuery.queryToFetch&&this._partialQuery.scope===n.Scope.Work&&o&&typeof n.isMsbWorkScope=="function"&&n.isMsbWorkScope(o.handoffType)&&this._previewPane.getPreviewedSuggestion()&&o.reactKey?(e=o,this.handleWorkScopeRequeryTophit(e,r),h=!0):(h=!1,n.safeExecute(function(){return s._previewPane.onTopHitUpdated(s._partialQuery,o,e,s.getSuggestions(!1))},"ppOnTopHitUpdated"))),this.select(e,!1),this._page.scrollToTop()):t&&this.select(null,!1);var b=this.topResults.length>0,c=function(t){return!t.suppressed&&t.staticGroupType!=n.GroupType.VisualSearch},g=r&&r.length>0;return this._headerFooterViewModel&&!h&&(k=b||r.some(c)||this.groups.some(function(n){return n.suggestions.some(c)})||this._pendingSuggestionsInMissingGroups.some(function(n){return n.suggestions.some(c)})||this._pendingSuggestionsInExistingGroups.some(function(n){return n.suggestions.some(c)}),this._headerFooterViewModel.render(this._partialQuery,b,k,u,f,g)),v},t.prototype.isRankable=function(t){return n.config.enableAnaheimRelevance==2?t.typeWithSource.type!=n.GroupType.Websites&&t.typeWithSource.type!=n.GroupType.LocalPlaces&&!t.suggestions.some(n.enforceOriginalOrder):t.typeWithSource.type!=n.GroupType.SearchSuggestions&&t.typeWithSource.type!=n.GroupType.Websites&&t.typeWithSource.type!=n.GroupType.LocalPlaces&&!t.suggestions.some(n.enforceOriginalOrder)},t.prototype.isNotRankableWithRecourse=function(t){return t.typeWithSource.type==n.GroupType.Emails},t.prototype.openPreviewPane=function(t,i){if(i.stopPropagation(),this._previewPane.showPreview(this._partialQuery,t),n.getGroupType(t)==n.GroupType.SearchSuggestions||n.isChildSuggestion(t))this.onSuggestionLaunch(t,this._partialQuery);this.select(t,!0);n.config.reactGroups&&this.selectGroupItem(t);n.Host.setFocusInSearchBox(null,"openPreviewPane")},t.prototype.mayNeedFlush=function(){return!n.RuntimeConfig.FlatListWithoutGroups},t.prototype.update=function(t,i,r,u,f,o,s,h,c,l){var a=this,g,nt=this.topResults,p,tt,it,w,ut,v,ct,ot,d,vt,st;if(t&&(this._contentQuery=this._partialQuery,this._renderTopResultsTimerForIcons=null,this._renderGroupsTimerForIcons=null),n.config.enableMRUHint)for(p=0,tt=i;p<tt.length;p++)it=tt[p],it.mruHintEnabled&&(it.uxHint=n.Host.getLocString("MruBestMatch"));var ht=this.updateTopResults(t,i,r,u,f,c),rt=ht[0],yt=ht[1];for(yt(),this._resultsCounter.topResults=[],w=0,ut=this.topResults;w<ut.length;w++)v=ut[w],v.previewPaneNeedsRefreshAfterDeduping=!1,ct=1+(v.primaryMetadata?1:0)+(v.secondaryMetadata?1:0),this._resultsCounter.topResults.push({mainTextWrapsToTwoLines:e(v,null,!0),numberOfLines:ct,isHtmlAnswer:!!v.htmlContent,isSuppressed:!1,grid:n.displayedInGridLayout(v.type)});if(this._autoComplete&&this.topResults.length>0&&this._selectedItem==this.topResults[0]&&this._autoComplete.apply(this.topResults[0]),this.handlePendingSubmit(f)==0)return this.toggleProgressBar(!0),0;this._partialQuery&&this._partialQuery.isSearchHomeZI&&this.toggleProgressBar(!c);var ft=!1,b=0,pt=this.createIconRenderInfo(),lt=function(){var t,i;ft&&(t=a.groups.map(function(n){return n.typeWithSource.type}),a._contentQuery.queryToFetch||b!=0||(i=a._cvidAtLastRender!=n.Host.getConversationId(),a._cvidAtLastRender=n.Host.getConversationId(),n.InstrumentationHelper.instrumentZiRendered(u,i)),n.InstrumentationHelper.instrumentRenderFinished(u,s,t,b!=0,!a._contentQuery.queryToFetch))},et=function(t,i){var f,e=!1,r,o,s;if(a.isRankable(i)&&a._partialQuery&&a._partialQuery.queryToFetch)for(r=0;r<i.suggestions.length;r++)if(t.rankingScore>i.suggestions[r].rankingScore){i.suggestions.splice(r,0,t);e=!0;break}e||(o=n.config.msbNewWorkScopeEnabled&&((f=a._partialQuery)===null||f===void 0?void 0:f.scope)===n.Scope.Work,s=!t.childSuggestions&&t.handoffType===21,o&&!s&&i.suggestions.length>=n.config.msbWorkScopeGroupSuggestionLimit||i.suggestions.push(t));++b;a.setupIcon(u,t,pt,function(){--b;lt()});a.onSuggestionAddedToGroup(t,i)},y=this.getMaxNumberOfGroupsToFitMinSuggestionsPerGroup()-this.groups.length,k=!1,at=function(){var i,f,t,e;if(y!=0&&r||a.flush(et,u,h),a.groups.sort(function(t,i){return h.findIndex(function(i){return n.sameGroup(i,t.typeWithSource)})-h.findIndex(function(t){return n.sameGroup(t,i.typeWithSource)})}),a._partialQuery&&a._partialQuery.queryToFetch)for(i=0,f=a.groups;i<f.length;i++)t=f[i],a.isRankable(t)?t.suggestions.sort(function(n,t){return t.rankingScore-n.rankingScore}):a.isNotRankableWithRecourse(t)&&(e=t.suggestions.map(function(n){return n.notAResult}).findIndex(function(n){return n}),e!=-1&&t.suggestions.splice(t.suggestions.length-1,0,t.suggestions.splice(e,1)[0])),a.populateGroupHeaderFlags(t)};return t||f.length>0||o.length>0?(this.renderGroupsAfter(function(){for(var ut,s,c,k,d,v,g,p,tt,i,w,it,e=0,b=o;e<b.length;e++)i=b[e],ut=a.removeSuggestion(i,l),ut&&(y+=1);for(s=function(t,i){var e=a.getGroupData(t),f=e[0],r=e[1],o;(n.cohortProfileManager===null||n.cohortProfileManager===void 0?void 0:n.cohortProfileManager.isTourVisible())&&(t.click=undefined,t.tooltip=undefined);r?(r.count&&r.count++,o=n.config.minSuggestionsPerGroup&&!i?n.config.minSuggestionsPerGroup-r.suggestions.length:999,o>0&&a.canFitSuggestion(!1,f,t)?et(t,r):a._partialQuery.isSearchHomeZI||a.queueSuggestionInExistingGroup(t,r)):y>0&&a.canFitSuggestion(!0,f,t)?(r=a.addGroup(f,t,u,h,l),a.shouldTrackGroupCount(r)&&(r.count=1),et(t,r),y-=1):a._partialQuery.isSearchHomeZI||a.queueSuggestionInMissingGroup(t,f,l)},c=0,k=nt;c<k.length;c++){var ft=k[c],ot=a.getGroupData(ft),r=ot[1];r&&r.count&&(r.count-=1)}if(d=function(){return a._contentQuery.isSearchHomeZI||n.getTweakedSetting("scrollBarInL1")||n.config.bypassSuggestionQueueForL2&&n.isL2(a._contentQuery)},rt&&!t){for(v=0,g=f;v<g.length;v++)i=g[v],n.contains(nt,i)&&s(i,!0);for(p=0,tt=f;p<tt.length;p++)i=tt[p],n.contains(nt,i)||s(i,d())}else f.forEach(function(n){return s(n,d())});for(w=0,it=a.topResults;w<it.length;w++){var ft=it[w],st=a.getGroupData(ft),r=st[1];r&&r.count&&(r.count+=1)}at()}),this.isWorkScope()&&((g=this.groups)===null||g===void 0?void 0:g.length)>1&&(ot=this.groups.findIndex(function(t){return t.type===n.GroupType.Related}),ot>-1&&(this.groups[ot].maxSuggestionsToShow=vr)),k=!0,ft=!0):y!=0&&r||(this._pendingSuggestionsInMissingGroups.some(function(n){return n.suggestions.length>0})||this._pendingSuggestionsInExistingGroups.some(function(n){return n.suggestions.length>0}))&&(this.renderGroupsAfter(function(){return at()}),k=!0,ft=!0),(rt||k)&&(d=void 0,rt?k||(d=!0):d=!1,this.resetIconTimers(d,!0)),vt=this.groups.findIndex(function(t){return t.type==n.GroupType.MRUHistory}),vt>-1&&(st=this.groups.findIndex(function(t){return t.type==n.GroupType.CuratedSuggestions}),st>-1&&this.groups.splice(st,1)),lt(),c&&this.toggleProgressBar(!1),n.config.mruSearchHome&&this._partialQuery.isSearchHomeZI&&this._partialQuery.scope==n.Scope.All&&this.sortMRUList(),1},t.prototype.sortMRUList=function(){var r=this.groups.filter(function(t){return t.type==n.GroupType.MRUHistory}),u=this.groups.filter(function(t){return t.type!=n.GroupType.MRUHistory}),f=this.getMaxNumberOfRecentItems(n.GroupType.MRUHistory),t,i;r.length>0?(n.LightweightStorage.removeItem(ti),t=r[0],t.suggestions.sort(function(n,t){return t.lastLaunchTime-n.lastLaunchTime}),t.suggestions.length>f&&(t.suggestions=t.suggestions.splice(0,f)),i=-1,this.groups.forEach(function(t,r){i=t.type==n.GroupType.MRUHistory?r:i}),u.splice(i,0,t),this.groups=u,this.renderGroups()):n.LightweightStorage.setItem(ti,"1")},t.prototype.canGoToL2=function(n){return n.click&&!n.instItem},t.prototype.populateGroupHeaderFlags=function(n){if(this.canGoToL2(n)){var t=n.suggestions.every(function(n){return n.suppressed});n.showCountInHeader=t}},t.prototype.shouldTrackGroupCount=function(n){return this.canGoToL2(n)},t.prototype.getGroupData=function(t){var r={type:n.getGroupType(t),source:t.sourceForGroup};return n.enableMRUSearchHome()&&r.type==n.GroupType.MRUHistory&&(r.source=undefined),[r,i(this.groups,r)]},t.prototype.removePendingSuggestionFromExistingGroup=function(n,t){for(var r,u,i=0;i<this._pendingSuggestionsInExistingGroups.length;++i)if(r=this._pendingSuggestionsInExistingGroups[i],r.group==t)if(u=r.suggestions.indexOf(n),u==-1)throw new Error("Pending suggestion not found in existing group");else{r.suggestions.splice(u,1);r.suggestions.length==0&&this._pendingSuggestionsInExistingGroups.splice(i,1);return}throw new Error("Pending suggestion not found: pending suggestions in existing groups is empty");},t.prototype.removePendingSuggestionFromMissingGroup=function(t,i){for(var u,f,r=0;r<this._pendingSuggestionsInMissingGroups.length;++r)if(u=this._pendingSuggestionsInMissingGroups[r],n.sameGroup(u.typeWithSource,i))if(f=u.suggestions.indexOf(t),f==-1)throw new Error("Pending suggestion not found in missing group");else{u.suggestions.splice(f,1);u.suggestions.length==0&&this._pendingSuggestionsInMissingGroups.splice(r,1);return}throw new Error("Pending suggestion not found: pending suggestions in missing groups is empty");},t.prototype.queueSuggestionInExistingGroup=function(n,t){var i=si(this._pendingSuggestionsInExistingGroups,t.typeWithSource);i?i.suggestions.push(n):(i={group:t,suggestions:[n]},this._pendingSuggestionsInExistingGroups.push(i))},t.prototype.queueSuggestionInMissingGroup=function(n,t,r){var u=i(this._pendingSuggestionsInMissingGroups,t);u?u.suggestions.push(n):(u={typeWithSource:t,suggestions:[n],extraSignalsMap:r},this._pendingSuggestionsInMissingGroups.push(u))},t.prototype.partialFlush=function(n,t,i,r){while(n>0&&i.length>0){var u=i[0];this.canFitSuggestion(!1,t.typeWithSource,u)&&r(u,t);i.splice(0,1);n-=1}},t.prototype.flush=function(t,i,r){for(var e,s,u,c,l=this,a=function(u){var o=u.suggestions[0],e;o&&f.canFitSuggestion(!0,u.typeWithSource,o)&&(e=f.addGroup(u.typeWithSource,o,i,r,u.extraSignalsMap),f.shouldTrackGroupCount(e)&&(e.count=u.suggestions.length),f.partialFlush(n.config.minSuggestionsPerGroup,e,u.suggestions,t),u.suggestions.forEach(function(n){return l.queueSuggestionInExistingGroup(n,e)}),u.suggestions=[])},f=this,o=0,h=this._pendingSuggestionsInMissingGroups;o<h.length;o++)u=h[o],a(u);while(this._pendingSuggestionsInExistingGroups.some(function(n){return n.suggestions.length>0}))for(e=0,s=this._pendingSuggestionsInExistingGroups;e<s.length;e++)u=s[e],c=n.config.minSuggestionsPerGroup?1:u.suggestions.length,this.partialFlush(c,u.group,u.suggestions,t)},t.prototype.removeSuggestion=function(t,r){var s={type:n.getGroupType(t),source:t.sourceForGroup},u=i(this.groups,s),f,h,o;if(u)if(n.tryRemove(u.suggestions,t)){if(f=i(this._resultsCounter.groups,u.typeWithSource),h=e(t,u.typeWithSource.type,!1),n.removeFirstWhere(f.suggestions,function(n){return n.mainTextWrapsToTwoLines==h}),n.displayedInGridLayout(u.typeWithSource.type)&&u.suggestions.filter(function(n){return!n.suppressed}).length==0&&(u.cssClasses=""),u.suggestions.length==0)return n.tryRemove(this.groups,u),this._resultsCounter.groups=this._resultsCounter.groups.filter(function(n){return n!=f}),o=si(this._pendingSuggestionsInExistingGroups,u.typeWithSource),o&&this._pendingSuggestionsInMissingGroups.push({typeWithSource:u.typeWithSource,suggestions:o.suggestions,extraSignalsMap:r}),!0}else this.removePendingSuggestionFromExistingGroup(t,u);else this.removePendingSuggestionFromMissingGroup(t,s);return!1},t.prototype.isScopeElement=function(n){return this._headerFooterViewModel&&this._headerFooterViewModel.isScopeElement(n)},t.prototype.createIconRenderInfo=function(n){var t={iconsPendingReturn:0,isTopResult:n};return this._iconRenderInfos.push(t),t},t.prototype.getCurrentTopResults=function(){return this.topResults.slice(0)},t.prototype.getTopResultsWhichFitInCanvas=function(n){return n},t.prototype.resetAriaSelected=function(n){n&&this._page.render(function(){var t=_ge(n.id);t&&(t.setAttribute("aria-selected","false"),t.setAttribute("aria-selected","true"))})},t.prototype.updateTopResults=function(t,i,r,u,f,e){var h=this,a,o,s,y;t!=(u!=this._lastUpdatedSequenceNumber)&&SharedLogHelper.LogError("updateTopResult",t+" != (sequenceNumber "+u+" != lastUpdateSequenceNumber "+this._lastUpdatedSequenceNumber+")",new Error("Precondition failed"));this._lastUpdatedSequenceNumber=u;t&&(this.groups=[],this.onGroupsCleared());a=this._selectedItem;o=this.topResults;i=this.getTopResultsWhichFitInCanvas(i);i.forEach(function(t){n.RuntimeConfig.QfMode==5||n.RuntimeConfig.QfMode==9||t.staticGroupType&&t.staticGroupType==n.GroupType.Upsell||!t.secondaryMetadata||t.secondaryMetadata.indexOf(n.Host.getLocString("LastModified")+": ")!==0||(t.template=1,t.narratorText=n.getNarratorText(t))});s=!n.sequenceEqual(i,o)||o.some(function(n){return n.needsRefreshAfterDeduping});s&&(this.topResults=i.slice(0));var c=!1,l=s?i.length:0,p=this.createIconRenderInfo(!0),v=function(){c&&(n.config.enableLocalInstrumentation&&n.InstrumentationHelper.instrumentRenderedLocalSuggestion(u,i),n.InstrumentationHelper.instrumentTopResultRendered(u,i.map(function(n){return n.type}),l!=0))};return s?(this.renderTopResultsAfter(function(){for(var s,i=0,c=h.topResults;i<c.length;i++)s=c[i],s.needsRefreshAfterDeduping=!1,n.contains(o,s)?l-=1:h.setupIcon(u,s,p,function(){l-=1;v()});h.onBeforeRenderTopResults(t,o,f,r,e)}),c=!0):(y=this.onBeforeRenderTopResults(t,o,f,r,e),y==0&&(this.renderTopResults(),c=!0)),this._selectedItem&&(a!=this._selectedItem||t)&&n.contains(this.topResults,this._selectedItem)&&this.resetAriaSelected(this._selectedItem),[s,v]},t.prototype.renderGroupsAfter=function(n){var t=this._groupRenderingDisabled;this._groupRenderingDisabled=!0;try{n()}finally{this._groupRenderingDisabled=t;this.renderGroups()}},t.prototype.renderTopResults=function(t){this._topResultsRenderingDisabled||(this._page.updateTopResultsView({query:this._contentQuery,topResults:this.topResults,groups:this.groups},t),n.InstrumentationHelper.updateSuggestionsList(this.topResults,this.groups))},t.prototype.renderTopResultsAfter=function(n){var u=this._topResultsRenderingDisabled,t,i,r;this._topResultsRenderingDisabled=!0;try{n()}finally{for(this._topResultsRenderingDisabled=u,this.renderTopResults(),t=0,i=this.topResults;t<i.length;t++)r=i[t],r.executeScript&&r.executeScript()}},t}();n.RootViewModel=vi})(WSB||(WSB={}))